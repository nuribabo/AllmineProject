(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{221:function(e,t,n){"use strict";n.r(t);var i=n(2),a=n.n(i),o=n(4),s=n.n(o),r=n(8),l=n(139),c=n(69),u=n(33),d=n(11),h=n(36),p=n(21),m=n(51),f=n(12),v=n(15),g=n(321),E=n(344),y=n(361),T=n(522),I=n(270),C=n(253),k=n(0),L=n.n(k),_=n(1),w=n.n(_),S=n(229),b=n(404),R=n(250),A=n(473),O=n(237),P=function(){function e(t,n,i,a){if(L()(this,e),this.launcherParam=t,this.useOverWrite=!1,null==t){if(!i||!i.rawData)return;if(this.localSaveParameter=(new A.a).getSaveFailedDesignDoc(n.idx,i.designHistoryIdx),this.launcherParam=Object.assign({},JSON.parse(i.rawData).launcherParam),!this.launcherParam.mode)return;var o=i.designHistoryIdx||i.historyIdx;if(a&&a.rawData){var s=Object.assign({},JSON.parse(a.rawData).launcherParam);s.mode&&(s.mode===R.a.NEW?(o=a.designHistoryIdx||a.historyIdx,this.launcherParam=s):s.mode===R.a.UPDATE&&(this.useOverWrite=!0,s.mode!==this.launcherParam.mode&&(this.launcherParam.mode=s.mode,this.launcherParam=s)))}this.launcherParam.design={id:n.idx,revision:o}}this.init(this.launcherParam)}return w()(e,[{key:"init",value:function(e){e&&(S.a.initOption(e),b.a.initMasks(),e.output&&e.output.guides&&(this.printGuides=e.output.guides,this.printGuides.forEach(function(e){e.position&&(e.position=O.a.createWithRightBottom(e.position.left,e.position.top,e.position.right,e.position.bottom))})))}},{key:"hasOption",value:function(){return!!this.launcherParam&&!!this.launcherParam.mode}},{key:"shouldPrintInspectWhenOpen",value:function(){var e=navigator.platform.toLowerCase(),t=e.includes("win")||e.includes("mac");return S.a.getExecutionMode().isChangeUpdateMode()&&t}}]),e}(),D=n(354),M=n(166),N=n(474),x=n(290),B=n(6),V=n.n(B),U=n(3),F=n.n(U),G=n(14),H=n.n(G),W=n(7),z=n.n(W),K=n(224),Y=n(226),X=n(225),j=n(367),Z=n(243),q=n(238),Q=n(230),J=n(236),ee=n(239),te=function(){function e(){L()(this,e)}return w()(e,null,[{key:"getItemIdList",value:function(e){var t=[];return e.forEach(function(e){t.push(e.tbpeId)}),t}},{key:"getNoEditItemIdList",value:function(e){var t=[];return e.forEach(function(e){e.isEditMode||t.push(e.tbpeId)}),t}}]),e}(),ne=n(10),ie=n(336),ae=n(282),oe=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).actionType=K.a.ONE_TIME,e.changeDesign=function(){return!1},e.commitAction=function(n,i,a){var o=a.canvasAreaVC.printout;if(o){var s={isShowPrintoutGuide:t.getIsShowPrintoutGuide,isPhotoCropMode:t.getIsPhotoCropMode,getPageSize:function(){return t.getPageSize()},getActiveItems:t.getActiveItems,getRenderedPageId:e.getRenderedPageId.bind(H()(e)),getPageDOMPosition:e.getPageDOMPosition.bind(H()(e)),getPageCount:e.getPageCount.bind(H()(e)),getAllPageIdList:e.getAllPageIdList.bind(H()(e)),removeNotExistResultOfItem:e.removeNotExistResultOfItem.bind(H()(e)),removePrintoutGuideById:e.removePrintoutGuideById.bind(H()(e)),removeNotExistResultOfPage:e.removeNotExistResultOfPage.bind(H()(e)),selectItemById:e.selectItemById.bind(H()(e))};o.setCallbackReference(s)}var r={isSelected:e.isSelected.bind(H()(e)),getItemTitle:e.getItemTitle.bind(H()(e)),selectItemByIdList:e.selectItemByIdList.bind(H()(e)),getItemThumbElement:e.getItemThumbElement.bind(H()(e)),showAlertPopup:e.showAlertPopup.bind(H()(e))};ie.a.setCallbackReference(r),a.itemGuideAlertMobile.setPrintoutAlertBtnClickListener(e.showAlertPopup.bind(H()(e)))},e.rollbackAction=function(){},e.recycle=function(){},e.doSaveQueue=!1,e.renderAuto=!1,e}var n,i,o;return z()(t,e),w()(t,[{key:"getRenderedPageId",value:function(){var e="";return X.a.instance.dispatch(new K.c(function(t,n){e=t.pages[n.renderPageIdx].pageId})),e}},{key:"getPageDOMPosition",value:function(){var e=null;return X.a.instance.dispatch(new K.c(function(t,n){var i=t.pages[0].sheetSize,a=n.zoomScale*n.pageEditScale;e={left:0,top:0,width:i.width*a,height:i.height*a}})),e}},{key:"getPageCount",value:function(){var e=0;return X.a.instance.dispatch(new K.c(function(t){e=t.pages.length})),e}},{key:"getAllPageIdList",value:function(){var e=[];return X.a.instance.dispatch(new K.c(function(t){t.pages.forEach(function(t){return e.push(t.pageId)})})),e}},{key:"isSelected",value:function(e){var t=this.searchItem(e);return!!t&&t.select}},{key:"getItemTitle",value:function(e){var t="null",n=this.searchItem(e);return n&&(t=n instanceof q.a?n.props.getText():Q.b.getText(n.getResourceType())),t}},{key:"searchItem",value:function(e){var t=null;return X.a.instance.dispatch(new K.c(function(n){n.pages.forEach(function(n){return n.getAllSingleItems().forEach(function(n){n.tbpeId===e&&(t=n)})})})),t}},{key:"selectItemByIdList",value:(o=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&0!==t.length){e.next=2;break}return e.abrupt("return");case 2:n=[],X.a.instance.dispatch(new K.c(function(){var e=s()(a.a.mark(function e(i,o,s){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.forEach(function(e){i.pages.forEach(function(t){return t.getAllSingleItems().forEach(function(t){t.tbpeId!==e||n.push(t)})})}),0!==n.length){e.next=3;break}throw new Error("해당 아이템을 찾을 수 없습니다.");case 3:return J.a.selectItems(n),e.next=6,s.renderAuto(i,o);case 6:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})},{key:"getItemThumbElement",value:function(e){var n=document.createElement("div");return n.className=r.a.THUMB,X.a.instance.dispatch(new K.c(function(i){i.pages.forEach(function(i){return i.getAllSingleItems().forEach(function(){var i=s()(a.a.mark(function i(o){var s;return a.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(o.tbpeId!==e){i.next=13;break}if(!(o instanceof q.a)){i.next=5;break}Object(ne.setToolsIcon)(n,ne.ToolsIcon.ITEM_TEXT),i.next=13;break;case 5:if(!(o instanceof Z.a)){i.next=9;break}Object(ne.setToolsIcon)(n,ne.ToolsIcon.ITEM_GRID),i.next=13;break;case 9:return i.next=11,t.renderItemThumb(o);case 11:s=i.sent,n.appendChild(s);case 13:case"end":return i.stop()}},i)}));return function(e){return i.apply(this,arguments)}}())})})),n}},{key:"showAlertPopup",value:function(e){X.a.instance.dispatch(new K.c(function(t,n,i){t.pages.forEach(function(t){return t.getAllSingleItems().forEach(function(){var n=s()(a.a.mark(function n(o){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:o.tbpeId===e&&i.canvasAreaVC.printout.showAlertPopup(t.pageId,o.tbpeId);case 1:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}())})}))}},{key:"removePrintoutGuideById",value:function(e){X.a.instance.dispatch(new K.c(function(){var t=s()(a.a.mark(function t(n,i,o){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.pages.forEach(function(t){return t.getAllSingleItems().forEach(function(t){t.tbpeId===e&&t})}),o.canvasAreaVC.printout&&(o.canvasAreaVC.printout.removeItemById([e]),ie.a.addItemAlert(e,ae.a.DELETE_ITEM));case 2:case"end":return t.stop()}},t)}));return function(e,n,i){return t.apply(this,arguments)}}()))}},{key:"removeNotExistResultOfItem",value:function(){X.a.instance.dispatch(new K.c(function(e,t,n){e.pages.forEach(function(e){var t=te.getItemIdList(e.getAllSingleItems());n.canvasAreaVC.printout.inspectionResult.removeNotExistResultOfItem(e.pageId,t)})}))}},{key:"selectItemById",value:(i=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:X.a.instance.dispatch(new K.c(function(){var e=s()(a.a.mark(function e(n,i,o){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.pages.forEach(function(e){return e.getAllSingleItems().forEach(function(e){e.tbpeId!==t||e.isOnlyOneItem()||J.a.selectItem(e)})}),e.next=3,o.renderAuto(n,i);case 3:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)})},{key:"removeNotExistResultOfPage",value:function(){var e=[];X.a.instance.dispatch(new K.c(function(t,n,i){t.pages.forEach(function(t){e.push(t.pageId)}),i.canvasAreaVC.printout.inspectionResult.removeNotExistResultOfPage(e)}))}}],[{key:"getIsShowPrintoutGuide",value:function(){return Y.a.instance.option.showPrintOutGuide}},{key:"getPageSize",value:function(){return j.a.getPageSize()}},{key:"getActiveItems",value:function(){return Y.a.instance.activeItems}},{key:"getIsPhotoCropMode",value:function(){return Y.a.isCropMode()}},{key:"renderItemThumb",value:(n=s()(a.a.mark(function e(n,i){var o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n instanceof ee.b)){e.next=5;break}o=document.createElement("div"),t.setImageFrameThumb(o,n.getThumbString(36)),e.next=15;break;case 5:return o=new Image,e.prev=6,e.next=9,n.getThumbUrl(36,36);case 9:o.src=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6);case 15:return e.abrupt("return",o);case 16:case"end":return e.stop()}},e,null,[[6,12]])})),function(e,t){return n.apply(this,arguments)})},{key:"setImageFrameThumb",value:function(e,t){e.innerHTML=t;var n=e.firstElementChild;n.style.top="50%",n.style.left="50%",n.style.transform="translate(-50%, -50%)"}}]),t}(K.b),se=n(266),re=n(68),le=n(74),ce=n(20),ue=function(){function e(){L()(this,e)}var t;return w()(e,null,[{key:"getDesignIndexFromHistoryDesign",value:(t=s()(a.a.mark(function e(t,n){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i="/api/design/{designIdx}?historyIdx={historyIdx}".replace("{designIdx}",t.toString()).replace("{historyIdx}",n.toString()),e.prev=1,e.next=4,ce.b.get(i,{contentType:"application/json"});case 4:return o=e.sent.data,e.abrupt("return",o.idx);case 8:return e.prev=8,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",t);case 12:case"end":return e.stop()}},e,null,[[1,8]])})),function(e,n){return t.apply(this,arguments)})}]),e}(),de=n(9),he=n.n(de),pe=n(13),me=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}var n,i,o;return z()(t,e),w()(t,null,[{key:"fetchDesignHistory",value:(o=s()(a.a.mark(function e(n,i){var o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o={page:i,pageSize:t.PAGE_SIZE,blockSize:void 0!==i?t.PAGE_SIZE:void 0},e.next=3,he()(F()(t),"requestV3",this).call(this,void 0,pe.b.GET,"/api/design/history/".concat(n),o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)})),function(e,t){return o.apply(this,arguments)})},{key:"copyDesignRevision",value:(i=s()(a.a.mark(function e(n,i,o){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he()(F()(t),"requestV3",this).call(this,void 0,pe.b.POST,"/api/design/".concat(n,"/revision/").concat(i,"/copy"),{selectedTeam:o});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e,t,n){return i.apply(this,arguments)})},{key:"overwriteDesignWithRevision",value:(n=s()(a.a.mark(function e(n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he()(F()(t),"requestV3",this).call(this,void 0,pe.b.POST,"/api/design/".concat(n,"/revision/").concat(i,"/overwrite"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})}]),t}(pe.a);me.PAGE_SIZE=10;var fe=n(101),ve=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,t.POPUP_ID))).temporaryDesignLoadHandler=e,i.tempSaveTime=n,i.getContents().appendChild(i.makeElements()),i.getContents().appendChild(i.makeFooter()),i}return z()(t,e),w()(t,[{key:"makeElements",value:function(){var e=document.createElement("div");e.className=r.a.BODY;var t=document.createElement("div");t.className="info_image",e.appendChild(t);var n=document.createElement("p");n.className="info_title",n.innerText="수정완료 후 임시저장된 디자인이 있습니다.",e.appendChild(n);var i=document.createElement("p");return i.className="info_contents",i.innerHTML="마지막 수정완료 디자인이 주문에 반영됩니다. </br>\n                              <span>상단바 > 파일 > 작업내역</span>에서 작업한 디자인을 다시 불러올 수 있습니다.",e.appendChild(i),e}},{key:"makeButton",value:function(e,t,n){var i=document.createElement("div");i.className="button",i.classList.add(e);var a=document.createElement("div");if(a.className="label",a.innerText=t,i.appendChild(a),n){var o=document.createElement("div");o.className="label_time",o.innerText=n,i.appendChild(o)}return i}},{key:"makeFooter",value:function(){var e=this,t=document.createElement("div");t.className=r.a.FOOTER;var n=this.makeButton("update_completed_design_load_button","수동 저장한 디자인 불러옴");n.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),e.close()});var i=this.makeButton("temporary_design_load_button","임시저장 디자인 불러오기",this.tempSaveTime);return i.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),e.close(),e.temporaryDesignLoadHandler()}),t.appendChild(n),t.appendChild(i),t}},{key:"isPreventBackgroundCloseEvent",value:function(){return!0}}]),t}(fe.a);ve.POPUP_ID="temporaryStorageInfoPopup";var ge,Ee,ye=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(o)))).actionType=K.a.ONE_TIME,n.doSaveQueue=!1,n.renderAuto=!1,n.changeDesign=function(){return!1},n.commitAction=function(){var e=s()(a.a.mark(function e(t,n){var i,o,r,l,c,u,d;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.launcherOption.hasOption()&&f.a.getUser().isLogin()&&!S.a.getEditorOpenOption().getBizhowsTemplate()&&!S.a.getEditorOpenOption().getBizhowsDesign()&&S.a.getSaveOption().loadAutoSavedDesign){e.next=2;break}return e.abrupt("return");case 2:return i=n.launcherOption.launcherParam,o=i.design.id,e.next=6,me.fetchDesignHistory(o);case 6:if(r=e.sent,l=le.a.get().getLatestDesignHistoryIdx(),c="",(u=r.list.find(function(e){return e.designHistoryIdx===l}))&&(c=re.a.toFormattedStringWithSecond(new Date(u.createdDate))),(d=r.list.find(function(e){return e.autoSaved}))&&(l=d.designHistoryIdx),d&&!(i.design.revision>=l)){e.next=15;break}return e.abrupt("return");case 15:new ve(function(){var e=s()(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.getDesignIndexFromHistoryDesign(o,l);case 2:return t=e.sent,I.b.keepSheetSize(),e.next=6,I.b.load(t);case 6:X.a.instance.dispatch(new se.d);case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),c).open();case 18:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.rollbackAction=function(){},n.recycle=function(){},n}return z()(t,e),t}(K.b),Te=n(46),Ie=n(91),Ce=n(99),ke=n(66),Le=n(170),_e=function(){function e(){L()(this,e)}return w()(e,null,[{key:"makeSliderUI",value:function(e){var t=document.createElement("label");t.className=r.a.SWITCH;var n=document.createElement("input");n.type="checkbox",n.checked=e.isChecked,n.addEventListener("change",function(){e.listener(n.checked)}),t.appendChild(n);var i=document.createElement("span");return i.className=r.a.SLIDER,t.appendChild(i),t}},{key:"toggleElementActive",value:function(e){var t=r.a.ACTIVE;e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)}},{key:"toggleElementActiveOfElements",value:function(e,t){e.forEach(function(e){e===t?e.classList.add(r.a.ACTIVE):e.classList.remove(r.a.ACTIVE)})}},{key:"showElement",value:function(e){e.classList.remove(r.a.HIDE)}},{key:"hideElement",value:function(e){e.classList.add(r.a.HIDE)}},{key:"getFirstChildLabelWidth",value:function(e){var t=e.getElementsByTagName("label")[0];return t?t.offsetWidth:0}}]),e}();!function(e){e.POPUP_DOWNLOAD="popup_download",e.POPUP_DOWNLOAD_HEADER="download_header",e.POPUP_DOWNLOAD_HEADER_TITLE="header_title",e.POPUP_DOWNLOAD_BODY="download_body",e.POPUP_DOWNLOAD_BODY_TITLE="body_title",e.POPUP_DOWNLOAD_BODY_OUTPUT_TYPE="body_output_type",e.POPUP_DOWNLOAD_BODY_OUTPUT_TYPE_TAB="output_type_tab",e.POPUP_DOWNLOAD_BODY_OUTPUT_TYPE_TAB_BG="output_type_tab_background",e.POPUP_DOWNLOAD_BODY_FILE_TYPE="body_file_type",e.POPUP_DOWNLOAD_BODY_FILE_TYPE_BUTTON_AREA="file_type_button_area",e.POPUP_DOWNLOAD_BODY_FILE_TYPE_BUTTON="file_type_button",e.POPUP_DOWNLOAD_BODY_FILE_TYPE_BUTTON_ICON="file_type_button_icon",e.POPUP_DOWNLOAD_BODY_DROPDOWN="dropdown_list_area",e.POPUP_DOWNLOAD_BODY_DROPDOWN_TEXT="body_dropdown_text",e.POPUP_DOWNLOAD_BODY_DROPDOWN_BUTTON_AREA="dropdown_button_area",e.POPUP_DOWNLOAD_BODY_SELECT_PAGE="body_select_page",e.POPUP_DOWNLOAD_BODY_SELECT_PAGE_BUTTON="dropdown_button_label_wrapper",e.POPUP_DOWNLOAD_BODY_SELECT_PAGE_LIST_CONTAINER="select_page_list_container",e.POPUP_DOWNLOAD_BODY_SELECT_PAGE_LIST_ITEMS="select_page_list_items",e.POPUP_DOWNLOAD_BODY_SELECT_PAGE_DONE_BUTTON="select_page_done_button",e.POPUP_DOWNLOAD_BODY_OUTPUT_INFO="body_output_info",e.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_TEXT_BOX="output_info_text_box",e.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_TEXT_BOX_NORMAL="normal",e.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_TIP="output_info_tip",e.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_LICENSE_AREA="output_info_license_area",e.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_LICENSE_TEXT="output_info_license_text",e.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_GUIDE="output_info_guide",e.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_PAGE_NOT_SELECTED="output_info_page_not_selected",e.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_PAGE_CONFIRM="output_info_page_confirm",e.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_IMG_COMBINE_MAX_PAGE_SIZE="output_info_img_combine_max_page_size",e.POPUP_DOWNLOAD_BODY_IMG_COMBINE="img_combine",e.POPUP_DOWNLOAD_BODY_IMG_COMBINE_CHECK_BOX_AREA="check_box_area",e.POPUP_DOWNLOAD_BODY_IMG_COMBINE_CHECK_BOX_TEXT="check_box_text",e.POPUP_DOWNLOAD_FOOTER="download_footer",e.POPUP_DOWNLOAD_FOOTER_DOWNLOAD_BUTTON_AREA="download_button_area",e.POPUP_DOWNLOAD_INFO_BUTTON="info_button",e.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP="info_tooltip_popup",e.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_CONTENT_BACKGROUND="content_background",e.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_CONTENT_AREA="content_area",e.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_MAIN_TITLE="main_title",e.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_SUB_TITLE="sub_title",e.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_DESCRIPTION="description",e.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_LINK="link",e.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_DESCRIPTION_HIGHLIGHT="description_highlight",e.POPUP_BUTTON_HIGHLIGHT="popup_button_highlight",e.HIGH_RESOLUTION_TEST_AREA="high_resolution_test_area",e.HIGH_RESOLUTION_TEST_SIZE_INPUT="high_resolution_test_size_input",e.HIGH_RESOLUTION_TEST_DOWNLOAD_BUTTON="high_resolution_test_download_btn",e.RESTRICT_TEXT_INFO="restrict_text_info"}(ge||(ge={})),function(e){e.OUTPUT_TYPE="data-output-type",e.FILE_TYPE="data-file-type",e.DOWNLOAD_TYPE="data-download-type"}(Ee||(Ee={}));var we;!function(e){e.SELECT_PAGE_DEFAULT="페이지 선택",e.SELECT_PAGE_ALL_PAGE="모든 페이지",e.SELECT_PAGE="페이지",e.OUTPUT_INFO_PAGE_COUNT="총 페이지수 : ${pageCount} 페이지",e.OUTPUT_INFO_WORK_SIZE="작업사이즈 : ${width} × ${height}",e.OUTPUT_INFO_DPI="DPI 해상도 : ${dpi}DPI",e.OUTPUT_INFO_IOS_RESTRICT="※ 현재 사용중인 기기에서 빠른 다운로드는 4096px X 4096px 이하일 때 사용이 가능해요."}(we||(we={}));var Se=n(288),be=n(310),Re=function(){function e(){L()(this,e)}return w()(e,null,[{key:"createMenuItemView",value:function(t,n){var i=e.makeWrapElement("button",t,"popup_menu");if(i.type="button",t.id&&(i.id=t.id),t.title){var a=document.createElement("span");a.innerText=t.title,i.appendChild(a)}if(n&&i.addEventListener("click",function(e){e.stopPropagation(),n(t)}),t.subTitle){var o=document.createElement("span");o.classList.add(r.a.SUB_TITLE,t.subTitleDirection),o.innerText=t.subTitle,i.appendChild(o)}return t.icon&&Object(ne.setToolsIcon)(i,t.icon),i}},{key:"createDepthMenuItemView",value:function(t,n){var i=e.makeWrapElement("div",t,"popup_menu");if(Object(ne.setToolsIcon)(i,ne.ToolsIcon.GREATER_THAN,!0,"right"),i.appendChild(e.makeParagraph("menu_title",t.title)),n&&i.addEventListener("click",function(){return n(t)}),t.subTitle){var a=document.createElement("div");a.classList.add(r.a.SUB_TITLE,"right"),a.innerText=t.subTitle,i.appendChild(a)}return i}},{key:"createRadioMenuItemView",value:function(t,n){var i=e.makeWrapElement("div",t,r.a.RADIO_WRAP),a=document.createElement("span");a.className=r.a.TITLE,a.innerText=t.title,i.appendChild(a);var o=new be.b(function(e){return n(t,e)},t.radioItems);return i.appendChild(o.getContainer()),i}},{key:"createToggleMenuItemView",value:function(t,n){var i=e.makeWrapElement("div",t,r.a.BUTTON_WRAP),a=document.createElement("span");if(a.className=r.a.TITLE,a.innerText=t.title,i.appendChild(a),t.subTitle){var o=document.createElement("span");o.classList.add(r.a.SUB_TITLE,t.subTitleDirection),o.innerText=t.subTitle,i.appendChild(o)}var s=document.createElement("label"),l=document.createElement("input");l.type="checkbox",l.checked=t.on,l.addEventListener("change",function(){n(t,l.checked)}),s.appendChild(l);var c=document.createElement("div");return c.appendChild(document.createElement("span")),s.appendChild(c),i.appendChild(s),{btnWrap:i,checkbox:l}}},{key:"makeContour",value:function(){var e=document.createElement("div");return e.className=r.a.CONTOUR,e}},{key:"makeParagraph",value:function(e,t){var n=document.createElement("p");return n.className=e,n.innerText=t,n}},{key:"makeWrapElement",value:function(t,n,i){var a=document.createElement(t),o=null!=n.className?[n.className]:[];return n.overLarge&&o.push(e.OVER_LARGE_CLASS),n.separatorOnTop&&o.push(r.a.ROW_BORDER_TOP),n.bottomMargin&&o.push(e.BOTTOM_MARGIN),i&&o.push(i),o.length>0&&(a.className=o.join(" ")),a}}]),e}();Re.OVER_LARGE_CLASS="over_large",Re.BOTTOM_MARGIN="bottom_margin";var Ae,Oe=function(){function e(){L()(this,e),this.initContent(),this.makeElement()}return w()(e,[{key:"initContent",value:function(){this.webContent=[],this.webContent.push({mainTitle:"파일 형식",components:[{type:Ae.TITLE,description:"PNG (권장)"},{type:Ae.DESCRIPTION,description:"고품질의 이미지이며 투명한 배경을 지원합니다."},{type:Ae.TITLE,description:"JPG"},{type:Ae.DESCRIPTION,description:"용량이 작지만 이미지손상이 다소 있습니다."}]}),this.webContent.push({mainTitle:"다운로드 방식",components:[{type:Ae.TITLE,description:"빠른 다운로드"},{type:Ae.DESCRIPTION,description:"크기가 작은 디자인 문서를 빠르고 효율적으로<br/>다운로드합니다."},{type:Ae.DESCRIPTION_HIGHLIGHT,description:"빠른 다운로드 결과물의 화질이 좋지 않다면,<br/>고해상도 다운로드를 이용해보세요."},{type:Ae.TITLE,description:"고해상도 다운로드"},{type:Ae.DESCRIPTION,description:"디자인 문서 크기가 크거나 큰 사이즈의 이미지<br/>사용시 고품질로 다운받으실 수 있습니다."}]}),this.printoutContent=[],this.printoutContent.push({mainTitle:"파일 형식",components:[{type:Ae.TITLE,description:"JPG (인쇄용)"},{type:Ae.DESCRIPTION,description:"고품질 이미지를 포함한 인쇄용 포맷입니다."},{type:Ae.TITLE,description:"PDF (인쇄용)"},{type:Ae.DESCRIPTION,description:"백터 요소가 포함된 인쇄용 PDF 포맷입니다."}]}),this.textConvertToImageGuideContent=[],this.textConvertToImageGuideContent.push({mainTitle:"",components:[{type:Ae.TITLE,description:"개별 요소 이미지화 (권장)"},{type:Ae.DESCRIPTION,description:"미리캔버스에서 작업한 이미지와 폰트 스타일을 그대로 유지하고 다운로드 받을 수 있어요 :)\n단, 텍스트 내용을 수정할 수는 없어요."},{type:Ae.LINE_BREAK},{type:Ae.TITLE,description:"텍스트 편집가능"},{type:Ae.DESCRIPTION,description:"PPT 파일에서 텍스트를 수정할 수 있어요. 고객님의 컴퓨터에 폰트가 없을 경우 기본 폰트로 표시돼요."},{type:Ae.DESCRIPTION_HIGHLIGHT,description:"베타 버전이라 텍스트에 적용된 스타일이나 효과가 제대로 표현되지 않을 수 있어요!"},{type:Ae.LINE_BREAK},{type:Ae.TITLE,description:"통 이미지 (빠른 다운로드)"},{type:Ae.DESCRIPTION,description:"페이지 별로 하나의 이미지로 합쳐져서 다운로드 받아져요. 수정할 일이 없고 빠르게 다운로드 받고 싶을 때 추천해요 :)"},{type:Ae.LINE_BREAK},{type:Ae.LINE_BREAK},{type:Ae.LINK,description:"자세히 보러가기 >",url:"https://miricanvas.zendesk.com/hc/ko/articles/360039561892"}]})}},{key:"makeElement",value:function(){var e=this.elementWrapper=document.createElement("div");e.classList.add(ge.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP),e.classList.add(r.a.HIDE),e.addEventListener("click",function(e){e.stopPropagation()}),e.appendChild(this.makeHeader()),this.webContentElement=this.makeContentElement(this.webContent),this.printContentElement=this.makeContentElement(this.printoutContent),this.textConvertToImageGuide=this.makeContentElement(this.textConvertToImageGuideContent);var t=new Ce.a(!1,!0,"calc(100% - 76px)");return e.appendChild(t.render()),this.scrollContents=t.contents,e}},{key:"makeHeader",value:function(){var e=this,t=document.createElement("div");t.className="info_tooltip_popup_header",Object(ne.setToolsIcon)(t,ne.ToolsIcon.GREATER_THAN,!0,"left",180).addEventListener("click",function(){return e.hide()});var n=this.title=document.createElement("label");return t.appendChild(n),Object(ne.setToolsIcon)(t,ne.ToolsIcon.CLOSE).addEventListener("click",function(){return e.hide()}),t.appendChild(Re.makeContour()),t}},{key:"makeContentElement",value:function(e){var t=this,n=document.createElement("div");return n.className=ge.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_CONTENT_BACKGROUND,e.forEach(function(e){var i=document.createElement("div");i.className=ge.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_CONTENT_AREA;var a=document.createElement("label");a.className=ge.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_MAIN_TITLE,a.innerText=e.mainTitle,i.appendChild(a),"파일 형식"===e.mainTitle.toLowerCase()&&(t.fileTypeAreaElement=i),e.components.forEach(function(e){switch(e.type){case Ae.LINE_BREAK:var t=document.createElement("label");t.className=ge.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_DESCRIPTION,t.innerText="　",i.appendChild(t);break;case Ae.LINK:var n=document.createElement("label");n.className=ge.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_DESCRIPTION,n.classList.add(ge.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_LINK),n.innerHTML=e.description,e.url&&n.addEventListener("click",function(){return window.open(e.url)}),i.appendChild(n);break;case Ae.DESCRIPTION:var a=document.createElement("label");a.className=ge.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_DESCRIPTION,a.innerHTML=e.description,i.appendChild(a);break;case Ae.DESCRIPTION_HIGHLIGHT:var o=document.createElement("label");o.className=ge.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_DESCRIPTION,o.classList.add(ge.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_DESCRIPTION_HIGHLIGHT),o.innerHTML=e.description,i.appendChild(o);break;case Ae.TITLE:default:var s=document.createElement("label");s.className=ge.POPUP_DOWNLOAD_INFO_TOOLTIP_POPUP_SUB_TITLE,s.innerText=e.description,i.appendChild(s)}}),n.appendChild(i)}),n}},{key:"updateUI",value:function(e){this.isAdminMode=e.isAdminMode,this.isDevMode=e.isDevMode,this.updateContent(e.outputType,e.isTextConvertToImage)}},{key:"updateContent",value:function(e,t){this.scrollContents.innerHTML="",this.elementWrapper.classList.remove("text_convert_to_image"),t?(this.title.innerText="텍스트 이미지화",this.scrollContents.appendChild(this.textConvertToImageGuide),this.elementWrapper.classList.add("text_convert_to_image")):e===Se.c.WEB?(this.title.innerText="다운로드 도움말",this.scrollContents.appendChild(this.webContentElement)):(this.title.innerText="다운로드 도움말",this.scrollContents.appendChild(this.printContentElement))}},{key:"show",value:function(){this.elementWrapper.classList.remove(r.a.HIDE)}},{key:"hide",value:function(){this.elementWrapper.classList.add(r.a.HIDE)}},{key:"toggleVisible",value:function(){this.elementWrapper.classList.contains(r.a.HIDE)?this.elementWrapper.classList.remove(r.a.HIDE):this.elementWrapper.classList.add(r.a.HIDE)}}]),e}();!function(e){e[e.TITLE=0]="TITLE",e[e.DESCRIPTION=1]="DESCRIPTION",e[e.DESCRIPTION_HIGHLIGHT=2]="DESCRIPTION_HIGHLIGHT",e[e.LINE_BREAK=3]="LINE_BREAK",e[e.LINK=4]="LINK"}(Ae||(Ae={}));var Pe,De=n(16),Me=function(){function e(){L()(this,e)}return w()(e,null,[{key:"getImgCombineTextElements",value:function(e,t,n,i,a){var o=[],s=document.createElement("div"),l=i?1:t;s.innerText=e.totalPageCount.replace("${pageCount}",l.toString()),o.push(s);var c=document.createElement("div"),u=t*n.pageHeight;if(c.innerText=e.workSize.replace("${width}","".concat(n.pageWidth,"px")).replace("${height}","".concat(u,"px")),o.push(c),a){c.className=r.a.WARNING;var d=document.createElement("div");d.innerText=e.imgCombineMaxPageSize,d.classList.add(ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_IMG_COMBINE_MAX_PAGE_SIZE),d.classList.add(r.a.WARNING),o.push(d)}return o}},{key:"getInfoTextElements",value:function(t,n,i,a,o){var s=[],r=a?1:t;if(e.addBaseTextToTextList(r,s),n===Se.c.PRINT){var l={workWidth:i.workWidth,workHeight:i.workHeight,dpi:i.dpi,unit:i.unit};e.addPrintTypeTextToTextList(l,s,o)}else{var c=t*i.pageHeight,u={pageWidth:i.pageWidth,pageHeight:a?c:i.pageHeight};e.addWebTypeTextToTextList(u,s)}var d=[];return s.forEach(function(e){var t=document.createElement("div");t.innerText=e,d.push(t)}),d}},{key:"getiOSRestrictTextElement",value:function(){var e=document.createElement("div");return e.innerText=we.OUTPUT_INFO_IOS_RESTRICT,e.className=ge.RESTRICT_TEXT_INFO,e}},{key:"addBaseTextToTextList",value:function(e,t){t.push(we.OUTPUT_INFO_PAGE_COUNT.replace("${pageCount}",e.toString()))}},{key:"addWebTypeTextToTextList",value:function(t,n){n.push(e.replaceSizeText(we.OUTPUT_INFO_WORK_SIZE,t.pageWidth,t.pageHeight,"px"))}},{key:"addPrintTypeTextToTextList",value:function(t,n,i){var a=e.getPrintTypeUnit(t.unit);i&&n.push(e.getWorkSizeText(t.workWidth,t.workHeight,a)),n.push(e.getDPIText(t.dpi))}},{key:"getPrintTypeUnit",value:function(e){var t=e===De.a.PX?De.a.MM:e;return(t=t===De.a.IN?"inch":t).toLowerCase()}},{key:"replaceSizeText",value:function(e,t,n,i){var a=e;return a=(a=a.replace("${width}","".concat(t.toString()).concat(i))).replace("${height}","".concat(n.toString()).concat(i))}},{key:"getWorkSizeText",value:function(t,n,i){return e.replaceSizeText(we.OUTPUT_INFO_WORK_SIZE,t,n,i)}},{key:"getDPIText",value:function(e){return we.OUTPUT_INFO_DPI.replace("${dpi}",e.toString())}}]),e}(),Ne=function(){function e(t){L()(this,e),this.onClick=t,this.initDynamicText(),this.makeElement()}return w()(e,[{key:"initDynamicText",value:function(){this.dynamicText={totalPageCount:"총 페이지수 : ${pageCount} 페이지",workSize:"작업사이즈 : ${width} × ${height}",licenseDescription:"저작권 보호를 위해 1개의 요소만 존재하는<br/>페이지는 다운로드가 불가능합니다.",licenseLinkURL:"https://api.miricanvas.com/s/119",licenseLinkText:"미리캔버스 저작권안내",pageNotSelected:"페이지를 선택해주세요.",pageConfirm:"페이지를 확인해주세요.",imgCombineMaxPageSize:"※ 이미지 세로 최대 크기는 65000px 입니다.",pptNotice:"(필독) PPT 다운로드 저작권 유의사항"}}},{key:"makeElement",value:function(){var e=this.element=document.createElement("div");return e.className=ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_TEXT_BOX,e}},{key:"updateUI",value:function(e){var t=this.element;t.innerHTML="",f.a.getUser().isLogin()?e.isDownloadEnable?(t.classList.add(ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_TEXT_BOX_NORMAL),this.updateByDownloadEnable(t,e.enableOption)):(t.classList.remove(ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_TEXT_BOX_NORMAL),this.updateByDownloadDisable(t,e.disableOption)):(t.appendChild(this.makeLoginDefaultText()),t.classList.add(ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_TEXT_BOX_NORMAL)),this.updateToMatchImageFileType(t,e)}},{key:"makeLoginDefaultText",value:function(){var e=this,t=document.createElement("div");t.className="login_text_container";var n=document.createElement("span");n.innerText="디자인 저장, 다운로드를 위해 ",t.appendChild(n);var i=document.createElement("span");i.className="login_text",i.addEventListener("click",function(){e.onClick&&e.onClick()}),i.innerText="로그인/회원가입",t.appendChild(i);var a=document.createElement("span");return a.innerText="을 해주세요.",t.appendChild(a),t}},{key:"updateByDownloadEnable",value:function(e,t){if(Me.getInfoTextElements(t.selectedPageCount,t.outputType,t.outputInfo,t.isImgCombine,t.isDevMode).forEach(function(t){e.appendChild(t)}),t.isiOSBigSize){var n=Me.getiOSRestrictTextElement();e.appendChild(n)}}},{key:"updateByDownloadDisable",value:function(e,t){if(t.selectedPageCount){var n=t.acceptableInfo.imgTroublePageIdxList;n.length?this.updateTextByImageTrouble(e,t.selectedPageIdxList,n):t.isImgCombineOverMaxPageSize&&this.updateTextByImgCombineMaxPageSize(e,t.selectedPageCount,t.outputInfo,t.isImgCombine,t.isImgCombineOverMaxPageSize)}else this.updateTextByNotSelectedPage(e)}},{key:"updateToMatchImageFileType",value:function(e,t){var n=!t.isDownloadEnable&&t.disableOption.acceptableInfo.imgTroublePageIdxList.length>0;if(t.selectedFIleType===Se.b.PPTX&&!n){var i=document.createElement("a");i.className=ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_GUIDE,i.href="https://miricanvas.zendesk.com/hc/ko/articles/360039561892",i.target="_blank",i.innerText=this.dynamicText.pptNotice,e.appendChild(i)}}},{key:"updateTextByImageTrouble",value:function(e,t,n){var i=t.filter(function(e){return n.some(function(t){return e===t})}).map(function(e){return e+1}).join(", "),a=document.createElement("div");a.innerHTML=this.dynamicText.licenseDescription,e.appendChild(a);var o=document.createElement("div");o.className=ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_PAGE_CONFIRM,o.innerText="".concat(i,"  ").concat(this.dynamicText.pageConfirm),e.appendChild(o);var s=document.createElement("div");s.className=ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_LICENSE_AREA;var r=document.createElement("a");r.className=ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_LICENSE_TEXT,r.href=this.dynamicText.licenseLinkURL,r.target="_blank",r.innerText=this.dynamicText.licenseLinkText,s.appendChild(r),e.appendChild(s)}},{key:"updateTextByImgCombineMaxPageSize",value:function(e,t,n,i,a){Me.getImgCombineTextElements(this.dynamicText,t,n,i,a).forEach(function(t){e.appendChild(t)})}},{key:"updateTextByNotSelectedPage",value:function(e){var t=document.createElement("div");t.className=ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_PAGE_NOT_SELECTED,t.innerText=this.dynamicText.pageNotSelected,e.appendChild(t)}}]),e}(),xe=function(){function e(){L()(this,e),this.makeElement()}return w()(e,[{key:"makeElement",value:function(){var e=this.elementWrapper=document.createElement("div");return e.className=ge.POPUP_DOWNLOAD_BODY_IMG_COMBINE,e.appendChild(this.makeCheckBoxArea()),e}},{key:"makeCheckBoxArea",value:function(){var e=this,t=document.createElement("div");return t.className=ge.POPUP_DOWNLOAD_BODY_IMG_COMBINE_CHECK_BOX_AREA,t.appendChild(this.makeCheckBox()),t.appendChild(this.makeCheckBoxText()),t.addEventListener("click",function(){e.checkBox.checked=!e.checkBox.checked,e.checkEventListener&&e.checkEventListener()}),t}},{key:"makeCheckBox",value:function(){var e=this.checkBox=document.createElement("input");return e.type="checkbox",e.checked=!1,e}},{key:"makeCheckBoxText",value:function(){var e=document.createElement("label");return e.className=ge.POPUP_DOWNLOAD_BODY_IMG_COMBINE_CHECK_BOX_TEXT,e.innerText="한 장의 이미지로 합치기",Object(ne.setToolsIcon)(e,ne.ToolsIcon.CHECK),e}},{key:"initSetting",value:function(){this.checkBox.checked=!1}},{key:"addCheckEventListener",value:function(e){this.checkEventListener=e}},{key:"show",value:function(){this.elementWrapper.classList.remove(r.a.HIDE)}},{key:"hide",value:function(){this.initSetting(),this.elementWrapper.classList.add(r.a.HIDE)}},{key:"enable",value:function(){this.elementWrapper.classList.remove(r.a.DISABLE)}},{key:"disable",value:function(){this.elementWrapper.classList.add(r.a.DISABLE)}},{key:"isChecked",value:function(){return this.checkBox.checked}}]),e}(),Be=n(107);!function(e){e.RASTERIZE="개별 요소 이미지화 (권장)",e.EDITABLE_TEXT="텍스트 편집 가능",e.FULL_IMAGE="통 이미지 (빠른 다운로드)"}(Pe||(Pe={}));var Ve=function(){function e(){var t=this;L()(this,e),this.dropDownItems=new Array,(this.wrapper=document.createElement("div")).className=e.WRAPPER;var n=this.title=document.createElement("div");n.className=e.TITLE;var i=this.infoIcon=document.createElement("div");i.className=e.INFO_ICON,Object(ne.setToolsIcon)(i,ne.ToolsIcon.OUTLINE),i.addEventListener("click",function(e){e.stopPropagation(),t.listener&&t.listener.onClick()}),this.wrapper.appendChild(n),this.wrapper.appendChild(i),this.wrapper.appendChild(this.makeCheckBoxArea()),this.wrapper.appendChild(this.makeDropDownArea()),this.wrapper.appendChild(this.makeAdditionalinfo())}return w()(e,[{key:"makeAdditionalinfo",value:function(){var t=Be.a.makeDivElement("additional_info_wrapper");return this.pptInfo=Be.a.makeLabel("additional_info",e.PPT_INFO),t.appendChild(this.pptInfo),t}},{key:"makeDropDownArea",value:function(){var e=this,t=this.dropDownLabel=Be.a.makeLabel(Be.a.DROPDOWN_LABEL,Pe.RASTERIZE),n=this.dropDownButtonArea=Be.a.makeDropDownButton(t),i=[Pe.RASTERIZE,Pe.EDITABLE_TEXT,Pe.FULL_IMAGE],a=this.dropdownListArea=document.createElement("div");return a.className=Be.a.DROPDOWN_LIST_AREA,a.classList.add("ppt_options"),Be.a.setVisible(a,!1),i.forEach(function(t){var n=document.createElement("li");n.className=Be.a.DROPDOWN_LIST_ITEM,n.appendChild(Be.a.makeLabel(Be.a.DROPDOWN_LIST_ITEM_LABEL,t)),Object(ne.setToolsIcon)(n,ne.ToolsIcon.CHECK),n.addEventListener("click",function(n){e.onSelectPPTOption(t),Be.a.setActive(e.dropDownButtonArea,!1),Be.a.setVisible(a,!1)}),e.dropDownItems.push(n),a.appendChild(n)}),n.addEventListener("click",function(){if(e.listener){var t=Be.a.getVisible(a);Be.a.hideAllDropdownArea(a),e.setVisibleDropdownArea(!t)}}),n}},{key:"onSelectPPTOption",value:function(e){this.dropDownItems.forEach(function(t){var n=t.innerText===e;Be.a.setActive(t,n)}),this.dropDownLabel.innerText=e,Be.a.setVisible(this.pptInfo,e===Pe.EDITABLE_TEXT),this.listener&&this.listener.onSelectPPTOption(e)}},{key:"setVisibleDropdownArea",value:function(e){Be.a.setActive(this.dropDownButtonArea,e),Be.a.setVisible(this.dropdownListArea,e),e&&Be.a.setTopPosition(this.dropdownListArea,Be.a.calculatePopupOffset(this.dropDownButtonArea).top-70)}},{key:"makeCheckBoxArea",value:function(){var t=this,n=this.checkBoxArea=document.createElement("div");n.className=e.CHECK_AREA;var i=document.createElement("label");i.className=e.CHECKBOX_TEXT;var a=this.checkBoxLabel=document.createElement("label");a.innerText="투명한 배경",i.appendChild(a),Object(ne.setToolsIcon)(i,ne.ToolsIcon.CHECK);var o=this.checkBox=document.createElement("input");return o.type="checkbox",o.checked=!1,n.appendChild(o),n.appendChild(i),n.addEventListener("click",function(){t.checkBox.checked=!t.isChecked(),t.listener&&t.listener.onChecked(t.isChecked())}),n}},{key:"update",value:function(e){if(this.orgFileType!==e){this.initSetting(),this.orgFileType=e;var t=e===Se.b.PPTX,n=e===Se.b.PNG;n||t?this.show():this.hide(),Be.a.setVisible(this.dropDownButtonArea,t),Be.a.setVisible(this.checkBoxArea,n),Be.a.setVisible(this.infoIcon,t),this.setVisibleDropdownArea(!1),this.onSelectPPTOption(Pe.RASTERIZE),this.title.innerText=n?"PNG 옵션":t?"PPT 옵션":""}}},{key:"initSetting",value:function(){this.checkBox.checked=!1,this.listener&&this.listener.onChecked(!1)}},{key:"setListener",value:function(e){this.listener=e}},{key:"show",value:function(){this.wrapper.classList.remove(r.a.HIDE)}},{key:"hide",value:function(){this.initSetting(),this.wrapper.classList.add(r.a.HIDE)}},{key:"enable",value:function(){this.wrapper.classList.remove(r.a.DISABLE)}},{key:"disable",value:function(){this.wrapper.classList.add(r.a.DISABLE)}},{key:"isChecked",value:function(){return this.checkBox.checked}}]),e}();Ve.WRAPPER="download_file_type_option_wrapper",Ve.CHECK_AREA="check_box_area",Ve.INFO_ICON="info_icon",Ve.CHECKBOX_TEXT="check_box_text",Ve.TITLE="body_title",Ve.PPT_INFO="텍스트에 적용된 스타일이나 효과가 표현되지 않을 수 있어요. 텍스트는 재작업이 필요할 수도 있어요 :)";var Ue=function(e){function t(e){var n;L()(this,t),(n=V()(this,F()(t).call(this))).listener=e;var i=n.wrapper=Be.a.makeDivElement(t.WRAPPER),a=Be.a.makeDivElement(t.SCROLL_WRAPPER),o=Be.a.makeDivElement(t.IMAGE),s=Be.a.makeDivElement(t.TITLE,t.TITLE_TEXT),r=Be.a.makeDivElement(t.CONTENTS);r.innerHTML=t.CONTENTS_TEXT;var l=Be.a.makeDivElement(t.BOX_NOTICE);l.innerHTML=t.BOX_NOTICE_TEXT;var c=Be.a.makeDivElement(t.MORE,t.MORE_TEXT);return c.addEventListener("click",function(){window.open("https://miricanvas.zendesk.com/hc/ko/articles/360039561892")}),a.appendChild(o),a.appendChild(s),a.appendChild(r),a.appendChild(l),a.appendChild(c),i.appendChild(a),i.appendChild(n.makeFooter()),n.makeBtnClose=!0,n}return z()(t,e),w()(t,[{key:"makeFooter",value:function(){var e=this,n=Be.a.makeDivElement(t.FOOTER),i=this.checkBox=Be.a.makeCheckBox(t.CHECKBOX),a=Be.a.makeCheckBoxArea(t.CHECKBOX_AREA,i,t.CHECK_LABEL_TEXT,function(e){return Be.a.setActive(o,e)}),o=this.btnConfirm=Be.a.makeDivElement(t.CONFIRM_BUTTON,t.CONFIRM_BUTTON_TEXT);return o.addEventListener("click",function(){i.checked&&ce.b.post("/accounts/ppt-copyright-accepted").then(function(t){"YES"===t.data.accepted&&(e.listener&&e.listener.onPPTDownloadAccepted(),e.close())})}),n.appendChild(a),n.appendChild(o),n}},{key:"getContents",value:function(){return this.wrapper}},{key:"getId",value:function(){return"DownloadNoticePPTPopup"}},{key:"updateUI",value:function(){this.checkBox.checked=!1,Be.a.setActive(this.btnConfirm,!1)}}]),t}(u.a);Ue.WRAPPER="wrapper",Ue.SCROLL_WRAPPER="scroll_wrapper",Ue.IMAGE="image",Ue.TITLE="title",Ue.CONTENTS="contents",Ue.BOX_NOTICE="box_notice",Ue.MORE="more",Ue.FOOTER="footer",Ue.CHECKBOX_AREA="checkbox_area",Ue.CHECKBOX="checkbox",Ue.CONFIRM_BUTTON="confirm_button",Ue.TITLE_TEXT="PPT 다운로드 저작권을 확인해주세요!",Ue.CONTENTS_TEXT="미리캔버스에서 다운로드한 PPT는 재수정 및 상업적인 용도로 자유롭게 사용 가능해요. 하지만 <span>아래와 같은 사항은 저작권법에 위배되니 주의</span>해주셔야해요! (저작권 동의 후 다운로드가 가능해요.)",Ue.BOX_NOTICE_TEXT="① 유/무료 템플릿 형태로 공유 또는 유포</br>② 일부 요소를 추출하여 다른 디자인툴에 사용하거나 유포",Ue.MORE_TEXT="자세히 보러가기 >",Ue.CHECK_LABEL_TEXT="동의했어요!",Ue.CONFIRM_BUTTON_TEXT="확인";var Fe,Ge=n(73),He=n(31),We=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.makeMakePrintoutTextBox()}},{key:"makeMakePrintoutTextBox",value:function(){var e,t=this.container;(e=t.classList).add.apply(e,[ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO_TEXT_BOX,r.a.WARNING,"make_print"]);var n=document.createElement("span");n.innerText="인쇄용 다운로드 파일은 개인/사무용 프린터에 적합하며 인쇄물 제작을 원하실 경우";var i=document.createElement("span");i.className="bold",i.innerText=" '인쇄물 제작' ";var a=document.createElement("span");return a.innerText="을 이용해주세요.",t.appendChild(n),t.appendChild(i),t.appendChild(a),t}}]),t}(He.a),ze=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).infoTooltipPopup=new Oe,e.thumbImgList=[],e.selectedPages=[],e.selectedPPTOption=Pe.RASTERIZE,e.selectedOutputType=Se.c.WEB,e.selectedImageFileType=Se.b.PNG,e.selectedDownloadType=Se.a.QUICK,e.optionChecked=!1,e.downloadAvailableStatus=Fe.ENABLE,e.fileTypeIcons=[],e.webFileTypeButtonElements=[],e.printFileTypeButtonElements=[],e.initFileTypeIconData(),e.outputInfoTextBox=new Ne(function(){return e.openLoginPopup(Ie.a.OPEN_DOWNLOAD_POPUP)}),e.infoTooltipPopup=new Oe,e.imgCombine=new xe,e.downloadFileTypeOption=new Ve,e.downloadFileTypeOption.setListener(H()(e)),e}var n;return z()(t,e),w()(t,[{key:"openLoginPopup",value:function(e){var t=this;this.popupCallback.openLoginPopup(e,function(){return t.close()})}},{key:"setPositionOffsetElement",value:function(e){this.positionOffsetElement=e}},{key:"setOnPrintoutButtonClickListener",value:function(e){this.onMakePrintoutButtonClick=e}},{key:"addWindowResizeEvent",value:function(){window.addEventListener("resize",this.updatePosition.bind(this))}},{key:"removeWindowResizeEvent",value:function(){window.removeEventListener("resize",this.updatePosition)}},{key:"getId",value:function(){return t.ID_ELEMENT_WRAPPER}},{key:"getContents",value:function(){var e=this.wrapper=this.makeWrapperElement();return e.appendChild(this.makeHeaderUI()),e.appendChild(this.makeBodyUI()),e.appendChild(this.makeFooterUI()),e.appendChild(this.infoTooltipPopup.elementWrapper),this.wrapper.appendChild(this.downloadFileTypeOption.dropdownListArea),this.addEventListeners(),e}},{key:"updateUI",value:function(){this.updatePosition(),1===this.pageCount?_e.hideElement(this.selectPageElement):_e.showElement(this.selectPageElement),this.updateAllUiToDefault()}},{key:"addEventListeners",value:function(){var e=this;this.imgCombine.addCheckEventListener(function(){e.updateDownloadAvailableStatus(),e.updateOutputInfoUI(),e.updateDownloadButtonUI()})}},{key:"open",value:function(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.popupCallback){this.initPageInfoSetting(i),this.initSelectedPagesByPageCount(),this.updateDownloadAvailableStatus(),he()(F()(t.prototype),"open",this).call(this,e),this.popupCallback.environment.isLogin()&&(this.wrapper.classList.add("saving"),this.popupCallback.saveLatest(function(){n.wrapper.classList.remove("saving")})),this.element.classList.contains(r.a.UP_SIDE)&&this.element.classList.remove(r.a.UP_SIDE),this.addWindowResizeEvent();try{Te.a.moveVirtualPage(Te.c.DOWNLOAD),Te.a.sendEvent("다운로드","다운로드 팝업",location.pathname,!0)}catch(e){}return this}console.log("It can't open. undefined callback")}},{key:"close",value:function(){return this.hideDropdownAndTooltipUI(),this.removeWindowResizeEvent(),Te.a.moveVirtualPage(Te.c.PAGE_BACK),he()(F()(t.prototype),"close",this).call(this)}},{key:"setCallback",value:function(e){this.popupCallback=e}},{key:"initFileTypeIconData",value:function(){this.fileTypeIcons.push({outputType:Se.c.WEB,imgFileType:Se.b.JPG,tooltipTxt:"JPG"}),this.fileTypeIcons.push({outputType:Se.c.WEB,imgFileType:Se.b.PNG,tooltipTxt:"PNG",isSelect:!0}),this.fileTypeIcons.push({outputType:Se.c.WEB,imgFileType:Se.b.PDF,tooltipTxt:"PDF (웹용)"}),this.fileTypeIcons.push({outputType:Se.c.WEB,imgFileType:Se.b.PPTX,tooltipTxt:"PPT"}),this.fileTypeIcons.push({outputType:Se.c.PRINT,imgFileType:Se.b.JPG,tooltipTxt:"JPG (인쇄용)"}),this.fileTypeIcons.push({outputType:Se.c.PRINT,imgFileType:Se.b.PDF,tooltipTxt:"PDF (인쇄용)",isSelect:!0})}},{key:"updateDownloadAvailableStatus",value:function(){this.downloadAvailableStatus=this.getDownloadStatus()}},{key:"getDownloadStatus",value:function(){var e=this.popupCallback.getDownloadAcceptableInfo(),t=this.selectedPages.some(function(t){return e.imgTroublePageIdxList.some(function(e){return e===t})}),n=this.imgCombine.isChecked()&&this.isImgCombineOverMaxPageSize();return this.popupCallback.environment.isLogin()&&(!this.selectedPages.length||t||n)?Fe.DISABLE:Fe.ENABLE}},{key:"updateAllUiToDefault",value:function(){this.updateOutputTypeTabUI(),this.updateFileTypeUI(),this.initSelectPageCheckboxes(),this.updateSelectPageButtonUI(),this.updateOutputInfoUI(),this.updateImageCombineUI(),this.updateDownloadButtonUI()}},{key:"initPageInfoSetting",value:function(e){var t=this.pageCount!==e&&this.element;this.pageCount=e,t&&this.initSelectPageItemList()}},{key:"updateOutputTypeTabUI",value:function(){var e=this.outputTypeTabAreaElement.getElementsByClassName(ge.POPUP_DOWNLOAD_BODY_OUTPUT_TYPE_TAB),t=this.getOutputType(),n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;l.getAttribute(Ee.OUTPUT_TYPE)===t?l.classList.add(r.a.ACTIVE):l.classList.remove(r.a.ACTIVE)}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}this.selectedOutputType=t,t===Se.c.WEB?this.changeToWebTypeButtonUI():this.changeToPrintTypeButtonUI()}},{key:"updateFileTypeUI",value:function(){var e=this,t=this.selectedOutputType===Se.c.PRINT;t&&(this.selectedImageFileType!==Se.b.PNG&&this.selectedImageFileType!==Se.b.PPTX||(this.selectedImageFileType=Se.b.PDF));var n=t?this.printFileTypeButtonElements:this.webFileTypeButtonElements;n.forEach(function(t){t.getAttribute(Ee.FILE_TYPE)===e.selectedImageFileType&&_e.toggleElementActiveOfElements(n,t)})}},{key:"initSelectedPagesByPageCount",value:function(){this.selectedPages=[];for(var e=0;e<this.pageCount;e++)this.selectedPages.push(e)}},{key:"initSelectPageCheckboxes",value:function(){this.getCheckboxElementsOfSelectPage().forEach(function(e){e.checked=!0})}},{key:"initSelectPageItemList",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,a=this.selectPageScroll.contents.getElementsByTagName("ul")[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;o.parentElement.removeChild(o)}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}this.selectPageScroll.contents.appendChild(this.makeSelectPageItemListElement())}},{key:"updatePosition",value:function(){if(this.positionOffsetElement){var e=$(this.positionOffsetElement).offset().left,t=e+this.positionOffsetElement.offsetWidth;this.contentsWrap.style.left="".concat(t,"px"),$(window).width()<$(this.contentsWrap).width()+e?this.element.classList.add(r.a.LEFT_SIDE):this.element.classList.remove(r.a.LEFT_SIDE)}}},{key:"getCheckboxElementsOfSelectPage",value:function(){var e=this.selectPageItemListElement.getElementsByTagName("input"),t=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var r=o.value;t.push(r)}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return t}},{key:"makeWrapperElement",value:function(){var e=this,t=document.createElement("div");return t.className=ge.POPUP_DOWNLOAD,t.addEventListener("click",function(){e.infoTooltipPopup.hide()}),t}},{key:"makeHeaderUI",value:function(){var e=this.headerElement=document.createElement("div");e.className=ge.POPUP_DOWNLOAD_HEADER;var t=document.createElement("label");return t.className=ge.POPUP_DOWNLOAD_HEADER_TITLE,t.innerText="다운로드",e.appendChild(t),e}},{key:"makeBodyUI",value:function(){var e=document.createElement("div");e.className=ge.POPUP_DOWNLOAD_BODY,e.appendChild(this.makeOutputTypeTabElement()),e.appendChild(this.makeFileTypeElement()),e.appendChild(this.downloadFileTypeOption.wrapper),e.appendChild(this.makeSelectPageElement()),e.appendChild(this.imgCombine.elementWrapper),e.appendChild(this.makeOutputInfoElement()),this.bodyElement=e;var t=new Ce.a(!1,!0,"auto");return t.contents.appendChild(e),t.render()}},{key:"updateClassName",value:function(){this.wrapper.classList.remove(Se.b.PPTX),this.wrapper.classList.remove(Se.b.PNG),this.wrapper.classList.remove(Se.b.JPG),this.wrapper.classList.remove(Se.b.PDF),this.wrapper.classList.add(this.selectedImageFileType)}},{key:"makeOutputTypeTabElement",value:function(){var e=this,t=this.outputTypeTabAreaElement=document.createElement("div");t.className=ge.POPUP_DOWNLOAD_BODY_OUTPUT_TYPE;var n=document.createElement("div");n.className=ge.POPUP_DOWNLOAD_BODY_OUTPUT_TYPE_TAB_BG,t.appendChild(n);var i=this.webTabElement=document.createElement("div");i.className=ge.POPUP_DOWNLOAD_BODY_OUTPUT_TYPE_TAB,i.setAttribute(Ee.OUTPUT_TYPE,Se.c.WEB);var a=document.createElement("label");a.innerText="웹용",i.appendChild(a),t.appendChild(i);var o=this.printTabElement=document.createElement("div");o.className=ge.POPUP_DOWNLOAD_BODY_OUTPUT_TYPE_TAB,o.setAttribute(Ee.OUTPUT_TYPE,Se.c.PRINT);var s=document.createElement("label");s.innerText="인쇄용",o.appendChild(s),t.appendChild(o);var r=[i,o];i.addEventListener("click",function(){e.selectedOutputType!==Se.c.WEB&&(_e.toggleElementActiveOfElements(r,i),e.selectedOutputType=Se.c.WEB,e.changeToWebTypeButtonUI(),c())}),o.addEventListener("click",function(){e.selectedOutputType!==Se.c.PRINT&&(_e.toggleElementActiveOfElements(r,o),e.selectedOutputType=Se.c.PRINT,e.changeToPrintTypeButtonUI(),c())});var l=this;function c(){l.infoTooltipPopup.hide(),l.updateFileTypeUI(),l.updateImageCombineUI(),l.updateDownloadAvailableStatus(),l.updateOutputInfoUI(),l.updateDownloadButtonUI()}return t}},{key:"makeFileTypeElement",value:function(){var e=this,n=document.createElement("div");n.className=ge.POPUP_DOWNLOAD_BODY_FILE_TYPE;var i=document.createElement("label");i.className=ge.POPUP_DOWNLOAD_BODY_TITLE,i.innerText="파일 형식",n.appendChild(i);var o=this.fileTypeButtonAreaElement=document.createElement("div");o.className=ge.POPUP_DOWNLOAD_BODY_FILE_TYPE_BUTTON_AREA;var l=this.betaIcon=document.createElement("div");return l.className="beta_icon",l.innerText="베타",n.appendChild(l),this.popupCallback.getFileTypeIconElements().then(function(i){e.fileTypeIcons.forEach(function(){var n=s()(a.a.mark(function n(o){var s,l;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:(s=document.createElement("button")).className=ge.POPUP_DOWNLOAD_BODY_FILE_TYPE_BUTTON,(l=t.makeImageFileTypeElement(o.imgFileType,i)).classList.add(ge.POPUP_DOWNLOAD_BODY_FILE_TYPE_BUTTON_ICON),o.isSelect&&s.classList.add(r.a.ACTIVE),s.appendChild(l),o.tooltipTxt&&new Le.a(s,Ge.a.T,{title:{name:o.tooltipTxt}}),s.setAttribute(Ee.FILE_TYPE,o.imgFileType),o.outputType===Se.c.PRINT?e.printFileTypeButtonElements.push(s):e.webFileTypeButtonElements.push(s);case 9:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()),e.addButtonEventListener(e.webFileTypeButtonElements),e.addButtonEventListener(e.printFileTypeButtonElements),(e.selectedOutputType===Se.c.WEB?e.webFileTypeButtonElements:e.printFileTypeButtonElements).forEach(function(e){return o.appendChild(e)}),n.appendChild(o)}),n}},{key:"addButtonEventListener",value:function(e){var t=this;e.forEach(function(n){n.addEventListener("click",function(){t.selectedImageFileType=n.getAttribute(Ee.FILE_TYPE),_e.toggleElementActiveOfElements(e,n),t.updateImageCombineUI(),t.downloadFileTypeOption.update(t.selectedImageFileType),t.outputInfoTextBox.updateUI(t.getOutputInfoTextBoxOption()),t.updateClassName(),t.updateDownloadButtonUI(),t.selectedImageFileType===Se.b.PDF&&(t.updateDownloadAvailableStatus(),t.updateOutputInfoUI())})})}},{key:"makeSelectPageElement",value:function(){var e=this,t=this.selectPageElement=document.createElement("div");t.className=ge.POPUP_DOWNLOAD_BODY_SELECT_PAGE;var n=document.createElement("label");n.className=ge.POPUP_DOWNLOAD_BODY_TITLE,n.innerText="페이지 선택",t.appendChild(n);var i=this.selectedPageLabelElement=Be.a.makeLabel(Be.a.DROPDOWN_LABEL,this.getSelectPageButtonText()),a=this.selectedPageAreaElement=Be.a.makeDropDownButton(i);t.appendChild(a);var o=document.createElement("div");o.className=Be.a.DROPDOWN_LIST_AREA,o.classList.add("page_select"),_e.hideElement(o),this.selectPageScroll=new Ce.a(!1,!0),this.selectPageScroll.element.classList.add(ge.POPUP_DOWNLOAD_BODY_SELECT_PAGE_LIST_CONTAINER),this.selectPageScroll.contents.appendChild(this.makeSelectPageItemListElement()),o.appendChild(this.selectPageScroll.element);var s=this.selectPageDoneButtonElement=document.createElement("button");return s.className=ge.POPUP_DOWNLOAD_BODY_SELECT_PAGE_DONE_BUTTON,s.innerText="선택 완료",o.appendChild(s),this.wrapper.appendChild(o),a.addEventListener("click",function(){e.toggleDropdownUIVisible(a,o),_e.toggleElementActive(a)}),s.addEventListener("click",function(){Be.a.hideAllDropDown()}),t}},{key:"makeSelectPageItemListElement",value:function(){var e=this,t=this.selectPageItemListElement=document.createElement("ul");t.className=ge.POPUP_DOWNLOAD_BODY_SELECT_PAGE_LIST_ITEMS;var n=document.createElement("li"),i=this.allPageCheckBoxElement=document.createElement("input");i.type="checkbox",i.checked=!0,n.appendChild(i);var a=document.createElement("label");a.className=ge.POPUP_DOWNLOAD_BODY_DROPDOWN_TEXT,a.innerText=we.SELECT_PAGE_ALL_PAGE,Object(ne.setToolsIcon)(a,ne.ToolsIcon.CHECK),n.appendChild(a),t.appendChild(n);var o=function(t,n){t.preventDefault(),e.updateRelatedSelectPage(n)};n.addEventListener("click",function(e){o(e,i)}),this.thumbImgList=[];for(var s=function(n){var i=document.createElement("li"),a=new Image;e.thumbImgList.push(a),i.appendChild(a);var s=document.createElement("input");s.type="checkbox",s.value=n.toString(),s.checked=!0,i.appendChild(s);var r=document.createElement("label"),l=we.SELECT_PAGE;r.innerText="".concat(n+1," ").concat(l),Object(ne.setToolsIcon)(r,ne.ToolsIcon.CHECK),i.appendChild(r),t.appendChild(i),i.addEventListener("click",function(e){o(e,s)})},r=0;r<this.pageCount;r++)s(r);return t}},{key:"makeOutputInfoElement",value:function(){var e=this,t=this.outputInfoAreaElement=document.createElement("div");t.className=ge.POPUP_DOWNLOAD_BODY_OUTPUT_INFO;var n=document.createElement("label");n.className=ge.POPUP_DOWNLOAD_BODY_TITLE,n.innerText="최종 다운로드 정보",t.appendChild(n);var i=document.createElement("button");i.className=ge.POPUP_DOWNLOAD_INFO_BUTTON,Object(ne.setToolsIcon)(i,ne.ToolsIcon.OUTLINE);var a=document.createElement("label");return a.innerText="도움말",i.appendChild(a),i.addEventListener("click",function(t){e.updateInfoTooltipUI(!1),e.infoTooltipPopup.toggleVisible(),t.stopPropagation()}),t.appendChild(i),t.appendChild(this.outputInfoTextBox.element),this.printoutTextView=new We,t.appendChild(this.printoutTextView.getContainer()),t}},{key:"makeFooterUI",value:function(){var e=document.createElement("div");return e.className=ge.POPUP_DOWNLOAD_FOOTER,e.appendChild(this.makeDownloadButtons()),this.footerElement=e,e}},{key:"downloadForPrint",value:function(){var e=this.selectedDownloadType===Se.a.HIGH_RESOLUTION||this.selectedOutputType===Se.c.PRINT,t=this.selectedOutputType===Se.c.PRINT;this.doDownload({isHighResolution:e,isForceHighResolution:t})}},{key:"makeDownloadButtons",value:function(){var e=this,t=this.buttonWrap=document.createElement("div");t.className=ge.POPUP_DOWNLOAD_FOOTER_DOWNLOAD_BUTTON_AREA;var n=this.quickDownloadButtonElement=document.createElement("button");n.className="primary",n.tabIndex=-1,n.innerText="빠른 다운로드",n.setAttribute(Ee.DOWNLOAD_TYPE,Se.a.QUICK),n.addEventListener("click",function(){e.popupCallback.environment.isLogin()?(n.disabled=!0,e.doDownload({isHighResolution:!1})):e.openLoginPopup(e.isWebDownload()?Ie.a.OPEN_DOWNLOAD_POPUP:Ie.a.DOWNLOAD_PRINT)}),t.appendChild(n);var i=this.highResDownloadButtonElement=document.createElement("button");i.tabIndex=-1,i.innerText="고해상도 다운로드",i.setAttribute(Ee.DOWNLOAD_TYPE,Se.a.HIGH_RESOLUTION),i.addEventListener("click",function(){e.popupCallback.environment.isLogin()?(i.disabled=!0,e.doHighResDownload()):e.openLoginPopup(e.isWebDownload()?Ie.a.DOWNLOAD_HIGH:Ie.a.DOWNLOAD_PRINT)}),t.appendChild(i);var a=this.makePrintoutButton=document.createElement("button");return a.className="primary",a.innerText="인쇄물 제작",a.addEventListener("click",function(){e.onMakePrintoutButtonClick&&e.onMakePrintoutButtonClick(),e.close()}),t.appendChild(a),S.a.getDownloadPopupOption().showMakePrint?i.classList.add("outline"):i.classList.add("primary"),t}},{key:"doHighResDownload",value:function(){this.isWebDownload()?this.doDownload({isHighResolution:!0}):this.popupCallback.environment.isDevMode()?(this.popupCallback.confirmDownloadAction(this.downloadForPrint.bind(this)),this.close()):this.downloadForPrint()}},{key:"isWebDownload",value:function(){return this.selectedOutputType===Se.c.WEB}},{key:"doDownload",value:(n=s()(a.a.mark(function e(t){var n,i=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.selectedImageFileType!==Se.b.PPTX){e.next=5;break}return n=ce.b.get("/accounts/ppt-copyright-accepted"),e.next=4,n.then(function(e){"NO"===e.data.accepted?(i.close(),new Ue(i).open()):i.doDownloadAction({isHighResolution:i.selectedPPTOption!==Pe.FULL_IMAGE})});case 4:return e.abrupt("return");case 5:this.doDownloadAction(t);case 6:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"getDownloadParam",value:function(e){return{selectedPages:this.selectedPages,selectedFileType:this.selectedImageFileType,isApplyHighResolution:e.isHighResolution,printScale:e.printScale?e.printScale:1,isForceHighResolution:e.isForceHighResolution,isTransparentBackground:this.selectedImageFileType===Se.b.PNG&&this.optionChecked,isImgCombine:this.imgCombine.isChecked(),isWebDpi:this.selectedOutputType===Se.c.WEB,rasterize:this.isSelectedPPTFileType()&&this.selectedPPTOption===Pe.RASTERIZE}}},{key:"doDownloadAction",value:function(e){this.popupCallback.downloadAction(this.getDownloadParam(e)),this.doneDownloadEvent(e.isHighResolution)}},{key:"doneDownloadEvent",value:function(e){var t=this;this.downloadExecuteEvent&&e&&this.downloadExecuteEvent();try{var n=this.fileTypeIcons.find(function(e){return e.imgFileType===t.selectedImageFileType&&e.outputType===t.selectedOutputType}).tooltipTxt,i=null,a=null;e?this.selectedOutputType===Se.c.PRINT?(a=Te.c.DOWNLOAD_PRINT,i="인쇄용 다운로드"):(a=Te.c.DOWNLOAD_HIGH,i="고해상도 다운로드"):(a=Te.c.DOWNLOAD_QUICK,i="빠른 다운로드"),Te.a.moveVirtualPage(a),Te.a.sendEvent("다운로드",i,n,!0),ke.b.report(ke.a.DOWNLOAD,i)}catch(e){}this.close()}},{key:"toggleDropdownUIVisible",value:function(e,t){t.classList.contains(r.a.HIDE)?(Be.a.hideAllDropDown(),_e.showElement(t),Be.a.setTopPosition(t,Be.a.calculatePopupOffset(e).top-70),this.updateSelectPage()):_e.hideElement(t)}},{key:"updateSelectPage",value:function(){var e=this;this.updateSelectPageListHeightByPageCount(),X.a.instance.dispatch(new K.c(function(t){e.thumbImgList.forEach(function(){var e=s()(a.a.mark(function e(n,i){var o,s,r,l,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.pages[i],c=o.sheetSize.width/o.sheetSize.height,o.sheetSize.width>o.sheetSize.height?(s=n.height/o.sheetSize.height,l=n.height,r=l*c):(s=n.width/o.sheetSize.width,r=n.width,l=r/c),e.next=5,o.renderThumbnail(r,l,s);case 5:n.src=e.sent;case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}())}))}},{key:"hideDropdownAndTooltipUI",value:function(){Be.a.hideAllDropDown(),this.infoTooltipPopup.hide()}},{key:"updateInfoTooltipUI",value:function(e){var t=this.selectedOutputType===Se.c.WEB?_e.getFirstChildLabelWidth(this.webTabElement):_e.getFirstChildLabelWidth(this.printTabElement);this.infoTooltipPopup.updateUI({isTextConvertToImage:e,outputType:this.selectedOutputType,underBarWidth:t,isAdminMode:this.popupCallback.environment.isAdminMode(),isDevMode:this.popupCallback.environment.isDevMode()})}},{key:"updateRelatedSelectPage",value:function(e){e.checked=!e.checked,this.updateSelectedPages(e),this.updateSelectPageButtonUI(),this.updateDownloadAvailableStatus(),this.updateImageCombineUI(),this.updateOutputInfoUI(),this.updateDownloadButtonUI()}},{key:"updateSelectedPages",value:function(e){if(e===this.allPageCheckBoxElement)e.checked?this.initSelectedPagesByPageCount():this.selectedPages=[],this.toggleCheckAllPage(e.checked);else{var t=this.allPageCheckBoxElement,n=Number(e.value),i=this.selectedPages.indexOf(n);i>-1?(this.selectedPages.splice(i,1),t.checked&&(t.checked=!1)):(this.selectedPages.push(n),this.selectedPages.length===this.pageCount&&(t.checked=!0)),this.selectedPages.sort(function(e,t){return e-t})}}},{key:"updateSelectPageListHeightByPageCount",value:function(){var e=this.selectPageItemListElement.children[0],t=this.selectPageItemListElement.children.length,n=$(e).outerHeight(!0)*t;this.selectPageScroll.element.style.height="".concat(Math.min(n,216),"px")}},{key:"updateSelectPageButtonUI",value:function(){var e=this.selectedPageAreaElement,t=this.selectedPageLabelElement;this.selectedPages.length>0?(e.classList.remove(ge.POPUP_BUTTON_HIGHLIGHT),t.innerText=this.getSelectPageButtonText()):(e.classList.add(ge.POPUP_BUTTON_HIGHLIGHT),t.innerText=we.SELECT_PAGE_DEFAULT);var n=this.selectPageDoneButtonElement;this.popupCallback.environment.isDevMode()?n.classList.add(r.a.DEV_MODE):n.classList.remove(r.a.DEV_MODE)}},{key:"getSelectPageButtonText",value:function(){var e;e=(this.selectedPages[0]+1).toString();var t=this.selectedPages.length;if(1===t)e+=" ".concat(we.SELECT_PAGE);else if(t>1&&t<this.pageCount){for(var n=1;n<t;n++){if(8===n){e+="".concat(", ","...");break}var i=this.selectedPages[n]+1;e+="".concat(", ").concat(i.toString())}e+=" ".concat(we.SELECT_PAGE)}else e="".concat(we.SELECT_PAGE_ALL_PAGE," (1~").concat(this.pageCount,")");return e}},{key:"toggleCheckAllPage",value:function(e){var t=this.getCheckboxElementsOfSelectPage(),n=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){o.value.checked=e}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"changeToWebTypeButtonUI",value:function(){var e=this.fileTypeButtonAreaElement;t.clearChildNodes(e),this.webFileTypeButtonElements.forEach(function(t){e.appendChild(t)})}},{key:"changeToPrintTypeButtonUI",value:function(){var e=this.fileTypeButtonAreaElement;t.clearChildNodes(e),this.printFileTypeButtonElements.forEach(function(t){e.appendChild(t)})}},{key:"updateOutputInfoUI",value:function(){this.selectedOutputType===Se.c.PRINT?(this.outputInfoAreaElement.classList.add(String(Se.c.PRINT)),_e.hideElement(this.betaIcon)):(this.outputInfoAreaElement.classList.remove(String(Se.c.PRINT)),_e.showElement(this.betaIcon)),this.printoutTextView.setVisibility(S.a.getDownloadPopupOption().showMakePrint&&this.selectedOutputType===Se.c.PRINT&&this.popupCallback.environment.isLogin()),this.downloadFileTypeOption.update(this.selectedImageFileType),this.outputInfoTextBox.updateUI(this.getOutputInfoTextBoxOption()),this.updateClassName()}},{key:"getOutputInfoTextBoxOption",value:function(){return{isDownloadEnable:this.isHighResDownloadAvailable(),selectedFIleType:this.selectedImageFileType,enableOption:{selectedPageCount:this.selectedPages.length,outputType:this.selectedOutputType,outputInfo:this.popupCallback.getPrintSizeInfo(),isDevMode:this.popupCallback.environment.isDevMode(),isImgCombine:this.imgCombine.isChecked(),isiOSBigSize:this.isBigSizeIniOS()},disableOption:{selectedPageCount:this.selectedPages.length,selectedPageIdxList:this.selectedPages,acceptableInfo:this.popupCallback.getDownloadAcceptableInfo(),outputInfo:this.popupCallback.getPrintSizeInfo(),isImgCombine:this.imgCombine.isChecked(),isImgCombineOverMaxPageSize:this.isImgCombineOverMaxPageSize()}}}},{key:"isSingleDownloadButton",value:function(){return!this.isWebDownload()||this.isSelectedPPTFileType()}},{key:"isSelectedPPTFileType",value:function(){return this.selectedImageFileType===Se.b.PPTX}},{key:"updateDownloadButtonUI",value:function(){var e=this.isSingleDownloadButton()?"다운로드":"고해상도 다운로드",t=this.quickDownloadButtonElement,n=this.highResDownloadButtonElement;n.disabled=!1,this.isHighResDownloadAvailable()?n.classList.remove(r.a.DISABLE):n.classList.add(r.a.DISABLE),this.popupCallback.environment.isLogin()||!this.isTestMode()?n.innerText=e:n.innerText="로그인이 필요합니다";var i=S.a.getDownloadPopupOption().showMakePrint;this.isSingleDownloadButton()?(_e.hideElement(t),this.buttonWrap.classList.add("single_button")):(t.disabled=!1,_e.showElement(t),this.isQuickDownloadAvailable()?t.classList.remove(r.a.DISABLE):t.classList.add(r.a.DISABLE),this.buttonWrap.classList.remove("single_button")),this.isWebDownload()?(n.classList.add("primary"),n.classList.remove("outline")):i?(n.classList.remove("primary"),n.classList.add("outline"),this.buttonWrap.classList.remove("single_button")):(n.classList.add("primary"),n.classList.remove("outline")),i&&!this.isWebDownload()?_e.showElement(this.makePrintoutButton):_e.hideElement(this.makePrintoutButton)}},{key:"updateImageCombineUI",value:function(){this.selectedPages.length>1&&this.selectedOutputType===Se.c.WEB?this.imgCombine.show():this.imgCombine.hide(),this.selectedImageFileType===Se.b.PDF||this.selectedImageFileType===Se.b.PPTX?(this.imgCombine.disable(),this.imgCombine.initSetting()):this.imgCombine.enable()}},{key:"addDownloadButtonEventListener",value:function(e){this.downloadExecuteEvent=e}},{key:"getOutputType",value:function(){return this.popupCallback.pageOption.getPageSize().unit!==De.a.PX?Se.c.PRINT:Se.c.WEB}},{key:"isTestMode",value:function(){return this.popupCallback.environment.isDevMode()||this.popupCallback.environment.isAdminMode()}},{key:"isHighResDownloadAvailable",value:function(){return this.downloadAvailableStatus===Fe.ENABLE}},{key:"isBigSizeIniOS",value:function(){if(this.popupCallback.environment.isIOS()){var e=this.popupCallback.getPrintSizeInfo();if(e.pageWidth>4096||e.pageHeight>4096)return!0}return!1}},{key:"isQuickDownloadAvailable",value:function(){return this.downloadAvailableStatus===Fe.ENABLE&&(!this.imgCombine.isChecked()&&!this.isBigSizeIniOS())}},{key:"isImgCombineOverMaxPageSize",value:function(){return 65536<this.popupCallback.getPrintSizeInfo().pageHeight*this.selectedPages.length}},{key:"onChecked",value:function(e){this.optionChecked=e}},{key:"onClick",value:function(){this.updateInfoTooltipUI(!0),this.infoTooltipPopup.toggleVisible()}},{key:"onPPTDownloadAccepted",value:function(){this.doDownloadAction({isHighResolution:this.selectedPPTOption!==Pe.FULL_IMAGE})}},{key:"getSelectedPPTOption",value:function(){return this.selectedPPTOption?this.selectedPPTOption:Pe.RASTERIZE}},{key:"onSelectPPTOption",value:function(e){this.selectedPPTOption=e}}],[{key:"clearChildNodes",value:function(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild)}},{key:"makeImageFileTypeElement",value:function(e,t){var n;switch(e){case Se.b.PDF:n=t.pdf;break;case Se.b.PNG:n=t.png;break;case Se.b.PPTX:n=t.ppt;break;default:n=t.jpg}return null!=n?n.cloneNode(!0):document.createElement("div")}},{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}(u.a);ze.ID_ELEMENT_WRAPPER="download_popup",function(e){e[e.DISABLE=0]="DISABLE",e[e.ENABLE=1]="ENABLE"}(Fe||(Fe={}));var Ke=n(227),Ye=n(111),Xe=n(517),je=n(67),Ze=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).actionType=K.a.ONE_TIME,e.changeDesign=function(){return!1},e.commitAction=function(n,i,a){e.designDoc=n,e.store=i,e.renderer=a;var o={isLogin:t.isLogin,isAdminMode:t.isAdminMode,isDevMode:t.isDevMode,isIOS:t.isIOS},s={getPageSize:j.a.getPageSize};ze.instance.setCallback({environment:o,pageOption:s,saveLatest:Xe.a.saveLatest,downloadAction:Xe.a.doDownload,confirmDownloadAction:Xe.a.confirmDownload,getFileTypeIconElements:Xe.a.getFileTypeIconElements,getPrintSizeInfo:Xe.a.getOutputInfo,openLoginPopup:t.openLoginPopup,getDownloadAcceptableInfo:Xe.a.getDownloadAcceptableInfo})},e.rollbackAction=function(){},e.recycle=function(){},e.doSaveQueue=!1,e.renderAuto=!1,e}return z()(t,e),w()(t,null,[{key:"isLogin",value:function(){return f.a.getUser().isLogin()}},{key:"isAdminMode",value:function(){return Ke.a.getUserSetting().adminMode}},{key:"isDevMode",value:function(){return Ke.a.getUserSetting().devMode}},{key:"isIOS",value:function(){return je.a.isIOS()}},{key:"openLoginPopup",value:function(e,t,n){Ye.a.openLoginPopup(e,t,n)}}]),t}(K.b),qe=n(228),$e=n(256),Qe=n(233),Je=n(231),et=n(285),tt=n(309),nt=n(333),it=n(37),at=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.a.instance.renderPageIdx;L()(this,e),this.doSaveQueue=!0,this.actionType=K.a.ADD_TEXT_ITEM,this.isActionGroupEquals=function(){return!1},this.concat=function(e){return!1},this.changeDesign=function(){return!0},this.isLastSavedAction=!1,this.commit=function(){var e=s()(a.a.mark(function e(n,i,o){var s,r,l,c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.newItems,e.next=3,tt.a.getDefaultText();case 3:return r=e.sent,l=i.size,c=l.pageOffsetX*i.zoomScale+l.pageWidth*i.zoomScale/2,u=l.pageOffsetY*i.zoomScale+l.pageHeight*i.zoomScale/2,e.next=9,nt.b.loadToPage(r.idx,r.sheetUrl,t.pageIdx,t.newItems,c,u,!1);case 9:t.newItems=e.sent,je.a.isMobileDevice()||s||t.selectTextItemWordAll();case 11:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),this.rollback=function(){var e=s()(a.a.mark(function e(n,i,o){var s,r,l,c,u,d,h;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(s=n.pages[t.pageIdx],r=!0,l=!1,c=void 0,e.prev=4,u=t.newItems[Symbol.iterator]();!(r=(d=u.next()).done);r=!0)(h=d.value)instanceof q.a&&h.isEditMode&&i.pageController.getItemRenderer(h).toggleEditMode(),s.removeItem(h);e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),l=!0,c=e.t0;case 12:e.prev=12,e.prev=13,r||null==u.return||u.return();case 15:if(e.prev=15,!l){e.next=18;break}throw c;case 18:return e.finish(15);case 19:return e.finish(12);case 20:return e.next=22,o.renderAuto(n,i);case 22:case"end":return e.stop()}},e,null,[[4,8,12,20],[13,,15,19]])}));return function(t,n,i){return e.apply(this,arguments)}}(),this.recycle=function(){},this.pageIdx=n}return w()(e,[{key:"selectTextItemWordAll",value:function(){!it.a.isEmpty(this.newItems)&&this.newItems[0]instanceof q.a&&X.a.instance.dispatch(new et.c(this.newItems[0],0,0))}}]),e}(),ot={name:"family",actionType:K.a.TEXT_FONT_FAMILY,icon:ne.ToolsIcon.UPPER_CASE},st={name:"size",actionType:K.a.TEXT_FONT_SIZE},rt={name:"color",actionType:K.a.TEXT_FONT_COLOR,icon:ne.ToolsIcon.PENCIL,timeout:3e3},lt={name:"backgroundColor",actionType:K.a.TEXT_BACKGROUND_COLOR,icon:ne.ToolsIcon.FORMAT_COLOR_FILL,timeout:3e3},ct={name:"horizontalAlign",actionType:K.a.TEXT_HORIZONTAL_ALIGN},ut={name:"verticalAlign",actionType:K.a.TEXT_VERTICAL_ALIGN},dt={name:"bold",actionType:K.a.TEXT_BOLD,icon:ne.ToolsIcon.FORMAT_BOLD},ht={name:"italic",actionType:K.a.TEXT_ITALIC,icon:ne.ToolsIcon.FORMAT_ITALIC},pt={name:"underline",actionType:K.a.TEXT_UNDERLINE,icon:ne.ToolsIcon.FORMAT_UNDERLINE},mt={name:"strikeout",actionType:K.a.TEXT_STROKE,icon:ne.ToolsIcon.STROKE},ft={name:"upperCase",actionType:K.a.TEXT_UPPERCASE,icon:ne.ToolsIcon.UPPER_CASE},vt=(K.a.TEXT_GROUP_LIST_STYLE_BULLET,ne.ToolsIcon.FORMAT_LIST_BULLET,K.a.TEXT_GROUP_LIST_STYLE_NUMBER,ne.ToolsIcon.FORMAT_LIST_NUMBER,{groupName:"fontDetail",name:"active",actionType:K.a.TEXT_GROUP_FONT_DETAIL_ACTIVE}),gt={groupName:"fontDetail",name:"textSpace",actionType:K.a.TEXT_SPACE,timeout:3e3},Et={groupName:"fontDetail",name:"lineSpace",actionType:K.a.TEXT_LINE_SPACE,timeout:3e3},yt={groupName:"fontDetail",name:"scaleX",actionType:K.a.TEXT_SCALE_X,timeout:3e3},Tt={groupName:"curve",name:"active",actionType:K.a.TEXT_GROUP_CURVE_ACTIVE},It={groupName:"curve",name:"cw",actionType:K.a.TEXT_GROUP_CURVE_CW,icon:ne.ToolsIcon.CURVE_TEXT_IN},Ct={groupName:"curve",name:"cw",actionType:K.a.TEXT_GROUP_CURVE_CW,icon:ne.ToolsIcon.CURVE_TEXT_OUT},kt={groupName:"outline",name:"active",actionType:K.a.TEXT_OUTLINE_ACTIVE},Lt={groupName:"outline",name:"color",actionType:K.a.TEXT_OUTLINE_COLOR,timeout:3e3},_t={groupName:"outline",name:"size",actionType:K.a.TEXT_OUTLINE_SIZE,timeout:3e3},wt={groupName:"shadow",name:"active",actionType:K.a.TEXT_SHADOW_ACTIVE},St={groupName:"shadow",name:"color",actionType:K.a.TEXT_SHADOW_COLOR,timeout:3e3},bt={groupName:"shadow",name:"alpha",actionType:K.a.TEXT_SHADOW_ALPHA,timeout:3e3},Rt={groupName:"shadow",name:"angle",actionType:K.a.TEXT_SHADOW_ANGLE,timeout:3e3},At={groupName:"shadow",name:"distance",actionType:K.a.TEXT_SHADOW_DISTANCE,timeout:3e3},Ot={groupName:"shadow",name:"spread",actionType:K.a.TEXT_SHADOW_SPREAD,timeout:3e3},Pt={groupName:"shadow",name:"size",actionType:K.a.TEXT_SHADOW_SIZE,timeout:3e3},Dt={groupName:"gradient",name:"active",actionType:K.a.TEXT_GRADIENT_ACTIVE,timeout:3e3},Mt=(K.a.TEXT_GRADIENT_TYPE,{groupName:"gradient",name:"angle",actionType:K.a.TEXT_GRADIENT_ANGLE,timeout:3e3}),Nt={groupName:"gradient",name:"color1",actionType:K.a.TEXT_GRADIENT_COLOR1,timeout:3e3,icon:ne.ToolsIcon.FORMAT_COLOR_FILL},xt={groupName:"gradient",name:"color2",actionType:K.a.TEXT_GRADIENT_COLOR2,timeout:3e3,icon:ne.ToolsIcon.FORMAT_COLOR_FILL},Bt={groupName:"gradient",name:"color3",actionType:K.a.TEXT_GRADIENT_COLOR3,timeout:3e3,icon:ne.ToolsIcon.FORMAT_COLOR_FILL},Vt={groupName:"gradient",name:"color4",actionType:K.a.TEXT_GRADIENT_COLOR4,timeout:3e3,icon:ne.ToolsIcon.FORMAT_COLOR_FILL},Ut=n(330),Ft=n(276),Gt=n(366),Ht=n(271),Wt=n(287),zt=n(317),Kt=n(342),Yt=n(259),Xt=n(244),jt=n(298),Zt=n(400),qt=n(318),$t=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"removeElement",value:function(){$(this.container).remove()}},{key:"getTemplateSize",value:function(){return null}}]),t}(He.a),Qt=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0,d.b.random(),"li"))).useFavorite=!0,n.listItemData=e,n.container.draggable=!0,n}var n;return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.makeDefaultLi(),this.makeElement()}},{key:"onClosePopup",value:function(){this.setDddotBtnVisibility(!1)}},{key:"onOpenDddot",value:(n=s()(a.a.mark(function e(){var t,n=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(n.length>0&&void 0!==n[0])||n[0],e.next=3,qt.a.setListItem(this);case 3:this.setDddotBtnVisibility(!0),t&&Ft.a.sendDetailClick(this.listItemData.myCollectionPk);case 5:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"setDddotBtnVisibility",value:function(e){this.dddotBtn&&(e?this.dddotBtn.classList.add(r.a.SHOWN):this.dddotBtn.classList.remove(r.a.SHOWN))}},{key:"render",value:function(){return this.onCreateViewIfNotCreated(),this.container}},{key:"makeElement",value:function(){this.container.appendChild(this.makeThumbImg()),this.container.appendChild(this.makeHoverLayer())}},{key:"makeDefaultLi",value:function(){var e=this;this.container.setAttribute(t.ATTRIBUTE_RESOURCE_KEY,this.listItemData.resourceKey),this.container.addEventListener("click",function(){return e.doAction()})}},{key:"makeHoverLayer",value:function(){var e=this,t=document.createElement("div");return t.className=r.a.BTN_LAYER,t.draggable=!0,t.addEventListener("dragstart",function(t){e.container.classList.add("dragging"),t.dataTransfer.setData("text",e.container.id)}),t.addEventListener("dragend",function(){e.container.classList.remove("dragging")}),t}},{key:"makeThumbImg",value:function(){var e=this.thumb=jt.a.getImageElementWithReplaceableThumbnail(),t=this.getThumbUrlList();return!it.a.isEmpty(t)&&t[0]&&(e.src=t[0]),e}},{key:"updateThumbImg",value:function(e){if(this.thumb)if(e)this.thumb.src=e;else{var t=this.getThumbUrlList();this.thumb.src=it.a.isEmpty(t)?null:t[0]}}},{key:"doAction",value:function(){var e=Y.a.instance,t=e.size,n=t.pageOffsetX*e.zoomScale+t.pageWidth*e.zoomScale/2,i=t.pageOffsetY*e.zoomScale+t.pageHeight*e.zoomScale/2;X.a.instance.dispatch(new ui(Y.a.instance.renderPageIdx,n,i,this.listItemData.resourceKey))}},{key:"getEECItemData",value:function(e,t,n){this.onCreateViewIfNotCreated();var i=this.listItemData.myCollectionPk,a=Object(Q.c)(i.resourceType),o="".concat(a,":").concat(i.referenceKey);return{name:o,id:o,price:0,brand:"요소",category:e,variant:a,list:t,position:n}}}]),t}($t);Qt.ATTRIBUTE_RESOURCE_KEY="data-resource-key";var Jt=function e(t,n,i){L()(this,e),this.resourceData=t;var a=Zt.a.createInstance(n,i);this.myCollectionPk={resourceType:n,repositoryType:i,referenceKey:a.getKey(t)},this.dropEventKey=a.getDropEventKey(t),this.resourceKey=Ut.a.getResourceKey(this.myCollectionPk.resourceType,this.dropEventKey,this.myCollectionPk.repositoryType)},en=n(163),tn=n(26),nn=n(436),an=n(41),on=n(136),sn=n(323),rn=n(160),ln=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.listWrap.appendChild(this.btnShowMoreInList=this.makeBtnShowMoreInList())}},{key:"makeBtnShowMoreInList",value:function(){var e=this,t=document.createElement("div");t.className=r.a.BTN_MORE,t.addEventListener("click",function(t){e.listener&&e.listener.onShowMore(e.contentsStates.showMoreParameter),t.stopPropagation()});var n=document.createElement("div");return Object(ne.setToolsIcon)(n,ne.ToolsIcon.MOVE_RIGHT),t.appendChild(n),t}},{key:"refreshRenderView",value:function(){he()(F()(t.prototype),"refreshRenderView",this).call(this),this.btnShowMoreInList&&this.hideElementWhen(!this.scrollElement.hasHorizontalScroll(),this.btnShowMoreInList)}},{key:"getContentStateWithAdminMode",value:function(e,t,n){return new rn.a(e,t,n,Ke.a.getUserSetting().adminMode)}},{key:"renderItemView",value:function(e){return e.render()}}]),t}(rn.d),cn=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0))).templateListViewMap=new Map,n.props=e,n}return z()(t,e),w()(t,[{key:"setListener",value:function(e){this.listener=e}},{key:"getTemplateDC",value:function(){return this.templateDC||(this.templateDC=new yn({makeListItem:this.props.makeListItem})),this.templateDC.setTemplateStatus(this.props.getStatusParameter()),this.templateDC}},{key:"onFetchList",value:function(){var e=Array.from(this.templateListViewMap.values());if(!e.some(function(e){return void 0===e.itemViews})){var t=[];e.forEach(function(e){return t=t.concat(e.itemViews)}),this.listener.onFetchMultipleListAll(t)}}},{key:"makeTemplateListView",value:function(e){var t=new ln;return t.setListener(this),this.templateListViewMap.set(e,t),t}}]),t}(He.a);cn.LIST_SIZE=5;var un=cn,dn=n(29),hn=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,null,[{key:"update",value:function(e,t){return this.requestV3(void 0,pe.b.POST,"/api/design-resource/recent-update?resourceGroup=".concat(e),JSON.stringify(t))}}]),t}(pe.a),pn=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).dataMap=new Map,n.listeners=new Set,n}var n,i;return z()(t,e),w()(t,[{key:"addListener",value:function(e){this.listeners.add(e)}},{key:"fetchList",value:(i=s()(a.a.mark(function e(t){var n,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(i.length>1&&void 0!==i[1])||i[1],f.a.getUser().isLogin()){e.next=3;break}return e.abrupt("return",[]);case 3:if(this.dataMap.has(t)){e.next=10;break}return e.t0=this.dataMap,e.t1=t,e.next=8,this.fetchListInternal(t);case 8:e.t2=e.sent.reverse(),e.t0.set.call(e.t0,e.t1,e.t2);case 10:return n&&this.onResultList(t),e.abrupt("return",this.dataMap.get(t));case 12:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"addRecentResource",value:(n=s()(a.a.mark(function e(n,i,o){var s,r,l,c=this,u=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=!(u.length>3&&void 0!==u[3])||u[3],f.a.getUser().isLogin()){e.next=3;break}return e.abrupt("return");case 3:if(this.dataMap.has(i)){e.next=6;break}return e.next=6,this.fetchList(i,!1);case 6:r=this.makeRecentDesignResourceParam(n,i),(l=this.dataMap.get(i).filter(function(e){return!c.makeRecentDesignResourceParam(e,i).equal(r)})).unshift(n),l.splice(t.MAX_CNT),this.dataMap.set(i,l),this.onResultList(i),s&&(r.type||(r.type=i),r.searchWord||(r.searchWord=o),this.updateItem(i,r));case 13:case"end":return e.stop()}},e,this)})),function(e,t,i){return n.apply(this,arguments)})},{key:"onResultList",value:function(e){var t=this;this.listeners.forEach(function(n){return n.onResultRecentDesignResource(t.dataMap.get(e),e)})}},{key:"updateItem",value:function(e,t){hn.update(e,[t])}}]),t}(dn.a);pn.MAX_CNT=100;var mn,fn=pn,vn=function(){function e(t,n,i){L()(this,e),this.idx=t,this.type=n,this.searchWord=i}return w()(e,[{key:"equal",value:function(e){return this.idx===e.idx&&this.type===e.type}}]),e}(),gn=n(50),En=new(function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}var n,i,o;return z()(t,e),w()(t,[{key:"fetchListInternal",value:(o=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",on.a.fetchRecentList(t));case 1:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})},{key:"makeRecentDesignResourceParam",value:function(e,t){return new vn(String(e.idx),e.displayType?e.displayType.join(","):t)}},{key:"addRecentResource",value:(i=s()(a.a.mark(function e(n,i){var o,s,r=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.templateTypeList){e.next=2;break}return e.abrupt("return");case 2:if(0!==(o=new Set(n.templateTypeList.map(function(e){return e.purpose}))).size){e.next=5;break}return e.abrupt("return");case 5:s=o.size>1,he()(F()(t.prototype),"addRecentResource",this).call(this,n,gn.a.TEMPLATE,i,s),o.forEach(function(e){return he()(F()(t.prototype),"addRecentResource",r).call(r,n,tn.a.getDesignResourceType(e),i,!s)});case 8:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"addRecentSingleResource",value:(n=s()(a.a.mark(function e(n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:he()(F()(t.prototype),"addRecentResource",this).call(this,n,gn.a.TEMPLATE,i,!0);case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})}]),t}(fn));!function(e){e.DEFAULT="DEFAULT",e.BY_TEMPLATE_IDX="BY_TEMPLATE_IDX",e.BY_DESIGNER_ID="BY_DESIGNER_ID"}(mn||(mn={}));var yn=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).templateStatus=nn.a.ACTIVE,n.requestMode=mn.DEFAULT,n.multiTypeListenerMap=new Map,n.param=e,n}var n,i,o,r,l;return z()(t,e),w()(t,[{key:"setKeyword",value:function(e){this.keyword=e}},{key:"getKeyword",value:function(){return this.keyword}},{key:"setTemplateType",value:function(e){this.templateType=e}},{key:"setTemplateTypeIdList",value:function(e){this.templateTypeIdList=e}},{key:"getTemplateType",value:function(){return this.templateType}},{key:"setTemplateStatus",value:function(e){this.templateStatus=e}},{key:"getTemplateStatus",value:function(){return this.templateStatus}},{key:"fetchRecentList",value:(l=s()(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.templateType&&this.templateType.isAllType()){e.next=2;break}return e.abrupt("return",{items:[],totalRow:0});case 2:return e.next=4,En.fetchList(tn.a.getDesignResourceType(this.templateType.purpose));case 4:return t=e.sent,n=this.makeListItems(t),e.abrupt("return",{items:n,totalRow:n.length});case 7:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"fetchListInternal",value:(r=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setGTMLibDataAuto(this.keyword),e.t0=this.requestMode,e.next=e.t0===mn.BY_TEMPLATE_IDX?4:e.t0===mn.BY_DESIGNER_ID?7:(e.t0,mn.DEFAULT,10);break;case 4:return e.next=6,this.requestListByTemplateIdx(t);case 6:return e.abrupt("return",e.sent);case 7:return e.next=9,this.requestListByDesignerId(t);case 9:return e.abrupt("return",e.sent);case 10:return e.next=12,this.requestListDefault(t);case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"requestListDefault",value:(o=s()(a.a.mark(function e(t){var n,i,o,s,r,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,on.a.getTemplateListResponse(t);case 2:if(n=e.sent,i=this.makeListItems(n.list),o={items:i,totalRow:n.pagination.totalRow},i.length>0)try{s=this.getGTMLibData(),r=s.listTitle,l=s.category,Ft.a.sendImpressions({items:i,category:l,listTitle:r,pageNo:t.page,pageSize:t.pageSize})}catch(e){}return e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"requestListByDesignerId",value:(i=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,on.a.getTemplateListResponse(t);case 2:return n=e.sent,e.next=5,this.makeListItems(n.list);case 5:return e.t0=e.sent,e.t1=n.pagination.totalRow,e.abrupt("return",{items:e.t0,totalRow:e.t1});case 8:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"requestListByTemplateIdx",value:(n=s()(a.a.mark(function e(t){var n,i,o=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={items:[],totalRow:0},!isNaN(t.templateIdx)){e.next=3;break}return e.abrupt("return",n);case 3:return e.next=5,on.a.findOneTemplate(t.templateIdx);case 5:if(i=e.sent){e.next=8;break}return e.abrupt("return",n);case 8:return null!=i.templateTypeList.find(function(e){return o.templateType.id===e.id})&&i.status===this.templateStatus&&(n.items=this.makeListItems([i])),n.totalRow=n.items.length,e.abrupt("return",n);case 11:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"getRequestParam",value:function(e){var t=!this.templateType||this.templateType.id===an.d.ALL_TYPE.id||this.templateType.isAllType()&&this.templateTypeIdList?"":this.templateType.id,n=this.templateType.isAllType()?this.templateTypeIdList:null;switch(this.requestMode){case mn.BY_TEMPLATE_IDX:return{templateIdx:Number(this.keyword.substr(1))};case mn.BY_DESIGNER_ID:var i=this.keyword.substr(1);return{page:e.page,pageSize:e.pageSize,status:this.templateStatus,creatorEmail:i+v.b.ADMIN_EMAIL_DOMAIN,templateTypeId:t};case mn.DEFAULT:default:return{page:e.page,pageSize:e.pageSize,status:Ke.a.getUserSetting().adminMode?this.templateStatus:nn.a.ACTIVE,keyword:this.keyword,templateTypeId:t,templateTypeIdList:n}}}},{key:"initRequestMode",value:function(){if(!Ke.a.getUserSetting().adminMode||d.b.isEmpty(this.keyword))this.requestMode=mn.DEFAULT;else switch(this.keyword.charAt(0)){case"#":this.requestMode=mn.BY_TEMPLATE_IDX;break;case"@":this.requestMode=mn.BY_DESIGNER_ID;break;default:this.requestMode=mn.DEFAULT}}},{key:"setGTMLibDataAuto",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.templateType||an.d.ALL_TYPE,n="템플릿>",i=t.title,a=t.groupTitle;a?(n+="".concat(a,">").concat(i),i="".concat(a," ").concat(i)):n+=i,e&&(i+=":검색:".concat(e));var o="템플릿 > ".concat(i);this.setGTMLibData({listTitle:o,category:n,keyword:e})}},{key:"setGTMLibDataForce",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.setGTMLibDataAuto(e)}},{key:"isMultiType",value:function(){return!this.templateType||this.templateType.isMultiType()}},{key:"loadMultiTypeList",value:function(e,t){var n=this;arguments.length>2&&void 0!==arguments[2]?arguments[2]:tn.a.ALL;if(this.multiTypeListDataMap)t.onFetchMultiTypeTemplateList(e,this.makeListItems(this.multiTypeListDataMap.get(e.id)));else{if(this.multiTypeListenerMap.size>0)return this.multiTypeListenerMap.has(e)||this.multiTypeListenerMap.set(e,new Set),void this.multiTypeListenerMap.get(e).add(t);this.multiTypeListenerMap.set(e,(new Set).add(t)),s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,en.a.fetchAndMakeAllTemplatesMap(un.LIST_SIZE);case 3:n.multiTypeListDataMap=e.sent,e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),n.multiTypeListDataMap=new Map,console.error(e.t0);case 10:return e.prev=10,n.multiTypeListenerMap.forEach(function(e,i){e.forEach(function(e){return t.onFetchMultiTypeTemplateList(i,n.makeListItems(n.multiTypeListDataMap.get(i.id)))})}),e.finish(10);case 13:case"end":return e.stop()}},e,null,[[0,6,10,13]])}))()}}},{key:"makeListItems",value:function(e){var t=this;return e?e.map(function(e){return t.param.makeListItem(e)}):[]}},{key:"getLibType",value:function(){return sn.b.TEMPLATE}}],[{key:"getColsByTemplateType",value:function(e){return isNaN(e.width)||isNaN(e.height)?-1:this.getColsByRatio(e.width/e.height)}},{key:"getColsByRatio",value:function(e){return e>2.5?1:e>1?1:1===e?2:e>=.45?2:e>=.3?3:e>=.2?4:5}}]),t}(sn.a),Tn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q.a.TEMPLATE_PAGE;return L()(this,t),(e=V()(this,F()(t).call(this,!0))).resourceType=n,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add(r.a.SUB_PAGES_TOOL),this.setVisibility(!1),this.makeHeader(),this.makeBody()}},{key:"makeHeader",value:function(){var e=this,t=this.headerElem=document.createElement("div");t.className=r.a.TOOLS_HEADER;var n=document.createElement("div");t.appendChild(n),this.titleElem=document.createElement("div"),this.titleElem.className=r.a.TITLE,n.appendChild(this.titleElem),Object(ne.setToolsIcon)(n,ne.ToolsIcon.CLOSE,!0).addEventListener("click",function(){return e.setVisibility(!1)});var i=document.createElement("button");i.innerText=this.getTemplateLoadButtonName(),i.addEventListener("click",function(){Y.a.instance.editorMainVC.leftBarVC.setActive(!1),e.listItem.loadTemplateDesign(),e.onClickBtnTemplateLoad&&e.onClickBtnTemplateLoad()}),t.appendChild(i),this.container.appendChild(t)}},{key:"getTemplateLoadButtonName",value:function(){return"이 템플릿으로 덮어쓰기"}},{key:"makeBody",value:function(){this.listElem=document.createElement("div"),this.listElem.className=r.a.LIST_WRAP,this.container.appendChild(new Ce.a(void 0,void 0,"100%").render(this.listElem))}},{key:"updateUI",value:function(e){var n=this,i=this.listItem=e.listItem,a=i.listItemData;e.onClickItem&&(this.onClickBtnTemplateLoad=e.onClickItem),$(this.listElem).empty();var o=a.dropEventKey;i.getThumbUrlList().forEach(function(i,s){var r=t.makeTemplatePageKey(o,s),l=Ut.a.getResourceKey(n.resourceType,r,a.myCollectionPk.repositoryType);n.insertListItem(i,l,e.onClickItem)}),this.titleElem.innerText=e.listItem.getTitle()||"";var s=$(i.container),r=e.cols?e.cols:yn.getColsByRatio(s.height()/s.width());this.listElem.setAttribute("data-cols",String(r>0?r:t.DEFAULT_COLS))}},{key:"insertListItem",value:function(e,t,n){var i=this,a=document.createElement("div");a.className=r.a.PAGE_LIST_ITEM,a.id="sub_page_item_".concat(d.b.random()),a.setAttribute(Qt.ATTRIBUTE_RESOURCE_KEY,t),a.draggable=!0,$(a).on("click",function(){Y.a.instance.editorMainVC.leftBarVC.setActive(!1),i.listItem.loadTemplatePage($(a).index()),Ft.a.sendClick(i.listItem.listItemData.myCollectionPk),n&&n()}).on("dragstart",function(e){return e.originalEvent.dataTransfer.setData("text",a.id)});var o=jt.a.getImageElementWithReplaceableThumbnail();o.src=e,a.appendChild(o),this.listElem.appendChild(a)}}],[{key:"makeTemplatePageKey",value:function(e,n){return e+t.TEMPLATE_PAGE_KEY_SEPARATOR+n}},{key:"parseTemplatePageKey",value:function(e){var n=e.split(t.TEMPLATE_PAGE_KEY_SEPARATOR);return{designKey:n[0],pageIdx:Number(n[1])}}}]),t}(He.a);Tn.DEFAULT_COLS=2,Tn.TEMPLATE_PAGE_KEY_SEPARATOR="___page_key_sep___";var In=n(338);function Cn(e,t){var n=Y.a.instance;return{outputX:e/n.zoomScale,outputY:t/n.zoomScale}}var kn=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).renderAuto=!1,n.changeDesign=function(){return!0},n.doSaveQueue=!0,n}return z()(t,e),t}(K.b),Ln=n(265),_n=function(e){function t(e,n,i,a,o,s,r,l){var c;L()(this,t),(c=V()(this,F()(t).call(this))).cellsPos=[],c.doSaveQueue=!1,c.changeDesign=function(){return!1},c.actionType=K.a.GRID_SELECT_CELL,c.commitAction=function(e,t,n){if(c.selectedCellsChanged){var i=t.pageController.getItemRenderer(c.gridItem);c.gridItem.isTextEditMode&&i.toggleEditMode(c.offsetX,c.offsetY),c.gridItem.selectCells(c.cellsPos),i.renderViewAfter(null,t.pageEditScale),c.renderItemTools&&n.renderItemTools(e,t)}else c.gridItem.isTextEditMode;n.renderHandler(e,t)},c.rollbackAction=function(e,t,n){},c.recycle=function(){c.gridItem=null,c.cellsPos=null},c.gridItem=e,c.baseX=n,c.baseY=i,c.offsetX=a,c.offsetY=o,c.renderItemTools=l;var u=c.gridItem.selectedCells,d=c.gridItem.positionTool.getCellsPos(c.baseX,c.baseY,c.offsetX,c.offsetY);if(s&&!r){if(!c.gridItem.shiftClickBaseCellPos){var h=c.gridItem.selectedCells;if(h.length>0)c.gridItem.shiftClickBaseCellPos=new Ln.a(h[0].row,h[0].col);else{var p=c.gridItem.positionTool.getCellsPos(c.baseX,c.baseY,c.baseX,c.baseY);c.gridItem.shiftClickBaseCellPos=new Ln.a(p.startPos.row,p.startPos.col)}}for(var m=c.gridItem.shiftClickBaseCellPos,f=c.gridItem.positionTool.getCellsPos(c.baseX,c.baseY,c.baseX,c.baseY).startPos,v=Math.min(m.row,f.row),g=Math.min(m.col,f.col),E=Math.max(m.row,f.row),y=Math.max(m.col,f.col),T=v;T<=E;T++)for(var I=g;I<=y;I++)c.cellsPos.push(new Ln.a(T,I))}else if(r&&!s){c.gridItem.shiftClickBaseCellPos=null;for(var C=[],k=d.startPos.row;k<=d.endPos.row;k++)for(var _=d.startPos.col;_<=d.endPos.col;_++)C.push({row:k,col:_});for(var w=u.slice(),S=function(){var e=R[b];w.some(function(t){return t.row===e.row&&t.col===e.col})?w.splice(w.findIndex(function(t){return t.row===e.row&&t.col===e.col}),1):w.push(e)},b=0,R=C;b<R.length;b++)S();c.cellsPos=w}else{c.gridItem.shiftClickBaseCellPos=null;for(var A=d.startPos.row;A<=d.endPos.row;A++)for(var O=d.startPos.col;O<=d.endPos.col;O++)c.cellsPos.push(new Ln.a(A,O))}return c.selectedCellsChanged=!c.isArrayOfCellPosEquals(u,c.cellsPos),c}return z()(t,e),w()(t,[{key:"isArrayOfCellPosEquals",value:function(e,t){if(e.length!==t.length)return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++){var i=e[n],a=t[n];if(i.row!==a.row||i.col!==a.col)return!1}return!0}}]),t}(kn),wn=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).doSaveQueue=!1,n.actionType=K.a.GRID_SELECT_ALL_CELL,n.changeDesign=function(){return!1},n.commitAction=function(e,t,i){for(var a=[],o=0;o<n.gridItem.row;o++)for(var s=0;s<n.gridItem.col;s++)a.push(new Ln.a(o,s));n.gridItem.selectCells(a),t.pageController.getItemRenderer(n.gridItem).renderViewAfter(null,e.pages[t.renderPageIdx].lastRenderEditScale),i.renderHandler(e,t)},n.rollbackAction=function(e,t,n){},n.recycle=function(){n.gridItem=null},n.gridItem=e,n}return z()(t,e),t}(kn),Sn=function(e){function t(e,n,i){var o;return L()(this,t),(o=V()(this,F()(t).call(this))).doSaveQueue=!1,o.actionType=K.a.TEXT_CHANGE,o.commitAction=function(){var e=s()(a.a.mark(function e(t,n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.skipAction){e.next=2;break}return e.abrupt("return");case 2:J.a.selectItem(o.gridItem),n.pageController.getItemRenderer(o.gridItem).toggleEditMode(o.offsetX,o.offsetY);case 5:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),o.rollbackAction=function(e,t,n){},o.recycle=function(){o.gridItem=null},o.offsetX=n,o.offsetY=i,o.gridItem=e,o.skipAction=null===e.positionTool.getCell(n,i),o.skipAction||X.a.instance.dispatch(new _n(e,n,i,n,i,!1,!1)),o}return z()(t,e),t}(kn),bn=function(e){function t(e){var n,i;L()(this,t),(n=V()(this,F()(t).call(this))).deleted=[],n.selectedCells=[],n.doSaveQueue=!0,n.actionType=K.a.TEXT_CHANGE,n.commitAction=function(){var e=s()(a.a.mark(function e(t,i,o){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.selectedCells.forEach(function(e){return e.textProps.setText("")});case 1:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),n.rollbackAction=function(e,t,i){n.selectedCells.forEach(function(e,t){return e.textProps.setText(n.deleted[t])})},n.recycle=function(){n.gridItem=null,n.deleted=[],n.selectedCells=[]},n.gridItem=e;for(var o=0;o<e.row;o++)for(var r=0;r<e.col;r++)(i=e.cells[o][r]).selected&&(n.selectedCells.push(i),n.deleted.push(i.textProps.getText()));return n}return z()(t,e),t}(kn),Rn=n(300),An=n(297),On=n(260),Pn=n(57),Dn=n(475),Mn=n(293),Nn=n(110),xn=function(){function e(t,n){var i=this;L()(this,e),this.doSaveQueue=!1,this.actionType=K.a.COPY,this.isActionGroupEquals=function(){return!1},this.concat=function(){return!1},this.isLastSavedAction=!1,this.changeDesign=function(){return!1},this.commit=function(t,n){var a;if(i.itemsToCopy&&i.itemsToCopy.length>0)a=i.itemsToCopy;else if((a=Qe.b.getSortedGroupItemsAddedArray(n.activeItems.filter(function(e){return e.select}))).length<1)return;e.clearOsClipboard(),a.forEach(function(e){return e.copyKey=e.tbpeId});var o=Dn.a.makeCopyXml(Mn.a.getLatestVersion(),a);Pn.a.setItem(Pn.b.COPY_SHEET_SIZE,JSON.stringify(t.pages[i.pageIdx].sheetSize)),Pn.a.setItem(Pn.b.COPY_ITEMS,(new XMLSerializer).serializeToString(o))},this.rollback=function(){},this.recycle=function(){},this.pageIdx=t,n&&(this.itemsToCopy=n)}return w()(e,null,[{key:"clearOsClipboard",value:function(){var e=window.clipboardData;if(e)e.clearData();else{var t=document.createElement("input");t.value="item",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}}}]),e}(),Bn=function e(t){var n=this;L()(this,e),this.concat=function(){return!1},this.isLastSavedAction=!1,this.changeDesign=function(){return!0},this.doSaveQueue=!0,this.actionType=K.a.CUT,this.isActionGroupEquals=function(){return!1},this.commit=function(){var e=s()(a.a.mark(function e(t,i,o){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.activeItems.filter(function(e){return e.select}).length<1)){e.next=3;break}return e.abrupt("return");case 3:return n.copyAction.commit(t,i,o),n.deleteAction.commit(t,i,o),e.next=7,o.renderAuto(t,i);case 7:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),this.rollback=function(){var e=s()(a.a.mark(function e(t,i,o){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.deleteAction.rollback(t,i,o),n.copyAction.rollback(t,i,o),e.next=4,o.renderAuto(t,i);case 4:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),this.recycle=function(){n.copyAction=null,n.deleteAction=null},this.pageIdx=t,this.copyAction=new xn(t),this.deleteAction=new An.a},Vn=function(){function e(t){var n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];L()(this,e),this.doSaveQueue=!0,this.actionType=K.a.PASTE,this.isActionGroupEquals=function(){return!1},this.concat=function(){return!1},this.changeDesign=function(){return!0},this.isLastSavedAction=!1,this.commit=function(){var e=s()(a.a.mark(function e(t,i,o){var s,r,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.doSaveQueue){e.next=2;break}return e.abrupt("return");case 2:return s=t.pages[n.pageIdx].sheetSize,r=n.copySheetSize.width!==s.width||n.copySheetSize.height!==s.height,e.next=6,nt.b.paste(n.xml,n.pageIdx,t,i,o,n.newItems,0,0,!0,!1,!1,n.moveItems,r);case 6:n.newItems=e.sent,o.renderItemTools(t,i),(l=Y.a.instance.pageController.getPageRenderer(t.pages[i.renderPageIdx]))&&l.updateHoverLayer();case 10:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),this.rollback=function(){var e=s()(a.a.mark(function e(t,i,o){var s,r,l,c,u,d,h,p;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(s=t.pages[n.pageIdx],r=!0,l=!1,c=void 0,e.prev=4,u=n.newItems[Symbol.iterator]();!(r=(d=u.next()).done);r=!0)h=d.value,s.removeItem(h);e.next=12;break;case 8:e.prev=8,e.t0=e.catch(4),l=!0,c=e.t0;case 12:e.prev=12,e.prev=13,r||null==u.return||u.return();case 15:if(e.prev=15,!l){e.next=18;break}throw c;case 18:return e.finish(15);case 19:return e.finish(12);case 20:return e.next=22,o.renderAuto(t,i);case 22:(p=Y.a.instance.pageController.getPageRenderer(t.pages[i.renderPageIdx]))&&p.updateHoverLayer();case 24:case"end":return e.stop()}},e,null,[[4,8,12,20],[13,,15,19]])}));return function(t,n,i){return e.apply(this,arguments)}}(),this.recycle=function(){n.newItems=null,n.xml=null},this.pageIdx=t,this.moveItems=i;try{var o=Pn.a.getItem(Pn.b.COPY_ITEMS),r=Pn.a.getItem(Pn.b.COPY_SHEET_SIZE);if(o){var l=JSON.parse(r),c=l.width,u=l.height;this.copySheetSize=new Nn.a(c,u);var d=new DOMParser;this.xml=d.parseFromString(o,"text/xml")}else this.doSaveQueue=!1}catch(e){console.error(e),this.doSaveQueue=!!this.xml}}return w()(e,null,[{key:"canPaste",value:function(){return!!Pn.a.getItem(Pn.b.COPY_ITEMS)}}]),e}(),Un=n(277),Fn=n(241),Gn=n(295),Hn=n(396),Wn=n(168),zn=function(){function e(t){L()(this,e),this.keyEvent=t,this.keyCheck=new Wn.a(t),this.isStopAfterAction=!1}return w()(e,[{key:"keyDown",value:function(){if(!this.isItemKeyDown()){if(this.keyCheck.isCtrlSpace())this.changeScreenMoveMode();else if(this.keyCheck.isCtrlPlus()||this.keyCheck.isCtrlMinus()){this.keyEvent.preventDefault();var t=this.keyCheck.isCtrlPlus()?Hn.b.IN:Hn.b.OUT;Hn.a.zoomInOutByExtend(t)}if(this.keyCheck.isSpace()){if(Y.a.instance.editorMainVC.zoomSettingVC.isScreenMoveMode)return void this.keyCheck.eventPreventDefault();e.disableFocusButton()}e.isInputEditing()&&(this.isStopAfterAction=!0)}}},{key:"changeScreenMoveMode",value:function(){this.keyCheck.eventPreventDefault(),e.isScreenMoveMode()||(Y.a.instance.mouseAction.mode=Fn.a.MODE_NAVIGATION),Y.a.instance.editorMainVC.canvasAreaVC.enableScrollMode()}},{key:"isItemKeyDown",value:function(){var e=Y.a.instance.activeItems;return!(1!==e.length||!Y.a.isCropMode()&&e[0].groupId)&&this.isSingleItemKeyDown()}},{key:"isSingleItemKeyDown",value:function(){var e=Y.a.instance.activeItems[0];return!!(e instanceof Je.d&&Y.a.isCropMode())&&(this.isStopAfterAction=!0,this.keyCheck.isEnter()?e.belongsTo===Je.c.INDEPENDENT?X.a.instance.dispatch(new Gn.c):X.a.instance.dispatch(new Rn.i):this.keyCheck.isEsc()||this.keyCheck.isBackSpace()?X.a.instance.dispatch(new Gn.d):this.keyCheck.isArrowDirection()&&this.moveItemPosition(),!0)}},{key:"moveItemPosition",value:function(){var e,t=0,n=0;e=this.keyCheck.isShiftPress()?10:1,this.keyCheck.isLeft()?t=-e:this.keyCheck.isRight()?t=e:this.keyCheck.isUp()?n=-e:this.keyCheck.isDown()&&(n=e),0===t&&0===n||X.a.instance.dispatch(new On.g(t,n,!1,!0,!0))}}],[{key:"isScreenMoveMode",value:function(){return Y.a.instance.mouseAction.mode===Fn.a.MODE_NAVIGATION||Y.a.instance.mouseAction.mode===Fn.a.MODE_NAVIGATION_DRAG}},{key:"disableFocusButton",value:function(){var e=document.activeElement;"button"===e.tagName.toLowerCase()&&e.blur()}},{key:"isInputEditing",value:function(){var e=document.activeElement,t=e instanceof HTMLInputElement,n=!1;return t&&(n="text"===e.type.toLowerCase()),t&&n}}]),e}(),Kn=n(62),Yn=n.n(Kn),Xn=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe.b.getSortedGroupItemsAddedArray(Y.a.instance.activeItems.slice()),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y.a.instance.renderPageIdx;L()(this,e),this.doSaveQueue=!0,this.isActionGroupEquals=function(e){return!1},this.concat=function(e){return!1},this.changeDesign=function(){return!0},this.isLastSavedAction=!1,this.commit=function(e,n,i){t.saveOldItemList(e)},this.rollback=function(){var e=s()(a.a.mark(function e(n,i,o){var s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=Qe.b.convertSinglesToItems(t.oldItemList),n.pages[t.pageIdx].setItems(s,!0),e.next=4,o.renderAuto(n,i);case 4:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),this.selectedItems=n,this.pageIdx=i}return w()(e,[{key:"recycle",value:function(){this.oldItemList=null}},{key:"saveOldItemList",value:function(e){var t=e.pages[this.pageIdx];this.oldItemList=t.getAllSingleItems().slice(0)}}]),e}(),jn=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(o)))).actionType=K.a.LAYER_ALIGN_FIRST,n.commit=function(){var e=s()(a.a.mark(function e(t,i,o){var s,r,l,c,u,d,h,p,m,f;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.saveOldItemList(t),s=t.pages[n.pageIdx],r=s.getAllSingleItems().slice(),l=0,c=n.selectedItems.length;case 4:if(!(l<c)){e.next=19;break}u=n.selectedItems[l],d=0,h=r.length;case 7:if(!(d<h)){e.next=16;break}if(p=r[d],u.tbpeId!==p.tbpeId){e.next=13;break}return m=r.splice(d,1),r.push(m[0]),e.abrupt("break",16);case 13:d++,e.next=7;break;case 16:l++,e.next=4;break;case 19:return f=Qe.b.convertSinglesToItems(r),s.setItems(f,!0),e.next=23,o.renderAuto(t,i);case 23:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),n}return z()(t,e),t}(Xn),Zn=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(o)))).actionType=K.a.LAYER_ALIGN_FORWARD,n.commit=function(){var e=s()(a.a.mark(function e(t,i,o){var s,r,l,c,u,d,h,p,m,f,v,g,E,y,T,I,C;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.saveOldItemList(t),s=t.pages[n.pageIdx],r=s.getAllSingleItems().slice(),l=0,c=n.selectedItems.length;case 4:if(!(l<c)){e.next=25;break}u=n.selectedItems[c-1-l],d=null,h=0,p=r.length-1;case 9:if(!(p>=0)){e.next=22;break}if(m=r[p],u.tbpeId===m.tbpeId){e.next=16;break}return f=Qe.b.getRootGroup(m.groupId),(v=f?f.getGroupId():null)&&v===d?h++:(h=0,d=v),e.abrupt("continue",19);case 16:return g=r.length-1-l,p<g&&(E=1+h,y=r.splice(p+1+E),T=r.splice(p+1),I=r.splice(p),r=r.concat(T).concat(I).concat(y)),e.abrupt("break",22);case 19:p--,e.next=9;break;case 22:l++,e.next=4;break;case 25:return C=Qe.b.convertSinglesToItems(r),s.setItems(C,!0),e.next=29,o.renderAuto(t,i);case 29:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),n}return z()(t,e),t}(Xn),qn=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(o)))).actionType=K.a.LAYER_ALIGN_BACKWARD,n.commit=function(){var e=s()(a.a.mark(function e(t,i,o){var s,r,l,c,u,d,h,p,m,f,v,g,E,y,T,I,C,k,L;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.saveOldItemList(t),s=t.pages[n.pageIdx],r=s.getAllSingleItems().slice(),l=0,c=n.selectedItems.length;case 4:if(!(l<c)){e.next=24;break}u=n.selectedItems[l],d=null,h=0,p=0,m=r.length;case 9:if(!(p<m)){e.next=21;break}if(f=r[p],u.tbpeId===f.tbpeId){e.next=16;break}return v=Qe.b.getRootGroup(f.groupId),(g=v?v.getGroupId():null)&&g===d?h++:(h=0,d=g),e.abrupt("continue",18);case 16:return p>l&&(E=r.splice(p+1),y=r.splice(p),T=1+h,I=r.splice(p-T),r=r.concat(y).concat(I).concat(E)),e.abrupt("break",21);case 18:p++,e.next=9;break;case 21:l++,e.next=4;break;case 24:return(C=s.background.backgroundItem)&&r.length>1&&C.tbpeId!==r[0].tbpeId&&(k=r.indexOf(C),r.splice(k,1),r.unshift(C)),L=Qe.b.convertSinglesToItems(r),s.setItems(L,!0),e.next=30,o.renderAuto(t,i);case 30:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),n}return z()(t,e),t}(Xn),$n=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(o)))).actionType=K.a.LAYER_ALIGN_LAST,n.commit=function(){var e=s()(a.a.mark(function e(t,i,o){var s,r,l,c,u,d,h,p,m,f,v,g;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.saveOldItemList(t),s=t.pages[n.pageIdx],r=s.getAllSingleItems().slice(),l=0,c=n.selectedItems.length;case 4:if(!(l<c)){e.next=20;break}u=n.selectedItems[c-1-l],d=0,h=r.length;case 7:if(!(d<h)){e.next=17;break}if(p=r[d],u.tbpeId===p.tbpeId){e.next=11;break}return e.abrupt("continue",14);case 11:return m=r.splice(d,1),r=m.concat(r),e.abrupt("break",17);case 14:d++,e.next=7;break;case 17:l++,e.next=4;break;case 20:return(f=s.background.backgroundItem)&&(v=r.indexOf(f),r.splice(v,1),r.unshift(f)),g=Qe.b.convertSinglesToItems(r),s.setItems(g,!0),e.next=26,o.renderAuto(t,i);case 26:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),n}return z()(t,e),t}(Xn),Qn=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return L()(this,t),(i=V()(this,F()(t).call(this))).actionType=K.a.LAYER_ALIGN_SWAP,i.changeDesign=function(){return!0},i.doSaveQueue=!0,i.lastIdxList=null,i.targetIdxList=null,i.selectedItems=Y.a.instance.activeItems.slice(),i.commit=function(){var e=s()(a.a.mark(function e(t,n,o){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.doSaveQueue){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,i.commitAction(t,n,o);case 4:o.renderCanvas(t,n),o.renderLayer(t,n);case 6:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),i.rollback=function(){var e=s()(a.a.mark(function e(t,n,o){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.rollbackAction(t,n,o);case 2:o.renderCanvas(t,n),o.renderLayer(t,n);case 4:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),i.commitAction=function(){var e=s()(a.a.mark(function e(t,n,o){var s,r,l,c,u,d,h,p,m,f;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.targetIdx<=i.targetIdxOri?(s=t.pages[n.renderPageIdx],r=s.getAllSingleItems().slice(),l=r.splice(i.lastIdxList[i.lastIdxList.length-1]+1),c=r.splice(i.targetIdxList[0],i.targetIdxList.length),u=Qe.b.convertSinglesToItems(r.concat(c).concat(l)),s.setItems(u,!0)):(d=t.pages[n.renderPageIdx],h=d.getAllSingleItems().slice(),p=h.splice(i.targetIdxList[0],i.targetIdxList.length),m=h.splice(i.lastIdxList[0]),f=Qe.b.convertSinglesToItems(h.concat(p).concat(m)),d.setItems(f,!0));case 1:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),i.rollbackAction=function(){var e=s()(a.a.mark(function e(t,n,o){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.switchSwapActionDirection(),i.commitAction(t,n,o),i.switchSwapActionDirection();case 3:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),i.recycle=function(){i.selectedItems=null,i.lastIdxList=null,i.targetIdxList=null},i.targetIdxOri=e,i.targetIdx=n,i.lastIdxList=o,i.targetIdxList=r,i.doSaveQueue=n!==e,i}return z()(t,e),w()(t,[{key:"switchSwapActionDirection",value:function(){var e=Yn()(this.targetIdxList);this.targetIdxList=this.lastIdxList,this.lastIdxList=e;var t=this.targetIdxOri;this.targetIdxOri=this.targetIdx,this.targetIdx=t}}]),t}(Xn),Jn=n(279),ei=n(401),ti=n(303),ni=n(341),ii=function(){function e(){L()(this,e)}return w()(e,null,[{key:"makeElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("span");t.className=r.a.RING_LOADER,t.appendChild(document.createElement("span")),t.appendChild(document.createElement("span")),t.appendChild(document.createElement("span")),t.appendChild(document.createElement("span"));var n=document.createElement("label");return n.innerText=e,t.appendChild(n),t}}]),e}(),ai=function(e){function t(e,n,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return L()(this,t),(o=V()(this,F()(t).call(this,e,i,a,s))).photoKey=n,o.actionType=K.a.ADD_PHOTO,o}var n,i,o;return z()(t,e),w()(t,[{key:"getImageSize",value:(o=s()(a.a.mark(function e(t){var n,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=ni.a.getFileIDWithKey(this.photoKey),e.next=3,ti.d.requestToDownloadPixabayImage(n);case 3:return i=ti.b.get(n),e.next=6,M.b.setUrlImage(this.photoKey,i.webformatURL);case 6:return o=e.sent,this.webFormatURL=i.webformatURL,e.abrupt("return",{imgWidth:o.width,imgHeight:o.height});case 9:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"createNewItem",value:(i=s()(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Je.d(t,n.toRect()));case 1:case"end":return e.stop()}},e)})),function(e,t){return i.apply(this,arguments)})},{key:"afterCreateItem",value:(n=s()(a.a.mark(function e(t,n){var i,o,r,l=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.newItem,e.next=3,ti.d.downloadStatus(this.photoKey);case 3:o=e.sent,r=Y.a.instance.pageController.getItemRenderer(i),o.data.status!==ti.a.CACHED&&(r.elements.downloadCheck=function(){var e=s()(a.a.mark(function e(t){var o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.elements.downloadCheck=null,(o=ii.makeElement()).style.transform="scale(".concat(1/(n.zoomScale*n.pageEditScale),")"),t.appendChild(o),e.next=6,ti.d.startDownloadCompletePolling(l.photoKey,function(){t.removeChild(o)},function(){t.removeChild(o),i.setResourceLoadStatus(qe.b.TEMPORARY_ERROR)});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"setItemOption",value:function(e){he()(F()(t.prototype),"setItemOption",this).call(this,e);var n=e;n.props.setPhotoKey(this.photoKey),n.orgType=Je.b.Pixabay}}]),t}(On.j),oi=n(322),si=n(503),ri=n(314),li=n(234),ci=n(308),ui=function(e){function t(e,n,i,o){var r,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return L()(this,t),(r=V()(this,F()(t).call(this))).doSaveQueue=!1,r.changeDesign=function(){return!1},r.actionType=K.a.CANVAS_DROP,r.commitAction=function(){var e=s()(a.a.mark(function e(t,n,i){var o,s,l,c,u,d,h,p,m,f,v,g,E,y,T,I,C,k,L,_,w,S,b,R,A,O,P,D,M,N,x,B;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Cn(r.offsetX,r.offsetY),s=o.outputX,l=o.outputY,c=n.activeItems[0],i.leftBarVC.setActive(!1),!r.isDragging){e.next=39;break}u=!1,d=!0,h=!1,p=void 0,e.prev=8,m=t.pages[Symbol.iterator]();case 10:if(d=(f=m.next()).done){e.next=23;break}if(v=f.value,!(g=n.pageController.getPageRenderer(v)).isInRange(r.offsetX,r.offsetY)){e.next=20;break}return r.pageIdx=v.pageIdx,E=g.getPagePosition(r.offsetX,r.offsetY),s=E.x/Y.a.instance.zoomScale,l=E.y/Y.a.instance.zoomScale,u=!0,e.abrupt("break",23);case 20:d=!0,e.next=10;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(8),h=!0,p=e.t0;case 29:e.prev=29,e.prev=30,d||null==m.return||m.return();case 32:if(e.prev=32,!h){e.next=35;break}throw p;case 35:return e.finish(32);case 36:return e.finish(29);case 37:if(u){e.next=39;break}return e.abrupt("return");case 39:if(y=t.pages[r.pageIdx],T=r.offsetX/Y.a.instance.zoomScale,I=r.offsetY/Y.a.instance.zoomScale,C=n.pageController.getPageRenderer(y),k=C.getInRangeItems(T,I,T,I),null!=(L=Ut.a.parseResourceKey(r.resourceKey))){e.next=47;break}return e.abrupt("return");case 47:_=s/n.pageEditScale,w=l/n.pageEditScale,c&&c.isEditMode&&c.changeNormalMode(),S=!0,e.t1=L.resourceType,e.next=e.t1===Q.a.BITMAP?53:e.t1===Q.a.IMAGE?53:e.t1===Q.a.BACKGROUND_PATTERN?56:e.t1===Q.a.BACKGROUND_IMAGE?61:e.t1===Q.a.PHOTO?63:e.t1===Q.a.PIXABAY?66:e.t1===Q.a.SVG?69:e.t1===Q.a.MOCKUP?74:e.t1===Q.a.TEXT?74:e.t1===Q.a.COMBINATION?74:e.t1===Q.a.STYLE?74:e.t1===Q.a.GRID?76:e.t1===Q.a.GRAPHIC?78:e.t1===Q.a.LINE?78:e.t1===Q.a.ILLUST?78:e.t1===Q.a.FIGURE?78:e.t1===Q.a.TEMPLATE?83:e.t1===Q.a.DESIGN?85:e.t1===Q.a.FRAME?87:e.t1===Q.a.TEMPLATE_PAGE?92:e.t1===Q.a.DESIGN_PAGE?95:98;break;case 53:return b=k.filter(function(e){return e instanceof ee.b&&e.canInsertPhotoItem()}),r.isDragging&&b.length>0?X.a.instance.dispatch(new Rn.d(b[0],L.key,L.resourceType)):L.resourceType===Q.a.BITMAP?X.a.instance.dispatch(new si.a(r.pageIdx,L.key,s,l,r.isDragging)):X.a.instance.dispatch(new si.b(r.pageIdx,L.key,s,l,r.isDragging)),e.abrupt("break",100);case 56:return e.next=58,Xt.c.getSvgDataByKey(L.key);case 58:return R=e.sent,X.a.instance.dispatch(new oi.e(Y.a.instance.renderPageIdx,R)),e.abrupt("break",100);case 61:return X.a.instance.dispatch(new oi.a(L.key)),e.abrupt("break",100);case 63:return A=k.filter(function(e){return e instanceof ee.b&&e.canInsertPhotoItem()}),r.isDragging&&A.length>0?X.a.instance.dispatch(new Rn.d(A[0],L.key,L.resourceType)):r.isDragging&&1===n.activeItems.length&&c.isInRange(new li.a(_,w,_,w))?c instanceof Je.d&&X.a.instance.dispatch(new Gn.a(r.pageIdx,L.key,s,l,r.isDragging)):X.a.instance.dispatch(new Gn.a(r.pageIdx,L.key,s,l,r.isDragging)),e.abrupt("break",100);case 66:return O=k.filter(function(e){return e instanceof ee.b&&e.canInsertPhotoItem()}),r.isDragging&&O.length>0?X.a.instance.dispatch(new Rn.e(O[0],L.key,L.resourceType)):(P=L.key,X.a.instance.dispatch(new ai(r.pageIdx,P,s,l,r.isDragging))),e.abrupt("break",100);case 69:return e.next=71,In.a.makeSvgDataFromFileKey(L.key);case 71:return D=e.sent,X.a.instance.dispatch(new ri.d(r.pageIdx,D,s,l,r.isDragging)),e.abrupt("break",100);case 74:return X.a.instance.dispatch(new nt.b(r.pageIdx,L,s,l,r.isDragging,!0)),e.abrupt("break",100);case 76:return X.a.instance.dispatch(new nt.b(r.pageIdx,L,s,l,r.isDragging)),e.abrupt("break",100);case 78:return e.next=80,Xt.c.getSvgDataByKey(L.key);case 80:return M=e.sent,Xt.c.isDefaultShapeSvg(M)?X.a.instance.dispatch(new ri.i(r.pageIdx,M,s,l,r.isDragging)):X.a.instance.dispatch(new ri.f(r.pageIdx,M,s,l,r.isDragging)),e.abrupt("break",100);case 83:return X.a.instance.dispatch(new ei.a(Gt.a.getDesignBasis(L.key,L.repositoryType),0).setTemplateAction()),e.abrupt("break",100);case 85:return X.a.instance.dispatch(new ei.a(Gt.a.getDesignBasis(L.key,L.repositoryType,!1),0).setTemplateAction()),e.abrupt("break",100);case 87:return e.next=89,Yt.c.getImageframeDataByKey(L.key);case 89:return N=e.sent,X.a.instance.dispatch(new ri.g(r.pageIdx,N,s,l,r.isDragging)),e.abrupt("break",100);case 92:return x=Tn.parseTemplatePageKey(L.key),X.a.instance.dispatch(new ei.a(Gt.a.getDesignBasis(x.designKey,L.repositoryType),x.pageIdx)),e.abrupt("break",100);case 95:return B=Tn.parseTemplatePageKey(L.key),X.a.instance.dispatch(new ei.a(Gt.a.getDesignBasis(B.designKey,L.repositoryType,!1),B.pageIdx)),e.abrupt("break",100);case 98:return S=!1,e.abrupt("break",100);case 100:S&&Ft.a.sendClick(L);case 101:case"end":return e.stop()}},e,null,[[8,25,29,37],[30,,32,36]])}));return function(t,n,i){return e.apply(this,arguments)}}(),r.rollbackAction=function(e,t){},r.recycle=function(){},r.pageIdx=e,r.offsetX=n,r.offsetY=i,r.resourceKey=o,r.targetItem=l,r.isDragging=c,r.renderAuto=!1,r}return z()(t,e),t}(K.b),di=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).isPossibleInCropMode=!0,n.doSaveQueue=!1,n.changeDesign=function(){return!1},n.actionType=K.a.KEY_DOWN,n.commitAction=function(){var e=s()(a.a.mark(function e(t,i,o){var l,c,u,d,h,p,m,f,v,g,E,y,T,I,k,L,_,w,b,R,A,O,P,D,M,N,x,B,V,U,F,G,H,W,z,j,$,Q,te,ne,ie,ae,oe,se,re,le,ce,ue,de,he,pe,me,fe,ve,ge,Ee,ye,Ce,ke,Le,_e,we,Se,be,Re;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l=new Wn.a(n.e),c=!1,(u=new zn(n.e)).keyDown(),d=i.activeItems.slice(),h=t.pages[Y.a.instance.renderPageIdx],p=d&&d.length>0?d[0]:null,1!==d.length||p!==h.background.backgroundItem){e.next=18;break}if(!n.e.target.classList.contains(r.a.PAGE_TITLE)){e.next=10;break}return e.abrupt("return");case 10:if(n.e.preventDefault(),n.e.stopPropagation(),f=l.isCtrlOrCommandPress(),v=n.character.toUpperCase(),g=f&&("Z"===v||"Y"===v),E=f&&n.e.shiftKey&&"Z"===v,g||E){e.next=18;break}return e.abrupt("return");case 18:if(!Y.a.isSpoidMode()){e.next=20;break}return e.abrupt("return");case 20:if(!u.isStopAfterAction){e.next=26;break}return n.e.preventDefault(),n.e.stopPropagation(),o.renderCanvas(t,i,d),o.renderHandler(t,i),e.abrupt("return");case 26:if(46!==n.keyCode&&8!==n.keyCode){e.next=33;break}c=!0,y=!1,p instanceof q.a&&p.isEditMode||p instanceof Z.a&&p.isTextEditMode||(p instanceof Z.a&&p.existSelectedCell()?X.a.instance.dispatch(new bn(p)):1===d.length&&!p.groupId&&!p.isLock()&&p instanceof ee.b&&!p.isDefaultImage()?(X.a.instance.dispatch(new Rn.a(p)),y=!0):(n.e.preventDefault(),X.a.instance.dispatch(new An.a),y=!0)),y&&Te.a.sendEvent("단축키 vs 버튼클릭","삭제하기",8===n.keyCode?"Backspace":"Delete",!0),e.next=203;break;case 33:if(!l.isCtrlOrCommandPress()||!n.e.shiftKey||"."!==n.character){e.next=37;break}c=!0,e.next=203;break;case 37:if(!l.isCtrlOrCommandPress()||!n.e.shiftKey||","!==n.character){e.next=41;break}c=!0,e.next=203;break;case 41:if(!l.isCtrlOrCommandPress()||!n.e.shiftKey||"K"!==n.character){e.next=46;break}c=!0,p instanceof q.a&&(T=ft,I=!p.props.isUpperCase(),X.a.instance.dispatch(new Un.d(T.actionType,T.groupName,T.name,I,!0,T.timeout))),e.next=203;break;case 46:if(!l.isUngroupingHotkey()){e.next=52;break}c=!0,n.e.preventDefault(),X.a.instance.dispatch(new On.d),e.next=203;break;case 52:if(!l.isLayerWindowToggleHotkey()){e.next=56;break}Ke.a.setIsLayerVisible(!Ke.a.getUserSetting().isLayerVisible),e.next=203;break;case 56:if(!l.isRulerToggleHotkey()){e.next=60;break}Ke.a.setIsRulerVisible(!Ke.a.getUserSetting().isRulerVisible),e.next=203;break;case 60:if(!l.isCtrlOrCommandPress()||!(n.e.shiftKey&&"Z"===n.character||"Y"===n.character)){e.next=69;break}if(c=!1,n.renderAuto=!1,n.e.preventDefault(),Y.a.isCropMode()){e.next=67;break}return e.next=67,X.a.instance.dispatch(new K.c(function(){var e=s()(a.a.mark(function e(t,n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return X.a.instance.redo(),Ht.a.initStatusByAction(),e.next=4,i.renderAll(t,n);case 4:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}()));case 67:e.next=203;break;case 69:if(!l.isCtrlOrCommandPress()||!n.e.shiftKey||"}"!==n.e.key){e.next=74;break}c=!0,X.a.instance.dispatch(new jn),e.next=203;break;case 74:if(!l.isCtrlOrCommandPress()||!n.e.shiftKey||"{"!==n.e.key){e.next=79;break}c=!0,X.a.instance.dispatch(new $n),e.next=203;break;case 79:if(!l.isCtrlOrCommandPress()||"O"!==n.character){e.next=85;break}c=!0,n.e.preventDefault(),Ye.a.openLoginPopup(Ie.a.OPEN_DESIGN_HOTKEY)||(location.href="/myspace"),e.next=203;break;case 85:if(!l.isCtrlOrCommandPress()||"S"!==n.character){e.next=95;break}if(c=!0,n.e.preventDefault(),S.a.getSaveOption().saveHotkey){e.next=90;break}return e.abrupt("return");case 90:if(Ye.a.openLoginPopup(Ie.a.SAVE_HOTKEY)){e.next=93;break}return e.next=93,C.a.save({categoryIdx:Wt.a.getSaveCategoryIdx()});case 93:e.next=203;break;case 95:if(!l.isSelectAllHotKey()){e.next=100;break}c=!0,mi(d)?1===d.length&&(d[0]instanceof q.a||d[0]instanceof Z.a)||n.e.preventDefault():fi(d)?(n.e.preventDefault(),X.a.instance.dispatch(new wn(p))):(n.e.preventDefault(),X.a.instance.dispatch(new On.r)),e.next=203;break;case 100:if(!l.isCtrlOrCommandPress()||"B"!==n.character){e.next=105;break}c=!0,p instanceof q.a&&(L=dt,_=(k=p).getSelectionRange(),!k.isEditMode||_.start.col===_.end.col&&_.start.row===_.end.row?(b=!p.props.isBold(),X.a.instance.dispatch(new Un.c(L.actionType,L.groupName,L.name,b,!0,L.timeout,!0))):(w=!p.props.isBold(_.start,_.end),X.a.instance.dispatch(new Un.c(L.actionType,L.groupName,L.name,w,!0,L.timeout,!0,_.start,_.end)))),e.next=203;break;case 105:if(!l.isCtrlOrCommandPress()||"I"!==n.character){e.next=110;break}c=!0,p instanceof q.a&&(A=ht,O=(R=p).getSelectionRange(),!R.isEditMode||O.start.col===O.end.col&&O.start.row===O.end.row?(D=!p.props.isItalic(),X.a.instance.dispatch(new Un.c(A.actionType,A.groupName,A.name,D,!0,A.timeout,!0))):(P=!p.props.isItalic(O.start,O.end),X.a.instance.dispatch(new Un.c(A.actionType,A.groupName,A.name,P,!0,A.timeout,!0,O.start,O.end)))),e.next=203;break;case 110:if(!("Enter"===n.e.key&&pi(d)&&p instanceof q.a)){e.next=114;break}p.isEditMode||(n.e.preventDefault(),X.a.instance.dispatch(new et.c(p,0,0))),e.next=203;break;case 114:if(!l.isCtrlOrCommandPress()||"X"!==n.character){e.next=119;break}c=!0,mi(d)?1===d.length&&d[0]instanceof q.a||n.e.preventDefault():(n.e.preventDefault(),X.a.instance.dispatch(new Bn(Y.a.instance.renderPageIdx))),e.next=203;break;case 119:if(!l.isCtrlOrCommandPress()||"C"!==n.character){e.next=126;break}c=!0,M=!1,p instanceof Z.a&&p.existSelectedCell()?(N=p).isTextEditMode||N.selectedCells.length===N.row*N.col&&(n.e.preventDefault(),X.a.instance.dispatch(new xn(Y.a.instance.renderPageIdx)),M=!0):d&&1===d.length&&p instanceof q.a&&p.isEditMode||(n.e.preventDefault(),X.a.instance.dispatch(new xn(Y.a.instance.renderPageIdx)),M=!0),M&&Te.a.sendEvent("단축키 vs 버튼클릭","복사하기","Ctrl + C",!0),e.next=203;break;case 126:if(!l.isCtrlOrCommandPress()||"V"!==n.character){e.next=131;break}c=!0,Te.a.sendEvent("단축키 vs 버튼클릭","붙여넣기","Ctrl + V",!0),e.next=203;break;case 131:if(!l.isCtrlOrCommandPress()||"D"!==n.character){e.next=136;break}c=!0,p instanceof Z.a&&p.existSelectedCell()||d&&1===d.length&&p instanceof q.a&&p.isEditMode||(n.e.preventDefault(),X.a.instance.dispatch(new xn(Y.a.instance.renderPageIdx)),X.a.instance.dispatch(new Vn(Y.a.instance.renderPageIdx)),Te.a.sendEvent("단축키 vs 버튼클릭","복제하기","Ctrl + D",!0)),e.next=203;break;case 136:if(!l.isGroupingHotkey()){e.next=142;break}c=!0,n.e.preventDefault(),X.a.instance.dispatch(new On.a),e.next=203;break;case 142:if(!l.isCtrlOrCommandPress()||"L"!==n.character){e.next=150;break}if(p){e.next=145;break}return e.abrupt("return");case 145:c=!0,n.e.preventDefault(),p.isLock()?X.a.instance.dispatch(new On.p(d)):X.a.instance.dispatch(new On.l(d)),e.next=203;break;case 150:if(!l.isCtrlOrCommandPress()||"Z"!==n.character){e.next=159;break}if(c=!1,n.renderAuto=!1,n.e.preventDefault(),Y.a.isCropMode()){e.next=157;break}return e.next=157,X.a.instance.dispatch(new K.c(function(){var e=s()(a.a.mark(function e(t,n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return X.a.instance.rollback(),Ht.a.initStatusByAction(),e.next=4,i.renderAll(t,n);case 4:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}()));case 157:e.next=203;break;case 159:if(!l.isCtrlOrCommandPress()||"]"!==n.e.key){e.next=164;break}c=!0,X.a.instance.dispatch(new Zn),e.next=203;break;case 164:if(!l.isCtrlOrCommandPress()||"["!==n.e.key){e.next=169;break}c=!0,X.a.instance.dispatch(new qn),e.next=203;break;case 169:if(!l.isCtrlOrCommandPress()||"Right"!==n.e.key&&"ArrowRight"!==n.e.key){e.next=185;break}if(c=!0,!mi(d)){e.next=175;break}n.e.preventDefault(),e.next=183;break;case 175:if(!(Y.a.instance.activeItems.length>0)){e.next=183;break}return x=o.itemHandleVC.getLTRB().getCenterPos(),B=(o.itemHandleVC.positionStates.rotate+1.1)*Math.PI/180,X.a.instance.dispatch(new On.i(x.x+Math.sin(B),x.y-Math.cos(B))),o.renderCanvas(t,i,Qe.b.getGroupItemsAddedArray(d)),o.renderHandler(t,i,{type:$e.a.ROTATE}),e.next=182,o.renderAuto(t,i);case 182:return e.abrupt("return");case 183:e.next=203;break;case 185:if(!l.isCtrlOrCommandPress()||"Left"!==n.e.key&&"ArrowLeft"!==n.e.key){e.next=202;break}if(c=!0,!mi(d)){e.next=191;break}n.e.preventDefault(),e.next=200;break;case 191:if(!(Y.a.instance.activeItems.length>0)){e.next=200;break}return n.e.preventDefault(),V=o.itemHandleVC.getLTRB().getCenterPos(),U=(o.itemHandleVC.positionStates.rotate-.9)*Math.PI/180,X.a.instance.dispatch(new On.i(V.x+Math.sin(U),V.y-Math.cos(U))),o.renderCanvas(t,i,Qe.b.getGroupItemsAddedArray(d)),o.renderHandler(t,i,{type:$e.a.ROTATE}),e.next=199,o.renderAuto(t,i);case 199:return e.abrupt("return");case 200:e.next=203;break;case 202:n.e.shiftKey&&9===n.keyCode?(c=!0,n.e.preventDefault(),mi(d)?1===d.length&&d[0]instanceof Z.a&&d[0].isTextEditMode&&!d[0].editTextItemVC.changed&&(oe=d[0],(se=i.pageController.getItemRenderer(oe)).toggleEditMode(-1,-1),oe.selectCells([oe.positionTool.getPrevCellPos(oe.selectedCells[0])]),se.toggleEditMode(-1,-1,!0),n.e.preventDefault()):fi(d)?(F=d[0],G=i.pageController.getItemRenderer(F),F.selectCells([F.positionTool.getPrevCellPos(F.selectedCells[0])]),G.renderViewAfter(null,h.lastRenderEditScale)):d&&d.length>0?(H=h.items,W=Qe.b.getRootGroup(d[0].groupId),z=W||d[0],j=H.indexOf(z),$=(j+H.length-1)%H.length,Kt.a.isItemSkinable(H[$],h.sheetSize)&&(H[$]===h.items[0]?$=H.length-1:$-=1),(Q=H[$])instanceof qe.d?J.a.selectItem(Q):Q instanceof Qe.a&&J.a.selectItems(Q.getAllSingleMembers())):h.items.length>0&&(te=h.items.length-1,ne=h.items[te],ie=Kt.a.isItemSkinable(ne,h.sheetSize),(ae=ie?h.items[te-1]:ne)instanceof qe.d?J.a.selectItem(ae):ae instanceof Qe.a&&J.a.selectItems(ae.getAllSingleMembers())),o.layerPanelVC&&o.layerPanelVC.onDataChanged(t)):n.e.shiftKey&&Wn.a.isRightKey(n.e.key)?(c=!0,mi(d)?1===d.length&&(d[0]instanceof q.a||d[0]instanceof Z.a)||n.e.preventDefault():(d.length>0&&n.e.preventDefault(),m=!0,X.a.instance.dispatch(new On.g(10,0,!1,!0,!0)))):n.e.shiftKey&&Wn.a.isLeftKey(n.e.key)?(c=!0,mi(d)?1===d.length&&(d[0]instanceof q.a||d[0]instanceof Z.a)||n.e.preventDefault():(d.length>0&&n.e.preventDefault(),m=!0,X.a.instance.dispatch(new On.g(-10,0,!1,!0,!0)))):!n.e.shiftKey||"Down"!==n.e.key&&"ArrowDown"!==n.e.key?!n.e.shiftKey||"Up"!==n.e.key&&"ArrowUp"!==n.e.key?!(n.e.altKey&&("Right"===n.e.key||"ArrowRight"===n.e.key)||n.e.altKey&&("Left"===n.e.key||"ArrowLeft"===n.e.key)||n.e.altKey&&("Down"===n.e.key||"ArrowDown"===n.e.key)||n.e.altKey&&("Up"===n.e.key||"ArrowUp"===n.e.key))?"Right"===n.e.key||"ArrowRight"===n.e.key?(c=!0,mi(d)?1===d.length&&(d[0]instanceof q.a||d[0]instanceof Z.a)||n.e.preventDefault():fi(d)?(re=d[0],le=i.pageController.getItemRenderer(re),re.selectCells([re.positionTool.getNextCellPos(re.selectedCells[0])]),le.renderViewAfter(null,h.lastRenderEditScale)):(d.length>0&&n.e.preventDefault(),m=!0,X.a.instance.dispatch(new On.g(1,0,!1,!0,!0)))):l.isCtrlOrCommandPress()&&n.e.altKey&&"E"===n.character?o.showTemplateProjectPanel():"Left"===n.e.key||"ArrowLeft"===n.e.key?(c=!0,mi(d)?1===d.length&&(d[0]instanceof q.a||d[0]instanceof Z.a)||n.e.preventDefault():fi(d)?(ce=d[0],ue=i.pageController.getItemRenderer(ce),ce.selectCells([ce.positionTool.getPrevCellPos(ce.selectedCells[0])]),ue.renderViewAfter(null,h.lastRenderEditScale)):(d.length>0&&n.e.preventDefault(),m=!0,X.a.instance.dispatch(new On.g(-1,0,!1,!0,!0)))):"Down"===n.e.key||"ArrowDown"===n.e.key?(c=!0,mi(d)?1===d.length&&(d[0]instanceof q.a||d[0]instanceof Z.a)||n.e.preventDefault():fi(d)?(de=d[0],he=i.pageController.getItemRenderer(de),de.selectCells([de.positionTool.getNextCellPos(de.selectedCells[0],!0)]),he.renderViewAfter(null,h.lastRenderEditScale)):(d.length>0&&n.e.preventDefault(),m=!0,X.a.instance.dispatch(new On.g(0,1,!1,!0,!0)))):"Up"===n.e.key||"ArrowUp"===n.e.key?(c=!0,mi(d)?1===d.length&&(d[0]instanceof q.a||d[0]instanceof Z.a)||n.e.preventDefault():fi(d)?(pe=d[0],me=i.pageController.getItemRenderer(pe),pe.selectCells([pe.positionTool.getPrevCellPos(pe.selectedCells[0],!0)]),me.renderViewAfter(null,h.lastRenderEditScale)):(d.length>0&&n.e.preventDefault(),m=!0,X.a.instance.dispatch(new On.g(0,-1,!1,!0,!0)))):27===n.keyCode?(c=!0,n.e.preventDefault(),X.a.instance.dispatch(new On.c)):9===n.keyCode?(c=!0,n.e.preventDefault(),mi(d)?1===d.length&&d[0]instanceof Z.a&&d[0].isTextEditMode&&!d[0].editTextItemVC.changed&&(be=d[0],(Re=i.pageController.getItemRenderer(be)).toggleEditMode(-1,-1),be.selectCells([be.positionTool.getNextCellPos(be.selectedCells[0])]),Re.toggleEditMode(-1,-1,!0),n.e.preventDefault()):fi(d)?((fe=d[0]).selectCells([fe.positionTool.getNextCellPos(fe.selectedCells[0])]),i.pageController.getItemRenderer(fe).renderViewAfter(null,h.lastRenderEditScale)):d&&d.length>0?(ve=h.items,ge=Qe.b.getRootGroup(d[d.length-1].groupId),Ee=ge||d[0],ye=ve.indexOf(Ee),Ce=(ye+1)%ve.length,ke=Kt.a.isItemSkinable(ve[Ce],h.sheetSize),(Le=ke?ve[Ce+1]:ve[Ce])instanceof qe.d?J.a.selectItem(Le):Le instanceof Qe.a&&J.a.selectItems(Le.getAllSingleMembers())):h.items.length>0&&(_e=h.items[0],we=Kt.a.isItemSkinable(_e,h.sheetSize),(Se=we?h.items[1]:_e)instanceof qe.d?J.a.selectItem(Se):Se instanceof Qe.a&&J.a.selectItems(Se.getAllSingleMembers())),o.layerPanelVC&&o.layerPanelVC.onDataChanged(t)):"T"===n.character?(c=!0,mi(d)||X.a.instance.dispatch(new at)):"R"===n.character?c=!0:"L"===n.character?c=!0:l.isCtrlOrCommandPress()&&n.e.altKey&&";"===n.e.key?Ke.a.setIsGuidelineLock(!Ke.a.getUserSetting().isGuidelineLock):l.isCtrlOrCommandPress()&&";"===n.e.key&&Ke.a.setIsGuidelineVisible(!Ke.a.getUserSetting().isGuidelineVisible):c=!0:(c=!0,mi(d)?1===d.length&&(d[0]instanceof q.a||d[0]instanceof Z.a)||n.e.preventDefault():(d.length>0&&n.e.preventDefault(),m=!0,X.a.instance.dispatch(new On.g(0,-10,!1,!0,!0)))):(c=!0,mi(d)?1===d.length&&(d[0]instanceof q.a||d[0]instanceof Z.a)||n.e.preventDefault():(d.length>0&&n.e.preventDefault(),m=!0,X.a.instance.dispatch(new On.g(0,10,!1,!0,!0))));case 203:c&&(o.renderCanvas(t,i,Qe.b.getGroupItemsAddedArray(d)),o.renderItemTools(t,i),m||o.renderHandler(t,i));case 204:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),n.rollbackAction=function(e,t){},n.recycle=function(){},n.e=e,n.renderAuto=!1,n.keyCode=e.which,n.keyboardKey=e.key,n.keyboardCode=e.code,0===e.which&&"Escape"===e.key&&"Escape"===e.code&&(n.keyCode=27),n.character=String.fromCharCode(n.keyCode),n}return z()(t,e),t}(K.b),hi=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).doSaveQueue=!1,n.actionType=K.a.CLIPBOARD_PASTE,n.changeDesign=function(){return!0},n.doItemPasteAction=!0,n.commitAction=function(e,t){if(!Y.a.isSpoidMode()){n.doItemPasteAction=!(n.e.target instanceof HTMLInputElement||n.e.target instanceof HTMLTextAreaElement||"true"===n.e.target.contentEditable);for(var i=n.items.length,a=0;a<i;a++){var o=n.items[a].getAsFile();n.canUpload(o)?(n.doItemPasteAction=!1,J.a.unselectAllItems(),ci.a.dispatchUploadUserFile(o)):n.renderAuto=!1}if(n.doItemPasteAction){var s=t.activeItems.slice(),r=s&&s.length>0?s[0]:null;r instanceof Z.a&&r.existSelectedCell()&&r.isTextEditMode||s&&1===s.length&&r instanceof q.a&&r.isEditMode||X.a.instance.dispatch(new Vn(t.renderPageIdx))}}},n.rollbackAction=function(e,t){},n.recycle=function(){},n.e=e,n.items=e.clipboardData.items,n}return z()(t,e),w()(t,[{key:"canUpload",value:function(e){if(null===e)return!1;var t=e.name.split(".").pop();return"png"===t||"jpeg"===t||"jpg"===t}}]),t}(K.b);function pi(e){return!!e&&1===e.length}function mi(e){if(!e)return!1;var t=!0,n=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value;if(s instanceof Je.d&&s.isEditMode||s instanceof q.a&&s.isEditMode||s instanceof Z.a&&s.isTextEditMode)return!0}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return!1}function fi(e){return!!e&&(e&&1===e.length&&e[0]instanceof Z.a&&!e[0].isTextEditMode&&e[0].selectedCells.length>0)}K.b;var vi=function(){function e(){L()(this,e),this.listener=[]}return w()(e,[{key:"addEventListener",value:function(e,t){this.listener.push({type:e,listener:t}),document.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.listener=this.listener.filter(function(n){return n.type!==e||n.listener!==t}),document.removeEventListener(e,t)}},{key:"removeAllEventListener",value:function(){this.listener.forEach(function(e){document.removeEventListener(e.type,e.listener)}),this.listener=[]}}]),e}();vi.instance=new vi;var gi=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).isPossibleInCropMode=!0,n.actionType=K.a.KEY_UP,n.changeDesign=function(){return!1},n.commitAction=function(e,i){n.isScreenMoveMode()&&t.disableScreenMoveMode()},n.rollbackAction=function(e,t){},n.recycle=function(){},n.renderAuto=!1,n.doSaveQueue=!1,n.keyCheck=new Wn.a(e),n}return z()(t,e),w()(t,[{key:"isScreenMoveMode",value:function(){return(!this.keyCheck.isCtrlOrCommandPress()||this.keyCheck.isSpace())&&!Y.a.instance.editorMainVC.zoomSettingVC.isScreenMoveMode&&(Y.a.instance.mouseAction.mode===Fn.a.MODE_NAVIGATION||Y.a.instance.mouseAction.mode===Fn.a.MODE_NAVIGATION_DRAG)}}],[{key:"disableScreenMoveMode",value:function(){Y.a.instance.mouseAction.mode=Fn.a.MODE_NONE,Y.a.instance.editorMainVC.canvasAreaVC.disableScrollMode()}}]),t}(K.b),Ei=n(235),yi=n(264),Ti=n(327),Ii=n(257),Ci=n(502),ki=(K.a.IMAGE_SOLID_LINE_ACTIVE,{name:"intensity",actionType:K.a.IMAGE_FILTER_INTENSITY,timeout:3e3}),Li={name:"brightness",actionType:K.a.IMAGE_FILTER_BRIGHTNESS,timeout:3e3},_i={name:"contrast",actionType:K.a.IMAGE_FILTER_CONTRAST,timeout:3e3},wi={name:"lightness",actionType:K.a.IMAGE_FILTER_LIGHTNESS,timeout:3e3},Si={name:"saturation",actionType:K.a.IMAGE_FILTER_SATURATION,timeout:3e3},bi={name:"tint",actionType:K.a.IMAGE_FILTER_TINT,timeout:3e3},Ri={name:"colorTone",actionType:K.a.IMAGE_FILTER_COLOR_TONE,timeout:3e3},Ai={name:"temperature",actionType:K.a.IMAGE_FILTER_TEMPERATURE,timeout:3e3},Oi={name:"blur",actionType:K.a.IMAGE_FILTER_BLUR,timeout:3e3},Pi={name:"vignette",actionType:K.a.IMAGE_FILTER_VIGNETTE,timeout:3e3},Di={groupName:"solidLine",name:"active",actionType:K.a.IMAGE_SOLID_LINE_ACTIVE},Mi={groupName:"solidLine",name:"color",actionType:K.a.IMAGE_SOLID_LINE_COLOR,icon:ne.ToolsIcon.FORMAT_COLOR_FILL,timeout:3e3},Ni={groupName:"solidLine",name:"alpha",actionType:K.a.IMAGE_SOLID_LINE_ALPHA},xi={groupName:"solidLine",name:"thickness",actionType:K.a.IMAGE_SOLID_LINE_THICKNESS},Bi={groupName:"bitmapMask",name:"active",actionType:K.a.IMAGE_BITMAP_MASK_ACTIVE},Vi={groupName:"bitmapMask",name:"bitmapId",actionType:K.a.IMAGE_BITMAP_MASK_ITEM},Ui={groupName:"stickerFrame",name:"active",actionType:K.a.IMAGE_STICKER_FRAME_ACTIVE},Fi={groupName:"stickerFrame",name:"stickerId",actionType:K.a.IMAGE_STICKER_FRAME_ITEM},Gi={groupName:"gradationMask",name:"active",actionType:K.a.IMAGE_GRADATION_ACTIVE},Hi={groupName:"gradationMask",name:"direction",actionType:K.a.IMAGE_GRADATION_DIRECTION},Wi={groupName:"gradationMask",name:"depth",actionType:K.a.IMAGE_GRADATION_DEPTH,timeout:3e3},zi={groupName:"shadow",name:"active",actionType:K.a.IMAGE_SHADOW_ACTIVE},Ki={groupName:"shadow",name:"color",actionType:K.a.IMAGE_SHADOW_COLOR,timeout:3e3},Yi={groupName:"shadow",name:"angle",actionType:K.a.IMAGE_SHADOW_ANGLE,timeout:3e3},Xi={groupName:"shadow",name:"alpha",actionType:K.a.IMAGE_SHADOW_ALPHA,timeout:3e3},ji={groupName:"shadow",name:"distance",actionType:K.a.IMAGE_SHADOW_DISTANCE,timeout:3e3},Zi={groupName:"shadow",name:"blur",actionType:K.a.IMAGE_SHADOW_BLUR,timeout:3e3},qi=n(379),$i=function(){function e(){L()(this,e)}return w()(e,null,[{key:"parse",value:function(e,t){var n=new Qi,i=qi.a.build((new DOMParser).parseFromString(e,"text/xml")).SHEET[this.getNodeName(t)],a=this.getPropertyMapperList(t),o=!0,s=!1,r=void 0;try{for(var l,c=a[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value,d=null!=u.groupName;d||null==i["@"+u.name]?d&&null!=i[u.groupName]&&null!=i[u.groupName]["@"+u.name]&&n.addPropValue(u,i[u.groupName]["@"+u.name]):n.addPropValue(u,i["@"+u.name])}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}return n}},{key:"getNodeName",value:function(e){switch(e){case Ei.b.PHOTO:return"PHOTO";case Ei.b.TEXT:return"TEXT"}}},{key:"getPropertyMapperList",value:function(e){switch(e){case Ei.b.PHOTO:return this.IMAGE_PROPERTY_MAPPER_LIST;case Ei.b.TEXT:return this.TEXT_PROPERTY_MAPPER_LIST}}}]),e}();$i.IMAGE_PROPERTY_MAPPER_LIST=[ki,Li,_i,wi,Si,bi,Oi,Pi,Ai,Ri,Di,Mi,xi,Ni,Bi,Vi,Ui,Fi,Gi,Hi,Wi,zi,Ki,Yi,Xi,ji,Zi],$i.TEXT_PROPERTY_MAPPER_LIST=[lt,ct,ut,rt,ot,st,Et,dt,ht,mt,pt,ft,vt,gt,yt,kt,Lt,_t,wt,bt,Rt,St,At,Pt,Ot,Dt,Mt,Nt,xt,Bt,Vt];var Qi=function(){function e(){L()(this,e),this.propValueMap=new Map}return w()(e,[{key:"addPropValue",value:function(e,t){this.propValueMap.set(e,t)}},{key:"applyProperty",value:function(e,t,n,i){var a=this;X.a.instance.groupingAction(function(){for(var o=a.propValueMap.entries(),s=o.next();!s.done;){var r=s.value[0],l=s.value[1];s=o.next(),(null==e||r===e||e.callback)&&(t&&n?X.a.instance.dispatch(new Un.c(K.a.PRESET_CODE_APPLY,r.groupName,r.name,l,!1,r.timeout,s.done,t,n)):X.a.instance.dispatch(new Un.d(K.a.PRESET_CODE_APPLY,r.groupName,r.name,l,!1,r.timeout,s.done,i)))}e&&e.callback&&e.callback()})}},{key:"getValue",value:function(e){return this.propValueMap.get(e)}}]),e}(),Ji=n(302),ea=function(){function e(){L()(this,e),this.styleList=[]}return w()(e,null,[{key:"add",value:function(t){this.remove(t.idx),e.isEffectType(t.type)||this.instance.styleList.unshift(t)}},{key:"remove",value:function(e){var t=0,n=!0,i=!1,a=void 0;try{for(var o,s=this.instance.styleList[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){if(o.value.idx===e){this.instance.styleList.splice(t,1);break}t++}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"isEffectType",value:function(e){return e===Ji.c.STYLE_TEXT_FONT_FAMILY}},{key:"getList",value:function(){return this.instance.styleList}},{key:"clear",value:function(){this.instance.styleList=[]}}]),e}();ea.instance=new ea;var ta,na=function(){function e(t,n,i,a,o,s){L()(this,e),this.doSaveQueue=!1,this.actionType=K.a.STYLE_TEMPLATE_APPLY,this.isActionGroupEquals=function(){return!1},this.concat=function(e){return!1},this.changeDesign=function(){return!0},this.isLastSavedAction=!1,this.templateStyleIdx=t,this.itemType=n,this.mapper=i,this.param1=a,this.param2=o,this.items=s}return w()(e,[{key:"commit",value:function(e,t){var n=this;t.activeItems.length<1||(!this.items&&t.activeItems[0]instanceof ee.b&&(this.items=[t.activeItems[0].innerPhotoItem]),D.a.fetchResourceStyle(this.templateStyleIdx).then(function(e){$i.parse(e.xml,n.itemType).applyProperty(n.mapper,n.param1,n.param2,n.items),ea.add(e)}).catch(function(e){alert("아이템 효과를 불러오는 중에 오류가 발생하였습니다."),console.error(e)}))}},{key:"rollback",value:function(e,t){}},{key:"recycle",value:function(){}}]),e}(),ia=n(242),aa=n(251),oa=n(405),sa=n(5),ra=n.n(sa),la=n(82),ca=function e(){L()(this,e),this.categoryList=[],this.btnPrevVisibility=!1,this.btnNextVisibility=!0},ua=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).state=new ca,n.scrollElementRef=ra.a.createRef(),n.btnPrev=ra.a.createRef(),n.btnNext=ra.a.createRef(),n}return z()(t,e),w()(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.categoryList,i=t.btnPrevVisibility,a=t.btnNextVisibility,o=this.props,s=o.selectedCategory,l=o.onChangeCategory;return ra.a.createElement("div",{className:"".concat(r.a.FONT_FAMILY_CATEGORY_SELECT," ").concat(r.a.SLIDE_VIEW),onMouseEnter:this.updateBtnVisibility.bind(this)},ra.a.createElement("div",{className:r.a.SCROLL_ELEMENT},ra.a.createElement("div",{ref:this.scrollElementRef,onScroll:this.updateBtnVisibility.bind(this)},n.map(function(e){return ra.a.createElement("div",{key:e,onClick:function(){return l(e)},className:e===s?r.a.SELECTED:""},e)}))),ra.a.createElement("button",{ref:this.btnPrev,onClick:function(){return e.moveScroll(!1)},className:"".concat(i?"":r.a.HIDDEN," ").concat(r.a.PREV)},ra.a.createElement(la.a,{icon:ne.ToolsIcon.GREATER_THAN})),ra.a.createElement("button",{ref:this.btnNext,onClick:function(){return e.moveScroll(!0)},className:"".concat(a?"":r.a.HIDDEN," ").concat(r.a.NEXT)},ra.a.createElement(la.a,{icon:ne.ToolsIcon.GREATER_THAN})))}},{key:"componentDidMount",value:function(){this.setState({categoryList:oa.a.getCategoryList()}),this.updateBtnVisibility()}},{key:"updateBtnVisibility",value:function(){var e=this;setTimeout(function(){var t=e.scrollElementRef.current;e.setState({btnPrevVisibility:t.scrollLeft>0,btnNextVisibility:t.scrollLeft+t.clientWidth+1<t.scrollWidth})})}},{key:"moveScroll",value:function(e){var t=this.scrollElementRef.current,n=t.scrollLeft+(e?1:-1)*t.clientWidth;$(t).stop().animate({scrollLeft:n},{duration:200})}}]),t}(sa.Component),da=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"render",value:function(){var e=this.props,t=e.fontFamily,n=t.name,i=t.backgroundPositionY,a=e.selected,o=e.focusing,s=e.onSelectFont;return ra.a.createElement("div",{onClick:function(){return s(n)},className:"".concat(r.a.FONT_FAMILY_LIST_ITEM," ").concat(a?r.a.SELECTED:""," ").concat(o?r.a.FOCUSING:"")},ra.a.createElement("div",{className:r.a.THUMBNAIL,style:{backgroundPositionY:i}}),a&&ra.a.createElement(la.a,{icon:ne.ToolsIcon.CHECK}))}}]),t}(sa.Component),ha=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.list,i=e.selectedFont,a=e.focusingFont,o=e.onSelectFont,s=e.maxRowCount,l=e.hasEmptyMsg,c=!it.a.isEmpty(n);return ra.a.createElement("div",{className:r.a.FONT_FAMILY_LIST},t&&c&&ra.a.createElement("div",{className:r.a.TITLE},t),c?ra.a.createElement("div",{className:r.a.LIST_CONTAINER},(s>0?n.slice(0,s):n).map(function(e){return ra.a.createElement(da,{key:e.name,fontFamily:e,onSelectFont:o,selected:e.name===i,focusing:e.name===a})})):l&&ra.a.createElement("div",{className:r.a.EMPTY_MESSAGE},"검색 결과가 없어요."))}}]),t}(sa.Component),pa=n(93),ma=n(137),fa=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"moveScrollToSelectedFont",value:function(){var e=this.getItemElement(r.a.SELECTED);e&&this.setScrollY($(e).position().top)}},{key:"moveScrollToFocusingFont",value:function(e){var t=this.getItemElement(r.a.FOCUSING);if(t){var n=this.scrollContentRef.current.clientHeight,i=this.getScrollY(),a=t.clientHeight,o=$(t).position().top;(i>o||i+n<o+a)&&this.setScrollY(e===ma.a.UP?o:o-n+a)}}},{key:"getItemElement",value:function(e){var t=this.scrollContentRef.current.querySelectorAll(".".concat(r.a.FONT_FAMILY_LIST_ITEM,".").concat(e));return t.length>0?t[t.length-1]:null}}]),t}(pa.a),va=function(e){function t(e){return L()(this,t),V()(this,F()(t).call(this,e))}return z()(t,e),w()(t,[{key:"onChange",value:function(e){e.stopPropagation();var t=!this.props.isChecked;this.props.onChange(this.props.name,t)}},{key:"render",value:function(){return ra.a.createElement("div",{className:"checkbox_wrapper",onClick:this.onChange.bind(this)},ra.a.createElement("input",{type:"checkbox",checked:this.props.isChecked,name:this.props.name,readOnly:!0}),ra.a.createElement("i",{className:"tools_icon icon_check"}),ra.a.createElement("p",null,this.props.text))}}]),t}(ra.a.Component);!function(e){e[e.CURRENT_USING=0]="CURRENT_USING",e[e.RECENTLY_USED=1]="RECENTLY_USED",e[e.SEARCH=2]="SEARCH"}(ta||(ta={}));var ga,Ea=[ta.CURRENT_USING,ta.RECENTLY_USED,ta.SEARCH];(ga=ta||(ta={})).getNextListType=function(e){return Ea[Ea.indexOf(e)+1]},ga.getPrevListType=function(e){return Ea[Ea.indexOf(e)-1]};var ya,Ta=function e(){L()(this,e),this.category=oa.a.defaultCategory,this.currentUsingList=[],this.recentlyUsedList=[],this.searchList=[],this.searchStart=!1,this.isAllSameFontChangeChecked=!1,this.isShowFooter=!1},Ia=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).state=new Ta,n.scrollViewRef=Object(sa.createRef)(),n}return z()(t,e),w()(t,[{key:"onChangeAllSameFont",value:function(e,t){this.props.onChangeAllSameFont(this.state.selectedFont,t),this.setState({isAllSameFontChangeChecked:t})}},{key:"renderList",value:function(){return this.isSearchMode()?this.renderSearchList():this.renderPresetList()}},{key:"isSearchMode",value:function(){var e=this.state,t=e.keyword,n=e.category;return e.searchStart&&Boolean(t)||n!==oa.a.defaultCategory}},{key:"renderSearchList",value:function(){var e=this.state,t=e.searchList,n=e.selectedFont;return this.renderListView(void 0,t,n,ta.SEARCH,void 0,!0)}},{key:"renderPresetList",value:function(){var e=this.state,t=e.currentUsingList,n=e.recentlyUsedList,i=e.searchList,a=e.selectedFont;return ra.a.createElement(ra.a.Fragment,null,this.renderListView(ya.CURRENT_USING_FONT,t,a,ta.CURRENT_USING),this.renderListView(ya.RECENTLY_USED_FONT,n,void 0,ta.RECENTLY_USED),this.renderListView(ya.ALL_FONT,i,a,ta.SEARCH,void 0,!0))}},{key:"setSelectedFont",value:function(e){var n=oa.a.getCurrentUsingList(),i=oa.a.getRecentlyUsedList(t.MAX_COUNT_RECENTLY_USED_LIST),a=oa.a.getListAll();this.originFontWhenOpen=e,this.setState({keyword:e,category:oa.a.defaultCategory,selectedFont:e,focusingListType:ta.SEARCH,focusingIdx:a.findIndex(function(t){return t.name===e}),searchStart:!1,currentUsingList:n,recentlyUsedList:i,searchList:a,isShowFooter:!1,isAllSameFontChangeChecked:!1}),this.scrollViewRef.current.moveScrollToSelectedFont()}},{key:"setKeyword",value:function(e){this.state.keyword!==e&&(this.setState({keyword:e,searchStart:!0,focusingListType:null,focusingIdx:-1,searchList:oa.a.search(e,this.state.category)}),this.scrollViewRef.current.setScrollY(0))}},{key:"renderListView",value:function(e,t,n,i){var a=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=this.state,l=r.focusingListType,c=r.focusingIdx,u=this.getFocusingFontList(l)[c];return ra.a.createElement(ha,{selectedFont:n,focusingFont:i===l&&u?u.name:null,list:t,title:e,onSelectFont:function(e){return a.onSelectFont(e,i)},maxRowCount:o,hasEmptyMsg:s})}},{key:"onSelectFont",value:function(e,n){var i=this,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.props.onSelectFont(e,a,this.state.isAllSameFontChangeChecked),Y.a.instance.editorMainVC.canvasAreaVC.getAllEditTextVCByFont(oa.a.getOriginFont()).then(function(o){var s=!!o.length;a&&i.setState({selectedFont:e,searchStart:!1,focusingListType:n,focusingIdx:i.getFocusingFontList(n).findIndex(function(t){return t.name===e}),currentUsingList:oa.a.getCurrentUsingList(),recentlyUsedList:oa.a.getRecentlyUsedList(t.MAX_COUNT_RECENTLY_USED_LIST),isShowFooter:s})})}},{key:"onChangeCategory",value:function(e){this.setState({category:e,focusingListType:null,focusingIdx:-1,searchList:oa.a.search(this.state.searchStart?this.state.keyword:"",e)}),this.scrollViewRef.current.setScrollY(0),this.props.onChangeCategory()}},{key:"executeKeyDownAction",value:function(e){switch(e){case ma.a.ENTER:return this.onSelectFocusingFont(!0);case ma.a.UP:case ma.a.DOWN:return this.onChangeFocusing(e)}}},{key:"executeKeyUpAction",value:function(e){switch(e){case ma.a.UP:case ma.a.DOWN:this.onSelectFocusingFont(!1)}}},{key:"onChangeFocusing",value:function(e){var t=this.state,n=t.focusingIdx,i=t.focusingListType;switch(e){case ma.a.UP:if(!i||n<0)break;if(n>0)this.setState({focusingIdx:n-1});else{var a=this.isSearchMode()?null:ta.getPrevListType(i);this.setState({focusingListType:a,focusingIdx:this.getFocusingFontList(a).length-1})}break;case ma.a.DOWN:if(!i||n<0){this.setState({focusingListType:this.isSearchMode()?ta.SEARCH:ta.CURRENT_USING,focusingIdx:0});break}if(this.getFocusingFontList(i).length-1>n)this.setState({focusingIdx:n+1});else{var o=ta.getNextListType(i);o&&this.setState({focusingListType:o,focusingIdx:0})}}this.scrollViewRef.current.moveScrollToFocusingFont(e)}},{key:"onSelectFocusingFont",value:function(e){var t=this.state,n=t.focusingListType,i=t.focusingIdx;n&&i>=0&&this.onSelectFont(this.getFocusingFont(n,i).name,n,e)}},{key:"getFocusingFont",value:function(e,t){return!e||t<0?null:this.getFocusingFontList(e)[t]}},{key:"getFocusingFontList",value:function(e){switch(e){case ta.CURRENT_USING:return this.state.currentUsingList;case ta.RECENTLY_USED:return this.state.recentlyUsedList;case ta.SEARCH:return this.state.searchList;default:return[]}}},{key:"render",value:function(){return ra.a.createElement("div",{className:r.a.FONT_FAMILY_SEARCH_VIEW},ra.a.createElement("div",{className:r.a.SEARCH_FORM_SECTION},ra.a.createElement(ua,{selectedCategory:this.state.category,onChangeCategory:this.onChangeCategory.bind(this)})),ra.a.createElement(fa,{ref:this.scrollViewRef},ra.a.createElement("div",{className:"".concat(r.a.LIST_SECTION)},this.renderList())),this.state.isShowFooter&&Ke.a.getUserSetting().devMode&&ra.a.createElement("div",{className:r.a.FONT_FAMILY_FOOTER},ra.a.createElement(va,{text:"같은 폰트 모두 변경",name:"changeAllType",isChecked:this.state.isAllSameFontChangeChecked,onChange:this.onChangeAllSameFont.bind(this)}),ra.a.createElement("div",{className:r.a.FONT_FAMILY_FOOTER_INFO_TEXT},ra.a.createElement("span",null,this.originFontWhenOpen),ra.a.createElement("span",null," > "),ra.a.createElement("span",null,this.state.selectedFont))))}}]),t}(sa.Component);Ia.MAX_COUNT_RECENTLY_USED_LIST=5,function(e){e.CURRENT_USING_FONT="사용중인 폰트",e.RECENTLY_USED_FONT="최근 사용 폰트",e.ALL_FONT="모든 폰트",e.SEARCH_RESULT="검색 결과"}(ya||(ya={}));var Ca,ka=Ia,La=n(75),_a=n.n(La),wa=n(350),Sa=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0))).listener=e,n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add(r.a.FONT_FAMILY_SELECT),this.makeBackground(),this.makeInput(),this.makeSearchViewContainer()}},{key:"makeSearchViewContainer",value:function(){this.searchViewContainer=document.createElement("div"),this.searchViewContainer.className=r.a.FONT_FAMILY_SEARCH_VIEW_CONTAINER,this.container.appendChild(this.searchViewContainer)}},{key:"setActive",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return he()(F()(t.prototype),"setActive",this).call(this,e),e?(n||this.listener.onActiveFontSelectView(),setTimeout(this.renderFontSearchView.bind(this),0),this.setBtnClearVisibility()):(this.searchViewContainer.removeAttribute("style"),this.input.blur(),this.setInputValue(this.currentFontFamily),this.requireRollback&&this.listener.onSelectFont(this.selectedFont,!1),this.requireRollback=!1,this.selectedFont=""),this}},{key:"makeBackground",value:function(){var e=this,t=document.createElement("div");t.className=r.a.BACKGROUND,this.container.appendChild(t),t.addEventListener("click",function(){return e.setActive(!1)})}},{key:"makeInput",value:function(){var e=this,t=document.createElement("div");t.className=r.a.INPUT_CONTAINER,this.input=document.createElement("input"),t.appendChild(this.input),this.btnToggle=Object(ne.setToolsIcon)(t,ne.ToolsIcon.GREATER_THAN,!0,void 0,90),this.btnToggle.addEventListener("click",function(t){t.stopPropagation(),e.toggleActive(),e.isActive()&&e.selectInput()}),this.btnClear=Object(ne.setToolsIcon)(t,ne.ToolsIcon.CLOSE,!0),this.btnClear.addEventListener("click",function(t){t.stopPropagation(),e.onClear()}),this.container.appendChild(t),t.addEventListener("click",function(){return!e.isActive()&&e.setActive(!0)}),$(this.input).on("focus",function(){return e.selectInput(!0)}).on("focusout",function(){return e.input.blur()}).on("keyup",this.onKeyUpInput.bind(this)).on("keydown",this.onKeyDownInput.bind(this))}},{key:"onClear",value:function(){this.search(""),this.input.focus()}},{key:"search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.input.value;this.currentKeyword!==e&&this.searchView.setKeyword(e),this.setInputValue(e)}},{key:"onKeyDownInput",value:function(e){var t=this.isKeyDownAction(e.keyCode);return t&&this.searchView.executeKeyDownAction(e.keyCode),!t}},{key:"onKeyUpInput",value:function(e){this.isKeyDownAction(e.keyCode)?this.searchView.executeKeyUpAction(e.keyCode):this.search()}},{key:"isKeyDownAction",value:function(e){switch(e){case ma.a.UP:case ma.a.DOWN:case ma.a.ENTER:return!0;default:return!1}}},{key:"renderView",value:function(e){he()(F()(t.prototype),"renderView",this).call(this),this.currentFontFamily=e,this.selectedFont||(this.selectedFont=e,this.requireRollback=!1),this.setInputValue(e)}},{key:"setSearchViewHeight",value:function(e){this.searchViewContainer.style.height="".concat(e,"px")}},{key:"setBtnClearVisibility",value:function(){this.enableStyle(Boolean(this.input.value),this.btnClear,r.a.ACTIVE)}},{key:"renderFontSearchView",value:function(){this.searchView||(this.searchView=_a.a.render(ra.a.createElement(ka,{onSelectFont:this.onSelectFont.bind(this),onChangeCategory:this.selectInput.bind(this),onChangeAllSameFont:this.onChangeAllSameFont.bind(this)}),this.searchViewContainer)),this.searchView.setSelectedFont(this.currentFontFamily)}},{key:"getCurrentFont",value:function(){return this.currentFontFamily}},{key:"onChangeAllSameFont",value:function(e,t){this.listener.onChangeAllSameFont(e,t)}},{key:"onSelectFont",value:function(e,t,n){this.setInputValue(e),this.selectInput(),this.listener.onSelectFont(e,n),this.requireRollback=!t,t&&(this.selectedFont=e)}},{key:"selectInput",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];je.a.isMobileDevice()&&!t||setTimeout(function(){return wa.a.selectAll(e.input)},0)}},{key:"setInputValue",value:function(e){this.input.value=e,this.currentKeyword=e,this.setBtnClearVisibility()}}]),t}(He.a),ba=n(445),Ra=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,!0))).gradation=e,i.onClickGradationPreset=n,i}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.COLOR_CHIP,this.container.style.background="linear-gradient(".concat(90-this.gradation.angle,"deg,").concat(this.gradation.startColor,",").concat(this.gradation.endColor,")"),this.container.addEventListener("click",function(t){e.onClickGradationPreset(e.gradation.idx)})}}]),t}(He.a),Aa=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).elementId="GradationPresetPopup",n.tooltipElems=[],n.onClickGradationPreset=e,n.isAutoDirection=!0,n.makeElement(x.a.getTextGradationPresets()),n.makeBtnClose=!1,n}return z()(t,e),w()(t,[{key:"makeElement",value:function(e){var t=this;this.contents=document.createElement("div"),this.contents.className=r.a.CONTENTS,e.reverse(),e.forEach(function(e){var n=new Ra(e,t.onClickColorChip.bind(t)).getContainer();t.contents.appendChild(n);var i=new Le.a(n,Ge.a.T,{description:e.title});t.tooltipElems.push(i)})}},{key:"onClickColorChip",value:function(e){this.onClickGradationPreset(e),this.tooltipElems.forEach(function(e){e.hide()})}},{key:"getContents",value:function(){return this.contents}},{key:"getId",value:function(){return this.elementId}},{key:"updateUI",value:function(){}}]),t}(u.a),Oa=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;L()(this,t),(n=V()(this,F()(t).call(this,!0))).active=!0,n.title=e,n.useChangeSameColors=i,n.onClickGradationPreset=a,n.container.className="".concat(r.a.TOOLS_ITEM," ").concat(r.a.GRADATION_COLOR_PICKER_ITEM);for(var o=arguments.length,s=new Array(o>3?o-3:0),l=3;l<o;l++)s[l-3]=arguments[l];return n.listenerList=s,n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.gradationPresetPopup=new Aa(this.onClickGradationPreset);var e=document.createElement("label");e.innerText=this.title,this.container.appendChild(e);var n=document.createElement("div");n.className=r.a.GRADATION_VALUE_LINE,this.container.appendChild(n),this.colorLine=document.createElement("div"),this.colorLine.className=r.a.GRADATION_COLOR_LINE,this.container.appendChild(this.colorLine),this.gradationItemList=this.listenerList.map(function(e){var t=document.createElement("div");t.classList.add(r.a.GRADATION_COLOR_VALUE),t.classList.add(r.a.VALUE_ELEMENT),n.appendChild(t);var i=document.createElement("span");return i.className=r.a.COLOR_ELEMENT,t.appendChild(i),{listener:e,element:t}});var i=document.createElement("div");i.classList.add(r.a.GRADATION_COLOR_VIEW_BOX),i.classList.add(r.a.VALUE_ELEMENT),this.colorViewBoxOuter=i,this.colorViewBox=document.createElement("div"),this.colorViewBox.className=r.a.COLOR_ELEMENT,i.appendChild(this.colorViewBox),this.colorControl=new ba.a(null,!1,this.useChangeSameColors),this.gradationItemList.forEach(function(e){e.element.addEventListener("dblclick",function(t){if(t.shiftKey){var n=prompt("format : #rgb, rgb... ex)#ff7362, 4285f4");if(n){var i=6===n.length?"#"+n:n;e.listener(i.toUpperCase())}}})}),this.addEventListener()}},{key:"updateUI",value:function(e){var t=this;null!=e.active&&(this.active=!0===e.active);var n=["".concat(90-e.rotate,"deg")];e.valueList.forEach(function(e,i){var a=t.gradationItemList[i].element.children[0];n.push(e.rgb),a.style.backgroundColor=e.rgb,t.colorControl.updateUI({value:a.style.backgroundColor})}),this.enableStyle(!this.active,this.container,r.a.DISABLE);var i="",a="";switch(n.length){case 0:case 1:i="transparent";break;case 2:n.push(n[1]);default:e.isNewFormat&&5===n.length&&n[1]===n[2]&&n[4]===n[3]&&n.splice(2,2),i="linear-gradient(".concat(n.join(","),")"),n[0]="90deg",a="linear-gradient(".concat(n.join(","),")")}this.colorLine.style.background=a,this.colorViewBox.style.background=i,this.colorViewBox.style.backgroundOrigin="border-box",e.isNewFormat?(this.gradationItemList[1].element.style.display="none",this.gradationItemList[3].element.style.display="none"):(this.gradationItemList[1].element.style.display="",this.gradationItemList[3].element.style.display="")}},{key:"addEventListener",value:function(){var e=this;this.gradationItemList.forEach(function(t){t.element.addEventListener("mouseup",function(n){if(2!==n.button&&e.active){e.colorControl.listener=t.listener;var i=t.element.getElementsByTagName("span")[0].style.backgroundColor,a=$(t.element).offset().left+t.element.offsetWidth/2,o=$(t.element).offset().top+t.element.offsetHeight/2;return e.colorControl.openColorControl({value:i},a,o),n.preventDefault(),n.stopPropagation(),!1}})}),this.colorViewBoxOuter.addEventListener("click",function(t){e.gradationPresetPopup.open({left:t.pageX,top:t.pageY})})}},{key:"getColorViewBoxOuter",value:function(){return this.onCreateViewIfNotCreated(),this.colorViewBoxOuter}}]),t}(He.a),Pa=n(278),Da=n(248),Ma=function(e){function t(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(L()(this,t),(i=V()(this,F()(t).call(this,"div",[r.a.RADIO_ITEM]))).listener=e,i.itemList=n,i.selectedIdx=a,i.title=o,null!=i.title){var s=document.createElement("label");s.innerText=i.title||"",i.container.appendChild(s)}var l="radio"+d.b.random(20);return i.itemList.forEach(function(e,t){var n=document.createElement("label");n.setAttribute("data-key",e.value);var a=document.createElement("input");a.name=l,a.type="radio",a.value=e.value,t===i.selectedIdx&&(a.checked=!0),Object(ne.setToolsIcon)(n,e.icon),n.insertBefore(a,n.childNodes.item(0)),i.container.appendChild(n),e.element=a}),i.addEventListener(),i}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this)}},{key:"updateUI",value:function(e){this.selectedItem=e.value;var t=this.itemList.find(function(t){return t.value===e.value});if(t?t.element.checked=!0:this.itemList.forEach(function(e){return e.element.checked=!1}),!0===e.active||void 0===e.active){this.container.classList.remove(r.a.DISABLE);var n=!0,i=!1,a=void 0;try{for(var o,s=this.container.children[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){o.value.classList.remove(r.a.DISABLE)}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}this.itemList.forEach(function(e){e.element.disabled=!1,e.element.classList.remove(r.a.DISABLE),e.element.classList.add(r.a.ENABLE)})}else{this.container.classList.add(r.a.DISABLE);var l=!0,c=!1,u=void 0;try{for(var d,h=this.container.children[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){d.value.classList.add(r.a.DISABLE)}}catch(e){c=!0,u=e}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}this.itemList.forEach(function(e){e.element.disabled=!0,e.element.checked=!1,e.element.classList.add(r.a.DISABLE),e.element.classList.remove(r.a.ENABLE)})}}},{key:"addEventListener",value:function(){var e=this,t=function(t){e.listener(t.target.value),t.stopPropagation()};this.itemList.forEach(function(e){e.element.addEventListener("change",t)})}}]),t}(Da.a),Na=n(273),xa=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this,"div",[r.a.TOGGLE_ITEM]))).preventDefault=!1,o.listener=e,o.trueDataSet=n,o.falseDataSet=i,o.titleLabel=a,o}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){if(he()(F()(t.prototype),"onCreateView",this).call(this),this.element=document.createElement("label"),this.inputElement=document.createElement("input"),this.inputElement.type="checkbox",this.element.appendChild(this.inputElement),this.trueDataSet.element=Object(ne.setToolsIcon)(this.element,this.trueDataSet.icon),this.falseDataSet&&(this.falseDataSet.element=Object(ne.setToolsIcon)(this.element,this.falseDataSet.icon)),this.trueDataSet.titleKey&&(this.trueDataSet.titleString=this.trueDataSet.titleKey||""),this.trueDataSet.titleString){var e=document.createElement("h6");e.className=r.a.TOOLS_ITEM_TITLE,e.innerText=this.trueDataSet.titleString,this.element.appendChild(e),this.titleElement=e,this.falseDataSet&&(this.falseDataSet.titleKey?this.falseDataSet.titleString=this.falseDataSet.titleKey||"":this.falseDataSet.titleString=this.trueDataSet.titleString)}if(this.container.appendChild(this.element),this.titleLabel&&!d.b.isEmpty(this.titleLabel)){var n=document.createElement("div");n.className="title_label",n.innerText=this.titleLabel,this.container.appendChild(n),this.addClickEventListener()}else this.addChangeEventListener()}},{key:"updateUI",value:function(e){if(this.onCreateViewIfNotCreated(),e&&(this.inputElement.checked=e.isSelected,e.isSelected?this.element.classList.add(r.a.ACTIVE):this.element.classList.remove(r.a.ACTIVE)),null!=e.active&&(this.active=!0===e.active),this.preventDefault&&(this.inputElement.checked=!1),null!=this.falseDataSet){var t=this.inputElement.checked?this.trueDataSet:this.falseDataSet;this.inputElement.checked?(this.trueDataSet.element.style.display="",this.falseDataSet.element.style.display="none"):(this.trueDataSet.element.style.display="none",this.falseDataSet.element.style.display=""),this.titleElement&&(this.titleElement.innerText=t.titleString)}this.inputElement.checked?this.container.classList.add(r.a.ACTIVE):this.container.classList.remove(r.a.ACTIVE),this.active?this.container.classList.remove(r.a.DISABLE):this.container.classList.add(r.a.DISABLE)}},{key:"addClickEventListener",value:function(){var e=this;this.container.addEventListener("click",function(t){t.stopPropagation(),e.active&&(e.listener(e.inputElement.checked),e.preventDefault&&(e.inputElement.checked=!1))}),this.inputElement.addEventListener("click",function(e){e.stopPropagation()})}},{key:"addChangeEventListener",value:function(){var e=this;this.inputElement.addEventListener("change",function(t){t.stopPropagation(),e.active&&(e.listener(e.inputElement.checked),e.preventDefault&&(e.inputElement.checked=!1))})}},{key:"setPreventDefault",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.preventDefault=!0===e,this}},{key:"enabled",get:function(){return!this.inputElement.disabled},set:function(e){e?this.element.classList.remove(r.a.DISABLE):this.element.classList.add(r.a.DISABLE),this.inputElement.disabled=!e}}]),t}(Da.a),Ba=n(315),Va=n(345),Ua=function(){function e(){L()(this,e)}return w()(e,null,[{key:"isInvalidNumberSymbolKeyDown",value:function(e,t){var n="e"===e.toLowerCase()||"-"===e||"+"===e,i="."===e&&t.includes(".");return n||i}},{key:"isInvalidNumberEnter",value:function(e){return Number.isNaN(Number(e))||!e.toString().trim()}}]),e}(),Fa=function(e){function t(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],d=arguments.length>8?arguments[8]:void 0,h=arguments.length>9?arguments[9]:void 0;return L()(this,t),(i=V()(this,F()(t).call(this,!0))).isStyleTemplateProp=!1,i.selecting=-1,i.comparator=null,i.searchMode=!1,i.isChangedFontListOrder=!1,i.listener=e,i.type=n,i.menuList=a,i.isNumberInput=o,i.selectedValue=s,i.option=c,i.filtered=u,i.recommendListTitle=d,i.addNewValueWhenUpdateUI=h,i.container.className="".concat(r.a.TOOLS_ITEM," ").concat(r.a.SELECT_ITEM),l&&(i.container.style.width=l),i}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.makeMenuLayer(),this.input=document.createElement("input"),this.input.type=this.isNumberInput?"number":"text",this.input.readOnly=!0,this.setMenuList(this.menuList),this.isNumberInput||(this.input.placeholder="폰트 검색",Object(ne.setToolsIcon)(this.container,ne.ToolsIcon.ZOOM,!0)),this.container.appendChild(this.input),this.inputCaret=Object(ne.setToolsIcon)(this.container,ne.ToolsIcon.GREATER_THAN,!0,void 0,90),this.option&&(this.itemx=this.option.x||0,this.customCss=this.option.class,this.itemHeight=this.option.height),this.addEventListener();var n=document.createElement("input");n.type="checkbox",n.className=r.a.STYLE_TEMPLATE_SELECTOR,n.checked=this.isStyleTemplateProp,n.addEventListener("change",function(){return e.isStyleTemplateProp=n.checked}),this.container.appendChild(n)}},{key:"makeMenuLayer",value:function(){var e=this.menuLayer=document.createElement("div");e.className=r.a.MENU_LAYER,this.menuListScrollElem=new Ce.a(!1,!0,"100%");var t=this.menuListWrap=document.createElement("div");t.className=r.a.LIST_WRAP;var n=document.createElement("div");if(n.className=r.a.RECOMMEND_LIST,this.recommendListTitle){var i=document.createElement("p");i.innerText=this.recommendListTitle,n.appendChild(i)}this.recommendUl=document.createElement("ul"),n.appendChild(this.recommendUl),t.appendChild(n),this.ul=document.createElement("ul"),t.appendChild(this.ul),e.appendChild(this.menuListScrollElem.render(t)),this.container.appendChild(e)}},{key:"updateUI",value:function(e){var t=this.selectedValue,n=e.value.toString().trim(),i="undefined"!==n&&null!=n;this.selectedValue=i?e.value.toString():this.selectedValue,e.itemX&&(this.itemx=e.itemX);var a=$(this.ul).children(":visible").eq(this.selecting)[0];if(je.a.isMobilePortraitSize()?this.container.parentElement&&this.container.parentElement.parentElement&&!this.container.parentElement.parentElement.classList.contains("mobile_active")&&(this.input.value=""):t===this.selectedValue&&this.isMenuLayerOpened()&&a?(this.selectedLi=a,this.selectedLi.classList.add(r.a.SELECTED_VALUE)):(this.selecting=this.getSelectedLiIdx(),this.setMenuLayer(!1)),this.setMenuList(e.itemList?e.itemList:this.menuList),this.setRecommendList(e.recommendItemList),this.lastFontRecommendList=e.recommendItemList,this.setScrollRel(),i){var o=e.value.toString();this.lastInput=o,je.a.isMobilePortraitSize()||(this.input.value=o)}}},{key:"addEventListener",value:function(){var e=this,n="click.".concat(d.b.random());$(this.container).on("click",function(t){if(t.stopPropagation(),$(document.body).off(n).trigger("click"),je.a.isMobileDevice()){var i=Y.a.instance.editorMainVC.canvasAreaVC.mouseDblClickManager;i.downMouse(t.clientX,t.clientY,!0),i.isDoubleClick()?(e.input.readOnly=!1,e.input.select(),e.input.focus(),e.isMenuLayerOpened()||e.toggleMenuLayer()):e.toggleMenuLayer()}else e.toggleMenuLayer();e.isMenuLayerOpened()&&$(document.body).on(n,function(){return e.setMenuLayer(!1)})}),$(this.menuListWrap).on("click","li",function(n){var i=n.currentTarget;e.select(i.getAttribute(t.LI_TAG_VALUE_ATTR_NAME))}),this.filtered&&$(this.input).on("keyup",function(){var t=e.input.value;e.lastInput!==t&&(e.lastInput=t,t?e.sortFontListByKeyword():e.resetFontList(),e.setMenuLayerHeightAuto(),e.input.focus(),e.selecting=-1)}),this.menuLayer.addEventListener("click",function(e){return e.stopPropagation()})}},{key:"resetFontList",value:function(){this.searchMode=!1,this.setMenuList(this.menuList),this.setRecommendList(this.lastFontRecommendList),this.selecting=this.getSelectedLiIdx()}},{key:"sortFontListByKeyword",value:function(){var e=this,n=[],i=[],a=this.input.value.toLowerCase(),o=!0,s=!1,l=void 0;try{for(var c,u=this.ul.children[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var d=c.value,h=d.getAttribute(t.LI_TAG_VALUE_ATTR_NAME).toLowerCase();if(h.includes(a)){var p=d;p.classList.remove(r.a.HIDE),0===h.indexOf(a)?n.push(p):i.push(p)}else d.classList.add(r.a.HIDE);d.classList.remove(r.a.SELECTED_VALUE)}}catch(e){s=!0,l=e}finally{try{o||null==u.return||u.return()}finally{if(s)throw l}}i.reverse(),i.forEach(function(t){return e.ul.insertBefore(t,e.ul.children.item(0))}),n.reverse(),n.forEach(function(t){return e.ul.insertBefore(t,e.ul.children.item(0))}),this.searchMode=this.lastInput.length>0,this.selecting=-1,this.setRecommendListVisible(!this.searchMode),this.setMenuLayer(!0),this.isChangedFontListOrder=!0}},{key:"setMenuLayerHeightAuto",value:function(){this.menuLayer.style.height="".concat(this.menuListWrap.scrollHeight,"px"),this.menuListScrollElem.updateScrollbar()}},{key:"toggleMenuLayer",value:function(){this.setMenuLayer(!this.isMenuLayerOpened())}},{key:"setMenuLayer",value:function(e){e||je.a.isMobilePortraitSize()?(this.menuLayer.classList.add(r.a.ACTIVE),this.setMenuLayerHeightAuto()):(this.menuLayer.classList.remove(r.a.ACTIVE),je.a.isMobileDevice()&&(this.input.readOnly=!0))}},{key:"isMenuLayerOpened",value:function(){return this.menuLayer.classList.contains(r.a.ACTIVE)}},{key:"getSelectedLiIdx",value:function(){for(var e=this.searchMode?$(this.ul).children(":visible"):this.ul.children,n=0;n<e.length;n++){if(e[n].getAttribute(t.LI_TAG_VALUE_ATTR_NAME)===this.selectedValue)return n}return-1}},{key:"setEditable",value:function(e,n,i){var o=this;return this.onCreateViewIfNotCreated(),this.input.readOnly=je.a.isMobileDevice(),$(this.input).on("focus",function(){je.a.isMobileDevice()||(o.isMenuLayerOpened()||(o.selectedValueBeforeOpenMenuLayer=o.selectedValue),o.input.select())}).on("keydown",function(a){if(a.stopPropagation(),i&&Ua.isInvalidNumberSymbolKeyDown(a.key,o.input.value))return!1;switch(a.key.toUpperCase()){case"ESCAPE":if(a.stopPropagation(),a.preventDefault(),!o.isMenuLayerOpened())break;var s=o.selectedValueBeforeOpenMenuLayer;s!==o.input.value.toString()&&(o.select(s||o.selectedValue),o.setMenuLayer(!1)),o.onSelectListItem&&o.onSelectListItem.setExecCallBack(!1);break;case"ENTER":a.stopPropagation(),a.preventDefault();var l=o.input.value;if(i&&(o.input.value="",o.input.value=l,Ua.isInvalidNumberEnter(l)))return void(o.input.value="");if(!n&&o.searchMode){var c=o.selecting<0?0:o.selecting,u=$(o.ul).children(":visible").eq(c)[0];if(u){o.selecting=c,o.selectedValue=u.getAttribute(t.LI_TAG_VALUE_ATTR_NAME),o.select(e(o.selectedValue)),o.onSelectListItem&&o.onSelectListItem.setExecCallBack(!1),o.selectedValueBeforeOpenMenuLayer=o.selectedValue;break}o.input.value=o.selectedValue}o.searchMode=!1,o.selecting=o.getSelectedLiIdx(),o.setMenuList(o.menuList),i?o.select(e(l)):o.select(e(o.selectedValue)),o.onSelectListItem&&o.onSelectListItem.setExecCallBack(!1);break;case"ARROWUP":case"UP":a.stopPropagation(),a.preventDefault();var d=-1!==o.selecting?o.selecting:$(o.ul).children(":visible").length;if(d<1)break;var h=$(o.ul).children(":visible").eq(d)[0],p=$(o.ul).children(":visible").eq(d-1)[0];h&&h.classList.remove(r.a.SELECTED_VALUE),o.selecting=d-1,p.classList.add(r.a.SELECTED_VALUE),o.selectedValue=p.getAttribute(t.LI_TAG_VALUE_ATTR_NAME),o.setScrollRel(p),o.onSelectListItem&&o.onSelectListItem.resetExecCallBack();break;case"ARROWDOWN":case"DOWN":a.stopPropagation(),a.preventDefault();var m=o.selecting;if(m>=$(o.ul).children(":visible").length-1)break;var f=$(o.ul).children(":visible").eq(m)[0],v=$(o.ul).children(":visible").eq(m+1)[0];f.classList.remove(r.a.SELECTED_VALUE),o.selecting=m+1,v.classList.add(r.a.SELECTED_VALUE),o.selectedValue=v.getAttribute(t.LI_TAG_VALUE_ATTR_NAME),o.setScrollRel(v),o.onSelectListItem&&o.onSelectListItem.resetExecCallBack();break;default:o.isMenuLayerOpened()||o.setMenuLayer(!0)}}).on("keyup",function(n){n.stopPropagation();var r=o.input.value;if(i){if(Number.isNaN(Number(r))||r.includes("e"))return void(o.input.value=o.selectedValue.toString());if(!r.trim()||Number(r)<0)return void(o.input.value="")}switch(n.key.toUpperCase()){case"ARROWUP":case"UP":case"ARROWDOWN":case"DOWN":n.stopPropagation(),n.preventDefault(),o.onSelectListItem&&o.onSelectListItem.setExecCallBack(!1),o.onSelectListItem=new Va.a(t.VALUE_CHANGE_DURATION,function(){var t=s()(a.a.mark(function t(n){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o.selectedValue&&""!==o.selectedValue&&n.getExecCallBack()&&o.select(e(o.selectedValue),!0);case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}}).on("focusout",function(){o.searchMode&&(o.searchMode=!1,o.selecting=o.getSelectedLiIdx()),o.input.value!==o.selectedValue&&(o.input.value=o.selectedValue)}),this}},{key:"setComparator",value:function(e){return this.comparator=e,this}},{key:"select",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!0,a=!1,o=void 0;try{for(var s,l=this.ul.children[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;c.classList.remove(r.a.SELECTED_VALUE),c.getAttribute(t.LI_TAG_VALUE_ATTR_NAME)===e&&(this.selectedLi=c,this.selectedLi.classList.add(r.a.SELECTED_VALUE))}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}this.lastInput=e,this.selectedValue=e,this.input.value=e,je.a.isMobileDevice()&&(this.input.readOnly=!0),this.isChangedFontListOrder&&(this.resetFontList(),this.isChangedFontListOrder=!1),this.listener&&this.listener(e,n),n&&this.input.focus(),this.setMenuLayer(!!n)}},{key:"setMenuList",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!this.searchMode){this.ul.innerHTML="",this.selectedLi=null;var i=!1,a=document.createDocumentFragment(),o=Boolean(this.customCss);if(n.forEach(function(n,s){var r=t.makeLi(n,e.selectedValue,o);r.style.backgroundPositionY="".concat(-1*e.itemHeight*s+5,"px"),r.style.backgroundPositionX="".concat(-1*e.itemx,"px"),"text"===e.input.type&&je.a.isMobilePortraitSize()&&Object(ne.setToolsIcon)(r,ne.ToolsIcon.CHECK),o&&r.classList.add(e.customCss),e.selectedValue===n.value&&(i=!0,e.selectedLi=r),a.appendChild(r)}),this.ul.appendChild(a),this.addNewValueWhenUpdateUI&&this.selectedValue&&!i){var s={value:this.selectedValue},r=0;if(n=[s].concat(Yn()(n)),this.comparator){n.sort(this.comparator);for(var l=0,c=n.length;l<c;l++)if(n[l]===s){r=l;break}}this.selectedLi=t.makeLi(s,this.selectedValue),this.ul.insertBefore(this.selectedLi,this.ul.children.item(r))}this.menuList=n}}},{key:"setRecommendList",value:function(e){var n=this;if(e&&!this.searchMode&&(this.recommendUl.innerHTML="",this.recommendUl.parentElement.classList.remove(r.a.ACTIVE),!it.a.isEmpty(e))){this.recommendUl.parentElement.classList.add(r.a.ACTIVE);var i=document.createDocumentFragment();e.forEach(function(e){var a=n.menuList.findIndex(function(t){return t.value===e.value});if(!(a<0)){var o=t.makeLi(e,null,!0);o.style.backgroundPositionY="".concat(-1*n.itemHeight*a+5,"px"),o.style.backgroundPositionX="".concat(-1*n.itemx,"px"),d.b.isEmpty(n.customCss)||o.classList.add(n.customCss),i.appendChild(o)}}),this.recommendUl.appendChild(i)}}},{key:"setRecommendListVisible",value:function(e){e?this.recommendUl.parentElement.classList.add(r.a.ACTIVE):this.recommendUl.parentElement.classList.remove(r.a.ACTIVE)}},{key:"setScrollRel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedLi;if(e){var t=je.a.isMobilePortraitSize()?140:300;this.menuListScrollElem.getScrollY()>e.offsetTop?this.menuListScrollElem.setScrollY(e.offsetTop):e.offsetTop+e.offsetHeight>this.menuListScrollElem.getScrollY()+t&&this.menuListScrollElem.setScrollY(e.offsetTop+e.offsetHeight-t)}}},{key:"setMenuListScroll",value:function(){this.menuListScrollElem.setScrollY(0)}}],[{key:"makeLi",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=document.createElement("li");return n===e.value&&a.classList.add(r.a.SELECTED_VALUE),a.setAttribute(t.LI_TAG_VALUE_ATTR_NAME,e.value),i||(a.innerText=e.label?e.label:e.value),a}}]),t}(He.a);Fa.LI_TAG_VALUE_ATTR_NAME="data-value",Fa.VALUE_CHANGE_DURATION=500,function(e){e.FAMILY="FAMILY",e.FONTSIZE="FONTSIZE"}(Ca||(Ca={}));var Ga=n(84),Ha=function(){function e(t){L()(this,e),this.onChangeScrollY=t,this.makeRow123(),this.makeAccordionRow1(),this.makeColorRow(),this.makeAccordionOutlineRow(),this.makeAccordionShadowRow(),this.makeAccordionGradient(),this.makeAccordionCurveRow(),this.makeTextSizeRow(),this.makeTextEffectRow(),this.changeFont=this.changeFont.bind(this)}return w()(e,[{key:"changeFont",value:function(t,n){t.some(function(e){return e.props.getFamily()!==n})&&e.useTextItemsCharPropMapper(ot,n,t,!0,!1)}},{key:"onChangeAllSameFont",value:function(e,t){var n=this;oa.a.addRecentlyUsedFont(e),t?Y.a.instance.editorMainVC.canvasAreaVC.getAllEditTextVCByFont(oa.a.getOriginFont()).then(function(t){oa.a.setOriginFont(e),n.changeFont(t,e)}):X.a.instance.rollback()}},{key:"onSelectFont",value:function(e,t){var n=this;oa.a.addRecentlyUsedFont(e),t?Y.a.instance.editorMainVC.canvasAreaVC.getAllEditTextVCByFont(oa.a.getOriginFont()).then(function(t){oa.a.setOriginFont(e),n.changeFont(t,e)}):this.changeFont(this.currentItems,e)}},{key:"makeRow123",value:function(){var t=this;this.fontFamily=new Sa(this);this.fontSize=new Fa(function(n){e.useTextItemsCharPropMapper(st,n*yi.a.FONT_SIZE_RATIO,t.currentItems)},Ca.FONTSIZE,x.a.getFontSizePresets(),!0,"","102px").setEditable(function(n){var i=parseFloat(n);return isNaN(i)?t.fontSize.selectedValue:(i=Math.round(10*i)/10,i=Math.min(i,e.MAX_FONT_SIZE),i=Math.max(i,e.MIN_FONT_SIZE),String(i))},!0,!0).setComparator(function(e,t){return Number(e.value)-Number(t.value)});new Le.a(this.fontSize.container,Ge.a.T,{title:{name:"글자 크기"}});this.textBold=new xa(function(n){e.useTextItemsCharPropMapper(dt,n,t.currentItems)},{icon:dt.icon});new Le.a(this.textBold.container,Ge.a.T,{title:{name:"굵게",shortcut:"Ctrl + B"}});this.italic=new xa(function(n){e.useTextItemsCharPropMapper(ht,n,t.currentItems)},{icon:ht.icon});new Le.a(this.italic.container,Ge.a.T,{title:{name:"기울임",shortcut:"Ctrl + I"}});this.textUpperCase=new xa(function(n){e.useTextItemsPropMapper(ft,n,t.currentItems)},{icon:ft.icon});new Le.a(this.textUpperCase.container,Ge.a.TL,{title:{name:"대문자 변환",shortcut:"Ctrl + Shift + K"}});this.textUnderline=new xa(function(n){e.useTextItemsCharPropMapper(pt,n,t.currentItems)},{icon:pt.icon});new Le.a(this.textUnderline.container,Ge.a.T,{title:{name:"밑줄",shortcut:"Ctrl + U"}});this.textStroke=new xa(function(n){e.useTextItemsCharPropMapper(mt,n,t.currentItems)},{icon:mt.icon});new Le.a(this.textStroke.container,Ge.a.TL,{title:{name:"취소선",shortcut:"Alt + Shift + S"}});this.textAlign=new Ma(function(n){e.useTextItemsPropMapper(ct,n,t.currentItems)},[{value:Ii.f.LEFT.toString(),icon:ne.ToolsIcon.FORMAT_ALIGN_LEFT},{value:Ii.f.CENTER.toString(),icon:ne.ToolsIcon.FORMAT_ALIGN_CENTER},{value:Ii.f.RIGHT.toString(),icon:ne.ToolsIcon.FORMAT_ALIGN_RIGHT}]);new Le.a(this.textAlign.container.children[0],Ge.a.TR,{title:{name:"왼쪽 정렬"}}),new Le.a(this.textAlign.container.children[1],Ge.a.TR,{title:{name:"가운데 정렬"}}),new Le.a(this.textAlign.container.children[2],Ge.a.T,{title:{name:"오른쪽 정렬"}});this.textVerticalAlign=new Ma(function(n){e.useTextItemsPropMapper(ut,n,t.currentItems)},[{value:Ii.g.TOP.toString(),icon:ne.ToolsIcon.VERTICAL_ALIGN_TOP},{value:Ii.g.CENTER.toString(),icon:ne.ToolsIcon.VERTICAL_ALIGN_CENTER},{value:Ii.g.BOTTOM.toString(),icon:ne.ToolsIcon.VERTICAL_ALIGN_BOTTOM}]);new Le.a(this.textVerticalAlign.container.children[0],Ge.a.TL,{title:{name:"상단 정렬"}}),new Le.a(this.textVerticalAlign.container.children[1],Ge.a.TL,{title:{name:"중앙 정렬"}}),new Le.a(this.textVerticalAlign.container.children[2],Ge.a.TL,{title:{name:"하단 정렬"}});var n=(new ia.g).setFlex().addCustomClass(r.a.ROW_FONT_SIZE).setMarginTop(),i=(new ia.g).addCustomClass(r.a.ROW_FONT_DETAIL),a=(new ia.g).addCustomClass(r.a.ROW_TEXT_ALIGN).setBorderBottom(),o=new ia.f(100),s=new ia.f,l=(new ia.f).addCustomClass(r.a.COL_TEXT_COLOR),c=new ia.f,u=new ia.f;o.add(this.fontFamily),s.add(this.fontSize),l.add(this.textBold,this.italic,this.textUnderline,this.textStroke,this.textUpperCase),c.add(this.textAlign),u.add(this.textVerticalAlign),n.add(o),i.add(s,l),a.add(c,u),this.fontFamilyRow=n,this.fontEtcRow=i,this.textAlignRow=a}},{key:"onActiveFontSelectView",value:function(){var e=this.fontFamilyRow.container,t=e.parentElement.parentElement,n=Math.min($(e).position().top-200,t.scrollHeight-t.clientHeight-t.scrollTop);this.fontFamily.setSearchViewHeight(.95*window.innerHeight-$(e).offset().top+Math.max(n,0)),n>0&&this.onChangeScrollY(t.scrollTop+n),oa.a.setOriginFont(this.fontFamily.getCurrentFont())}},{key:"makeTextEffectRow",value:function(){var e=this;this.textEffecRow=(new ia.g).addCustomClass(r.a.ACCORDION_EFFECT_ROW),this.outlineMenu=new Ba.a("외곽선",function(){return e.showOutlineMenu.click()},function(t){return e.outlineCheckedEvent(t)}),this.shadowMenu=new Ba.a("그림자",function(){return e.showShadowMenu.click()},function(t){return e.shadowCheckedEvent(t)}),this.gradationMenu=new Ba.a("그라데이션",function(){return e.showGradationMenu.click()},function(t){return e.gradientCheckedEvent(t)}),this.curveMenu=new Ba.a("곡선",function(){return e.showCurveMenu.click()},function(t){return e.curveCheckedEvent(t)}),this.textEffecRow.add(this.outlineMenu,this.shadowMenu,this.gradationMenu,this.curveMenu)}},{key:"makeTextSizeRow",value:function(){var t=this,n=this.fontSizeRow=new ia.g;this.fontSizeRange=new Na.a(function(n){e.useTextItemsCharPropMapper(st,n*yi.a.FONT_SIZE_RATIO,t.currentItems)},"글자 크기",1,999,1),n.add(this.fontSizeRange)}},{key:"makeMobileToolbox",value:function(){var e=this;this.toolTopContents=aa.a.makeToolboxTopContentsWrapper();var t=this.btnTextInput=aa.a.makeLabelContents("입력");t.addEventListener("click",this.onTextEditMode.bind(this)),this.toolTopContents.appendChild(t);var n=aa.a.makeFontShowToolsRow(this.fontFamilyRow,function(){return e.fontFamily.setActive(!0,!0)});this.selectedFont=document.createElement("div"),n.appendChild(this.selectedFont),this.toolTopContents.appendChild(n);var i=aa.a.makeFontSizeToolsRow(this.fontSizeRow);return this.selectedFontSize=document.createElement("div"),i.appendChild(this.selectedFontSize),this.toolTopContents.appendChild(i),this.toolTopContents.appendChild(this.fontColor.container),aa.a.setEventColorTool(this.fontColor,this.colorPickerRow),this.afterColorMenu=aa.a.makeButtonShowToolsRow("글자 정렬",this.textAlignRow),this.toolTopContents.appendChild(this.afterColorMenu),this.toolTopContents.appendChild(aa.a.makeButtonShowToolsRow("스타일",this.fontEtcRow)),this.toolTopContents.appendChild(aa.a.makeButtonShowToolsAccordionRow("글자 조정",this.accordionFontDefault)),this.effectMenu=aa.a.makeButtonShowToolsRow("효과",this.textEffecRow),this.toolTopContents.appendChild(this.effectMenu),this.toolTopContents.appendChild(aa.a.makeButtonShowToolsRow("배경색",this.fontColorRow)),this.showOutlineMenu=aa.a.makeButtonShowToolsAccordionRow("외곽선",this.accordionOutline),this.showOutlineMenu.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.showOutlineMenu),this.showShadowMenu=aa.a.makeButtonShowToolsAccordionRow("그림자",this.accordionGroupShadow),this.showShadowMenu.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.showShadowMenu),this.showGradationMenu=aa.a.makeButtonShowToolsAccordionRow("그라데이션",this.accordionGroupGradient),this.showGradationMenu.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.showGradationMenu),this.showCurveMenu=aa.a.makeButtonShowToolsButtonRow("곡선",this.curveRow),this.showCurveMenu.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.showCurveMenu),this.toolTopContents}},{key:"makeColorRow",value:function(){var t=this,n=(new ia.g).addCustomClass(r.a.ROW_TEXT_COLOR);this.fontColor=new Pa.a(function(n){e.useTextItemsCharPropMapper(rt,n,t.currentItems)},rt.icon,"글자색",!1,!0);new Le.a(this.fontColor.container,Ge.a.TL,{title:{name:"글자 색상"}});this.backgroundColor=new Pa.a(function(n){e.useTextItemsCharPropMapper(lt,n,t.currentItems)},lt.icon,"배경색",!0,!0);new Le.a(this.backgroundColor.container,Ge.a.TL,{title:{name:"글 배경 색상"}});n.add(this.fontColor,this.backgroundColor),this.fontColorRow=n,this.colorPickerRow=(new ia.g).addCustomClass(r.a.COLOR_PICKER_ROW)}},{key:"makeAccordionRow1",value:function(){var t=this,n=new ia.c("글자 조정",null).setScrollStart(250).setFlex().setBorderTop().addCustomClass(r.a.ROW_TEXT_DEFAULT,r.a.HIDDEN_LABEL);this.textSpace=new Na.a(function(n){e.useTextItemsCharPropMapper(gt,n,t.currentItems)},"자간",Ti.a.MIN_TEXT_SPACE,Ti.a.MAX_TEXT_SPACE,1),this.lineSpace=new Na.a(function(n){e.useTextItemsCharPropMapper(Et,n,t.currentItems,!0,!0)},"행간",.5,2.5,.01,"",function(e){return Ga.a.round(e,3)}),this.scaleX=new Na.a(function(n){e.useTextItemsPropMapper(yt,n,t.currentItems)},"장평",50,200,1,"%"),n.add(this.textSpace),n.add(this.lineSpace),n.add(this.scaleX),this.accordionFontDefault=n}},{key:"outlineCheckedEvent",value:function(t,n){var i=this;X.a.instance.groupingAction(function(){i.currentItems.forEach(function(i){if(e.useTextItemPropMapper(kt,t,[i]),!0===t){var a=i.getSelectionRange();!i.isEditMode||a.end.col===a.start.col&&a.end.row===a.start.row?Wa(i.props.getOutlineColors())&&za(i.props.getOutlineSizes())&&e.useTextItemPropMapper(_t,20,[i]):e.useTextItemCharPropMapper(_t,20,i),n&&e.useTextItemCharPropMapper(Lt,n,i)}})})}},{key:"shadowCheckedEvent",value:function(t,n){var i=this;X.a.instance.groupingAction(function(){i.currentItems.forEach(function(i){e.useTextItemPropMapper(wt,t,[i]);var a=i.getSelectionRange();!i.isEditMode||a.end.col===a.start.col&&a.end.row===a.start.row?!0===t&&Wa(i.props.getShadowColors())&&i.props.isShadowAngleDefault()&&za(i.props.getShadowDistances())&&za(i.props.getShadowSpreads())&&(e.useTextItemPropMapper(Rt,315,[i]),e.useTextItemPropMapper(bt,50,[i]),e.useTextItemPropMapper(At,12,[i]),e.useTextItemPropMapper(Ot,8,[i])):(e.useTextItemPropMapper(Rt,315,[i]),e.useTextItemPropMapper(bt,50,[i]),e.useTextItemCharPropMapper(At,12,i),e.useTextItemCharPropMapper(Ot,8,i)),n&&e.useTextItemCharPropMapper(St,n,i)})})}},{key:"gradientCheckedEvent",value:function(t){e.useTextItemsPropMapper(Dt,t,this.currentItems)}},{key:"curveCheckedEvent",value:function(t){e.useTextItemsPropMapper(Tt,t,this.currentItems)}},{key:"makeAccordionOutlineRow",value:function(){var t=this,n=new ia.c("외곽선",function(e){return t.outlineCheckedEvent(e)}).setFlex().setBorderTop();this.outlineColor=new Pa.a(function(e){t.outlineCheckedEvent(!0,e)},ne.ToolsIcon.PENCIL,"색상",!1,!0).addClass(r.a.ACCORDION_ROW_COLOR),this.outlineSize=new Na.a(function(n){e.useTextItemsCharPropMapper(_t,n,t.currentItems)},"두께",0,100,1),n.addCustomClass(r.a.EFFECT_TOOLS),n.setPrevCallback(function(){return t.effectMenu.click()}),n.appendElement(this.outlineColor.getContainer()).add(this.outlineSize),this.accordionOutline=n}},{key:"makeAccordionShadowRow",value:function(){var t=this,n=new ia.c("그림자",function(e){return t.shadowCheckedEvent(e)}).setFlex().setBorderTop().setBorderBottom();this.shadowColor=new Pa.a(function(e){t.shadowCheckedEvent(!0,e)},ne.ToolsIcon.PENCIL,"색상",!1,!0).addClass(r.a.ACCORDION_ROW_COLOR),this.shadowAngle=new Na.a(function(n){e.useTextItemsCharPropMapper(Rt,n,t.currentItems)},"방향",0,360,1,"°"),this.shadowAlpha=new Na.a(function(n){e.useTextItemsCharPropMapper(bt,n,t.currentItems)},"투명도",0,100,1,"%"),this.shadowDistance=new Na.a(function(n){e.useTextItemsCharPropMapper(At,n,t.currentItems)},"거리",0,100,1),this.shadowSpread=new Na.a(function(n){e.useTextItemsCharPropMapper(Ot,n,t.currentItems)},"흐림",0,100,1),n.addCustomClass(r.a.EFFECT_TOOLS),n.appendElement(this.shadowColor.getContainer()).add(this.shadowAngle,this.shadowAlpha,this.shadowDistance,this.shadowSpread),n.setPrevCallback(function(){return t.effectMenu.click()}),this.accordionGroupShadow=n}},{key:"makeAccordionGradient",value:function(){var t=this,n=new ia.c("그라데이션",function(e){return t.gradientCheckedEvent(e)}).setFlex().setBorderBottom();this.gradientAngle=new Na.a(function(n){e.useTextItemsPropMapper(Mt,n,t.currentItems)},"방향",0,360,1,"°"),this.gradationColor=new Oa("색상",!0,this.applyPreset.bind(this),function(n){e.useTextItemsPropMapper(Nt,n,t.currentItems)},function(n){e.useTextItemsPropMapper(xt,n,t.currentItems)},function(n){e.useTextItemsPropMapper(Bt,n,t.currentItems)},function(n){e.useTextItemsPropMapper(Vt,n,t.currentItems)}),n.addCustomClass(r.a.EFFECT_TOOLS),n.appendElement(this.gradationColor.getColorViewBoxOuter()).add(this.gradationColor,this.gradientAngle),n.setPrevCallback(function(){return t.effectMenu.click()}),this.accordionGroupGradient=n}},{key:"makeAccordionCurveRow",value:function(){var t=this,n=new ia.e("곡선",function(e){return t.curveCheckedEvent(e)}).setFlex().setBorderBottom();this.curveRow=n;var i=new xa(function(n){e.useTextItemsPropMapper(It,n,t.currentItems)},{icon:It.icon}).addClass(r.a.TOGGLE_BUTTON_FIRST);this.curveCW=i;new Le.a(this.curveCW.container,Ge.a.B,{title:{name:"바깥쪽 쓰기"}});this.curveCW.container.classList.add("tools_item_curve");var a=new xa(function(n){e.useTextItemsPropMapper(Ct,!n,t.currentItems)},{icon:Ct.icon}).addClass(r.a.TOGGLE_BUTTON_SECOND);this.curveCCW=a;new Le.a(this.curveCCW.container,Ge.a.B,{title:{name:"안쪽 쓰기"}});this.curveCCW.container.classList.add("tools_item_curve"),n.addCustomClass(r.a.EFFECT_TOOLS),n.add(i),n.add(a),n.setPrevCallback(function(){return t.effectMenu.click()})}},{key:"updateUI",value:function(e){var t=this.currentItem,n=(e.length,null),i=null;if(t.isEditMode){var a=t.getSelectionRange();n=a.start.getCopy(),i=a.end.getCopy(),n.col===i.col&&n.row===i.row&&(0===n.col?i.col+=1:n.col-=1)}this.btnTextInput.style.display=1===this.currentItems.length?"":"none";Ci.a.getUsedFontFamilyList();var o=t.props.getFamily(n,i);this.fontFamily.renderView(o);var s,l=t.props.getSize(n,i);Number.isNaN(l)||(s=Math.round(l/yi.a.FONT_SIZE_RATIO*10)/10),this.fontSize.updateUI({value:"".concat(s)}),this.selectedFontSize.innerText="".concat(s),this.fontSizeRange.updateUI({value:s}),this.selectedFont.innerText=o,this.textBold.updateUI({isSelected:t.props.isBold(n,i)}),this.italic.updateUI({isSelected:t.props.isItalic(n,i)}),this.textUnderline.updateUI({isSelected:t.props.isUnderline(n,i)}),this.textStroke.updateUI({isSelected:t.props.isStrikeout(n,i)}),this.textUpperCase.updateUI({isSelected:t.props.isUpperCase()}),this.fontColor.updateUI({value:t.props.getColor(n,i),isMultiColor:this.isMulticolor(e,n,i,function(e,t,n){return e.props.getDuplicateValExcludedColors(t,n)})}),this.backgroundColor.updateUI({value:t.props.getBackgroundColor(n,i),isMultiColor:this.isMulticolor(e,n,i,function(e,t,n){return e.props.getDuplicateValExcludedBacgroundColors(t,n)})}),this.textAlign.updateUI({value:t.props.getHorizontalAlign().toString()}),this.textVerticalAlign.updateUI({value:t.props.getVerticalAlign().toString(),active:!t.props.isActiveCurve()}),this.accordionFontDefault.updateUI(t.props.isActiveFontDetail()),this.textSpace.updateUI({value:t.props.getFontDetailTextSpace(!0,n,i),active:t.props.isActiveFontDetail()}),this.lineSpace.updateUI({value:t.props.getFontDetailLineSpace(!0,n,i),active:t.props.isActiveFontDetail()&&!t.props.isActiveCurve()}),this.scaleX.updateUI({value:t.props.getFontDetailScaleX(!0),active:t.props.isActiveFontDetail()&&!t.props.isActiveCurve()}),this.accordionOutline.updateUI(t.props.isActiveOutline()),this.outlineColor.updateUI({value:t.props.getOutlineColor(!0,n,i),active:!0,isMultiColor:this.isMulticolor(e,n,i,function(e,t,n){return e.props.getDuplicateValExcludedOutlineColors(t,n)})}),this.outlineSize.updateUI({value:t.props.getOutlineSize(!0,n,i),active:t.props.isActiveOutline()}),this.accordionGroupShadow.updateUI(t.props.isActiveShadow()),this.shadowColor.updateUI({value:t.props.getShadowColor(!0,n,i),active:!0,isMultiColor:this.isMulticolor(e,n,i,function(e,t,n){return e.props.getDuplicateValExcludedShadowColors(t,n)})}),this.shadowAlpha.updateUI({value:t.props.getShadowAlpha(!0,n,i),active:t.props.isActiveShadow()}),this.shadowAngle.updateUI({value:t.props.getShadowAngle(!0,n,i),active:t.props.isActiveShadow()}),this.shadowDistance.updateUI({value:t.props.getShadowDistance(!0,n,i),active:t.props.isActiveShadow()}),this.shadowSpread.updateUI({value:t.props.getShadowSpread(!0,n,i),active:t.props.isActiveShadow()}),this.accordionGroupGradient.updateUI(t.props.isActiveGradient());var c=t.props.getGradient();this.gradientAngle.updateUI({value:c.getAngle(!0),active:t.props.isActiveGradient()}),this.gradationColor.updateUI({active:t.props.isActiveGradient(),isNewFormat:c.getIsNewFormat(),rotate:c.getAngle(!0),valueList:[{rgb:c.getColor(1,!0)},{rgb:c.getColor(2,!0)},{rgb:c.getColor(3,!0)},{rgb:c.getColor(4,!0)}]}),this.curveRow.updateUI(t.props.isActiveCurve()),this.curveCW.updateUI({active:t.props.isActiveCurve(),isSelected:!1}),this.curveCCW.updateUI({active:t.props.isActiveCurve(),isSelected:!1}),t.props.isCurveCw()?(this.curveCW.container.classList.add(r.a.HIDE),this.curveCCW.container.classList.remove(r.a.HIDE)):(this.curveCW.container.classList.remove(r.a.HIDE),this.curveCCW.container.classList.add(r.a.HIDE)),this.curveMenu.updateUI(t.props.isActiveCurve()),this.gradationMenu.updateUI(t.props.isActiveGradient()),this.outlineMenu.updateUI(t.props.isActiveOutline()),this.shadowMenu.updateUI(t.props.isActiveShadow())}},{key:"isMulticolor",value:function(e,t,n,i){var a=this.currentItem,o=!1;if(e.length>1){var s=i(a)[0].toLowerCase(),r=!0,l=!1,c=void 0;try{for(var u,d=e[Symbol.iterator]();!(r=(u=d.next()).done);r=!0){var h=i(u.value);if(h.length>1||s!==h[0].toLowerCase()){o=!0;break}}}catch(e){l=!0,c=e}finally{try{r||null==d.return||d.return()}finally{if(l)throw c}}}else o=i(a,t,n).length>1;return o}},{key:"applyPreset",value:function(e,t){X.a.instance.dispatch(new na(e,Ei.b.TEXT,t))}},{key:"makeToolboxRowContents",value:function(){return[{row:this.fontFamilyRow,priority:200,viewType:0},{row:this.fontEtcRow,priority:210,viewType:0},{row:this.textAlignRow,priority:220,viewType:0},{row:this.fontColorRow,priority:530,viewType:0},{row:this.accordionFontDefault,priority:535,viewType:0},{row:this.accordionOutline,priority:540,viewType:0},{row:this.accordionGroupShadow,priority:550,viewType:0},{row:this.accordionGroupGradient,priority:560,viewType:0},{row:this.curveRow,priority:570,viewType:0},{row:this.fontSizeRow,priority:580,viewType:0},{row:this.textEffecRow,priority:590,viewType:0},{row:this.colorPickerRow,priority:600,viewType:0}]}},{key:"updateToolboxRowContents",value:function(e,t){var n=e.filter(function(e){return e instanceof q.a}),i=e.every(function(e){return e instanceof q.a}),a=n.length>1,o=i&&e.some(function(e){return e instanceof q.a&&e.props.isActiveCurve()}),s=i&&!t.isAdminEditView;je.a.isMobilePortraitSize()?(this.toolTopContents.insertBefore(this.fontColor.container,this.afterColorMenu),this.fontColor.canNotAppend=!0):(this.fontColorRow.container.insertBefore(this.fontColor.container,this.backgroundColor.container),this.fontColor.canNotAppend=!1),this.fontSizeRow.rowVisible=s&&je.a.isMobilePortraitSize(),this.textEffecRow.rowVisible=s&&je.a.isMobilePortraitSize(),this.colorPickerRow.rowVisible=s&&je.a.isMobilePortraitSize(),this.fontFamilyRow.rowVisible=s,this.fontEtcRow.rowVisible=s,this.textAlignRow.rowVisible=s,this.fontColorRow.rowVisible=s,this.accordionFontDefault.rowVisible=s,this.curveRow.rowVisible=s,this.accordionOutline.rowVisible=s,this.accordionGroupShadow.rowVisible=s,this.accordionGroupGradient.rowVisible=s&&!(a&&o),this.curveRow.rowVisible=s&&!a;var r=s&&e[0]&&!e[0].isLock();return aa.a.setContentsVisible(this.toolTopContents,r),this.curveMenu.container&&aa.a.setContentsVisible(this.curveMenu.container,!a),i?(this.currentItems=e.filter(function(e){return e instanceof q.a}),this.currentItem=this.currentItems[0],this.updateUI(this.currentItems)):(this.currentItem=null,this.currentItems=null),!0}},{key:"changeFontSizeListByScale",value:function(e){var t=this.fontSize.menuList.slice();t.forEach(function(t){var n=Number(t.value),i=Math.round(n*e);t.value=i.toString()}),this.fontSize.updateUI({itemList:t,value:""})}},{key:"onTextEditMode",value:function(){this.currentItems&&1===this.currentItems.length&&!this.currentItems[0].isEditMode&&X.a.instance.dispatch(new et.c(this.currentItems[0],0,0))}}],[{key:"makeStyleTemplateXmlDoc",value:function(e){return null}},{key:"setStyleTemplateNode",value:function(e,t,n,i){return i&&e.attr(t.name,n),this}},{key:"useTextItemsPropMapper",value:function(t,n,i){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e.useTextItemPropMapper(t,n,i,a)}},{key:"useTextItemPropMapper",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];X.a.instance.dispatch(new Un.e(e.actionType,e.groupName,e.name,t,i,e.timeout,!0,n));var a=!0,o=!1,s=void 0;try{for(var r,l=n[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value;if(c.isEditMode){var u=Y.a.instance.pageController.getItemRenderer(c);u.focus()}}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}}},{key:"useTextItemsCharPropMapper",value:function(t,n,i){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6?arguments[6]:void 0;X.a.instance.groupingAction(function(){var l=!0,c=!1,u=void 0;try{for(var d,h=i[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var p=d.value;if(e.useTextItemCharPropMapper(t,n,p,a,o,r),p.isEditMode&&!s)Y.a.instance.pageController.getItemRenderer(p).focus()}}catch(e){c=!0,u=e}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}})}},{key:"useTextItemCharPropMapper",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,s=n.getSelectionRange();n.isEditMode&&(s.start.col!==s.end.col||s.start.row!==s.end.row||a)?X.a.instance.dispatch(new Un.c(e.actionType,e.groupName,e.name,t,i,e.timeout,!0,s.start,s.end,n,o)):X.a.instance.dispatch(new Un.c(e.actionType,e.groupName,e.name,t,i,e.timeout,!0,null,null,n,o))}},{key:"applyPresetParam",value:function(e,t,n){}}]),e}();function Wa(e){var t=!0,n=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value,r=!0,l=!1,c=void 0;try{for(var u,d=s[Symbol.iterator]();!(r=(u=d.next()).done);r=!0){if("#000000"!==u.value)return!1}}catch(e){l=!0,c=e}finally{try{r||null==d.return||d.return()}finally{if(l)throw c}}}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return!0}function za(e){var t=!0,n=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value,r=!0,l=!1,c=void 0;try{for(var u,d=s[Symbol.iterator]();!(r=(u=d.next()).done);r=!0){if(0!==u.value)return!1}}catch(e){l=!0,c=e}finally{try{r||null==d.return||d.return()}finally{if(l)throw c}}}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return!0}Ha.MAX_FONT_SIZE=999,Ha.MIN_FONT_SIZE=1;var Ka,Ya={name:"cellBackgroundColor",actionType:K.a.GRID_CELL_BACKGROUND,timeout:3e3},Xa=function(e){function t(e,n,i,a,o,s,r){var l,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;return L()(this,t),(l=V()(this,F()(t).call(this,i,a,o,s,r,c,r,[e]))).oldValues=[],l.cells=[],l.gridItem=e,l.propsType=n,l.actionType=i,l.groupName=a,l.propName=o,l.newValue=s,l.updateUI=r,l.timeout=c,l.saveQueue=u,l.onCompleteRender=d,l.selectedCells=e.selectedCells,l.doSaveQueue=u,l.isRender=r,l}return z()(t,e),w()(t,[{key:"commitAction",value:function(e,n){var i=this;if(this.propsType===Z.b.GRID)this.propsArray[0]=this.gridItem.props,he()(F()(t.prototype),"commitProps",this).call(this,e,n),this.oldValues.push(this.oldValue);else{if(this.cells=this.gridItem.positionTool.getCells(this.selectedCells),0===this.cells.length){var a=!0,o=!1,s=void 0;try{for(var r,l=this.gridItem.cells[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c,u=r.value;(c=this.cells).push.apply(c,Yn()(u))}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}}this.cells.forEach(function(a){switch(i.propsType){case Z.b.CELL:i.propsArray[0]=a.cellProps;break;case Z.b.TEXT:i.propsArray[0]=a.childTextItem.props;break;default:return}he()(F()(t.prototype),"commitProps",i).call(i,e,n),i.oldValues.push(i.oldValue)})}n.editorMainVC.canvasAreaVC.renderAuto(e,n,[this.gridItem]).then(function(){i.onCompleteRender&&i.onCompleteRender()}),n.editorMainVC.renderLayerThumb(this.items)}},{key:"rollbackAction",value:function(e,n){var i=this;this.propsType===Z.b.GRID?(this.oldValue=this.oldValues.shift(),he()(F()(t.prototype),"rollbackProps",this).call(this,e,n)):this.cells.forEach(function(a){switch(i.propsType){case Z.b.CELL:i.propsArray[0]=a.cellProps;break;case Z.b.TEXT:i.propsArray[0]=a.childTextItem.props;break;default:return}i.oldValue=i.oldValues.shift(),he()(F()(t.prototype),"rollbackProps",i).call(i,e,n)}),n.editorMainVC.renderLayerThumb(this.items)}}]),t}(Un.d),ja=function(e){function t(e){var n;L()(this,t),(n=V()(this,F()(t).call(this))).widths=[],n.cols=[],n.actionType=K.a.GRID_CELLS_WIDTH_EQUAL,n.commitAction=function(e,t,i){if(n.doSaveQueue){var a=0,o=!0,s=!1,r=void 0;try{for(var l,c=n.cols[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value,d=n.gridItem.cols[u].thickness;n.widths.push(d),a+=d}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}var h=a/n.cols.length,p=!0,m=!1,f=void 0;try{for(var v,g=n.cols[Symbol.iterator]();!(p=(v=g.next()).done);p=!0){var E=v.value;h=Math.max(h,n.gridItem.cols[E].minThickness)}}catch(e){m=!0,f=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw f}}var y=!0,T=!1,I=void 0;try{for(var C,k=n.cols[Symbol.iterator]();!(y=(C=k.next()).done);y=!0){var L=C.value;n.gridItem.cols[L].thickness=h}}catch(e){T=!0,I=e}finally{try{y||null==k.return||k.return()}finally{if(T)throw I}}n.gridItem.adjustSize(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)}},n.rollbackAction=function(e,t,i){for(var a=0;a<n.cols.length;a++){var o=n.cols[a],s=n.widths[a];n.gridItem.cols[o].thickness=s}n.gridItem.adjustSize(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.recycle=function(){n.gridItem=null,n.widths=[]},n.gridItem=e;var i=e.selectedCells;if(0===i.length)for(var a=0;a<e.cols.length;a++)n.cols.push(a);else{var o=!0,s=!1,r=void 0;try{for(var l,c=i[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;n.cols.indexOf(u.col)<0&&n.cols.push(u.col)}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}}return n}return z()(t,e),t}(kn),Za=function(e){function t(e){var n;L()(this,t),(n=V()(this,F()(t).call(this))).rows=[],n.heights=[],n.actionType=K.a.GRID_CELLS_HEIGHT_EQUAL,n.commitAction=function(e,t,i){if(n.doSaveQueue){var a=0,o=!0,s=!1,r=void 0;try{for(var l,c=n.rows[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value,d=n.gridItem.rows[u].thickness;n.heights.push(d),a+=d}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}var h=a/n.rows.length,p=!0,m=!1,f=void 0;try{for(var v,g=n.gridItem.rows[Symbol.iterator]();!(p=(v=g.next()).done);p=!0){var E=v.value;h=Math.max(h,E.minThickness)}}catch(e){m=!0,f=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw f}}var y=!0,T=!1,I=void 0;try{for(var C,k=n.rows[Symbol.iterator]();!(y=(C=k.next()).done);y=!0){var L=C.value;n.gridItem.rows[L].thickness=h}}catch(e){T=!0,I=e}finally{try{y||null==k.return||k.return()}finally{if(T)throw I}}n.gridItem.adjustSize(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)}},n.rollbackAction=function(e,t,i){for(var a=0;a<n.rows.length;a++){var o=n.rows[a],s=n.heights[a];n.gridItem.rows[o].thickness=s}n.gridItem.adjustSize(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.recycle=function(){n.gridItem=null,n.heights=[]},n.gridItem=e;var i=e.selectedCells;if(0===i.length)for(var a=0;a<e.rows.length;a++)n.rows.push(a);else{var o=!0,s=!1,r=void 0;try{for(var l,c=i[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;n.rows.indexOf(u.row)<0&&n.rows.push(u.row)}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}}return n}return z()(t,e),t}(kn),qa=n(267),$a=function(e){function t(e){var n;L()(this,t),(n=V()(this,F()(t).call(this))).originTexts=[],n.mergedCellsPoses=[],n.actionType=K.a.GRID_MERGE_CELLS,n.commitAction=function(e,t,i){n.doSaveQueue&&(n.gridItem.mergeTool.mergeCells(n.cellsPos),n.gridItem.adjustColThickness(),n.gridItem.adjustRowThickness(),n.gridItem.adjustSize(),n.gridItem.setStatus(qe.g.CHANGE),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t),i.renderItemTools(e,t))},n.rollbackAction=function(e,t,i){var a=0,o=n.gridItem.positionTool.getRectCells(n.cellsPos),s=!0,r=!1,l=void 0;try{for(var c,u=o[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var d=c.value,h=!0,p=!1,m=void 0;try{for(var f,v=d[Symbol.iterator]();!(h=(f=v.next()).done);h=!0){f.value.textProps.setText(n.originTexts[a]),a++}}catch(e){p=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw m}}}}catch(e){r=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(r)throw l}}n.gridItem.mergeTool.splitCells(n.cellsPos);var g=!0,E=!1,y=void 0;try{for(var T,I=n.mergedCellsPoses[Symbol.iterator]();!(g=(T=I.next()).done);g=!0){var C=T.value;n.gridItem.mergeTool.mergeCells(C)}}catch(e){E=!0,y=e}finally{try{g||null==I.return||I.return()}finally{if(E)throw y}}n.gridItem.cols.forEach(function(e,t){e.thickness=n.colThickness[t]}),n.gridItem.rows.forEach(function(e,t){e.thickness=n.rowThickness[t]}),n.gridItem.adjustSize(),n.gridItem.setStatus(qe.g.CHANGE),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t),i.renderItemTools(e,t)},n.recycle=function(){n.gridItem=null,n.cellsPos=null,n.originTexts=[],n.mergedCellsPoses=[],n.colThickness=[],n.rowThickness=[]},n.gridItem=e;var i=n.gridItem.selectedCells,a=n.gridItem.positionTool.isRectSelectedCells(i);if(n.doSaveQueue=a,a){n.cellsPos=n.gridItem.positionTool.arrayOfCellPosToCellsPos(i);var o=n.gridItem.positionTool.getRectCells(n.cellsPos),s=!0,r=!1,l=void 0;try{for(var c,u=o[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var d=c.value,h=!0,p=!1,m=void 0;try{for(var f,v=d[Symbol.iterator]();!(h=(f=v.next()).done);h=!0){var g=f.value;n.originTexts.push(g.innerText),g.cellType===qa.b.MASTER&&n.mergedCellsPoses.push(g.childCellsPos)}}catch(e){p=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw m}}}}catch(e){r=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(r)throw l}}n.rowThickness=[],n.colThickness=[];var E=!0,y=!1,T=void 0;try{for(var I,C=e.rows[Symbol.iterator]();!(E=(I=C.next()).done);E=!0){var k=I.value;n.rowThickness.push(k.thickness)}}catch(e){y=!0,T=e}finally{try{E||null==C.return||C.return()}finally{if(y)throw T}}var _=!0,w=!1,S=void 0;try{for(var b,R=e.cols[Symbol.iterator]();!(_=(b=R.next()).done);_=!0){var A=b.value;n.colThickness.push(A.thickness)}}catch(e){w=!0,S=e}finally{try{_||null==R.return||R.return()}finally{if(w)throw S}}}return n}return z()(t,e),t}(kn),Qa=function(e){function t(e){var n;L()(this,t),(n=V()(this,F()(t).call(this))).mergedCellsPoses=[],n.actionType=K.a.GRID_SPLIT_CELLS,n.commitAction=function(e,t,i){if(n.doSaveQueue){var a=!0,o=!1,s=void 0;try{for(var r,l=n.mergedCellsPoses[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value;n.gridItem.mergeTool.splitCells(c)}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}n.gridItem.adjustSize(),n.gridItem.setStatus(qe.g.CHANGE),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t),i.renderItemTools(e,t)}},n.rollbackAction=function(e,t,i){var a=!0,o=!1,s=void 0;try{for(var r,l=n.mergedCellsPoses[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value;n.gridItem.mergeTool.mergeCells(c)}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}n.gridItem.adjustSize(),n.gridItem.setStatus(qe.g.CHANGE),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t),i.renderItemTools(e,t)},n.recycle=function(){n.gridItem=null,n.mergedCellsPoses=null},n.gridItem=e;var i=n.gridItem.selectedCells,a=n.gridItem.positionTool.isRectSelectedCells(i);if(n.doSaveQueue=a,a){var o=n.gridItem.positionTool.arrayOfCellPosToCellsPos(i),s=n.gridItem.positionTool.getRectCells(o),r=!0,l=!1,c=void 0;try{for(var u,d=s[Symbol.iterator]();!(r=(u=d.next()).done);r=!0){var h=u.value,p=!0,m=!1,f=void 0;try{for(var v,g=h[Symbol.iterator]();!(p=(v=g.next()).done);p=!0){var E=v.value;E.cellType===qa.b.MASTER&&n.mergedCellsPoses.push(E.childCellsPos)}}catch(e){m=!0,f=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw f}}}}catch(e){l=!0,c=e}finally{try{r||null==d.return||d.return()}finally{if(l)throw c}}}return n}return z()(t,e),t}(kn),Ja=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.getFirstSelectedCell().col;return L()(this,t),(n=V()(this,F()(t).call(this))).actionType=K.a.GRID_INSERT_COL_LEFT,n.commitAction=function(e,t,i){n.gridItem.sizeTool.insertColWithStyle(n.colNum,n.colNum),n.gridItem.sizeTool.synchronizeCells(),n.gridItem.adjustSize(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.rollbackAction=function(e,t,i){for(var a=0;a<n.gridItem.row;a++){var o=n.gridItem.cells[a][n.colNum],s=n.gridItem.cells[a][n.colNum+1];s.assignCellStyle(o),s.assignFontStyle(o),s.assignBorderStyle(o)}n.gridItem.sizeTool.deleteCol(n.colNum),n.gridItem.sizeTool.synchronizeCells(),n.gridItem.adjustSize(),n.gridItem.unselectAllCell(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.recycle=function(){n.gridItem=null},n.gridItem=e,n.colNum=i,n}return z()(t,e),t}(kn),eo=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.getFirstSelectedCell().col+1;return L()(this,t),(n=V()(this,F()(t).call(this))).actionType=K.a.GRID_INSERT_COL_RIGHT,n.commitAction=function(e,t,i){n.gridItem.sizeTool.insertColWithStyle(n.colNum-1,n.colNum),n.gridItem.sizeTool.synchronizeCells(),n.gridItem.adjustSize(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.rollbackAction=function(e,t,i){for(var a=0;a<n.gridItem.row;a++){var o=n.gridItem.cells[a][n.colNum],s=n.gridItem.cells[a][n.colNum-1];s.assignCellStyle(o),s.assignFontStyle(o),s.assignBorderStyle(o)}n.gridItem.sizeTool.deleteCol(n.colNum),n.gridItem.sizeTool.synchronizeCells(),n.gridItem.adjustSize(),n.gridItem.unselectAllCell(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.recycle=function(){n.gridItem=null},n.gridItem=e,n.colNum=i,n}return z()(t,e),t}(kn),to=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.getFirstSelectedCell().row;return L()(this,t),(n=V()(this,F()(t).call(this))).actionType=K.a.GRID_INSERT_ROW_TOP,n.commitAction=function(e,t,i){n.gridItem.sizeTool.insertRowWithStyle(n.rowNum,n.rowNum),n.gridItem.sizeTool.synchronizeCells(),n.gridItem.adjustSize(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.rollbackAction=function(e,t,i){for(var a=0;a<n.gridItem.col;a++){var o=n.gridItem.cells[n.rowNum][a],s=n.gridItem.cells[n.rowNum+1][a];s.assignCellStyle(o),s.assignFontStyle(o),s.assignBorderStyle(o)}n.gridItem.sizeTool.deleteRow(n.rowNum),n.gridItem.sizeTool.synchronizeCells(),n.gridItem.adjustSize(),n.gridItem.unselectAllCell(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.recycle=function(){n.gridItem=null},n.gridItem=e,n.rowNum=i,n}return z()(t,e),t}(kn),no=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.getFirstSelectedCell().row+1;return L()(this,t),(n=V()(this,F()(t).call(this))).actionType=K.a.GRID_INSERT_ROW_BOTTOM,n.commitAction=function(e,t,i){n.gridItem.sizeTool.insertRowWithStyle(n.rowNum-1,n.rowNum),n.gridItem.sizeTool.synchronizeCells(),n.gridItem.adjustSize(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.rollbackAction=function(e,t,i){for(var a=0;a<n.gridItem.col;a++){var o=n.gridItem.cells[n.rowNum][a],s=n.gridItem.cells[n.rowNum-1][a];s.assignCellStyle(o),s.assignFontStyle(o),s.assignBorderStyle(o)}n.gridItem.sizeTool.deleteRow(n.rowNum),n.gridItem.sizeTool.synchronizeCells(),n.gridItem.adjustSize(),n.gridItem.unselectAllCell(),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.recycle=function(){n.gridItem=null},n.gridItem=e,n.rowNum=i,n}return z()(t,e),t}(kn),io=function(e){function t(e){var n;L()(this,t),(n=V()(this,F()(t).call(this))).deleteCells=[],n.deleteCols=[],n.deleteColNum=[],n.actionType=K.a.GRID_DELETE_COL,n.commitAction=function(e,t,i){if(n.isDeleteItem)n.gridItem.unselectAllCell(),X.a.instance.dispatch(new An.a([n.gridItem]));else if(n.deleteColNum.length>0){var a=n.deleteColNum.slice().reverse(),o=!0,s=!1,r=void 0;try{for(var l,c=a[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value,d=[],h=!0,p=!1,m=void 0;try{for(var f,v=n.gridItem.cells[Symbol.iterator]();!(h=(f=v.next()).done);h=!0){var g=f.value;d.push(g[u])}}catch(e){p=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw m}}n.deleteCells.push(d),n.deleteCols.push(n.gridItem.cols[u]),n.gridItem.sizeTool.deleteCol(u)}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}var E=[],y=n.deleteColNum[0];if(n.gridItem.col>y)for(var T=0;T<n.gridItem.rows.length;T++)E.push(new Ln.a(T,y));else for(var I=0;I<n.gridItem.rows.length;I++)E.push(new Ln.a(I,n.gridItem.col-1));n.gridItem.sizeTool.synchronizeCells(),n.gridItem.selectCells(E),n.gridItem.adjustSize(),n.gridItem.setStatus(qe.g.CHANGE),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)}},n.rollbackAction=function(e,t,i){var a=!0,o=!1,s=void 0;try{for(var r,l=n.deleteColNum[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value;n.gridItem.sizeTool.insertColWithCol(n.deleteCols.pop(),n.deleteCells.pop(),c)}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}n.gridItem.sizeTool.synchronizeCells(),n.gridItem.adjustSize(),n.gridItem.setStatus(qe.g.CHANGE),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.recycle=function(){n.gridItem=null,n.deleteCellsPos=null,n.deleteCells=[],n.deleteCols=[]},n.gridItem=e,n.deleteCellsPos=e.selectedCells;var i=!0,a=!1,o=void 0;try{for(var s,r=n.deleteCellsPos[Symbol.iterator]();!(i=(s=r.next()).done);i=!0)for(var l=s.value,c=n.gridItem.cells[l.row][l.col].childCellsPos,u=c.startPos.col;u<=c.endPos.col;u++)n.deleteColNum.indexOf(u)<0&&n.deleteColNum.push(u)}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}return n.deleteColNum.sort(function(e,t){return e>t?1:e<t?-1:0}),n.deleteColNum.length===n.gridItem.col&&(n.isDeleteItem=!0,n.doSaveQueue=!1),n.gridItem.unselectAllCell(),n}return z()(t,e),t}(kn),ao=function(e){function t(e){var n;L()(this,t),(n=V()(this,F()(t).call(this))).deleteCells=[],n.deleteRows=[],n.deleteRowNum=[],n.actionType=K.a.GRID_DELETE_ROW,n.commitAction=function(e,t,i){if(n.isDeleteItem)n.gridItem.unselectAllCell(),X.a.instance.dispatch(new An.a([n.gridItem]));else if(n.deleteRowNum.length>0){var a=n.deleteRowNum.slice().reverse(),o=!0,s=!1,r=void 0;try{for(var l,c=a[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;n.deleteCells.push(n.gridItem.cells[u].concat()),n.deleteRows.push(n.gridItem.rows[u]),n.gridItem.sizeTool.deleteRow(u)}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}var d=[],h=n.deleteRowNum[0];if(n.gridItem.row>h)for(var p=0;p<n.gridItem.cols.length;p++)d.push(new Ln.a(h,p));else for(var m=0;m<n.gridItem.cols.length;m++)d.push(new Ln.a(n.gridItem.row-1,m));n.gridItem.sizeTool.synchronizeCells(),n.gridItem.selectCells(d),n.gridItem.adjustSize(),n.gridItem.setStatus(qe.g.CHANGE),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)}},n.rollbackAction=function(e,t,i){var a=!0,o=!1,s=void 0;try{for(var r,l=n.deleteRowNum[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value;n.gridItem.sizeTool.insertRowWithRow(n.deleteRows.pop(),n.deleteCells.pop(),c)}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}n.gridItem.sizeTool.synchronizeCells(),n.gridItem.adjustSize(),n.gridItem.setStatus(qe.g.CHANGE),i.renderCanvas(e,t,[n.gridItem]),i.renderHandler(e,t)},n.recycle=function(){n.gridItem=null,n.deleteCellsPos=null,n.deleteCells=null,n.deleteRows=null},n.gridItem=e,n.deleteCellsPos=e.selectedCells;var i=!0,a=!1,o=void 0;try{for(var s,r=n.deleteCellsPos[Symbol.iterator]();!(i=(s=r.next()).done);i=!0)for(var l=s.value,c=n.gridItem.cells[l.row][l.col].childCellsPos,u=c.startPos.row;u<=c.endPos.row;u++)n.deleteRowNum.indexOf(u)<0&&n.deleteRowNum.push(u)}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}return n.deleteRowNum.sort(function(e,t){return e>t?1:e<t?-1:0}),n.deleteRowNum.length===n.gridItem.row&&(n.isDeleteItem=!0,n.doSaveQueue=!1),n.gridItem.unselectAllCell(),n}return z()(t,e),t}(kn),oo=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).actionType=K.a.GRID_CELL_BORDER,n.oldBorders=[],n.commitAction=function(e,t,i){var a=n.getBorders(n.selectedCells),o=!0,s=!1,r=void 0;try{for(var l,c=a[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;n.oldBorders.push(u.clone()),u.assign(n.srcBorder)}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}n.afterAction(e,t,i)},n.rollbackAction=function(e,t,i){for(var a=n.getBorders(n.selectedCells),o=0;o<a.length;o++){var s=a[o],r=n.oldBorders[o];s.assign(r)}n.afterAction(e,t,i)},n.recycle=function(){n.gridItem=void 0,n.srcBorder=void 0,n.oldBorders=void 0,n.selectedCells=void 0},n.gridItem=e,n.selectedCells=n.gridItem.selectedCells.length>0?n.gridItem.selectedCells:n.gridItem.everyCellsPos(),n.gridItem.props.updateBorder(),n.srcBorder=n.gridItem.props.border.clone(),n}return z()(t,e),w()(t,[{key:"afterAction",value:function(e,t,n){this.syncBorders(this.selectedCells),this.gridItem.adjustSize(),this.gridItem.setStatus(qe.g.CHANGE),n.renderCanvas(e,t,[this.gridItem]),n.renderHandler(e,t)}}]),t}(kn),so=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getBorders",value:function(e){var t=this.getBorderType();return this.getChangeCells(e).map(function(e){return e.getBorder(t)})}},{key:"syncBorders",value:function(e){var t=this.getBorderType();this.getChangeCells(e).forEach(function(e){return e.synchronizeBorder(e.getBorder(t))})}}]),t}(oo),ro=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getChangeCells",value:function(e){var t=this.gridItem.positionTool.arrayOfCellPosToCellsPos(e),n=this.gridItem.positionTool.getRectCells(t);return this.getChangeCellsFromRectCells(n)}}]),t}(so),lo=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getChangeCellsFromRectCells",value:function(e){return e.map(function(e){return e[0]})}},{key:"getBorderType",value:function(){return qa.a.LEFT}}]),t}(ro),co=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getChangeCellsFromRectCells",value:function(e){return e[0]}},{key:"getBorderType",value:function(){return qa.a.TOP}}]),t}(ro),uo=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getChangeCellsFromRectCells",value:function(e){var t=e[0].length;return e.map(function(e){return e[t-1]})}},{key:"getBorderType",value:function(){return qa.a.RIGHT}}]),t}(ro),ho=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getChangeCellsFromRectCells",value:function(e){return e[e.length-1]}},{key:"getBorderType",value:function(){return qa.a.BOTTOM}}]),t}(ro),po=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getChangeCells",value:function(e){return this.gridItem.positionTool.getCells(e)}}]),t}(so),mo=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getBorderType",value:function(){return qa.a.DOWNDIAGONAL}}]),t}(po),fo=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getBorderType",value:function(){return qa.a.UPDIAGONAL}}]),t}(po),vo=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getBorders",value:function(e){return this.getMultiBordersChangeParams(e).map(function(e){return e.getBorder()})}},{key:"syncBorders",value:function(e){this.getMultiBordersChangeParams(e).forEach(function(e){return e.getCell().synchronizeBorder(e.getBorder())})}}]),t}(oo),go=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getMultiBordersChangeParams",value:function(e){var t=this.gridItem.positionTool.arrayOfCellPosToCellsPos(e),n=this.gridItem.positionTool.getRectCells(t);return this.getMultiBordersChangeParamsWithRectCells(n)}}]),t}(vo),Eo=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getMultiBordersChangeParamsWithRectCells",value:function(e){var t=[],n=e.length,i=e[0].length;return e.map(function(e){return e[0]}).forEach(function(e){var n=e.getBorder(qa.a.LEFT);t.push(new Lo(e,n))}),e[0].forEach(function(e){var n=e.getBorder(qa.a.TOP);t.push(new Lo(e,n))}),e.map(function(e){return e[i-1]}).forEach(function(e){var n=e.getBorder(qa.a.RIGHT);t.push(new Lo(e,n))}),e[n-1].forEach(function(e){var n=e.getBorder(qa.a.BOTTOM);t.push(new Lo(e,n))}),t}}]),t}(go),yo=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getMultiBordersChangeParamsWithRectCells",value:function(e){var t=[],n=e[0].length;return e.forEach(function(e){e.filter(function(e,t){return t<n-1}).forEach(function(e){var n=e.getBorder(qa.a.RIGHT);t.push(new Lo(e,n))})}),t}}]),t}(go),To=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getMultiBordersChangeParamsWithRectCells",value:function(e){var t=[],n=e.length;return e.filter(function(e,t){return t<n-1}).forEach(function(e){e.forEach(function(e){var n=e.getBorder(qa.a.BOTTOM);t.push(new Lo(e,n))})}),t}}]),t}(go),Io=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getMultiBordersChangeParams",value:function(e){var t=[];return this.gridItem.positionTool.getCells(e).forEach(function(e){t.push(new Lo(e,e.getBorder(qa.a.LEFT))),t.push(new Lo(e,e.getBorder(qa.a.TOP))),t.push(new Lo(e,e.getBorder(qa.a.RIGHT))),t.push(new Lo(e,e.getBorder(qa.a.BOTTOM)))}),t}}]),t}(vo),Co=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).srcBorder.visible=!1,n}return z()(t,e),w()(t,[{key:"getMultiBordersChangeParams",value:function(e){var t=[];return this.gridItem.positionTool.getCells(e).forEach(function(e){t.push(new Lo(e,e.getBorder(qa.a.LEFT))),t.push(new Lo(e,e.getBorder(qa.a.TOP))),t.push(new Lo(e,e.getBorder(qa.a.RIGHT))),t.push(new Lo(e,e.getBorder(qa.a.BOTTOM))),t.push(new Lo(e,e.getBorder(qa.a.DOWNDIAGONAL))),t.push(new Lo(e,e.getBorder(qa.a.UPDIAGONAL)))}),t}}]),t}(vo);!function(e){e.LEFT="left",e.TOP="top",e.RIGHT="right",e.BOTTOM="bottom",e.DOWNDIAGONAL="downDiagonal",e.UPDIAGONAL="upDiagonal",e.INNERVER="innerVer",e.INNERHOR="innerHor",e.OUTER="outer",e.CROSS="cross",e.ALL="all",e.NONE="none"}(Ka||(Ka={}));var ko,Lo=function(){function e(t,n){L()(this,e),this.cell=t,this.border=n}return w()(e,[{key:"getCell",value:function(){return this.cell}},{key:"getBorder",value:function(){return this.border}}]),e}();(ko||(ko={})).createBorderChangeAction=function(e,t){switch(e){case Ka.LEFT:return new lo(t);case Ka.TOP:return new co(t);case Ka.RIGHT:return new uo(t);case Ka.BOTTOM:return new ho(t);case Ka.INNERHOR:return new To(t);case Ka.INNERVER:return new yo(t);case Ka.OUTER:return new Eo(t);case Ka.CROSS:return new K.c(function(){X.a.instance.groupingAction(function(){X.a.instance.dispatch(new To(t)),X.a.instance.dispatch(new yo(t))})});case Ka.DOWNDIAGONAL:return new mo(t);case Ka.UPDIAGONAL:return new fo(t);case Ka.ALL:return new Io(t);case Ka.NONE:return new Co(t);default:return}};var _o=function(){function e(t){L()(this,e),this.onChangeScrollY=t,this.makeAccordionCellBackground(),this.makeFontDefaultRows(),this.makeAccordionFontDetail(),this.makeFontColorRow(),this.makeCellManagementRow(),this.makeCellBorderRow(),this.makeTextSizeRow()}return w()(e,[{key:"makeMobileToolbox",value:function(){var e=this;this.toolTopContents=aa.a.makeToolboxTopContentsWrapper(),this.toolTopContents.appendChild(aa.a.makeButtonShowToolsRow("셀 편집",this.cellToolsRow)),this.toolTopContents.appendChild(aa.a.makeButtonShowToolsRow("셀 배경",this.accordionCellBackground)),this.toolTopContents.appendChild(aa.a.makeButtonShowToolsRow("셀 테두리",this.accordionCellBorder));var t=aa.a.makeFontShowToolsRow(this.fontFamilyRow,function(){return e.fontFamily.setActive(!0,!0)});this.selectedFont=document.createElement("div"),t.appendChild(this.selectedFont),this.toolTopContents.appendChild(t);var n=aa.a.makeFontSizeToolsRow(this.fontSizeRow);return this.selectedFontSize=document.createElement("div"),n.appendChild(this.selectedFontSize),this.toolTopContents.appendChild(n),this.toolTopContents.appendChild(this.fontColor.container),aa.a.setEventColorTool(this.fontColor,this.colorPickerRow),this.afterColorMenu=aa.a.makeButtonShowToolsRow("글자 정렬",this.textAlignRow),this.toolTopContents.appendChild(this.afterColorMenu),this.toolTopContents.appendChild(aa.a.makeButtonShowToolsRow("스타일",this.fontEtcRow)),this.toolTopContents.appendChild(aa.a.makeButtonShowToolsAccordionRow("글자 조정",this.accordionFontDetail)),this.toolTopContents}},{key:"changeFontSizeListByScale",value:function(e){var t=this.fontSize.menuList.slice();t.forEach(function(t){var n=Number(t.value),i=Math.round(n*e);t.value=i.toString()}),this.fontSize.updateUI({itemList:t,value:""})}},{key:"makeTextSizeRow",value:function(){var t=this,n=this.fontSizeRow=new ia.g;this.fontSizeRange=new Na.a(function(n){e.useTextItemCharPropMapper(st,n*yi.a.FONT_SIZE_RATIO,t.currentItem,!0,!1,function(){return e.renderEditText(t.currentItem)})},"글자 크기",1,999,1),n.add(this.fontSizeRange)}},{key:"makeAccordionCellBackground",value:function(){var t=this,n=(new ia.g).addCustomClass(r.a.ROW_GRID_COLOR);this.cellBackgroundColor=new Pa.a(function(n){return e.useCellPropMapper(t.currentItem,Ya,n,!0)},lt.icon,"셀 배경",!0,!0).addClass(r.a.ACCORDION_ROW_COLOR),n.add(this.cellBackgroundColor),this.accordionCellBackground=n}},{key:"makeFontDefaultRows",value:function(){var t=this;this.fontFamily=new Sa(this);this.fontSize=new Fa(function(n){e.useTextItemCharPropMapper(st,n*yi.a.FONT_SIZE_RATIO,t.currentItem,!0,!1,function(){return e.renderEditText(t.currentItem)})},Ca.FONTSIZE,x.a.getFontSizePresets(),!0,"","102px").setEditable(function(n){var i=parseFloat(n);return isNaN(i)?t.fontSize.selectedValue:(i=Math.round(10*i)/10,i=Math.min(i,e.MAX_FONT_SIZE),i=Math.max(i,e.MIN_FONT_SIZE),String(i))},!0,!0).setComparator(function(e,t){return Number(e.value)-Number(t.value)}),new Le.a(this.fontSize.container,Ge.a.T,{title:{name:"글자 크기"}}).renderView(),this.textBold=new xa(function(n){e.useTextItemCharPropMapper(dt,n,t.currentItem,!0,!1,function(){return e.renderEditText(t.currentItem)})},{icon:dt.icon}),new Le.a(this.textBold.container,Ge.a.TR,{title:{name:"굵게",shortcut:"Ctrl + B"}}).renderView(),this.textItalic=new xa(function(n){e.useTextItemCharPropMapper(ht,n,t.currentItem,!0,!1,function(){return e.renderEditText(t.currentItem)})},{icon:ht.icon}),new Le.a(this.textItalic.container,Ge.a.T,{title:{name:"기울임",shortcut:"Ctrl + I"}}).renderView(),this.textUnderline=new xa(function(n){e.useTextItemCharPropMapper(pt,n,t.currentItem,!0,!1,function(){return e.renderEditText(t.currentItem)})},{icon:pt.icon}),new Le.a(this.textUnderline.container,Ge.a.T,{title:{name:"밑줄",shortcut:"Ctrl + U"}}).renderView(),this.textStroke=new xa(function(n){e.useTextItemCharPropMapper(mt,n,t.currentItem,!0,!1,function(){return e.renderEditText(t.currentItem)})},{icon:mt.icon}),new Le.a(this.textStroke.container,Ge.a.T,{title:{name:"취소선",shortcut:"Alt + Shift + S"}}).renderView(),this.textUpperCase=new xa(function(n){return e.useTextPropMapper(t.currentItem,ft,n,!0,!0,function(){return e.renderSelectedText(t.currentItem)})},{icon:ft.icon}),new Le.a(this.textUpperCase.container,Ge.a.T,{title:{name:"대문자 변환",shortcut:"Ctrl + Shift + K"}}).renderView(),this.textAlign=new Ma(function(n){e.useTextPropMapper(t.currentItem,ct,n,!0,!0,function(){return e.renderSelectedText(t.currentItem)})},[{value:Ii.f.LEFT.toString(),icon:ne.ToolsIcon.FORMAT_ALIGN_LEFT},{value:Ii.f.CENTER.toString(),icon:ne.ToolsIcon.FORMAT_ALIGN_CENTER},{value:Ii.f.RIGHT.toString(),icon:ne.ToolsIcon.FORMAT_ALIGN_RIGHT}]),new Le.a(this.textAlign.container.children[0],Ge.a.TR,{title:{name:"왼쪽 정렬"}}).renderView(),new Le.a(this.textAlign.container.children[1],Ge.a.TR,{title:{name:"가운데 정렬"}}).renderView(),new Le.a(this.textAlign.container.children[2],Ge.a.T,{title:{name:"오른쪽 정렬"}}).renderView(),this.textVerticalAlign=new Ma(function(n){return e.useTextPropMapper(t.currentItem,ut,n,!0,!0,function(){return e.renderSelectedText(t.currentItem)})},[{value:Ii.g.TOP.toString(),icon:ne.ToolsIcon.VERTICAL_ALIGN_TOP},{value:Ii.g.CENTER.toString(),icon:ne.ToolsIcon.VERTICAL_ALIGN_CENTER},{value:Ii.g.BOTTOM.toString(),icon:ne.ToolsIcon.VERTICAL_ALIGN_BOTTOM}]),new Le.a(this.textVerticalAlign.container.children[0],Ge.a.TL,{title:{name:"상단 정렬"}}).renderView(),new Le.a(this.textVerticalAlign.container.children[1],Ge.a.TL,{title:{name:"중앙 정렬"}}).renderView(),new Le.a(this.textVerticalAlign.container.children[2],Ge.a.TL,{title:{name:"하단 정렬"}}).renderView();var n=(new ia.g).setFlex().addCustomClass(r.a.ROW_FONT_SIZE).setMarginTop(),i=(new ia.g).addCustomClass(r.a.ROW_FONT_DETAIL),a=(new ia.g).addCustomClass(r.a.ROW_TEXT_ALIGN).setBorderBottom(),o=new ia.f(100),s=new ia.f,l=(new ia.f).addCustomClass(r.a.COL_TEXT_COLOR),c=new ia.f,u=new ia.f;o.add(this.fontFamily),s.add(this.fontSize),l.add(this.textBold,this.textItalic,this.textUnderline,this.textStroke,this.textUpperCase),c.add(this.textAlign),u.add(this.textVerticalAlign),n.add(o),i.add(s,l),a.add(c,u),this.fontFamilyRow=n,this.fontEtcRow=i,this.textAlignRow=a}},{key:"onChangeAllSameFont",value:function(e){}},{key:"onSelectFont",value:function(t){var n=this,i=this.currentItem.positionTool.getCells(this.currentItem.selectedCells);0===i.length&&i.push.apply(i,Yn()(this.currentItem.positionTool.getCells(this.currentItem.everyCellsPos()))),i.some(function(e){return e.childTextItem.props.getFamily()!==t})&&e.useTextItemCharPropMapper(ot,t,this.currentItem,!0,!1,function(){return e.renderEditText(n.currentItem)})}},{key:"onActiveFontSelectView",value:function(){var e=this.fontFamilyRow.getContainer(),t=e.parentElement.parentElement,n=Math.min($(e).position().top-200,t.scrollHeight-t.clientHeight-t.scrollTop);this.fontFamily.setSearchViewHeight(.95*window.innerHeight-$(e).offset().top+Math.max(n,0)),n>0&&this.onChangeScrollY(t.scrollTop+n)}},{key:"makeAccordionFontDetail",value:function(){var t=this,n=new ia.c("글자 조정",null).setScrollStart(250).setFlex().setBorderBottom().addCustomClass(r.a.ROW_TEXT_DEFAULT,r.a.HIDDEN_LABEL);this.textSpace=new Na.a(function(n){e.useTextItemCharPropMapper(gt,n,t.currentItem,!0,!1,function(){return e.renderEditText(t.currentItem)})},"자간",Ti.a.MIN_TEXT_SPACE,Ti.a.MAX_TEXT_SPACE,1),this.lineSpace=new Na.a(function(n){e.useTextItemCharPropMapper(Et,n,t.currentItem,!0,!1,function(){return e.renderEditText(t.currentItem)})},"행간",.5,2.5,.01,"",function(e){return Ga.a.round(e,3)}),this.scaleX=new Na.a(function(n){e.useTextPropMapper(t.currentItem,yt,n,!0,!0,function(){return e.renderSelectedText(t.currentItem)})},"장평",50,200,1,"%"),n.add(this.textSpace),n.add(this.lineSpace),n.add(this.scaleX),this.accordionFontDetail=n}},{key:"makeFontColorRow",value:function(){var t=this,n=(new ia.g).setBorderBottom().addCustomClass(r.a.ROW_TEXT_COLOR);this.fontColor=new Pa.a(function(n){e.useTextItemCharPropMapper(rt,n,t.currentItem,!0,!1,function(){return e.renderEditText(t.currentItem)})},rt.icon,"글자색",!1,!0).addClass(r.a.FONT_COLOR),n.add(this.fontColor),this.fontColorRow=n,this.colorPickerRow=(new ia.g).addCustomClass(r.a.COLOR_PICKER_ROW)}},{key:"makeCellManagementRow",value:function(){var t=this;this.addRowPrev=new xa(function(){return X.a.instance.dispatch(new to(t.currentItem))},{icon:ne.ToolsIcon.ADD_ROW_PREV},null,"상단 행 추가").setPreventDefault(),e.appendTooltip(this.addRowPrev.container,Ge.a.T,{title:{name:"상단 행 추가하기"}}),this.addRowNext=new xa(function(){return X.a.instance.dispatch(new no(t.currentItem))},{icon:ne.ToolsIcon.ADD_ROW_NEXT},null,"하단 행 추가").setPreventDefault(),e.appendTooltip(this.addRowNext.container,Ge.a.T,{title:{name:"하단 행 추가하기"}}),this.addColumnPrev=new xa(function(){return X.a.instance.dispatch(new Ja(t.currentItem))},{icon:ne.ToolsIcon.ADD_COLUMN_PREV},null,"좌측 열 추가").setPreventDefault(),e.appendTooltip(this.addColumnPrev.container,Ge.a.T,{title:{name:"좌측 열 추가하기"}}),this.addColumnNext=new xa(function(){return X.a.instance.dispatch(new eo(t.currentItem))},{icon:ne.ToolsIcon.ADD_COLUMN_NEXT},null,"우측 열 추가").setPreventDefault(),e.appendTooltip(this.addColumnNext.container,Ge.a.T,{title:{name:"우측 열 추가하기"}}),this.removeRow=new xa(function(){return X.a.instance.dispatch(new ao(t.currentItem))},{icon:ne.ToolsIcon.REMOVE_ROW},null,"행 삭제").setPreventDefault(),e.appendTooltip(this.removeRow.container,Ge.a.T,{title:{name:"행 삭제하기"}}),this.removeColumn=new xa(function(){return X.a.instance.dispatch(new io(t.currentItem))},{icon:ne.ToolsIcon.REMOVE_COLUMN},null,"열 삭제").setPreventDefault(),e.appendTooltip(this.removeColumn.container,Ge.a.T,{title:{name:"열 삭제하기"}}),this.cellConcat=new xa(function(){return X.a.instance.dispatch(new $a(t.currentItem))},{icon:ne.ToolsIcon.CELL_CONCAT},null,"셀 합치기").setPreventDefault(),e.appendTooltip(this.cellConcat.container,Ge.a.T,{title:{name:"셀 합치기"}}),this.cellSplit=new xa(function(){return X.a.instance.dispatch(new Qa(t.currentItem))},{icon:ne.ToolsIcon.CELL_SPLIT},null,"셀 나누기").setPreventDefault(),e.appendTooltip(this.cellSplit.container,Ge.a.T,{title:{name:"셀 나누기"}}),this.cellDistributeVertical=new xa(function(){return X.a.instance.dispatch(new Za(t.currentItem))},{icon:ne.ToolsIcon.CELL_HEIGHT_EQUAL},null,"행 간격 균등").setPreventDefault(),e.appendTooltip(this.cellDistributeVertical.container,Ge.a.T,{title:{name:"행 간격 맞추기"}}),this.cellDistributeHorizon=new xa(function(){return X.a.instance.dispatch(new ja(t.currentItem))},{icon:ne.ToolsIcon.CELL_WIDTH_EQUAL},null,"열 간격 균등").setPreventDefault(),e.appendTooltip(this.cellDistributeHorizon.container,Ge.a.T,{title:{name:"열 간격 맞추기"}}),this.cellToolsRow=(new ia.g).addCustomClass(r.a.ROW_CELL_MANAGEMENT).setBorderBottom().add((new ia.f).addCustomClass(r.a.GRID_MANAGER_COL,r.a.GRID_FIRST_COL).add(this.addRowPrev,this.addRowNext),(new ia.f).addCustomClass(r.a.LINE,r.a.GRID_FIRST_LINE),(new ia.f).addCustomClass(r.a.GRID_MANAGER_COL,r.a.GRID_SECOND_COL).add(this.addColumnPrev,this.addColumnNext),(new ia.f).addCustomClass(r.a.LINE,r.a.GRID_SECOND_LINE),(new ia.f).addCustomClass(r.a.GRID_MANAGER_COL,r.a.GRID_LAST_COL).add(this.removeRow,this.removeColumn),(new ia.f).addCustomClass(r.a.GRID_MANAGER_COL,r.a.GRID_FIRST_COL,r.a.GRID_SECOND_ROW).add(this.cellConcat,this.cellSplit),(new ia.f).addCustomClass(r.a.LINE,r.a.GRID_FIRST_LINE,r.a.GRID_SECOND_ROW),(new ia.f).addCustomClass(r.a.GRID_MANAGER_COL,r.a.GRID_SECOND_COL,r.a.GRID_SECOND_ROW).add(this.cellDistributeHorizon,this.cellDistributeVertical),(new ia.f).addCustomClass(r.a.LINE,r.a.GRID_SECOND_LINE,r.a.GRID_SECOND_ROW))}},{key:"makeCellBorderRow",value:function(){var t=this,n=(new ia.g).addCustomClass(r.a.ROW_GRID_COLOR).setBorderTop().setBorderBottom().addCustomStyle("padding-bottom: 15px");this.cellBorderColor=new Pa.a(function(e){t.currentItem.props.setCellBorderColor(e),t.updateUI(t.currentItem)},lt.icon,"셀 테두리"),this.cellBorderThickness=new Na.a(function(e){return t.currentItem.props.setCellBorderThickness(e)},"두께",1,20,1),n.add(this.cellBorderColor),n.add(this.cellBorderThickness),this.noneBorders=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.NONE,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_NONE}),e.appendTooltip(this.noneBorders.container,Ge.a.T,{title:{name:"테두리 모두 지우기"}}),this.allBorders=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.ALL,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_ALL}),e.appendTooltip(this.allBorders.container,Ge.a.T,{title:{name:"모든 테두리 적용"}}),this.outerBorders=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.OUTER,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_OUTER}),e.appendTooltip(this.outerBorders.container,Ge.a.T,{title:{name:"바깥쪽 테두리 적용"}}),this.crossBorders=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.CROSS,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_CROSS}),new Le.a(this.crossBorders.container,Ge.a.T,{title:{name:"안쪽 테두리 적용"}}).renderView(),this.downDiagonalBorder=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.DOWNDIAGONAL,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_DOWN_DIAGONAL}),e.appendTooltip(this.downDiagonalBorder.container,Ge.a.T,{title:{name:"하향 대각선 테두리 적용"}}),this.upDiagonalBorder=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.UPDIAGONAL,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_UP_DIAGONAL}),e.appendTooltip(this.upDiagonalBorder.container,Ge.a.T,{title:{name:"상향 대각선 테두리 적용"}}),this.topBorder=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.TOP,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_TOP}),e.appendTooltip(this.topBorder.container,Ge.a.T,{title:{name:"위쪽 테두리 적용"}}),this.bottomBorder=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.BOTTOM,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_BOTTOM}),e.appendTooltip(this.bottomBorder.container,Ge.a.T,{title:{name:"아래쪽 테두리 적용"}}),this.leftBorder=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.LEFT,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_LEFT}),e.appendTooltip(this.leftBorder.container,Ge.a.T,{title:{name:"왼쪽 테두리 적용"}}),this.rightBorder=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.RIGHT,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_RIGHT}),e.appendTooltip(this.rightBorder.container,Ge.a.T,{title:{name:"오른쪽 테두리 적용"}}),this.innerHorBorders=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.INNERHOR,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_INNER_HOR}),e.appendTooltip(this.innerHorBorders.container,Ge.a.T,{title:{name:"안쪽 가로 테두리 적용"}}),this.innerVerBorders=new xa(function(e){return X.a.instance.dispatch(ko.createBorderChangeAction(Ka.INNERVER,t.currentItem))},{icon:ne.ToolsIcon.CELL_BORDER_INNER_VER}),e.appendTooltip(this.innerVerBorders.container,Ge.a.T,{title:{name:"안쪽 세로 테두리 적용"}});var i=(new ia.g).setFlex().addCustomClass(r.a.ROW_CELL_BORDER),a=(new ia.g).setFlex().addCustomClass(r.a.ROW_CELL_BORDER);i.add(this.noneBorders),i.add(this.allBorders),i.add(this.outerBorders),i.add(this.crossBorders),i.add(this.downDiagonalBorder),i.add(this.upDiagonalBorder),a.add(this.topBorder),a.add(this.bottomBorder),a.add(this.leftBorder),a.add(this.rightBorder),a.add(this.innerHorBorders),a.add(this.innerVerBorders),n.add(i),n.add(a),this.accordionCellBorder=n}},{key:"updateUI",value:function(e){var t,n=e.selectedCells;t=n.length>0?n[0]:new Ln.a(0,0);var i=e.cells[t.row][t.col],a=null,o=null;if(e.isTextEditMode){var s=e.editingCell.childTextItem.getSelectionRange();a=s.start.getCopy(),o=s.end.getCopy(),a.col===o.col&&a.row===o.row&&(0===a.col?o.col+=1:a.col-=1)}this.cellBackgroundColor.updateUI({value:i.cellProps.getCellBackgroundColor(),active:!0}),this.cellBorderColor.updateUI({value:e.props.getCellBorderColor(),active:!0}),this.cellBorderThickness.updateUI({value:e.props.getCellBorderThickness(),active:!0});var r=i.textProps.getSize(a,o);if(!Number.isNaN(r)){var l=Math.round(r/yi.a.FONT_SIZE_RATIO*10)/10;this.fontSize.updateUI({value:"".concat(l)}),this.selectedFontSize.innerText="".concat(l),this.fontSizeRange.updateUI({value:l})}this.fontFamily.renderView(i.textProps.getFamily()),this.selectedFont.innerText=i.textProps.getFamily(a,o),this.textBold.updateUI({isSelected:i.textProps.isBold(a,o)}),this.textItalic.updateUI({isSelected:i.textProps.isItalic(a,o)}),this.textUnderline.updateUI({isSelected:i.textProps.isUnderline(a,o)}),this.textStroke.updateUI({isSelected:i.textProps.isStrikeout(a,o)}),this.textUpperCase.updateUI({isSelected:i.textProps.isUpperCase()}),this.fontColor.updateUI({value:i.textProps.getColor(a,o)}),this.textAlign.updateUI({value:i.textProps.getHorizontalAlign().toString()}),this.textVerticalAlign.updateUI({value:i.textProps.getVerticalAlign().toString()}),this.accordionFontDetail.updateUI(i.textProps.isActiveFontDetail()),this.textSpace.updateUI({value:i.textProps.getFontDetailTextSpace(!0),active:i.textProps.isActiveFontDetail()}),this.lineSpace.updateUI({value:i.textProps.getFontDetailLineSpace(!0),active:i.textProps.isActiveFontDetail()}),this.scaleX.updateUI({value:i.textProps.getFontDetailScaleX(!0),active:i.textProps.isActiveFontDetail()}),this.accordionCellBorder.updateUI(!0);var c=!it.a.isEmpty(n);this.updateUIToggleButton(this.addRowPrev,c),this.updateUIToggleButton(this.addRowNext,c),this.updateUIToggleButton(this.addColumnPrev,c),this.updateUIToggleButton(this.addColumnNext,c);var u=n.length>1&&e.positionTool.isRectSelectedCells(n)&&!e.positionTool.isCellsPosEqual(e.positionTool.arrayOfCellPosToCellsPos(n),e.cells[n[0].row][n[0].col].childCellsPos);this.updateUIToggleButton(this.cellConcat,u);var d=n.length>0&&e.positionTool.getCells(n).some(function(e){return e.childCellsPos.endPos.row!==e.row||e.childCellsPos.endPos.col!==e.col});this.updateUIToggleButton(this.cellSplit,d);var h=n.length>0,p=!1,m=!0,f=!1,v=void 0;try{for(var g,E=n[Symbol.iterator]();!(m=(g=E.next()).done);m=!0){for(var y=g.value.row,T=0;T<e.cols.length;T++){var I=e.cells[y][T];if(I.cellType===qa.b.MASTER&&!I.selected){p=!0;break}}if(p)break}}catch(e){f=!0,v=e}finally{try{m||null==E.return||E.return()}finally{if(f)throw v}}this.updateUIToggleButton(this.removeRow,h&&!p);var C=n.length>0,k=!1,L=!0,_=!1,w=void 0;try{for(var S,b=n[Symbol.iterator]();!(L=(S=b.next()).done);L=!0){for(var R=S.value.col,A=0;A<e.rows.length;A++){var O=e.cells[A][R];if(O.cellType===qa.b.MASTER&&!O.selected){k=!0;break}}if(k)break}}catch(e){_=!0,w=e}finally{try{L||null==b.return||b.return()}finally{if(_)throw w}}this.updateUIToggleButton(this.removeColumn,C&&!k);var P=e.positionTool.isRectSelectedCells(n);this.updateUIToggleButton(this.outerBorders,P),this.updateUIToggleButton(this.crossBorders,P),this.updateUIToggleButton(this.topBorder,P),this.updateUIToggleButton(this.leftBorder,P),this.updateUIToggleButton(this.bottomBorder,P),this.updateUIToggleButton(this.rightBorder,P),this.updateUIToggleButton(this.innerHorBorders,P),this.updateUIToggleButton(this.innerVerBorders,P)}},{key:"updateUIToggleButton",value:function(e,t){e.updateUI({active:t,isSelected:!1}),t?e.container.classList.remove("inactive"):e.container.classList.add("inactive")}},{key:"makeToolboxRowContents",value:function(){return[{row:this.cellToolsRow,priority:490,viewType:0},{row:this.accordionCellBackground,priority:530,viewType:0},{row:this.accordionCellBorder,priority:540,viewType:0},{row:this.fontFamilyRow,priority:550,viewType:0},{row:this.fontEtcRow,priority:560,viewType:0},{row:this.textAlignRow,priority:570,viewType:0},{row:this.fontColorRow,priority:580,viewType:0},{row:this.accordionFontDetail,priority:590,viewType:0},{row:this.fontSizeRow,priority:600,viewType:0},{row:this.colorPickerRow,priority:610,viewType:0}]}},{key:"updateToolboxRowContents",value:function(e,t){var n=t.renderedItem&&t.renderedItem instanceof Z.a;this.accordionCellBackground.rowVisible=n&&!t.isAdminEditView,this.accordionCellBorder.rowVisible=n&&!t.isAdminEditView,this.cellToolsRow.rowVisible=n&&!t.isAdminEditView,this.fontFamilyRow.rowVisible=n&&!t.isAdminEditView,this.fontEtcRow.rowVisible=n&&!t.isAdminEditView,this.fontSizeRow.rowVisible=n&&!t.isAdminEditView&&je.a.isMobilePortraitSize(),this.colorPickerRow.rowVisible=n&&!t.isAdminEditView&&je.a.isMobilePortraitSize(),this.textAlignRow.rowVisible=n&&!t.isAdminEditView,this.accordionFontDetail.rowVisible=n&&!t.isAdminEditView,this.fontColorRow.rowVisible=n&&!t.isAdminEditView&&!je.a.isMobilePortraitSize(),je.a.isMobilePortraitSize()?(this.toolTopContents.insertBefore(this.fontColor.container,this.afterColorMenu),this.fontColor.canNotAppend=!0):(this.fontColorRow.container.appendChild(this.fontColor.container),this.fontColor.canNotAppend=!1);var i=n&&!t.isAdminEditView&&!t.renderedItem.isLock();return aa.a.setContentsVisible(this.toolTopContents,i),n?(this.currentItem=t.renderedItem,this.updateUI(this.currentItem)):this.currentItem=null,!0}}],[{key:"useGridPropMapper",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];X.a.instance.dispatch(new Xa(e,Z.b.GRID,t.actionType,t.groupName,t.name,n,i,t.timeout,!1))}},{key:"useCellPropMapper",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];X.a.instance.dispatch(new Xa(e,Z.b.CELL,t.actionType,t.groupName,t.name,n,i,t.timeout))}},{key:"useTextPropMapper",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;X.a.instance.dispatch(new Xa(e,Z.b.TEXT,t.actionType,t.groupName,t.name,n,i,t.timeout,a,o))}},{key:"useTextItemCharPropMapper",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;if(n.isTextEditMode){var s=n.editingCell.childTextItem.getSelectionRange();n.isTextEditMode&&(s.start.col!==s.end.col||s.start.row!==s.end.row||a)?X.a.instance.dispatch(new Un.a(n,e.actionType,e.groupName,e.name,t,i,e.timeout,!0,s.start,s.end,n.editingCell.childTextItem,o)):X.a.instance.dispatch(new Un.a(n,e.actionType,e.groupName,e.name,t,i,e.timeout,!0,null,null,n.editingCell.childTextItem,o))}else{var r=n.positionTool.getCells(n.selectedCells);0===r.length&&r.push.apply(r,Yn()(n.positionTool.getCells(n.everyCellsPos()))),X.a.instance.groupingAction(function(){var a=!0,s=!1,l=void 0;try{for(var c,u=r[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var d=c.value;X.a.instance.dispatch(new Un.a(n,e.actionType,e.groupName,e.name,t,i,e.timeout,!1,null,null,d.childTextItem,o))}}catch(e){s=!0,l=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw l}}})}}},{key:"appendTooltip",value:function(e,t,n){new Le.a(e,t,n).renderView(),new Le.a(e,t,n,null,{atDisable:!0}).renderView()}},{key:"renderEditText",value:function(t){if(t.isTextEditMode){var n=Y.a.instance.pageController.getItemRenderer(t),i=t.editingCell;n.getCellRenderers(i).renderText(1)}else e.renderSelectedText(t)}},{key:"renderSelectedText",value:function(e){var t,n=e.selectedCells;if(n.length>0){var i=e.positionTool.arrayOfCellPosToCellsPos(n);t=e.positionTool.getRectCells(i)}else t=e.cells;var a=Y.a.instance.pageController.getItemRenderer(e),o=!0,s=!1,r=void 0;try{for(var l,c=t[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value,d=!0,h=!1,p=void 0;try{for(var m,f=u[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var v=m.value;a.getCellRenderers(v).renderText(1)}}catch(e){h=!0,p=e}finally{try{d||null==f.return||f.return()}finally{if(h)throw p}}}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}}}]),e}();_o.MAX_FONT_SIZE=300,_o.MIN_FONT_SIZE=1;var wo=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ONE_TIME,n.doSaveQueue=!1,n.renderAuto=!1,n.changeDesign=function(){return!1},n.commitAction=function(e,n,i){S.a.getEditorOpenOption().hasOption()&&(t.updateFontSizeListByPageSize(i,n.option.pageSize),C.a.setExtraOption({copyWithCurrentTask:!S.a.getEditorOpenOption().hasKeyToLoadDesign()}))},n.rollbackAction=function(){},n.recycle=function(){},n}return z()(t,e),w()(t,null,[{key:"updateFontSizeListByPageSize",value:function(e,t){if(t.unit!==De.a.PX){var n=De.a.changeUnit(t.width,t.unit,De.a.MM),i=De.a.changeUnit(t.height,t.unit,De.a.MM),a=this.getScaleBySizeRange(Math.max(n,i));if(1!==a){var o=e.itemToolsRenderer.getToolRenderers().find(function(e){return e instanceof Ha}),s=e.itemToolsRenderer.getToolRenderers().find(function(e){return e instanceof _o});o.changeFontSizeListByScale(a),s.changeFontSizeListByScale(a)}}}},{key:"getScaleBySizeRange",value:function(e){return 500<e&&e<=1e3?3:e>1e3?8:1}}]),t}(K.b),So=n(232),bo=n(523),Ro=n(28),Ao=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).isReadyShowRelogin=!1,n}var n;return z()(t,e),w()(t,[{key:"keepAliveSession",value:(n=s()(a.a.mark(function e(){var n,i,o=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(o.length>0&&void 0!==o[0])||o[0],e.next=3,Ro.a.fetchSessionAccountId();case 3:i=e.sent,Ke.a.getUserSetting().devMode&&console.log("current acocuntId: ",i),f.a.getUser().isLogin()&&i===v.b.GUEST_ACCOUNT?this.isReadyShowRelogin?bo.a.instance.open(f.a.getUser().accountId):this.isReadyShowRelogin=!0:this.isReadyShowRelogin=!1,n&&setTimeout(this.keepAliveSession.bind(this),t.ALIVE_POLLING_TERM);case 7:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})}]),t}(dn.a);Ao.ALIVE_POLLING_TERM=18e4;var Oo,Po=new Ao,Do=n(86),Mo=n(43),No=n(27),xo=n(329),Bo=function(){function e(t){L()(this,e),t=t||{},this.logo=t.logo||"MIRI.DIH",this.partnerId=t.partnerId||"miridih",this.showDesignGuide=!0===t.showDesignGuide,this.showPhotoGuide=!0===t.showPhotoGuide,this.showPrintOutGuide=!0===t.showPrintOutGuide,this.showPageMaskGuide=!0===t.showPageMaskGuide,this.showSnapLIne=!0,this.showElementBordersInGroup=!1,this.isCsMode=t.csMode,this.initSizeOptionFromUrlParam()}return w()(e,[{key:"initByDesignBean",value:function(e){if(!d.b.isEmpty(e.sizeOption)){var t=Mo.a.createFromObject(JSON.parse(e.sizeOption)),n=e.pageList[0];t.unit!==De.a.PX||t.isSamePixel(n.width,n.height,xo.a.getMaxSheetSize(!0))?this.pageSize=t:(console.log("잘못된 사이즈 옵션값을 초기화합니다"),this.pageSize=new Mo.a(n.width,n.height,De.a.PX))}}},{key:"initSizeByMeta",value:function(e){var t=e.pages[0].sheetSize;this.pageSize=new Mo.a(t.width,t.height,De.a.PX,Mo.a.DEFAULT_DPI)}},{key:"equalsSizeOption",value:function(e){var t=this.pageSize;return t.dpi===e.dpi&&t.unit===e.unit&&t.width===e.width&&t.height===e.height}},{key:"getPixelByDefaultDpi",value:function(e){return De.a.getPixel(e,Mo.a.DEFAULT_DPI,this.pageSize.unit)}},{key:"initSizeOptionFromUrlParam",value:function(){var e=No.c.get(No.b.SIZE_UNIT),t=Number(No.c.get(No.b.DPI));if(!(!e||isNaN(t)||t<=0)){var n=Number(No.c.get(No.b.SHEET_W)),i=Number(No.c.get(No.b.SHEET_H)),a=De.a.getMaxDecimalPlaces(e)+1;this.pageSize=new Mo.a(Ga.a.round(De.a.getSizeFromPixel(n,t,e),a),Ga.a.round(De.a.getSizeFromPixel(i,t,e),a),e,t)}}}]),e}(),Vo=function(){function e(){L()(this,e)}return w()(e,null,[{key:"initSampleLauncherParameter",value:function(){}},{key:"getSampleLauncherParameter",value:function(){return this.sampleLauncherParameter||this.initSampleLauncherParameter(),this.sampleLauncherParameter}}]),e}(),Uo=new(function(){function e(){L()(this,e)}var t,n,i,o,r,l,c,u,d;return w()(e,[{key:"initEditorOption",value:function(e){this.option=new Bo(e)}},{key:"setListener",value:function(e){this.listener=e}},{key:"setPrintoutGuideVisibility",value:function(e){return this.option.showPrintOutGuide!==e&&(this.option.showPrintOutGuide=e,this.listener&&this.listener.onSetPrintoutGuideVisibility(e),!0)}},{key:"loadEditorOption",value:(d=s()(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.editorInitType,e.next="BLANK"===e.t0?3:"USER_DESIGN"===e.t0?4:"DESIGN_PROJECT"===e.t0?5:"LAUNCHER_GET"===e.t0?6:"LAUNCHER_POST"===e.t0?7:8;break;case 3:return e.abrupt("return",this.loadBlank(t));case 4:return e.abrupt("return",this.loadUserDesign(t,n));case 5:return e.abrupt("return",this.loadProject(t,n));case 6:return e.abrupt("return",this.loadGETLauncher(t,n));case 7:return e.abrupt("return",this.loadPOSTLauncher(t,n));case 8:return e.abrupt("return",this.neverLoad(n.editorInitType));case 9:case"end":return e.stop()}},e,this)})),function(e,t){return d.apply(this,arguments)})},{key:"neverLoad",value:function(e){throw new Error("유효하지 않은 타입: ".concat(e))}},{key:"loadBlank",value:(u=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce.b.get(t);case 2:return n=e.sent.data,e.abrupt("return",{editorConfig:n.editorConfig,unicornProfile:n.profile});case 4:case"end":return e.stop()}},e)})),function(e){return u.apply(this,arguments)})},{key:"loadUserDesign",value:(c=s()(a.a.mark(function e(t,n){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.designKey,e.prev=1,e.next=4,ce.b.get(t,{data:{designKey:i}});case 4:o=e.sent.data,e.next=20;break;case 7:if(e.prev=7,e.t0=e.catch(1),!(e.t0 instanceof p.a)){e.next=19;break}if(!e.t0.isForbidden()){e.next=14;break}window.open("/v/".concat(i),"_self"),e.next=19;break;case 14:if(!e.t0.isNotFound()){e.next=18;break}window.open("".concat(location.href,"/notfound"),"_self"),e.next=19;break;case 18:throw e.t0;case 19:return e.abrupt("return");case 20:return e.abrupt("return",{editorConfig:o.editorConfig,unicornProfile:o.profile,designData:{repositoryType:Do.a.UNICORN,idx:o.designIdx},designHistoryExtraData:o.designHistoryExtraData,designHistoryExtraDataLatest:o.designHistoryExtraDataLatest});case 21:case"end":return e.stop()}},e,null,[[1,7]])})),function(e,t){return c.apply(this,arguments)})},{key:"loadProject",value:(l=s()(a.a.mark(function e(t,n){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.projectKey,e.next=3,ce.b.get(t,{data:{projectKey:i}});case 3:return o=e.sent.data,e.abrupt("return",{editorConfig:o.editorConfig,unicornProfile:o.profile,designProjectData:{idx:o.projectIdx}});case 5:case"end":return e.stop()}},e)})),function(e,t){return l.apply(this,arguments)})},{key:"loadPOSTLauncher",value:(r=s()(a.a.mark(function e(t,n){var i,o,s,r,l,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.launcherParameter.launcherParam,o=n.launcherParameter.authorization,s=n.launcherParameter.process,r=n.launcherParameter.processR,e.next=6,ce.b.post(t,{data:{launcherParameter:JSON.stringify(i),authorization:o,process:s,r:r}});case 6:return"SUCCESS"!==(l=e.sent).resultCode&&this.reportGALauncherError(l.resultCode,l.messageCode),c=l.data,e.abrupt("return",{editorConfig:c.editorConfig,unicornProfile:c.profile,launcherParameter:i});case 10:case"end":return e.stop()}},e,this)})),function(e,t){return r.apply(this,arguments)})},{key:"loadGETLauncher",value:(o=s()(a.a.mark(function e(t,n){var i,o,s,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.process,o=n.processR,e.next=4,ce.b.post(t,{data:{process:i,r:o}});case 4:s=e.sent.data;try{r=JSON.parse(s.launcherParameter)}catch(e){r=s.launcherParameter}return e.abrupt("return",{editorConfig:s.editorConfig,unicornProfile:s.profile,launcherParameter:r});case 7:case"end":return e.stop()}},e)})),function(e,t){return o.apply(this,arguments)})},{key:"reportGALauncherError",value:function(e,t){Te.a.sendEvent("로그체크","비즈에디터실행.실패.백","오류타입.[[".concat(e,"]].오류로그[[").concat(t,"]]"))}},{key:"fetchData",value:(i=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadEditorServerConfig("/api/front/editor-config",t);case 2:return(n=e.sent).launcherParameter=Vo.getSampleLauncherParameter()||n.launcherParameter,e.abrupt("return",n);case 6:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"loadEditorServerConfig",value:(n=s()(a.a.mark(function e(t,n){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i="LAUNCHER_POST"===n.editorInitType,e.prev=1,e.next=4,this.loadEditorOption(t,n);case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),console.log("오류",e.t0),!i){e.next=14;break}return e.next=13,this.retryFetchData(n,t);case 13:return e.abrupt("return",e.sent);case 14:return alert("디자인 로드 중 에러가 발생하였습니다.\n빈 페이지를 로드합니다."),n.editorInitType="BLANK",e.next=18,this.loadEditorOption(t,n);case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}},e,this,[[1,7]])})),function(e,t){return n.apply(this,arguments)})},{key:"retryFetchData",value:(t=s()(a.a.mark(function e(t,n){var i=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){window.setTimeout(s()(a.a.mark(function o(){return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.t0=e,a.next=4,i.loadEditorOption(n,t);case 4:a.t1=a.sent,(0,a.t0)(a.t1),a.next=13;break;case 8:a.prev=8,a.t2=a.catch(0),i.reportGALauncherRunError(a.t2),alert("일시적으로 오류가 발생하였습니다.\n다시 시도해 주세요."),window.history.back();case 13:case"end":return a.stop()}},o,null,[[0,8]])})),5e3)}));case 1:case"end":return e.stop()}},e)})),function(e,n){return t.apply(this,arguments)})},{key:"reportGALauncherRunError",value:function(e){Te.a.sendEvent("로그체크","비즈에디터실행.실패.초기화","오류타입.[[API 오류]].오류로그.[[".concat(e,"]]"))}}]),e}()),Fo=n(61),Go=n(23),Ho=n(18),Wo=n(117),zo=n(81),Ko=new(function(){function e(){L()(this,e)}return w()(e,[{key:"openPopup",value:function(){this.popup||(this.popup=new zo.a(this.makeParam(),Wo.a.getNotificationPusher(),7e3)),this.popup.closeInstantly(),this.popup.open()}},{key:"open",value:function(){"true"!==Go.b.getCookie(Go.a.CHROME_RECOMMEND_NOTICE)&&(je.a.getBrowserType()===Ho.h.WHALE||je.a.isChromeBrowser()||je.a.isMobileDevice()||this.openPopup())}},{key:"makeParam",value:function(){var e=this,t=document.createElement("span");t.className="type_wrapper",t.classList.add(zo.b.CUSTOM);var n=document.createElement("object");n.data="https://resource.miricanvas.com/image/argo/argo_come_here.svg",n.type="image/svg+xml",n.className="popup_image",t.appendChild(n);var i=document.createElement("div");i.className="content",i.innerText="미리캔버스 에디터는 크롬 브라우저에 최적화 되어 있어요. ";var a=document.createElement("a");return a.href="https://www.google.com/intl/ko/chrome/",a.innerText="크롬 브라우저 설치하기",i.appendChild(a),{type:zo.b.CUSTOM,customTypeElement:t,customContentElement:i,title:"크롬 브라우저 사용을 권장해요.",footerRightText:"당분간 보지 않기",footerLeftText:"응, 알겠어 ",onClickFooterRightTextListener:function(){Go.b.setCookie(Go.a.CHROME_RECOMMEND_NOTICE,"true",7,0,0),e.popup.close()}}}}]),e}()),Yo=n(39),Xo=n(307),jo=function(){function e(){L()(this,e),this.makeMobileAlertBtn()}return w()(e,[{key:"getMobileAlertBtn",value:function(){return this.mobileAlertBtn}},{key:"setForceDisabled",value:function(e){this.forceDisabled=e}},{key:"setPrintoutAlertBtnClickListener",value:function(e){this.printoutAlertBtnClickListener=e}},{key:"showUnsupportedLicenseAlert",value:function(e,t){e?(this.unsupportedLicenseAlertBtn.classList.add(r.a.ACTIVE),this.unsupportedItemType=t):(this.unsupportedLicenseAlertBtn.classList.remove(r.a.ACTIVE),this.showPrintoutAlertBtn(!1))}},{key:"isShowUnsupportedLicenseAlertBtn",value:function(){return this.unsupportedLicenseAlertBtn.classList.contains(r.a.ACTIVE)}},{key:"showPrintoutAlertBtn",value:function(e,t){!this.forceDisabled&&e&&t&&!this.isShowUnsupportedLicenseAlertBtn()?(this.printoutAlertBtn.classList.add(r.a.ACTIVE),this.tbpeId=t):this.printoutAlertBtn.classList.remove(r.a.ACTIVE)}},{key:"makeLabel",value:function(e){var t=document.createElement("div");return t.classList.add("mobile_alert_button_label"),t.innerText=e,t}},{key:"makePrintoutAlertBtn",value:function(){var e=this,t=this.printoutAlertBtn=document.createElement("div");return t.classList.add("printout_alert"),Object(ne.setToolsIcon)(t,ne.ToolsIcon.ERROR),t.appendChild(this.makeLabel("확인해주세요")),t.addEventListener("touchend",function(t){t.stopPropagation(),t.preventDefault(),e.printoutAlertBtnClickListener&&e.tbpeId&&e.printoutAlertBtnClickListener(e.tbpeId)}),t}},{key:"makeUnsupportedLicenseAlertBtn",value:function(){var e=this,t=this.unsupportedLicenseAlertBtn=document.createElement("div");t.classList.add("unsupported_license_alert");var n=document.createElement("div");return n.className="unsupported_license_alert_icon",t.appendChild(n),t.appendChild(this.makeLabel("미지원 요소")),t.addEventListener("touchend",function(t){t.stopPropagation(),t.preventDefault(),Xo.c.showPusher(e.unsupportedItemType)}),t}},{key:"makeMobileAlertBtn",value:function(){var e=this.mobileAlertBtn=document.createElement("div");e.classList.add("mobile_alert_button"),e.appendChild(this.makePrintoutAlertBtn()),e.appendChild(this.makeUnsupportedLicenseAlertBtn())}}]),e}(),Zo=n(316),qo=n(337),$o=n(306),Qo=n(286),Jo=n(388);!function(e){var t=e.SNAP_TERM=10,n=t;function i(e){n=t/e}function a(e,t,n,i,a,s,r){var l=s.ltrb;if(s.type===Jo.a.GUIDELINE)return o(e,t,i,a,$e.c.LEFT,l.left,$e.c.LEFT,r)||o(e,n,i,a,$e.c.LEFT,l.left,$e.c.RIGHT,r);var c=(t+n)/2,u=l.getCenterPos().x;return o(e,t,i,a,$e.c.LEFT,l.left,$e.c.LEFT,r)||o(e,n,i,a,$e.c.LEFT,l.left,$e.c.RIGHT,r)||o(e,c,i,a,$e.c.LEFT,l.left,$e.c.CENTER_X,r)||o(e,t,i,a,$e.c.CENTER_X,u,$e.c.LEFT,r)||o(e,n,i,a,$e.c.CENTER_X,u,$e.c.RIGHT,r)||o(e,c,i,a,$e.c.CENTER_X,u,$e.c.CENTER_X,r)||o(e,t,i,a,$e.c.RIGHT,l.right,$e.c.LEFT,r)||o(e,n,i,a,$e.c.RIGHT,l.right,$e.c.RIGHT,r)||o(e,c,i,a,$e.c.RIGHT,l.right,$e.c.CENTER_X,r)}function o(e,t,n,i,a,o,s,r){var c=l(r);if(e<0){if(n<0)return(n-=e)>0?n=0:e=0,{moveX:e,snapTerm:n,useOldSnapData:!0};if(o<=t&&t-c<o){var u=o-t;return{moveX:e+=u,snapTerm:n=u,useOldSnapData:!1,line:s,targetIndex:i,targetLine:a}}return n>0?{moveX:e-n,snapTerm:0,useOldSnapData:!0}:null}if(n>0)return(n-=e)<0?n=0:e=0,{moveX:e,snapTerm:n,useOldSnapData:!0};if(t<=o&&o-c<t){var d=o-t;return{moveX:e+=d,snapTerm:n=d,useOldSnapData:!1,line:s,targetIndex:i,targetLine:a}}return n<0?{moveX:e-n,snapTerm:0,useOldSnapData:!0}:null}function s(e,t,n,i,a,o,s){var l=o.ltrb;if(o.type===Jo.a.GUIDELINE)return r(e,t,i,a,$e.c.TOP,l.top,$e.c.TOP,s)||r(e,n,i,a,$e.c.TOP,l.top,$e.c.BOTTOM,s);var c=(t+n)/2,u=l.getCenterPos().y;return r(e,t,i,a,$e.c.TOP,l.top,$e.c.TOP,s)||r(e,n,i,a,$e.c.TOP,l.top,$e.c.BOTTOM,s)||r(e,c,i,a,$e.c.TOP,l.top,$e.c.CENTER_Y,s)||r(e,t,i,a,$e.c.CENTER_Y,u,$e.c.TOP,s)||r(e,n,i,a,$e.c.CENTER_Y,u,$e.c.BOTTOM,s)||r(e,c,i,a,$e.c.CENTER_Y,u,$e.c.CENTER_Y,s)||r(e,t,i,a,$e.c.BOTTOM,l.bottom,$e.c.TOP,s)||r(e,n,i,a,$e.c.BOTTOM,l.bottom,$e.c.BOTTOM,s)||r(e,c,i,a,$e.c.BOTTOM,l.bottom,$e.c.CENTER_Y,s)}function r(e,t,n,i,a,o,s,r){var c=l(r);if(e<0){if(n<0)return(n-=e)>0?n=0:e=0,{moveY:e,snapTerm:n,useOldSnapData:!0};if(o<t&&t-c<=o){var u=o-t;return{moveY:e+=u,snapTerm:n=u,useOldSnapData:!1,line:s,targetIndex:i,targetLine:a}}return n>0?{moveY:e-n,snapTerm:0,useOldSnapData:!0}:null}if(n>0)return(n-=e)<0?n=0:e=0,{moveY:e,snapTerm:n,useOldSnapData:!0};if(t<o&&o-c<=t){var d=o-t;return{moveY:e+=d,snapTerm:n=d,useOldSnapData:!1,line:s,targetIndex:i,targetLine:a}}return n<0?{moveY:e-n,snapTerm:0,useOldSnapData:!0}:null}function l(e){return e?1:n}function c(e,t,n,i,a,s,r){var l=a.ltrb;return a.type===Jo.a.GUIDELINE?o(e,t,n,i,$e.c.LEFT,l.left,s,r):o(e,t,n,i,$e.c.LEFT,l.left,s,r)||o(e,t,n,i,$e.c.CENTER_X,l.getCenterPosX(),s,r)||o(e,t,n,i,$e.c.RIGHT,l.right,s,r)}function u(e,t,n,i,a,o,s){var l=a.ltrb;return a.type===Jo.a.GUIDELINE?r(e,t,n,i,$e.c.TOP,l.top,o,s):r(e,t,n,i,$e.c.TOP,l.top,o,s)||r(e,t,n,i,$e.c.CENTER_Y,l.getCenterPosY(),o,s)||r(e,t,n,i,$e.c.BOTTOM,l.bottom,o,s)}e.doSnapMove=function(e,t,n,o,r){if(0!==e.x||0!==e.y){i(t);var l=o.lineX,c=o.lineY,u=o.targetIndexX,d=o.targetIndexY,h=o.targetLineX,p=o.targetLineY;n.move(e.x,e.y);var m=n.left,f=n.top,v=n.right,g=n.bottom,E=0!==e.x,y=0!==e.y,T=0,I=!0,C=!1,k=void 0;try{for(var L,_=o.list[Symbol.iterator]();!(I=(L=_.next()).done);I=!0){var w=L.value;if(E){var S=a(e.x,m,v,o.dx,T,w,r);S&&(e.x=S.moveX,o.dx=S.snapTerm,o.lineX=null!=S.line?S.line:l,o.targetIndexX=null!=S.targetIndex?S.targetIndex:u,o.targetLineX=null!=S.targetLine?S.targetLine:h,o.targetTypeX=S.useOldSnapData?o.targetTypeX:w.type,o.isFromKeyAction=r,E=!1)}if(y){var b=s(e.y,f,g,o.dy,T,w,r);b&&(e.y=b.moveY,o.dy=b.snapTerm,o.lineY=null!=b.line?b.line:c,o.targetIndexY=null!=b.targetIndex?b.targetIndex:d,o.targetLineY=null!=b.targetLine?b.targetLine:p,o.targetTypeY=b.useOldSnapData?o.targetTypeY:w.type,o.isFromKeyAction=r,y=!1)}if(!E&&!y)break;T++}}catch(e){C=!0,k=e}finally{try{I||null==_.return||_.return()}finally{if(C)throw k}}E&&(o.dx=0,o.lineX=$e.c.NONE,o.targetIndexX=-1,o.targetLineX=$e.c.NONE,o.targetTypeX=Jo.a.NONE),y&&(o.dy=0,o.lineY=$e.c.NONE,o.targetIndexY=-1,o.targetLineY=$e.c.NONE,o.targetTypeY=Jo.a.NONE)}},e.doSnapResize=function(e,t,n,a,o,s,r){if(!function(e){return e===$e.b.TOP_LEFT||e===$e.b.TOP_RIGHT||e===$e.b.BOTTOM_RIGHT||e===$e.b.BOTTOM_LEFT}(e)||n){var l,d,h,p;switch(i(o),e){case $e.b.LEFT:l=$e.c.LEFT,d=s.left+t.x;break;case $e.b.TOP_LEFT:l=$e.c.LEFT,d=s.left+t.x,h=$e.c.TOP,p=s.top+t.y;break;case $e.b.TOP:h=$e.c.TOP,p=s.top+t.y;break;case $e.b.TOP_RIGHT:l=$e.c.RIGHT,d=s.right+t.x,h=$e.c.TOP,p=s.top+t.y;break;case $e.b.RIGHT:l=$e.c.RIGHT,d=s.right+t.x;break;case $e.b.BOTTOM_RIGHT:l=$e.c.RIGHT,d=s.right+t.x,h=$e.c.BOTTOM,p=s.bottom+t.y;break;case $e.b.BOTTOM:h=$e.c.BOTTOM,p=s.bottom+t.y;break;case $e.b.BOTTOM_LEFT:l=$e.c.LEFT,d=s.left+t.x,h=$e.c.BOTTOM,p=s.bottom+t.y;break;default:return}!function(e,t,n,i,a){var o=0!==t.x&&!function(e){return e===$e.b.TOP||e===$e.b.BOTTOM}(e);if(o){var s=i.lineX,r=i.targetIndexX,l=i.targetLineX,u=0,d=!0,h=!1,p=void 0;try{for(var m,f=i.list[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var v=m.value,g=c(t.x,n,i.dx,u,v,a,!1);if(g){t.x=g.moveX,i.dx=g.snapTerm,i.lineX=null!=g.line?g.line:s,i.targetIndexX=null!=g.targetIndex?g.targetIndex:r,i.targetLineX=null!=g.targetLine?g.targetLine:l,i.targetTypeX=g.useOldSnapData?i.targetTypeX:v.type,i.isFromKeyAction=!1,o=!1;break}u++}}catch(e){h=!0,p=e}finally{try{d||null==f.return||f.return()}finally{if(h)throw p}}}o&&(i.dx=0,i.lineX=$e.c.NONE,i.targetIndexX=-1,i.targetLineX=$e.c.NONE,i.targetTypeX=Jo.a.NONE)}(e,t,d,r,l),function(e,t,n,i,a){var o=0!==t.y&&!function(e){return e===$e.b.LEFT||e===$e.b.RIGHT}(e);if(o){var s=i.lineY,r=i.targetIndexY,l=i.targetLineY,c=0,d=!0,h=!1,p=void 0;try{for(var m,f=i.list[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var v=m.value,g=u(t.y,n,i.dy,c,v,a,!1);if(g){t.y=g.moveY,i.dy=g.snapTerm,i.lineY=null!=g.line?g.line:s,i.targetIndexY=null!=g.targetIndex?g.targetIndex:r,i.targetLineY=null!=g.targetLine?g.targetLine:l,i.targetTypeY=g.useOldSnapData?i.targetTypeY:v.type,i.isFromKeyAction=!1,o=!1;break}c++}}catch(e){h=!0,p=e}finally{try{d||null==f.return||f.return()}finally{if(h)throw p}}}o&&(i.dy=0,i.lineY=$e.c.NONE,i.targetIndexY=-1,i.targetLineY=$e.c.NONE,i.targetTypeY=Jo.a.NONE)}(e,t,p,r,h)}}}(Oo||(Oo={}));var es=n(409),ts=n(468),ns=n(90),is=function(){function e(){L()(this,e)}return w()(e,null,[{key:"isSimilarTo",value:function(t,n){var i=Math.abs(e.mouseV.x-t),a=Math.abs(e.mouseV.y-n),o=je.a.isMobileDevice()?e.MOBILE_SENSITIVITY:e.SENSITIVITY;return i<=o&&a<=o}},{key:"downMouse",value:function(t,n,i){var a=this;this.mouseV.x=t,this.mouseV.y=n;var o=(new Date).getTime();this.downTime=o,this.isLongTouch=!1,e.isDowned=!0,e._isSamePoint=!0,i&&setTimeout(function(){return a.handleLongTouch(i,o)},this.LONG_CLICK_MIN_TIME)}},{key:"handleLongTouch",value:function(e,t){this.isDowned&&this._isSamePoint&&this.downTime===t&&(this.isLongTouch=!0,e())}},{key:"moveMouse",value:function(t,n){e.isDowned&&!e.isSimilarTo(t,n)&&(e._isSamePoint=!1)}},{key:"upMouse",value:function(){e.isDowned=!1,e._isSamePoint=!1,this.downTime=0;var t=this.isLongTouch;return this.isLongTouch=!1,t}},{key:"isSamePoint",get:function(){return e._isSamePoint}}]),e}();is.mouseV=new ns.a(0,0),is.isDowned=!1,is._isSamePoint=!0,is.downTime=0,is.isLongTouch=!1,is.SENSITIVITY=0,is.MOBILE_SENSITIVITY=3,is.LONG_CLICK_MIN_TIME=700;var as=n(363),os=n(408),ss=n(364),rs=n(334),ls=function(e){function t(e,n,i,a,o,s){var r,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return L()(this,t),(r=V()(this,F()(t).call(this))).isPossibleInCropMode=!0,r.doSaveQueue=!1,r.changeDesign=function(){return!1},r.actionType=K.a.MOUSE_DOWN,r.commitAction=function(e,t,n){if(as.a.instance.hide(),r.shiftKey||n.canvasAreaVC.mouseDblClickManager.downMouse(r.mouseClientX,r.mouseClientY,r.isTouch),is.downMouse(r.mouseClientX,r.mouseClientY,r.canTouchLong()?function(){return r.onTouchLong(e)}:null),document.activeElement instanceof HTMLInputElement&&document.activeElement.blur(),t.mouseAction.mode!==Fn.a.MODE_GRID_HANDLER_DOWN){var i=Cn(r.mouseClientX,r.mouseClientY),a=i.outputX,o=i.outputY;t.mouseAction.offsetX=r.mouseClientX,t.mouseAction.offsetY=r.mouseClientY;var s=!0,l=!0,c=!1,u=void 0;try{for(var d,h=e.pages[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var p=d.value;if(t.pageController.getPageRenderer(p).isInRange(r.mouseClientX,r.mouseClientY)){r.pageIdx=p.pageIdx,t.renderPageIdx=p.pageIdx,s=!1;break}}}catch(e){c=!0,u=e}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}var m=e.pages[r.pageIdx],f=t.pageController.getPageRenderer(m),v=f.getInRangeItem(a,o);switch(Y.a.isCropMode()||X.a.instance.dispatch(new se.e(v)),t.mouseAction.mode){case Fn.a.MODE_NAVIGATION:t.mouseAction.mode=Fn.a.MODE_NAVIGATION_DRAG,t.mouseAction.baseX=r.event.pageX,t.mouseAction.baseY=r.event.pageY;case Fn.a.MODE_NAVIGATION_DRAG:case Fn.a.MODE_MOBILE_DOWN:return;case Fn.a.MODE_HANDLER_RESIZE_T:case Fn.a.MODE_HANDLER_RESIZE_TR:case Fn.a.MODE_HANDLER_RESIZE_R:case Fn.a.MODE_HANDLER_RESIZE_BR:case Fn.a.MODE_HANDLER_RESIZE_B:case Fn.a.MODE_HANDLER_RESIZE_BL:case Fn.a.MODE_HANDLER_RESIZE_L:case Fn.a.MODE_HANDLER_RESIZE_TL:return t.mouseAction.baseX=r.event.pageX,t.mouseAction.baseY=r.event.pageY,n.itemHandleVC.readyResize(),void t.activeItems.forEach(function(e){e.isLazyHandlerHandlePosition(ts.a.mouseActionToHandle(t.mouseAction.mode))&&e.setStatus(qe.g.LAZY),e instanceof q.a&&e.isEditMode&&X.a.instance.dispatch(new et.b(e))});case Fn.a.MODE_HANDLER_MOVE_START:return void(t.mouseAction.mode=Fn.a.MODE_ITEM_DRAG);case Fn.a.MODE_HANDLER_ROTATE:return void(t.mouseAction.mode=Fn.a.MODE_ITEM_ROTATE);case Fn.a.MODE_GUIDELINE_MOVE:return}if(Y.a.isCropMode())f.getInRangeItems(a,o,a,o)&&(t.mouseAction.mode=Fn.a.MODE_SELECT_ONE_OR_DRAG);else{if(m.background.backgroundItem){var g=t.activeItems.find(function(e){return e===m.background.backgroundItem});g&&J.a.unselectItem(g)}if(!r.isTouch||!Kt.a.isItemSkinable(v,f.page.sheetSize)){var E=m.getAllSingleItems(),y=E.filter(function(e){return!0===e.select}),T=f.getInRangeGroup(a,o);if(!s&&T){var I=T.getAllSingleMembers(),C=T.getSelectedItem();if(C instanceof q.a&&C===v&&!ss.a.isMultiSelectMode())return void(C.isEditArea(a,o)?(t.mouseAction.baseX=r.mouseClientX,t.mouseAction.baseY=r.mouseClientY,t.mouseAction.mode=Fn.a.MODE_TEXT_EDIT):v.isEditMode&&(X.a.instance.dispatch(new et.b(C)),r.canvas.style.cursor="move",t.mouseAction.mode=Fn.a.MODE_ITEM_DRAG));var k=E.indexOf(v),L=E.indexOf(I[I.length-1]),_=I.some(function(e){return e.select});if(_&&y.some(function(e){return I.indexOf(e)<0}))return void(t.mouseAction.mode=Fn.a.MODE_SELECT_ONE_OR_DRAG);if(L>=k&&!r.shiftKey&&(!r.ctrlKey||0===t.activeItems.length))return J.a.selectItems(I),_&&I.indexOf(v)>-1&&T.setSelectedItem(v),n.renderHandler(e,t,void 0,!0),void(t.mouseAction.mode=Fn.a.MODE_SELECT_ONE_OR_DRAG)}var w=y[y.length-1],S=E.indexOf(v)>E.indexOf(w),b=1===y.length&&y[0]===v;if(!s&&(!S||v.isLock())&&(t.mouseAction.mode===Fn.a.MODE_HANDLER_DOWN||v instanceof os.a&&b||v instanceof Z.a&&b)){if(null==v||!v.select)return void(t.mouseAction.mode=Fn.a.MODE_SELECT_ONE_OR_DRAG);if(y.push(v),Qe.b.isSameGroup(y))return J.a.appendSelectedItem(v),void(t.mouseAction.mode=Fn.a.MODE_SELECT_ONE_OR_DRAG);if(v.select&&v.props.isCanUserMove())return void(v instanceof q.a&&!ss.a.isMultiSelectMode()?v.isEditArea(a,o)&&(t.mouseAction.baseX=r.mouseClientX,t.mouseAction.baseY=r.mouseClientY,(v.isEditMode||!v.isEditMode&&!r.shiftKey)&&(t.mouseAction.mode=Fn.a.MODE_TEXT_EDIT)):v instanceof Z.a&&v.select&&!v.isLock()?(t.mouseAction.baseX=r.mouseClientX,t.mouseAction.baseY=r.mouseClientY,t.activeItems.length>1?r.shiftKey||(t.mouseAction.mode=Fn.a.MODE_ITEM_DRAG):v.selectedColNo>=0?t.mouseAction.mode=Fn.a.MODE_GRID_BORDER_HOR_DRAG:v.selectedRowNo>=0?t.mouseAction.mode=Fn.a.MODE_GRID_BORDER_VER_DRAG:v.positionTool.getCell(a,o)?t.mouseAction.mode=Fn.a.MODE_GRID_CLICK:t.mouseAction.mode=Fn.a.MODE_GRID_HANDLER_DOWN):t.mouseAction.mode=Fn.a.MODE_SELECT_ONE_OR_DRAG)}if(!(s||null==v||v.isLock()||m.background.isSkinItem(v))||Y.a.isSpoidMode())return s||!v||v.select||r.shiftKey||r.ctrlKey&&0!==t.activeItems.length||m.background.isSkinItem(v)||Y.a.isSpoidMode()?void 0:(J.a.selectItem(v),n.renderHandler(e,t,void 0,!0),void(t.mouseAction.mode!==Fn.a.MODE_ALERT_ICON_SELECT&&(t.mouseAction.mode=Fn.a.MODE_SELECT_ONE_OR_DRAG)));if(t.activeItems.length>0&&X.a.instance.dispatch(new se.d(t.activeItems)),r.shiftKey||r.ctrlKey||J.a.unselectAllItems(),t.mouseAction.mode=Fn.a.MODE_MULTI_SELECT,t.mouseAction.baseX=r.mouseClientX,t.mouseAction.baseY=r.mouseClientY,!r.isTouch){var R=n.canvasAreaVC.pagingManager.getSelectAreaOffset();r.selectArea.style.left="".concat(Math.min(r.mouseClientX,t.mouseAction.baseX)-R.x,"px"),r.selectArea.style.top="".concat(Math.min(r.mouseClientY,t.mouseAction.baseY)-R.y,"px"),r.selectArea.style.width="1px",r.selectArea.style.height="1px",r.selectArea.style.display="block"}}}}},r.rollbackAction=function(){},r.recycle=function(){r.canvas=null,r.event=null},r.pageIdx=e,r.canvas=n,r.selectArea=i,r.event=a,r.shiftKey=o,r.ctrlKey=s,r.isTouch=l,a&&(r.mouseClientX=a.clientX,r.mouseClientY=a.clientY),r.renderAuto=!1,r}return z()(t,e),w()(t,[{key:"canTouchLong",value:function(){return this.isTouch&&!Y.a.isCropMode()&&!Y.a.instance.activeItems.some(function(e){return e instanceof rs.a&&e.isEditMode})}},{key:"onTouchLong",value:function(e){var t=Y.a.instance,n=e.pages[this.pageIdx],i=t.pageController.getPageRenderer(n),a=Cn(this.mouseClientX,this.mouseClientY),o=a.outputX,s=a.outputY,r=i?i.getSelectedItemInfo(o,s):null,l=!it.a.isEmpty(r.selectedGroupItems);if(r&&(l||r.selectedSingleItem&&r.selectedSingleItem!==n.background.backgroundItem)){var c=l?r.selectedGroupItems:[r.selectedSingleItem];it.a.isEmpty(J.a.getSelectedItemsWithoutBackgroundItem())?J.a.selectItems(c):J.a.appendSelectedItems(c),t.editorMainVC.renderHandler(e,t,void 0,!0)}t.mouseAction.mode=Fn.a.MODE_ITEM_MULTI_SELECT,ss.a.setMultiSelectMode(!0).updateStateByActiveItems()}}]),t}(K.b),cs=n(258),us=n(48),ds=n(246),hs=function(){function e(){L()(this,e),this.cropAreaBoxLTRB=new li.a(0,0,0,0)}return w()(e,[{key:"getPhotoCropButtons",value:function(){return this.photoCropButtons}},{key:"addCropElements",value:function(e){this.cropArea.parentElement!==e&&(e.appendChild(this.cropArea),e.appendChild(this.photoCropButtons))}},{key:"removeCropElements",value:function(){this.photoCropButtons.parentElement&&this.photoCropButtons.parentElement.removeChild(this.photoCropButtons),this.cropArea.parentElement&&this.cropArea.parentElement.removeChild(this.cropArea)}},{key:"setImageframePhotoCropView",value:function(){this.cropArea.classList.add(Ts.CROP_IMAGE_FRAME_PHOTO),this.setVisibleResizeButtons(!1)}},{key:"setVisibleResizeButtons",value:function(e){e?this.cropResizeButtons.classList.remove(r.a.HIDE):this.cropResizeButtons.classList.add(r.a.HIDE)}},{key:"setPhotoCropView",value:function(e,t){var n=e.photoCrop.boxDivRect,i=e.photoCrop.areaDivRect,a=Y.a.instance.pageEditScale*t,o=new li.a(n.left,n.top,n.left+n.width,n.top+n.height).move(i.left,i.top).changeScale(a),s=new li.a(i.left,i.top,i.left+i.width,i.top+i.height).changeScale(a).getCenterPos(),r=ds.a.getRotatedVectorByPoint(s,o.getCenterPos(),cs.a.getRadianByDegree(e.props.getRotate()));o.moveCenter(r),this.cropAreaBoxLTRB.setLTRB(o),this.cropAreaBoxLTRB.rotate=e.props.getRotate(),this.cropArea.style.transform="translate(".concat(o.left,"px, ").concat(o.top,"px) rotate(").concat(e.props.getRotate(),"deg)"),this.cropArea.style.width="".concat(o.getWidth(),"px"),this.cropArea.style.height="".concat(o.getHeight(),"px"),this.cropResizeButtons.style.width="100%",this.cropResizeButtons.style.height="100%",this.cropArea.classList.remove(Ts.CROP_IMAGE_FRAME_PHOTO),this.setVisibleResizeButtons(!e.isBackground),this.setPhotoCropButtonsPosition()}},{key:"setPhotoCropButtonsPosition",value:function(){var t=e.CROP_BUTTONS_WIDTH/2,n=this.cropAreaBoxLTRB.getRotatedLTRB(this.cropAreaBoxLTRB.rotate),i=n.left+n.getWidth()/2-t,a=n.top+n.getHeight()+20;this.photoCropButtons.style.transform="translate(".concat(i,"px, ").concat(a,"px)")}},{key:"addPhotoCropButtons",value:function(){var e=this;this.photoCropButtons=document.createElement("div"),this.photoCropButtons.className=Ts.PHOTO_CROP_BUTTONS;var t=us.a.makeInlineButton(Ts.BTN_PHOTO_CROP_ACCEPT,ne.ToolsIcon.CHECK);this.tooltipPhotoCropAccept=new Le.a(t,Ge.a.T,{title:{name:"이미지 영역 적용하기"}}),this.photoCropButtons.appendChild(t);var n=us.a.makeInlineButton(Ts.BTN_PHOTO_CROP_CANCEL,ne.ToolsIcon.CLOSE);this.tooltipPhotoCropCancel=new Le.a(n,Ge.a.T,{title:{name:"취소하기"}}),this.photoCropButtons.appendChild(n),this.photoCropButtons.appendChild(us.a.makeMobileButton(Ts.BTN_PHOTO_CROP_CANCEL,"취소")),this.photoCropButtons.appendChild(us.a.makeMobileButton(Ts.BTN_PHOTO_CROP_ACCEPT,"자르기")),this.cropArea=document.createElement("div"),this.cropArea.className=Ts.PHOTO_CROP_AREA,this.cropResizeButtons=document.createElement("div"),this.cropResizeButtons.className=Ts.PHOTO_CROP_RESIZE_BUTTONS,[es.b.LT,es.b.RT,es.b.LB,es.b.RB].forEach(function(t){var n=document.createElement("div");n.className="".concat(Ts.CROP_RESIZE_HANDLE),n.setAttribute(Ts.CROP_RESIZE_DIRECTION_ATTR,t.toString()),e.cropResizeButtons.appendChild(n)}),this.cropArea.appendChild(this.cropResizeButtons)}},{key:"addEventListeners",value:function(e){var t=this;function n(e){e.preventDefault(),e.stopPropagation()}$(this.cropArea).on("mousedown touchstart",function(t){try{var n=t.target;if(n.classList.contains("".concat(Ts.CROP_RESIZE_HANDLE))){var i=n.getAttribute(Ts.CROP_RESIZE_DIRECTION_ATTR);Y.a.instance.activeItems[0].photoCrop.setResizeDirection(i)}Y.a.instance.mouseAction.mode=Fn.a.MODE_HANDLER_MOVE_START,document.addEventListener("mouseup",e),document.addEventListener("touchend",e)}catch(t){console.error(t)}}),$(this.photoCropButtons).on("mousedown touchstart",".".concat(Ts.BTN_PHOTO_CROP_ACCEPT),function(e){t.tooltipPhotoCropAccept.hide();var i=Y.a.instance.activeItems[0].belongsTo;i===Je.c.INDEPENDENT?X.a.instance.dispatch(new Gn.c):i===Je.c.IMAGEFRAME&&X.a.instance.dispatch(new Rn.i),n(e),Y.a.instance.mouseAction.mode=Fn.a.MODE_PHOTO_CROP_UI_SELECT}).on("mousedown touchstart",".".concat(Ts.BTN_PHOTO_CROP_CANCEL),function(e){t.tooltipPhotoCropCancel.hide(),X.a.instance.dispatch(new Gn.d),n(e),Y.a.instance.mouseAction.mode=Fn.a.MODE_PHOTO_CROP_UI_SELECT})}}]),e}();hs.CROP_BUTTONS_WIDTH=72;var ps=function(){function e(){L()(this,e)}return w()(e,null,[{key:"getDistance",value:function(e,t){return Math.hypot(t.clientX-e.clientX,t.clientY-e.clientY)}},{key:"getCenterPosition",value:function(e,t){return new ns.a((t.clientX+e.clientX)/2,(t.clientY+e.clientY)/2)}},{key:"startPinch",value:function(t,n){e.prevDistance=e.getDistance(t,n)}},{key:"getPinchScale",value:function(t,n){var i=e.getDistance(t,n),a=i/e.prevDistance;return e.prevDistance=i,a}}]),e}();ps.prevDistance=0;var ms,fs=n(30),vs=function(e){function t(e){return L()(this,t),V()(this,F()(t).call(this,!0,void 0,void 0,e))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.snapLineX=this.createDivElement("snap_line line_x"),this.container.appendChild(this.snapLineX),this.snapLineSubX1=this.createDivElement("snap_line line_x item"),this.snapLineSubX1.style.boxSizing="border-box",this.container.appendChild(this.snapLineSubX1),this.snapLineSubX2=this.createDivElement("snap_line line_x item"),this.snapLineSubX2.style.boxSizing="border-box",this.container.appendChild(this.snapLineSubX2),this.snapLineY=this.createDivElement("snap_line line_y"),this.container.appendChild(this.snapLineY),this.snapLineSubY1=this.createDivElement("snap_line line_y item"),this.snapLineSubY1.style.boxSizing="border-box",this.container.appendChild(this.snapLineSubY1),this.snapLineSubY2=this.createDivElement("snap_line line_y item"),this.snapLineSubY2.style.boxSizing="border-box",this.container.appendChild(this.snapLineSubY2)}},{key:"setMainSnapLineX",value:function(e,t){if(e.isSnapLineX()){var n=$e.c.NONE;e.isSourceSnapByType($e.c.LEFT)?n=$e.c.LEFT:e.isSourceSnapByType($e.c.RIGHT)?n=$e.c.RIGHT:e.isSourceSnapByType($e.c.CENTER_X)&&(n=$e.c.CENTER_X);var i=t.getScaledPositionBySnap(n);if(this.snapLineX.style.transform="translateX(".concat(i,"px)"),e.snapData.targetTypeX===Jo.a.ITEM){var a=this.getSnapTop(n,e,t),o=this.getSnapBottom(n,e,t);this.snapLineX.style.top="".concat(a,"px"),this.snapLineX.style.height="".concat(o-a,"px")}else this.snapLineX.style.top="",this.snapLineX.style.height=""}}},{key:"setMainSnapLineY",value:function(e,t){if(e.isSnapLineY()){var n=$e.c.NONE;e.isSourceSnapByType($e.c.TOP)?n=$e.c.TOP:e.isSourceSnapByType($e.c.BOTTOM)?n=$e.c.BOTTOM:e.isSourceSnapByType($e.c.CENTER_Y)&&(n=$e.c.CENTER_Y);var i=t.getScaledPositionBySnap(n);if(this.snapLineY.style.transform="translateY(".concat(i,"px)"),e.snapData.targetTypeY===Jo.a.ITEM){var a=this.getSnapLeft(n,e,t),o=this.getSnapRight(n,e,t);this.snapLineY.style.left="".concat(a,"px"),this.snapLineY.style.width="".concat(o-a,"px")}else this.snapLineY.style.left="",this.snapLineY.style.width=""}}},{key:"updateSnapLine",value:function(e,t,n,i){this.onCreateViewIfNotCreated();var a=e&&(e.type===$e.a.MOVE||e.type===$e.a.RESIZE)&&t.option.showSnapLIne;this.getAllSnapData(n,i),a&&(this.setMainSnapLineX(n,i),this.setMainSnapLineY(n,i)),this.setSnapLineDisplay(a,n),a&&(this.setSnapLineClassList(n),this.setSubSnapLineX(n,i),this.setSubSnapLineY(n,i))}},{key:"getAllSnapData",value:function(e,t){var n=this;e.snapData&&e.snapData.list.forEach(function(i){if(i.snapX=$e.c.NONE,i.snapY=$e.c.NONE,i.type===Jo.a.ITEM){var a=i.ltrb.getRotatedLTRB(-i.ltrb.rotate);a.changeScale(t.getScale());var o=[$e.c.LEFT,$e.c.CENTER_X,$e.c.RIGHT];e.snapData.targetTypeX!==Jo.a.PAGE&&e.snapData.targetTypeX!==Jo.a.GUIDELINE||(o=o.filter(function(t){return t!==e.snapData.lineX})),e.snapData.targetTypeX!==Jo.a.NONE&&o.forEach(function(e){n.matchWhereLTRBX(a,t.getNotCeilScaledPositionBySnap(e))&&(i.snapX|=e)});var s=[$e.c.TOP,$e.c.CENTER_Y,$e.c.BOTTOM];e.snapData.targetTypeY!==Jo.a.PAGE&&e.snapData.targetTypeY!==Jo.a.GUIDELINE||(s=s.filter(function(t){return t!==e.snapData.lineY})),e.snapData.targetTypeY!==Jo.a.NONE&&s.forEach(function(e){n.matchWhereLTRBY(a,t.getNotCeilScaledPositionBySnap(e))&&(i.snapY|=e)})}})}},{key:"setSubSnapLineX",value:function(e,t){e.isSnapLineX()&&e.hasSnapToItemX()&&(e.isSourceSnapByType($e.c.LEFT)?(this.setSnapLineSubX(this.snapLineSubX1,$e.c.CENTER_X,e,t),this.setSnapLineSubX(this.snapLineSubX2,$e.c.RIGHT,e,t)):e.isSourceSnapByType($e.c.CENTER_X)?(this.setSnapLineSubX(this.snapLineSubX1,$e.c.LEFT,e,t),this.setSnapLineSubX(this.snapLineSubX2,$e.c.RIGHT,e,t)):e.isSourceSnapByType($e.c.RIGHT)&&(this.setSnapLineSubX(this.snapLineSubX1,$e.c.LEFT,e,t),this.setSnapLineSubX(this.snapLineSubX2,$e.c.CENTER_X,e,t)))}},{key:"setSnapLineSubX",value:function(e,t,n,i){if(e.style.display="none",n.hasSnapToItemXByType(t)){var a=this.getSnapTop(t,n,i),o=this.getSnapBottom(t,n,i);e.style.display="block",e.style.transform="translateX(".concat(i.getScaledPositionBySnap(t),"px)"),e.style.top="".concat(a,"px"),e.style.height="".concat(o-a,"px")}}},{key:"setSnapLineSubY",value:function(e,t,n,i){if(e.style.display="none",n.hasSnapToItemYByType(t)){var a=this.getSnapLeft(t,n,i),o=this.getSnapRight(t,n,i);e.style.display="block",e.style.transform="translateY(".concat(i.getScaledPositionBySnap(t),"px)"),e.style.left="".concat(a,"px"),e.style.width="".concat(o-a,"px")}}},{key:"setSubSnapLineY",value:function(e,t){e.isSnapLineY()&&e.hasSnapToItemY()&&(e.isSourceSnapByType($e.c.TOP)?(this.setSnapLineSubY(this.snapLineSubY1,$e.c.CENTER_Y,e,t),this.setSnapLineSubY(this.snapLineSubY2,$e.c.BOTTOM,e,t)):e.isSourceSnapByType($e.c.CENTER_Y)?(this.setSnapLineSubY(this.snapLineSubY1,$e.c.TOP,e,t),this.setSnapLineSubY(this.snapLineSubY2,$e.c.BOTTOM,e,t)):e.isSourceSnapByType($e.c.BOTTOM)&&(this.setSnapLineSubY(this.snapLineSubY1,$e.c.TOP,e,t),this.setSnapLineSubY(this.snapLineSubY2,$e.c.CENTER_Y,e,t)))}},{key:"setSnapLineDisplay",value:function(e,t){this.clearTimeout();var n=e&&t.isSnapLineX(),i=e&&t.isSnapLineY();this.snapLineX.style.display=n?"block":"none",this.snapLineY.style.display=i?"block":"none",this.snapLineSubX1.style.display="none",this.snapLineSubX2.style.display="none",this.snapLineSubY1.style.display="none",this.snapLineSubY2.style.display="none",this.setTimeout(t,n||i)}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){clearTimeout(this.snapLineTimeOut)})},{key:"setTimeout",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var n=this;e.snapData&&e.snapData.isFromKeyAction&&t&&(this.snapLineTimeOut=setTimeout(function(){n.snapLineX.style.display="none",n.snapLineY.style.display="none",n.snapLineSubX1.style.display="none",n.snapLineSubX2.style.display="none",n.snapLineSubY1.style.display="none",n.snapLineSubY2.style.display="none"},1e3))})},{key:"setSnapLineClassList",value:function(e){e.snapData&&(this.changeSnapType(this.snapLineX,e.snapData.targetTypeX),this.changeSnapType(this.snapLineY,e.snapData.targetTypeY))}},{key:"changeSnapType",value:function(e,t){t===Jo.a.PAGE||t===Jo.a.GUIDELINE?(e.classList.remove("item"),e.classList.add("page")):t===Jo.a.ITEM&&(e.classList.remove("page"),e.classList.add("item"))}},{key:"getSnapTop",value:function(e,t,n){return Math.min(t.getScaledPositionBySnapX(e,$e.c.TOP,n.getScale()),n.getScaledPositionBySnap($e.c.TOP))}},{key:"getSnapBottom",value:function(e,t,n){return Math.max(t.getScaledPositionBySnapX(e,$e.c.BOTTOM,n.getScale()),n.getScaledPositionBySnap($e.c.BOTTOM))}},{key:"getSnapLeft",value:function(e,t,n){return Math.min(t.getScaledPositionBySnapY(e,$e.c.LEFT,n.getScale()),n.getScaledPositionBySnap($e.c.LEFT))}},{key:"getSnapRight",value:function(e,t,n){return Math.max(t.getScaledPositionBySnapY(e,$e.c.RIGHT,n.getScale()),n.getScaledPositionBySnap($e.c.RIGHT))}},{key:"matchWhereLTRBX",value:function(e,t){return this.isSameNumberWithCorrection(e.left,t)||this.isSameNumberWithCorrection(e.getCenterPosX(),t)||this.isSameNumberWithCorrection(e.right,t)}},{key:"matchWhereLTRBY",value:function(e,t){return this.isSameNumberWithCorrection(e.top,t)||this.isSameNumberWithCorrection(e.getCenterPosY(),t)||this.isSameNumberWithCorrection(e.bottom,t)}},{key:"isSameNumberWithCorrection",value:function(e,t){return Math.abs(e-t)<1e-11}}]),t}(He.a),gs=function(){function e(t,n){for(L()(this,e),this.cropTools=new hs,this.forceUpdatePosition=!1,this.tooltipDegRevision=0,this.gridRowDivs=[],this.gridColDivs=[],this.gridRowCellBorders=[],this.gridColCellBorders=[],this.element=t,this.pageId=n;t.firstChild;)t.firstChild.remove();this.elementMap=new Map,this.setElement(t,n)}return w()(e,[{key:"setElement",value:function(e,t){this.element=e,this.element.innerHTML="",this.pageId=t,this.makeElement(),this.addEventListeners()}},{key:"setRenderStates",value:function(e,t,n,i,a,o,s){var r=this;this.pageIdx=a.pageIdx,this.lastRotate=a.rotate;var l=a.zoomScale,c=a.editScale,u=this.forceUpdatePosition||l!==o.zoomScale||s&&s.type===$e.a.WINDOW_RESIZE,d=this.forceUpdatePosition||c!==o.editScale,h=u||d;if(a.setPositionFromItem&&t.activeItems.length>0){var p=t.activeItems[0],m=p.props;a.left=m.getLeft(),a.top=m.getTop(),a.width=m.getWidth(),a.height=m.getHeight(),n.ovalshape=p.isRBRound()}var f=1===t.activeItems.length&&t.activeItems[0]instanceof Je.d;(n.forceUpdate||h||a.width!==o.width||""===this.band.style.width)&&(this.band.style.width="".concat((f?Math.ceil(a.width):a.width)*c*l,"px")),(n.forceUpdate||h||a.height!==o.height||""===this.band.style.height)&&(this.band.style.height="".concat((f?Math.ceil(a.height):a.height)*c*l,"px")),n.isDisabledEvent?this.element.classList.add("event_disabled"):this.element.classList.remove("event_disabled"),this.band.style.display="",this.band.style.borderRadius=n.ovalshape?"100%":"",this.band.style.left="".concat(a.left*c*l,"px"),this.band.style.top="".concat(a.top*c*l,"px"),this.band.style.transform="rotate(".concat(a.rotate,"deg)"),this.updateBackgroundViewMode(t.activeItems);var v=[$e.d.PHOTO_CROP,$e.d.IMAGE_FRAME_PHOTO_CROP];a.isLock?this.setLockStatusView():v.includes(n.mode)?(this.cropTools.setPhotoCropView(t.activeItems[0],a.zoomScale),this.setButtonsView(this.cropTools.getPhotoCropButtons()),this.setFooterView(!1),n.mode===$e.d.IMAGE_FRAME_PHOTO_CROP&&this.cropTools.setImageframePhotoCropView()):n.mode===$e.d.GRID?this.setGridView(a,s):(n.hasGridItem?this.setDefaultViewWithoutButtons():this.setDefaultView(),a.canRotate?this.basicButtons.classList.add("canRotate"):this.basicButtons.classList.remove("canRotate")),this.setResizeButtonDisplay(a,o,s),this.setMoveButtonDisplay(a),a.footerDistance?this.footerElement.style.top="calc(100% + ".concat(a.footerDistance,"px"):this.footerElement.style.top="",void 0!==a.smallPlus?a.smallPlus?(this.lilPlus.classList.remove("ccw"),this.lilPlus.classList.add("cw")):(this.lilPlus.classList.remove("cw"),this.lilPlus.classList.add("ccw")):(this.lilPlus.classList.remove("cw"),this.lilPlus.classList.remove("ccw"));for(var g,E,y,T,I,C,k,L,_,w,S,b,R=this.buttonWrapper.getElementsByClassName(Ts.INLINE_BUTTON),A=0,O=R.length;A<O;A++)R.item(A).style.transform="rotateZ(".concat(-a.rotate,"deg)");if(this.moveButton.style.transform="translate(0, 50%) rotateZ(".concat(-a.rotate,"deg)"),this.setSizeBySheet(a.width,a.height,t.option.pageSize,e.pages[0].sheetSize),s)switch(s.type){case $e.a.MOVE:this.setMovePanel(a);break;case $e.a.ROTATE:if(n.mode===$e.d.GRID)break;this.tooltipRotate.hide(),this.tooltipDegree.updateContent({description:"".concat((Math.round(a.rotate)+360)%360,"°")});var P=this.tooltipDegree.getDefaultTooltip();if((g=t.mouseAction).mode===Fn.a.MODE_ITEM_ROTATE)E=32,y=10,w=Math.min(Math.max(g.offsetX+E,y),$(window).width()-P.offsetWidth-y),S=Math.min(Math.max(g.offsetY+E,y),$(window).height()-P.offsetHeight-y),P.style.transform="";else{I=(T=$(this.element).offset()).left+a.left*c*l,C=T.top+a.top*c*l,k=this.band.offsetWidth,L=this.band.offsetHeight,_=new ns.a(I+k/2,C+L/2);var D=new ns.a(I+k/2,C-63);w=(b=ds.a.calcLocationByRotate(D,_,a.rotate)).x,S=b.y,P.style.transform="translate(-50%, -50%)"}this.tooltipDegree.show(!1,0,w,S),g.mode===Fn.a.MODE_ITEM_ROTATE?(this.tooltipDegRevision=0,$(P).stop().animate({opacity:"1"},0)):(this.tooltipDegRevision++,$(P).finish().animate({opacity:"1"},0).animate({opacity:"0"},1e3,"swing",function(){r.tooltipDegRevision--,r.tooltipDegRevision<=0&&"0"===P.style.opacity&&r.tooltipDegree.hide()}));break;case $e.a.RESIZE:var M=t.option.pageSize;this.updateToolTipSizeText(M.unit.toLowerCase()),g=t.mouseAction,E=32,y=10;var N=this.tooltipSize.getDefaultTooltip();w=Math.min(Math.max(g.offsetX+E,y),$(window).width()-N.offsetWidth-y),S=Math.min(Math.max(g.offsetY+E,y),$(window).height()-N.offsetHeight-y),this.tooltipSize.show(!1,0,w,S)}else this.tooltipDegRevision<=0&&this.tooltipDegree.hide(),this.tooltipSize.hide();this.snapLineView.updateSnapLine(s,t,i,a),n.cmd!==i.cmd&&(s?this.element.setAttribute("data-cmd",s.type.toLowerCase()):this.element.removeAttribute("data-cmd"));var x=n.handlerType;x?this.element.setAttribute("data-handler-type",x):this.element.removeAttribute("data-handler-type"),this.element.style.display="block",this.setRotateButtonPosition(a.rotate),this.setMoveButtonPosition(a.rotate)}},{key:"setMovePanel",value:function(e){this.movePanel.innerText="".concat(e.getMathRoundLeft(),", ").concat(e.getMathRoundTop()),this.movePanel.style.transformOrigin="".concat(e.getTransformOriginXAxis(),"px ").concat(e.getTransformOriginYAxis(),"px"),this.movePanel.style.transform="rotateZ(".concat(-e.rotate,"deg) translate(-110%, -110%)")}},{key:"setSizeBySheet",value:function(t,n,i,a){var o=i.dpi,s=i.unit,r=De.a.getPixel(i.width,o,s)/a.width;this.sizeBySheet=e.getPositionSize(t*r,n*r,o,s)}},{key:"updateToolTipSizeText",value:function(e){this.tooltipSize.updateContent({description:"".concat(this.sizeBySheet.width," × ").concat(this.sizeBySheet.height," (").concat(e,")")})}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"makeElement",value:function(){this.band=document.createElement("div"),this.band.className=Ts.HANDLERS,this.tooltipDegree=new Le.a(this.band,Ge.a.CUSTOM,{description:""},null,{setDefaultEvents:!1}),this.tooltipSize=new Le.a(this.band,Ge.a.CUSTOM,{description:""},null,{setDefaultEvents:!1}),this.snapLineView=new vs(this.element),this.element.appendChild(this.band),this.buttonWrapper=document.createElement("div"),this.buttonWrapper.className="buttons",this.band.appendChild(this.buttonWrapper),this.resizeCursor=document.createElement("div"),this.resizeCursor.className=Ts.RESIZE_POINT_CURSOR_WRAP,this.curImg=new Image,this.curImg.src="".concat(fs.a.RESOURCE_DOMAIN,"image/cursor/resize_handle_ew.png"),this.curImg.className=Ts.RESIZE_POINT_CURSOR,this.curImg.draggable=!1,this.resizeCursor.appendChild(this.curImg),this.element.appendChild(this.resizeCursor),this.addBasicButtons(),this.addMoveButton(),this.cropTools.addPhotoCropButtons(),this.addLockStatusButtons(),this.makeGridButtons(),this.inlineButtons=[this.basicButtons,this.lockStatusButtons],this.addResizeButtons(),this.addFooterButtons(),this.addSmallPlusButton()}},{key:"setHandlerMode",value:function(e,t){e===$e.d.PHOTO_CROP||e===$e.d.IMAGE_FRAME_PHOTO_CROP?!document.body.classList.contains(Ts.IMAGE_CROP_MODE)&&t&&(this.band.style.cursor="move",document.body.classList.add(Ts.IMAGE_CROP_MODE)):(document.body.classList.remove(Ts.IMAGE_CROP_MODE),this.band.style.cursor="")}},{key:"setButtonsView",value:function(e){var t=this;this.inlineButtons.forEach(function(n){if(n===e)n.parentElement!==t.buttonWrapper&&t.buttonWrapper.appendChild(n),t.buttonWrapper.parentElement||t.band.appendChild(t.buttonWrapper);else{var i=n.parentElement;i&&(i.removeChild(n),0===i.children.length&&i.parentElement&&i.parentElement.removeChild(i))}}),e===this.cropTools.getPhotoCropButtons()?this.cropTools.addCropElements(this.element):this.cropTools.removeCropElements();var n=this.band.getElementsByClassName("grid_buttons").length>0;e!==this.gridButtons||n?e!==this.gridButtons&&n&&(this.band.classList.remove("hiddenResizePoint"),this.band.removeChild(this.gridButtons)):(this.band.classList.add("hiddenResizePoint"),this.band.appendChild(this.gridButtons))}},{key:"setFooterView",value:function(e){}},{key:"setDefaultView",value:function(){this.setButtonsView(this.basicButtons),this.setFooterView(!0)}},{key:"setDefaultViewWithoutButtons",value:function(){this.setButtonsView(null),this.setFooterView(!0)}},{key:"setLockStatusView",value:function(){this.setButtonsView(this.lockStatusButtons),this.setFooterView(!1)}},{key:"setRotateButtonPosition",value:function(e){var t=this.getButtonLTRB(this.rotateButton,this.isBottomRotateHandle()),n=this.getElementLTRB(this.element),i=(Math.round(e)+360)%360,a=Ts.BTN_TOP;(this.getClientRect().top<=n.top||t.top<=n.top&&(i<90||i>270)||t.bottom>=n.bottom&&i>90&&i<270||t.left<=n.left&&i>180&&i<360||t.right>=n.right&&i>0&&i<180)&&(a=Ts.BTN_BOTTOM),this.buttonWrapper.classList.remove(Ts.BTN_TOP),this.buttonWrapper.classList.remove(Ts.BTN_BOTTOM),this.buttonWrapper.classList.add(a)}},{key:"setMoveButtonPosition",value:function(e){var t=this.getButtonLTRB(this.moveButton,this.isLeftMoveHandle()),n=this.getElementLTRB(this.element),i=(Math.round(e)+360)%360,a=Ts.BTN_RIGHT;(t.top<=n.top&&i>180&&i<360||t.bottom>=n.bottom&&i>0&&i<180||t.left<=n.left&&i>90&&i<270||t.right>=n.right&&(i<90||i>270))&&(a=Ts.BTN_LEFT),this.moveButton.classList.remove(Ts.BTN_RIGHT),this.moveButton.classList.remove(Ts.BTN_LEFT),this.moveButton.classList.add(a)}},{key:"setGridView",value:function(e,t){if(this.setButtonsView(this.gridButtons),this.setFooterView(!0),!e.isLock&&!t){var n=e.editScale*e.zoomScale,i=Math.ceil(e.width*n),a=Math.ceil(e.height*n);this.band.style.display="block";var o=Y.a.instance.activeItems[0];if(o.selectedRowNo=-1,o.selectedColNo=-1,o.row>this.gridRowDivs.length)for(var s=this.gridRowDivs.length;s<o.row;s++){var r=this.makeRowDiv(s);this.gridButtons.appendChild(r),this.gridRowDivs.push(r)}else if(o.row<this.gridRowDivs.length)for(var l=this.gridRowDivs.length-1;l>=o.row;l--){var c=this.gridRowDivs[l];this.gridButtons.removeChild(c),this.gridRowDivs.splice(l,1)}if(o.col>this.gridColDivs.length)for(var u=this.gridColDivs.length;u<o.col;u++){var d=this.makeColDiv(u);this.gridButtons.appendChild(d),this.gridColDivs.push(d)}else if(o.col<this.gridColDivs.length)for(var h=this.gridColDivs.length-1;h>=o.col;h--){var p=this.gridColDivs[h];this.gridButtons.removeChild(p),this.gridColDivs.splice(h,1)}if(o.row+1>this.gridRowCellBorders.length)for(var m=this.gridRowCellBorders.length;m<o.row+1;m++){var f=this.makeRowCellBorders(m);this.gridButtons.appendChild(f),this.gridRowCellBorders.push(f)}else if(o.row+1<this.gridRowCellBorders.length)for(var v=this.gridRowCellBorders.length-1;v>=o.row+1;v--){var g=this.gridRowCellBorders[v];this.gridButtons.removeChild(g),this.gridRowCellBorders.splice(v,1)}if(o.col+1>this.gridColCellBorders.length)for(var E=this.gridColCellBorders.length;E<o.col+1;E++){var y=this.makeColCellBorders(E);this.gridButtons.appendChild(y),this.gridColCellBorders.push(y)}else if(o.col+1<this.gridColCellBorders.length)for(var T=this.gridColCellBorders.length-1;T>=o.col+1;T--){var I=this.gridColCellBorders[T];this.gridButtons.removeChild(I),this.gridColCellBorders.splice(T,1)}for(var C=0,k=o.getHeight(),L=0;L<o.rows.length;L++){var _=o.rows[L],w=this.gridRowDivs[L];w.style.top="".concat(C/k*a,"px"),w.style.height="".concat(_.thickness/k*a+1,"px"),C+=_.thickness}for(var S=0,b=o.getWidth(),R=0;R<o.cols.length;R++){var A=o.cols[R],O=this.gridColDivs[R];O.style.left="".concat(Math.floor(S/b*i),"px"),O.style.width="".concat(Math.ceil(A.thickness/b*i+1),"px"),S+=A.thickness}C=0;for(var P=0;P<this.gridRowCellBorders.length;P++){var D=this.gridRowCellBorders[P];if(0===P)D.style.top="-3px";else C+=o.rows[P-1].thickness,D.style.top="".concat(C/k*a-3,"px")}S=0;for(var M=0;M<this.gridColCellBorders.length;M++){var N=this.gridColCellBorders[M];if(0===M)N.style.left="-3px";else S+=o.cols[M-1].thickness,N.style.left="".concat(S/b*i-3,"px")}var x=!0,B=!1,V=void 0;try{for(var U,F=this.gridRowDivs[Symbol.iterator]();!(x=(U=F.next()).done);x=!0){U.value.firstChild.classList.remove("select")}}catch(e){B=!0,V=e}finally{try{x||null==F.return||F.return()}finally{if(B)throw V}}var G=!0,H=!1,W=void 0;try{for(var z,K=this.gridColDivs[Symbol.iterator]();!(G=(z=K.next()).done);G=!0){z.value.firstChild.classList.remove("select")}}catch(e){H=!0,W=e}finally{try{G||null==K.return||K.return()}finally{if(H)throw W}}this.gridButtons.classList.remove("selectAllCells");var X=o.selectedCells;if(X.length>0){var j=!0,Z=!1,q=void 0;try{for(var $,Q=X[Symbol.iterator]();!(j=($=Q.next()).done);j=!0){var J=$.value,ee=J.row,te=J.col;this.gridRowDivs[ee].firstChild.classList.add("select"),this.gridColDivs[te].firstChild.classList.add("select")}}catch(e){Z=!0,q=e}finally{try{j||null==Q.return||Q.return()}finally{if(Z)throw q}}X.length===o.row*o.col&&this.gridButtons.classList.add("selectAllCells")}for(var ne=0;ne<o.rows.length;ne++){o.rows[ne].thickness*n<Ts.RESIZE_HANDLE_VISIBLE_TERM_CELL?0===ne?this.firstRowPoint.classList.add("small"):(this.gridRowDivs[ne-1].classList.add("small"),this.gridRowCellBorders[ne-1].classList.add("small")):0===ne?this.firstRowPoint.classList.remove("small"):(this.gridRowDivs[ne-1].classList.remove("small"),this.gridRowCellBorders[ne-1].classList.remove("small"))}for(var ie=0;ie<o.cols.length;ie++){o.cols[ie].thickness*n<Ts.RESIZE_HANDLE_VISIBLE_TERM_CELL?0===ie?this.firstColPoint.classList.add("small"):(this.gridColDivs[ie-1].classList.add("small"),this.gridColCellBorders[ie-1].classList.add("small")):0===ie?this.firstColPoint.classList.remove("small"):(this.gridColDivs[ie-1].classList.remove("small"),this.gridColCellBorders[ie-1].classList.remove("small"))}i<Ts.RESIZE_HANDLE_VISIBLE_TERM_GRID?this.gridButtons.classList.add("small_w"):this.gridButtons.classList.remove("small_w"),a<Ts.RESIZE_HANDLE_VISIBLE_TERM_GRID?this.gridButtons.classList.add("small_h"):this.gridButtons.classList.remove("small_h")}else this.band.style.display="none"}},{key:"makeRowCellBorders",value:function(e){var t=document.createElement("div");return t.classList.add("row","cellBorder"),t.setAttribute("rowIdx","".concat(e)),this.addEventListnerToCellBorder(t),t}},{key:"makeColCellBorders",value:function(e){var t=document.createElement("div");return t.classList.add("col","cellBorder"),t.setAttribute("colIdx","".concat(e)),this.addEventListnerToCellBorder(t),t}},{key:"addEventListnerToCellBorder",value:function(e){var t=function(t){var n;0!==t.buttons||e.classList.contains("hover")||(e.classList.add("hover"),n=e.classList.contains("col")?"col-resize":"row-resize",X.a.instance.dispatch(new K.c(function(t,i,a){var o=i.activeItems[0];o.cursorOnBorder=!0,e.classList.contains("row")?(o.selectedRowNo=Number(e.getAttribute("rowIdx")),o.selectedColNo=-1):(o.selectedColNo=Number(e.getAttribute("colIdx")),o.selectedRowNo=-1),a.canvasAreaVC.container.style.cursor=n})))};e.addEventListener("mouseenter",t),e.addEventListener("mousemove",t),e.addEventListener("mouseleave",function(t){e.classList.contains("hover")&&(e.classList.remove("hover"),1!==t.buttons&&X.a.instance.dispatch(new K.c(function(e,t,n){if(1===t.activeItems.length&&t.activeItems[0]instanceof Z.a){var i=t.activeItems[0];i.cursorOnBorder=!1,i.selectedRowNo=-1,i.selectedColNo=-1}n.canvasAreaVC.container.style.cursor="block"})))})}},{key:"addBasicButtons",value:function(){this.basicButtons=document.createElement("div"),this.basicButtons.className=Ts.BASIC_BUTTONS,this.rotateButton=us.a.makeInlineButton(Ts.BTN_ROTATE,ne.ToolsIcon.ROTATE);var e=[];e.push({name:"시계방향",shortcut:"Ctrl + →"}),e.push({name:"반시계방향",shortcut:"Ctrl + ←"}),this.tooltipRotate=new Le.a(this.rotateButton,Ge.a.T,{title:{name:"회전"},subtitles:e}),this.basicButtons.appendChild(this.rotateButton),this.buttonWrapper.appendChild(this.basicButtons),this.movePanel=document.createElement("p"),this.movePanel.className="active_panel move",this.band.appendChild(this.movePanel)}},{key:"addMoveButton",value:function(){this.moveButton=document.createElement("div"),this.moveButton.classList.add(Ts.MOVE_BUTTON),Object(ne.setToolsIcon)(this.moveButton,ne.ToolsIcon.MOVE),this.band.appendChild(this.moveButton)}},{key:"addFooterButtons",value:function(){var e=this;this.footerElement=document.createElement("div"),this.footerElement.className=Ts.FOOTER_BUTTONS;var t=function(){X.a.instance.dispatch(new xn(e.pageIdx)),X.a.instance.dispatch(new Vn(e.pageIdx)),Te.a.sendEvent("단축키 vs 버튼클릭","복제하기","핸들",!0)},n=us.a.makeInlineButton(Ts.BTN_COPY,ne.ToolsIcon.COPY);n.addEventListener("click",t),n.addEventListener("touchend",t);new Le.a(n,Ge.a.B,{title:{name:"복제하기",shortcut:"Ctrl + D"}});var i=function(){X.a.instance.dispatch(new An.a),Te.a.sendEvent("단축키 vs 버튼클릭","삭제하기","핸들",!0)},a=us.a.makeInlineButton(Ts.BTN_DELETE,ne.ToolsIcon.DELETE);a.addEventListener("click",i),a.addEventListener("touchend",i);new Le.a(a,Ge.a.B,{title:{name:"삭제하기",shortcut:"Delete"}});this.footerElement.appendChild(n),this.footerElement.appendChild(a)}},{key:"addLockStatusButtons",value:function(){this.lockStatusButtons=document.createElement("div");var e=us.a.makeInlineButton(Ts.BTN_UNLOCK,ne.ToolsIcon.LOCK);this.tooltipBtnUnLock=new Le.a(e,Ge.a.T,{title:{name:"아이템 잠금 상태"},description:"클릭 시 아이템 잠금 해제"}),this.lockStatusButtons.appendChild(e)}},{key:"addResizeButtons",value:function(){var e=this;[Fn.a.MODE_HANDLER_RESIZE_T,Fn.a.MODE_HANDLER_RESIZE_TR,Fn.a.MODE_HANDLER_RESIZE_R,Fn.a.MODE_HANDLER_RESIZE_BR,Fn.a.MODE_HANDLER_RESIZE_B,Fn.a.MODE_HANDLER_RESIZE_BL,Fn.a.MODE_HANDLER_RESIZE_L,Fn.a.MODE_HANDLER_RESIZE_TL].forEach(function(t){var n=document.createElement("div");n.className=Ts.RESIZE_POINT,n.setAttribute(Ts.RESIZE_HANDLE_ATTR,t.toLowerCase()),t===Fn.a.MODE_HANDLER_RESIZE_TL&&(n.id=Ts.PHOTO_CROP_AREA_PIVOT),e.band.appendChild(n),e.elementMap.set(t.toLowerCase(),n)})}},{key:"addSmallPlusButton",value:function(){this.lilPlus=document.createElement("img"),this.lilPlus.src="".concat(fs.a.RESOURCE_DOMAIN,"image/itemhandle/extra_text_icon.png"),this.lilPlus.classList.add("small_plus"),this.band.appendChild(this.lilPlus)}},{key:"makeGridButtons",value:function(){this.gridButtons=document.createElement("div"),this.gridButtons.classList.add("grid_buttons");var e=document.createElement("div");e.classList.add("border","leftBorder");var t=document.createElement("div");t.classList.add("border","topBorder");var n=document.createElement("div");n.classList.add("border","rightBorder");var i=document.createElement("div");i.classList.add("border","bottomBorder");var a=document.createElement("div");a.classList.add("rightHandle");var o=this.makePointDiv();o.classList.add("top"),a.appendChild(o);var s=this.makePointDiv();s.classList.add("center"),a.appendChild(s);var r=this.makePointDiv();r.classList.add("bottom"),a.appendChild(r),a.setAttribute(Ts.RESIZE_HANDLE_ATTR,Fn.a.MODE_HANDLER_RESIZE_R);var l=document.createElement("div");l.classList.add("bottomHandle");var c=this.makePointDiv();c.classList.add("left"),l.appendChild(c);var u=this.makePointDiv();u.classList.add("center"),l.appendChild(u);var d=this.makePointDiv();d.classList.add("right"),l.appendChild(d),l.setAttribute(Ts.RESIZE_HANDLE_ATTR,Fn.a.MODE_HANDLER_RESIZE_B);var h=document.createElement("div");h.classList.add("rightBottomHandle");var p=this.makePointDiv();p.classList.add("center"),h.appendChild(p),h.setAttribute(Ts.RESIZE_HANDLE_ATTR,Fn.a.MODE_HANDLER_RESIZE_BR);var m=document.createElement("div");m.classList.add("leftTopHandle","hoverable");var f=document.createElement("div");f.classList.add("leftTopPoint"),m.appendChild(f);var v=this.makeRowDiv(-1),g=this.makeColDiv(-1);this.gridButtons.appendChild(e),this.gridButtons.appendChild(t),this.gridButtons.appendChild(n),this.gridButtons.appendChild(i),this.gridButtons.appendChild(a),this.gridButtons.appendChild(l),this.gridButtons.appendChild(h),this.gridButtons.appendChild(m),this.gridButtons.appendChild(v),this.gridButtons.appendChild(g),this.firstRowPoint=v,this.firstColPoint=g,this.gridColDivs=[],this.gridRowDivs=[],this.gridColCellBorders=[],this.gridRowCellBorders=[]}},{key:"makePointDiv",value:function(){var e=document.createElement("div");return e.classList.add("point"),e}},{key:"makeRowBorderPoint",value:function(e,t){var n=document.createElement("div");if(n.classList.add("borderDiv","hoverable","row"),0!==t){var i=function(e){e.preventDefault(),e.stopPropagation(),X.a.instance.dispatch(new K.c(function(e,n,i){n.mouseAction.mode=Fn.a.MODE_GRID_HANDLER_DOWN;var a=n.activeItems[0];a.unselectAllCell();for(var o=[],s=0;s<a.col;s++)o.push(new Ln.a(t-1,s));a.selectCells(o),n.pageController.getItemRenderer(a).renderViewAfter(null,n.pageEditScale),i.renderItemTools(e,n)}))};n.addEventListener("mousedown",i),n.addEventListener("touchstart",i)}var a=document.createElement("div");a.classList.add("borderPoint","row","hoverable"),a.setAttribute("rowBorderIdx","".concat(t)),Object(ne.setToolsIcon)(a,ne.ToolsIcon.PLUS),0===t&&a.classList.add("firstPoint"),e.appendChild(n),e.appendChild(a),this.addEventListenerGridBorderPoint(a)}},{key:"makeColBorderPoint",value:function(e,t){var n=document.createElement("div");if(n.classList.add("borderDiv","hoverable","col"),0!==t){var i=function(e){e.preventDefault(),e.stopPropagation(),X.a.instance.dispatch(new K.c(function(e,n,i){n.mouseAction.mode=Fn.a.MODE_GRID_HANDLER_DOWN;var a=n.activeItems[0];a.unselectAllCell();for(var o=[],s=0;s<a.row;s++)o.push(new Ln.a(s,t-1));a.selectCells(o),n.pageController.getItemRenderer(a).renderViewAfter(null,n.pageEditScale),i.renderItemTools(e,n)}))};n.addEventListener("mousedown",i),n.addEventListener("touchstart",i)}var a=document.createElement("div");a.classList.add("borderPoint","col","hoverable"),0===t&&a.classList.add("firstPoint"),a.setAttribute("colBorderIdx","".concat(t)),Object(ne.setToolsIcon)(a,ne.ToolsIcon.PLUS),e.appendChild(n),e.appendChild(a),this.addEventListenerGridBorderPoint(a)}},{key:"addEventListenerGridBorderPoint",value:function(e){var t=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(n||2!==t.button){Y.a.instance.mouseAction.mode=Fn.a.MODE_GRID_HANDLER_DOWN;var i=Y.a.instance.activeItems[0];if(e.classList.contains("row")){var a=Number(e.getAttribute("rowBorderIdx"));0===a?X.a.instance.dispatch(new to(i,a)):X.a.instance.dispatch(new no(i,a)),J.a.selectItem(i)}else if(e.classList.contains("col")){var o=Number(e.getAttribute("colBorderIdx"));0===o?X.a.instance.dispatch(new Ja(i,o)):X.a.instance.dispatch(new eo(i,o))}t.preventDefault(),t.stopPropagation()}};e.addEventListener("mousedown",t),e.addEventListener("touchstart",function(e){return t(e,!0)});var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t||2!==e.button){var n=Y.a.instance.activeItems[0];X.a.instance.dispatch(new K.c(function(e,t,i){J.a.selectItem(n),i.renderHandler(e,t),t.mouseAction.mode=Fn.a.MODE_NONE})),e.preventDefault(),e.stopPropagation()}};e.addEventListener("mouseup",n),e.addEventListener("touchend",function(e){return n(e,!0)}),e.addEventListener("mouseenter",function(){e.classList.add("hover")}),e.addEventListener("mouseleave",function(){e.classList.remove("hover")})}},{key:"makeRowDiv",value:function(e){var t=document.createElement("div");return t.classList.add("gridLine","row"),e<0&&t.classList.add("firstRow"),t.setAttribute("rowIdx","".concat(e)),this.makeRowBorderPoint(t,e+1),t}},{key:"makeColDiv",value:function(e){var t=document.createElement("div");return t.classList.add("gridLine","col"),e<0&&t.classList.add("firstCol"),t.setAttribute("rowIdx","".concat(e)),this.makeColBorderPoint(t,e+1),t}},{key:"setElementClass",value:function(e,t){e?this.element.classList.add(t):this.element.classList.remove(t)}},{key:"setVisibilityResizeButtons",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];n.forEach(function(n){var i=t.elementMap.get(n.toLowerCase());null!=i&&(e?(t.band!==i.parentElement&&t.band.appendChild(i),i.style.display=""):i.style.display="none")})}},{key:"setResizeButtonDisplay",value:function(e,t,n){if(e.isLock||n)this.setVisibilityResizeButtons(!1,[Fn.a.MODE_HANDLER_RESIZE_T,Fn.a.MODE_HANDLER_RESIZE_TR,Fn.a.MODE_HANDLER_RESIZE_R,Fn.a.MODE_HANDLER_RESIZE_BR,Fn.a.MODE_HANDLER_RESIZE_B,Fn.a.MODE_HANDLER_RESIZE_BL,Fn.a.MODE_HANDLER_RESIZE_L,Fn.a.MODE_HANDLER_RESIZE_TL]);else{var i=e.isLock!==t.isLock||null==n,a=Math.ceil(e.width*e.editScale*e.zoomScale),o=Math.ceil(e.height*e.editScale*e.zoomScale),s=e.isChangeableWidth!==t.isChangeableWidth,r=e.isChangeableHeight!==t.isChangeableHeight;i&&this.setVisibilityResizeButtons(!0,[Fn.a.MODE_HANDLER_RESIZE_TL,Fn.a.MODE_HANDLER_RESIZE_TR,Fn.a.MODE_HANDLER_RESIZE_BL,Fn.a.MODE_HANDLER_RESIZE_BR]),(i||s)&&this.setVisibilityResizeButtons(e.isChangeableWidth,[Fn.a.MODE_HANDLER_RESIZE_L,Fn.a.MODE_HANDLER_RESIZE_R]),(i||r)&&this.setVisibilityResizeButtons(e.isChangeableHeight,[Fn.a.MODE_HANDLER_RESIZE_T,Fn.a.MODE_HANDLER_RESIZE_B]),this.setElementClass(a<Ts.RESIZE_HANDLE_SIZE_TERM||o<Ts.RESIZE_HANDLE_SIZE_TERM,"handler_lv2");var l=a<Ts.RESIZE_HANDLE_VISIBLE_TERM,c=o<Ts.RESIZE_HANDLE_VISIBLE_TERM,u=l||c;this.setElementClass(l,"small_w_handler"),this.setElementClass(c,"small_h_handler"),this.setElementClass(u,"handler_lv3"),this.setElementClass(e.isTinyHandle,"tiny_handler")}}},{key:"setMoveButtonDisplay",value:function(e){var t=Math.ceil(e.width*e.editScale*e.zoomScale),n=Math.ceil(e.height*e.editScale*e.zoomScale);!e.isLock&&(t<Ts.MOVE_HANDLE_VISIBLE_TERM_BOTH&&n<Ts.MOVE_HANDLE_VISIBLE_TERM_BOTH||t<Ts.MOVE_HANDLE_VISIBLE_TERM_EITHER||n<Ts.MOVE_HANDLE_VISIBLE_TERM_EITHER)?this.moveButton.classList.add(Ts.BTN_MOVE):this.moveButton.classList.remove(Ts.BTN_MOVE)}},{key:"snapMove",value:function(e,t,n,i){Oo.doSnapMove(e,n.getScale(),n.getRotatedLTRB(!0),t.snapData,i)}},{key:"snapResize",value:function(e,t,n,i,a,o){Oo.doSnapResize(e,t,a,o,i.getScale(),i.getRotatedLTRB(!0),n.snapData)}},{key:"enableElementEvent",value:function(){this.element.style.pointerEvents=""}},{key:"disableElementEvent",value:function(){this.element.style.pointerEvents="none"}},{key:"updateHandlerPosition",value:function(){this.forceUpdatePosition=!0}},{key:"setCmd",value:function(e){this.element.setAttribute("data-cmd",e)}},{key:"getElementLTRB",value:function(e){var t=$(e).offset(),n=t.left,i=t.top,a=n+e.offsetWidth,o=i+e.offsetHeight;return new li.a(n,i,a,o)}},{key:"getButtonLTRB",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getElementLTRB(e);if(t){var i=this.getClientRect(),a=(i.left+i.right)/2,o=(i.top+i.bottom)/2,s=n.getCenterPos(),r=2*(a-s.x),l=2*(o-s.y);n.move(r,l)}return n}},{key:"getDegByDir",value:function(e,t){var n=0;if(t===Ts.RESIZE_POINT)switch(e){case Fn.a.MODE_HANDLER_RESIZE_R:n=0;break;case Fn.a.MODE_HANDLER_RESIZE_BR:n=45;break;case Fn.a.MODE_HANDLER_RESIZE_B:n=90;break;case Fn.a.MODE_HANDLER_RESIZE_BL:n=135;break;case Fn.a.MODE_HANDLER_RESIZE_L:n=180;break;case Fn.a.MODE_HANDLER_RESIZE_TL:n=225;break;case Fn.a.MODE_HANDLER_RESIZE_T:n=270;break;case Fn.a.MODE_HANDLER_RESIZE_TR:n=315}else switch(e){case es.b.RT:n=0;break;case es.b.RB:n=90;break;case es.b.LB:n=180;break;case es.b.LT:n=270}return n}},{key:"addEventListeners",value:function(){var e,t,n=this,i=!1,a=!1,o=!1;function s(e){e.preventDefault(),e.stopPropagation()}function l(e,t){t?e.classList.add(r.a.ACTIVE):e.classList.remove(r.a.ACTIVE)}function c(e){s(e),Y.a.instance.mouseAction.mode=Fn.a.MODE_NONE,X.a.instance.dispatch(new K.c(function(e,t,n){n.renderHandler(e,t)}))}je.a.isMobileDevice()||$(this.element).on("mouseenter",".".concat(Ts.RESIZE_POINT,", .").concat(Ts.CROP_RESIZE_HANDLE),function(s){if(!o){e=s.currentTarget;var l=0;if(s.currentTarget.classList.contains(Ts.RESIZE_POINT)){i=!0,n.curImg.src="".concat(fs.a.RESOURCE_DOMAIN,"image/cursor/resize_handle_ew.png");var c=e.getAttribute(Ts.RESIZE_HANDLE_ATTR).toUpperCase();l=n.getDegByDir(c,Ts.RESIZE_POINT)}else if(s.currentTarget.classList.contains(Ts.CROP_RESIZE_HANDLE)){a=!0,n.curImg.src="".concat(fs.a.RESOURCE_DOMAIN,"image/cursor/cur_crop.png");var u=e.getAttribute(Ts.CROP_RESIZE_DIRECTION_ATTR);l=n.getDegByDir(u,Ts.CROP_RESIZE_HANDLE)}l+=n.lastRotate,n.curImg.style.transform="rotate(".concat(l,"deg)"),n.resizeCursor.style.display="block",e.classList.add(r.a.HOVER),t=n.element.getBoundingClientRect(),n.curImg.style.left="".concat(s.pageX-t.left-n.curImg.width/2,"px"),n.curImg.style.top="".concat(s.pageY-t.top-n.curImg.height/2,"px"),X.a.instance.dispatch(new K.c(function(e,t,n){n.canvasAreaVC.container.style.cursor="none"}))}}),$(document).on("mousemove",function(s){var l=!1;if(i||a){switch(Y.a.instance.mouseAction.mode){case Fn.a.MODE_HANDLER_RESIZE_L:case Fn.a.MODE_HANDLER_RESIZE_T:case Fn.a.MODE_HANDLER_RESIZE_R:case Fn.a.MODE_HANDLER_RESIZE_B:case Fn.a.MODE_HANDLER_RESIZE_TL:case Fn.a.MODE_HANDLER_RESIZE_TR:case Fn.a.MODE_HANDLER_RESIZE_BL:case Fn.a.MODE_HANDLER_RESIZE_BR:l=!0}n.curImg.style.left="".concat(s.pageX-t.left-n.curImg.width/2,"px"),n.curImg.style.top="".concat(s.pageY-t.top-n.curImg.height/2,"px");var c=e.getBoundingClientRect(),u=s.clientX,d=s.clientY,h=new li.a(Math.floor(c.left),Math.floor(c.top),Math.ceil(c.right),Math.ceil(c.bottom)),p=u<h.left||u>h.right||d<h.top||d>h.bottom;l||o||!p||(n.resizeCursor.style.display="none",e.classList.remove(r.a.HOVER),i=!1,a=!1,X.a.instance.dispatch(new K.c(function(e,t,n){n.canvasAreaVC.container.style.cursor="default"})))}}),this.curImg.addEventListener("mousedown",function(t){i?n.resizePointMousedownListener(e):a&&(o=!0,$(e).trigger("mousedown"))});var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.stopPropagation(),t||2!==e.button){var i=Y.a.instance;if(i.renderPageIdx=n.pageIdx,t&&e.touches.length>=2)ps.startPinch(e.touches[0],e.touches[1]);else{var a=e.target,o=a.classList,s=t?e.touches[0]:e;if(i.mouseAction.mode===Fn.a.MODE_HANDLER_ROTATE||i.mouseAction.mode===Fn.a.MODE_HANDLER_MOVE_START)t&&e.preventDefault();else if(o.contains(Ts.RESIZE_POINT))n.resizePointMousedownListener(a),t&&e.preventDefault();else{var r,l=null,c=null;X.a.instance.dispatch(new K.c(function(e,t,i){var a=e.pages[n.pageIdx];l=t.pageController.getPageRenderer(a),r=l.isInRange(s.clientX,s.clientY),c=i.canvasAreaVC.mouseDblClickManager}));var u=Cn(s.clientX,s.clientY),d=u.outputX,h=u.outputY,p=l.getSelectedItemInfo(d,h),m=p.selectedSingleItem;if(m&&m instanceof q.a&&m.select&&!m.isEditMode&&c.clear(),t)if(Y.a.isCropMode())i.mouseAction.mode=Fn.a.MODE_HANDLER_DOWN,e.preventDefault();else{if(!r)return;var f=!1;if(it.a.isEmpty(p.selectedGroupItems)){if(p.selectedSingleItem){var v=Qe.b.getRootGroup(p.selectedSingleItem.groupId);f=v?null!==v.getSelectedItem():p.selectedSingleItem.select}}else f=p.selectedGroupItems.some(function(e){return e.select});var g=i.activeItems.some(function(e){return e.isLock()});f&&!g?(i.mouseAction.mode=Fn.a.MODE_HANDLER_DOWN,e.preventDefault()):i.mouseAction.mode=Fn.a.MODE_MOBILE_DOWN}else i.mouseAction.mode=Fn.a.MODE_HANDLER_DOWN}var E=null,y=null;X.a.instance.dispatch(new K.c(function(e,t,n){E=n.canvasAreaVC.container,y=n.canvasAreaVC.selectArea})),X.a.instance.dispatch(new ls(n.pageIdx,E,y,s,e.shiftKey,e.ctrlKey,t))}}};this.band.addEventListener("mousedown",u),this.band.addEventListener("touchstart",function(e){return u(e,!0)}),$(this.buttonWrapper).on("mousedown touchstart",".".concat(Ts.BTN_ROTATE),function(e){Y.a.instance.mouseAction.mode=Fn.a.MODE_HANDLER_ROTATE,l(this,!0)}).on("mouseup touchend",".".concat(Ts.BTN_ROTATE),function(e){l(this,!1)}).on("mousedown touchstart",".".concat(Ts.BTN_UNLOCK),s).on("mouseup touchend",".".concat(Ts.BTN_UNLOCK),function(e){n.tooltipBtnUnLock.hide(),X.a.instance.dispatch(new On.p(Y.a.instance.activeItems)),s(e)}).on("mousemove touchmove",".".concat(Ts.BTN_PHOTO_CROP_ACCEPT,",\n            .").concat(Ts.BTN_PHOTO_CROP_CANCEL,", .").concat(Ts.BTN_PHOTO_EMPTY,", .").concat(Ts.BTN_UNLOCK),function(e){s(e)}),$(this.moveButton).on("mousedown touchstart",function(e){Y.a.instance.mouseAction.mode=Fn.a.MODE_HANDLER_MOVE_START,l(this,!0)}).on("mouseup touchend",function(e){l(this,!1)}),$(this.footerElement).on("mousedown touchstart",".".concat(Ts.BTN_COPY,", .").concat(Ts.BTN_DELETE),c).on("mouseup touchend",".".concat(Ts.BTN_COPY,", .").concat(Ts.BTN_DELETE),c);this.cropTools.addEventListeners(function e(){o=!1;try{Y.a.instance.activeItems[0].photoCrop.initResizeDirection(),document.removeEventListener("mouseup",e),document.removeEventListener("touchend",e)}catch(e){console.error(e)}}),$(this.gridButtons).on("mousedown touchstart",".rightBottomHandle",function(e){Y.a.instance.mouseAction.mode=Fn.a.MODE_ITEM_RESIZE,s(e)}).on("mouseenter",".rightBottomHandle, .rightHandle, .bottomHandle",function(a){e=a.currentTarget;var o,s=0;i=!0,n.curImg.src="".concat(fs.a.RESOURCE_DOMAIN,"image/cursor/resize_handle_ew.png"),o=e.classList.contains("rightBottomHandle")?Fn.a.MODE_HANDLER_RESIZE_BR:e.classList.contains("rightHandle")?Fn.a.MODE_HANDLER_RESIZE_R:Fn.a.MODE_HANDLER_RESIZE_B,s=n.getDegByDir(o,Ts.RESIZE_POINT),s+=n.lastRotate,n.curImg.style.transform="rotate(".concat(s,"deg)"),n.curImg.style.zIndex="3950",n.resizeCursor.style.display="block",t=n.element.getBoundingClientRect(),n.curImg.style.left="".concat(a.pageX-t.left-n.curImg.width/2,"px"),n.curImg.style.top="".concat(a.pageY-t.top-n.curImg.height/2,"px"),X.a.instance.dispatch(new K.c(function(e,t,n){n.canvasAreaVC.container.style.cursor="none"}))}).on("mouseup touchend",".leftTopHandle",function(e){J.a.selectItem(Y.a.instance.activeItems[0])}).on("mouseenter",".hoverable",function(e){e.currentTarget.classList.add("hover")}).on("mouseleave",".hoverable",function(e){e.currentTarget.classList.remove("hover")}).on("mousedown touchstart",".leftTopHandle",function(e){2!==e.buttons&&(X.a.instance.dispatch(new K.c(function(e,t,n){t.mouseAction.mode=Fn.a.MODE_GRID_HANDLER_DOWN;var i=t.activeItems[0],a=t.pageController.getItemRenderer(i);i.isTextEditMode&&a.toggleEditMode(-1,-1);for(var o=[],s=0;s<i.row;s++)for(var r=0;r<i.col;r++)o.push(new Ln.a(s,r));i.selectCells(o),a.renderViewAfter(null,t.pageEditScale),n.renderHandler(e,t)})),s(e))})}},{key:"resizePointMousedownListener",value:function(e){var t=this;Y.a.instance.mouseAction.mode=e.getAttribute(Ts.RESIZE_HANDLE_ATTR).toUpperCase(),X.a.instance.dispatch(new K.c(function(n,i,a){a.itemHandleVC.contentsStates.cmd={type:$e.a.RESIZE},t.setCmd($e.a.RESIZE.toLowerCase()),t.updateToolTipSizeText(i.option.pageSize?i.option.pageSize.unit.toString():"px");var o=e.getBoundingClientRect(),s=o.left+30,r=o.top+30;t.tooltipSize.show(!1,100,s,r)}))}},{key:"isBottomRotateHandle",value:function(){return this.buttonWrapper.classList.contains(Ts.BTN_BOTTOM)}},{key:"isLeftMoveHandle",value:function(){return this.moveButton.classList.contains(Ts.BTN_LEFT)}},{key:"getClientRect",value:function(){return this.band.getBoundingClientRect()}},{key:"updateBackgroundViewMode",value:function(e){if(1===e.length){var t=e[0];t.isOnlyOneItem()&&t.select&&!t.isEditMode?this.band.classList.add("background_view"):this.band.classList.remove("background_view")}else this.band.classList.remove("background_view")}}],[{key:"getPositionSize",value:function(e,t,n,i){var a=De.a.getSizeFromPixelWithDecimal(e,n,i),o=De.a.getSizeFromPixelWithDecimal(t,n,i);return new Nn.a(a,o)}}]),e}(),Es=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e.d.DEFAULT,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4?arguments[4]:void 0,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return L()(this,t),(e=V()(this,F()(t).call(this))).mode=n,e.itemsKey=i,e.snapData=a,e.handlerType=o,e.cmd=s,e.hasGridItem=r,e.isDisabledEvent=l,e}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return!1}},{key:"compareSnapByType",value:function(e,t){return this.isTargetSnapByType(e)&&this.isSourceSnapByType(t)}},{key:"isTargetSnapByType",value:function(e){return!!this.snapData&&this.isSnapLineByType(this.snapData.targetLineX,this.snapData.targetLineY,e)}},{key:"isSourceSnapByType",value:function(e){return!!this.snapData&&this.isSnapLineByType(this.snapData.lineX,this.snapData.lineY,e)}},{key:"isSnapLineByType",value:function(e,t,n){return n===$e.c.LEFT||n===$e.c.RIGHT||n===$e.c.CENTER_X?(e&n)>0:(n===$e.c.TOP||n===$e.c.BOTTOM||n===$e.c.CENTER_Y)&&(t&n)>0}},{key:"isSnapLineX",value:function(){return!!this.snapData&&(0!==this.snapData.dx&&(this.snapData.lineX&($e.c.LEFT|$e.c.RIGHT|$e.c.CENTER_X))>0)}},{key:"isSnapLineY",value:function(){return!!this.snapData&&(0!==this.snapData.dy&&(this.snapData.lineY&($e.c.TOP|$e.c.BOTTOM|$e.c.CENTER_Y))>0)}},{key:"hasSnapToItemX",value:function(){return this.snapData&&this.snapData.list.filter(function(e){return e.snapX&&e.type===Jo.a.ITEM}).length>0}},{key:"hasSnapToItemY",value:function(){return this.snapData&&this.snapData.list.filter(function(e){return e.snapY&&e.type===Jo.a.ITEM}).length>0}},{key:"hasSnapToItemXByType",value:function(e){return this.snapData&&this.snapData.list.filter(function(t){return(t.snapX&e)>0&&t.type===Jo.a.ITEM}).length>0}},{key:"hasSnapToItemYByType",value:function(e){return this.snapData&&this.snapData.list.filter(function(t){return(t.snapY&e)>0&&t.type===Jo.a.ITEM}).length>0}},{key:"getScaledPositionBySnapX",value:function(e,t,n){var i=this.getSnapTargetDataX(e,t);if(void 0!==i)return Math.ceil(i*n)}},{key:"getSnapTargetDataX",value:function(e,t){if(this.snapData&&0!==this.snapData.list.length&&-1!==this.snapData.targetIndexX){var n=this.snapData.list.filter(function(t){return(t.snapX&e)>0&&t.type===Jo.a.ITEM});if(0!==n.length)return t===$e.c.TOP?n.map(function(e){return e.ltrb.getRotatedTop().y}).reduce(function(e,t){return Math.min(e,t)}):t===$e.c.BOTTOM?n.map(function(e){return e.ltrb.getRotatedBottom().y}).reduce(function(e,t){return Math.max(e,t)}):void 0}}},{key:"getScaledPositionBySnapY",value:function(e,t,n){var i=this.getSnapTargetDataY(e,t);if(void 0!==i)return Math.ceil(i*n)}},{key:"getSnapTargetDataY",value:function(e,t){if(this.snapData&&0!==this.snapData.list.length&&-1!==this.snapData.targetIndexY){var n=this.snapData.list.filter(function(t){return(t.snapY&e)>0&&t.type===Jo.a.ITEM});if(0!==n.length)return t===$e.c.LEFT?n.map(function(e){return e.ltrb.getRotatedLeft().x}).reduce(function(e,t){return Math.min(e,t)}):t===$e.c.RIGHT?n.map(function(e){return e.ltrb.getRotatedRight().x}).reduce(function(e,t){return Math.max(e,t)}):void 0}}}]),t}(He.b),ys=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,h=arguments.length>10&&void 0!==arguments[10]&&arguments[10],p=arguments.length>11&&void 0!==arguments[11]&&arguments[11],m=arguments.length>12&&void 0!==arguments[12]&&arguments[12],f=arguments.length>13&&void 0!==arguments[13]&&arguments[13],v=arguments.length>14&&void 0!==arguments[14]&&arguments[14],g=!(arguments.length>15&&void 0!==arguments[15])||arguments[15],E=arguments.length>16&&void 0!==arguments[16]&&arguments[16],y=arguments.length>17&&void 0!==arguments[17]?arguments[17]:0,T=arguments.length>18&&void 0!==arguments[18]?arguments[18]:0,I=arguments.length>19?arguments[19]:void 0,C=arguments.length>20?arguments[20]:void 0;return L()(this,t),(e=V()(this,F()(t).call(this))).pageIdx=n,e.left=i,e.top=a,e.width=o,e.height=s,e.ratio=r,e.rotate=l,e.editScale=c,e.visible=u,e.zoomScale=d,e.isLock=h,e.setPositionFromItem=p,e.isChangeableWidth=m,e.isChangeableHeight=f,e.isTinyHandle=v,e.canRotate=g,e.isBottomRotateHandle=E,e.canvasWidth=y,e.canvasHeight=T,e.smallPlus=I,e.footerDistance=C,e}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return!1}},{key:"getMathRoundLeft",value:function(){return Math.round(this.left)}},{key:"getMathRoundTop",value:function(){return Math.round(this.top)}},{key:"getTransformOriginXAxis",value:function(){return this.width/2*this.editScale}},{key:"getTransformOriginYAxis",value:function(){return this.height/2*this.editScale}},{key:"getRotatedLTRB",value:function(e){var t=new li.a(this.left,this.top,this.left+this.width,this.top+this.height),n=e?this.rotate:-this.rotate;return 0===this.rotate?t:t.getRotatedLTRB(n)}},{key:"getScale",value:function(){return this.editScale*this.zoomScale}},{key:"getScaledPositionBySnap",value:function(e){return Math.ceil(this.getNotCeilScaledPositionBySnap(e))}},{key:"getNotCeilScaledPositionBySnap",value:function(e){return this.getLTRBPosition(e)*this.getScale()}},{key:"getLTRBPosition",value:function(e){var t=this.getRotatedLTRB(!1);return e===$e.c.LEFT?t.left:e===$e.c.CENTER_X?t.getCenterPosX():e===$e.c.RIGHT?t.right:e===$e.c.TOP?t.top:e===$e.c.CENTER_Y?t.getCenterPosY():e===$e.c.BOTTOM?t.bottom:void 0}}]),t}(He.c),Ts=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,!0))).handlerList=[],e.contentsStates=new Es,e.positionStates=new ys,e}return z()(t,e),w()(t,[{key:"onDataChanged",value:function(e,t,n){this.designDoc=e,this.renderView(t,n)}},{key:"renderView",value:function(e,n){var i=this;he()(F()(t.prototype),"renderView",this).call(this),this.designDoc.pages.forEach(function(e){var t=Y.a.instance.pageController.getPageRenderer(e),n=i.handlerList[e.pageIdx];n?n.pageId!==e.pageId&&t&&(i.handlerList[e.pageIdx]=new gs(t.getLayerElement(Zo.a.HANDLER),e.pageId)):i.handlerList.push(new gs(t.getLayerElement(Zo.a.HANDLER),e.pageId))}),this.handlerList.length>this.designDoc.pages.length&&(this.handlerList=this.handlerList.slice(0,this.designDoc.pages.length));var a=this.contentsStates,o=this.positionStates;this.checkUpStatesChange(this.getRenderStatus(this.designDoc,e,n)),this.lastRenderPageIdx=this.positionStates.pageIdx,this.positionStates.visible?(this.handlerList[this.positionStates.pageIdx].setRenderStates(this.designDoc,Y.a.instance,this.contentsStates,a,this.positionStates,o,e),this.designDoc.pages.forEach(function(e){var t=e.background.backgroundItem,n=t&&t.select&&!t.isEditMode;(e.pageIdx!==i.positionStates.pageIdx||n)&&i.handlerList[e.pageIdx].hide(),i.handlerList[e.pageIdx].setHandlerMode(i.contentsStates.mode,e.pageIdx===i.positionStates.pageIdx)})):this.designDoc.pages.forEach(function(e){i.handlerList[e.pageIdx].hide()})}},{key:"getRenderStatus",value:function(e,t,n){if(!t)return this.getNewRenderStates(e,n);var i=this.contentsStates.shallowClone(),a=this.positionStates.shallowClone();switch(i.cmd=t,t.type){case $e.a.MOVE:a.left+=t.tx,a.top+=t.ty;break;case $e.a.ROTATE:break;case $e.a.RESIZE:i=this.contentsStatesForResize.shallowClone(),a=this.positionStatesForResize.shallowClone();break;case $e.a.PHOTO_CROP:i.mode=$e.d.PHOTO_CROP;break;case $e.a.IMAGE_FRAME_PHOTO_CROP:i.mode=$e.d.IMAGE_FRAME_PHOTO_CROP;break;case $e.a.CANCEL_PHOTO_CROP:i.mode=$e.d.DEFAULT;break;case $e.a.GRID_CELL_THICKNESS_RESIZE:i.mode=$e.d.GRID;break;case $e.a.WINDOW_RESIZE:return this.getNewRenderStates(e);default:throw Error("command... : "+t)}return{contents:i,position:a}}},{key:"getNewRenderStates",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Y.a.instance,i=Qe.b.getGroupItemsAddedArray(n.activeItems.slice());if(0===i.length||Y.a.isSpoidMode()){var a=this.contentsStates.shallowClone(),o=this.positionStates.shallowClone();return a.mode=$e.d.DEFAULT,o.visible=!1,{contents:a,position:o}}var s=this.lastRenderPageIdx===n.renderPageIdx?e.pages[n.renderPageIdx]:Qo.a.getItemIncludedPage(e.pages,i[0]),r=n.pageEditScale,l=null;Y.a.isCropMode()?l=n.activeItems[0]:1===i.length&&(l=i[0]);var c={list:[],dx:0,dy:0,lineX:$e.c.NONE,lineY:$e.c.NONE,targetIndexX:-1,targetLineX:$e.c.NONE,targetIndexY:-1,targetLineY:$e.c.NONE,targetTypeX:Jo.a.NONE,targetTypeY:Jo.a.NONE,isFromKeyAction:!1};c.list.push({ltrb:new li.a(0,0,s.sheetSize.width,s.sheetSize.height,0),type:Jo.a.PAGE}),Ke.a.getUserSetting().isGuidelineVisible&&(c.list=c.list.concat(s.guidelineManager.getSnapTargetDataArray()));var u,d,h=[],p=!0,m=!1,f=void 0;try{for(var v,g=s.getAllSingleItems()[Symbol.iterator]();!(p=(v=g.next()).done);p=!0){var E=v.value;if(!E.select){var y=Qe.b.getRootGroup(E.groupId);y?h.indexOf(y)<0&&(h.push(y),c.list.push({ltrb:$o.a.getItemsLTRBCoordinate(y.getMembers(),!0),type:Jo.a.ITEM})):c.list.push({ltrb:E.getLTRBCoordinate(!0),type:Jo.a.ITEM})}}}catch(e){m=!0,f=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw f}}var T,I,C,k,L,_,w,S=this.contentsStates.mode,b=ms.NORMAL,R=!1,A=!1,O=!1;if(l){T=l.tbpeId;var P=l.props;if(u=P.getLeft(),d=P.getTop(),I=P.getWidth(),C=P.getHeight(),k=P.getRotate(),S=l instanceof Z.a?$e.d.GRID:l instanceof Je.d&&Y.a.isCropMode()?l.belongsTo===Je.c.INDEPENDENT?$e.d.PHOTO_CROP:l.belongsTo===Je.c.IMAGEFRAME?$e.d.IMAGE_FRAME_PHOTO_CROP:$e.d.DEFAULT:$e.d.DEFAULT,R=l.isChangeableWidth(),A=l.isChangeableHeight(),l instanceof qo.a&&(l.isPatternSVG()||l.isExtendSVG()))R&&A?b=ms.PATTERN_WH:R?b=ms.PATTERN_W:A&&(b=ms.PATTERN_H);else if(l instanceof q.a){b=ms.TEXT,O=l.isTinyHandle();var D=l.getFooterDistance();0!==D&&(_=D),w=l.getSmallPlusPos()}else l instanceof Z.a&&(_=20);L=l.canRotate()}else{S=$e.d.DEFAULT,L=i.every(function(e){return e.canRotate()}),T=i.reduce(function(e,t){return e+t.tbpeId},"");var M=this.contentsStates.cmd;if(!M||M.type!==$e.a.ROTATE&&M.type!==$e.a.MOVE&&M.type!==$e.a.RESIZE||this.contentsStates.itemsKey!==T||n.renderPageIdx!==this.positionStates.pageIdx){var N=$o.a.getItemsLTRBCoordinate(i,!0);u=N.left,d=N.top,I=N.right-u,C=N.bottom-d,k=0}else u=this.positionStates.left,d=this.positionStates.top,I=this.positionStates.width,C=this.positionStates.height,k=this.positionStates.rotate}var x=this.handlerList[n.renderPageIdx].isBottomRotateHandle(),B=l&&(l instanceof qo.a||l instanceof q.a||S===$e.d.PHOTO_CROP),V=i[0].isLock(),U=!i.every(function(e){return e.getItemType()!==Ei.b.GRID}),F=this.contentsStates.isDisabledEvent;if(!t)if(1===n.activeItems.length&&n.activeItems[0].getItemType()===Ei.b.YOUTUBE)F=!0;else{var G=Qe.b.getRootGroup(n.activeItems[0].groupId);F=G&&G.getSelectedItem()&&G.getSelectedItem().getItemType()===Ei.b.YOUTUBE}var H=new Es(S,T,c,V?ms.LOCK:b,void 0,U,F),W=new ys(s.pageIdx,u,d,I,C,C/I,k,r,!0,n.zoomScale,V,B,R,A,O,L,x,n.size.canvasWidth,n.size.canvasHeight,w,_);return H.forceUpdate=this.lastRenderPageIdx!==s.pageIdx,{contents:H,position:W}}},{key:"snapMove",value:function(e,t){var n=this;Y.a.isCropMode()||X.a.instance.dispatch(new K.c(function(){n.handlerList[n.lastRenderPageIdx].snapMove(e,n.contentsStates,n.positionStates,t)}))}},{key:"snapResize",value:function(e,t,n,i){var a=this;Y.a.isCropMode()||X.a.instance.dispatch(new K.c(function(){a.handlerList[a.lastRenderPageIdx].snapResize(e,t,a.contentsStates,a.positionStates,n,i)}))}},{key:"getLTRB",value:function(){var e=this.positionStates;return new li.a(e.left,e.top,e.left+e.width,e.top+e.height,e.rotate)}},{key:"rotate",value:function(e){this.setDegree(this.positionStates.rotate+e)}},{key:"setDegree",value:function(e){this.positionStates.rotate=e}},{key:"readyResize",value:function(){this.contentsStatesForResize=this.contentsStates.shallowClone(),this.positionStatesForResize=this.positionStates.shallowClone()}},{key:"enableElementEvent",value:function(){var e=this;X.a.instance.dispatch(new K.c(function(t){t.pages.forEach(function(t){e.handlerList[t.pageIdx].enableElementEvent()})}))}},{key:"disableElementEvent",value:function(){var e=this;X.a.instance.dispatch(new K.c(function(t){t.pages.forEach(function(t){e.handlerList[t.pageIdx].disableElementEvent()})}))}},{key:"getOffsetLTRB",value:function(){if(this.handlerList[this.lastRenderPageIdx]){var e=$(this.handlerList[this.lastRenderPageIdx].band),t=e.offset().left,n=e.offset().top;return new li.a(t,n,t+e.width(),n+e.height())}}},{key:"updateHandlerPosition",value:function(){this.handlerList[this.lastRenderPageIdx]&&this.handlerList[this.lastRenderPageIdx].updateHandlerPosition()}},{key:"calculateRatio",value:function(){this.positionStates.ratio=this.positionStates.height/this.positionStates.width}},{key:"getClientRect",value:function(e){return this.handlerList[e].getClientRect()}}]),t}(He.a);Ts.HANDLERS="handlers",Ts.FOOTER_BUTTONS="footer_buttons",Ts.RESIZE_POINT="resize_point",Ts.RESIZE_POINT_CURSOR_WRAP="resize_point_cursor_wrap",Ts.RESIZE_POINT_CURSOR="resize_point_cursor",Ts.RESIZE_HANDLE_ATTR="data-term",Ts.INLINE_BUTTON="inline_button",Ts.BASIC_BUTTONS="basic_buttons",Ts.MOVE_BUTTON="move_button",Ts.PHOTO_CROP_BUTTONS="photo_crop_buttons",Ts.PHOTO_CROP_AREA="photo_crop_area",Ts.PHOTO_CROP_AREA_PIVOT="photo_crop_area_pivot",Ts.PHOTO_CROP_RESIZE_BUTTONS="photo_crop_resize_buttons",Ts.CROP_RESIZE_HANDLE="crop_resize_handle",Ts.CROP_IMAGE_FRAME_PHOTO="crop_image_frame_photo",Ts.CROP_RESIZE_DIRECTION_ATTR="data-direction",Ts.BTN_MOVE="btn_move",Ts.BTN_ROTATE="btn_rotate",Ts.BTN_UNLOCK="btn_unlock",Ts.BTN_COPY="btn_copy",Ts.BTN_DELETE="btn_delete",Ts.BTN_PHOTO_CROP_ACCEPT="crop_accept",Ts.BTN_PHOTO_CROP_CANCEL="crop_cancel",Ts.IMAGE_CROP_MODE="image_crop_mode",Ts.BTN_PHOTO_EMPTY="photo_empty",Ts.BTN_LEFT="btn_left",Ts.BTN_TOP="btn_top",Ts.BTN_RIGHT="btn_right",Ts.BTN_BOTTOM="btn_bottom",Ts.MOVE_HANDLE_VISIBLE_TERM_BOTH=60,Ts.MOVE_HANDLE_VISIBLE_TERM_EITHER=20,Ts.RESIZE_HANDLE_SIZE_TERM=44,Ts.RESIZE_HANDLE_VISIBLE_TERM=24,Ts.RESIZE_HANDLE_VISIBLE_TERM_GRID=24,Ts.RESIZE_HANDLE_VISIBLE_TERM_CELL=12,function(e){e.NORMAL="normal",e.LOCK="lock",e.PATTERN_WH="pattern_wh",e.PATTERN_W="pattern_w",e.PATTERN_H="pattern_h",e.TEXT="text",e.GRID="grid"}(ms||(ms={}));var Is=n(578),Cs=n(439),ks=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).commitAction=function(e,t,n){t.mouseAction.mode=Fn.a.MODE_NONE,e.pages[t.renderPageIdx].getAllSingleItems().forEach(function(e){e.props.updateRevision()}),n.renderCanvas(e,t),n.renderHandler(e,t,{type:$e.a.WINDOW_RESIZE}),n.renderPageNavigator(e,t),X.a.instance.dispatch(new Jn.g)},n}return z()(t,e),t}(K.d),Ls=n(386),_s=function(e){function t(e,n,i,a,o){var s;return L()(this,t),(s=V()(this,F()(t).call(this))).isPossibleInCropMode=!0,s.doSaveQueue=!1,s.changeDesign=function(){return!1},s.actionType=K.a.MOUSE_CLICK,s.commitAction=function(e,t,n){var i=e.pages[s.pageIdx],a=t.pageController.getPageRenderer(i),o=Cn(s.clientX,s.clientY),r=o.outputX,l=o.outputY,c=a.getInRangeItem(r,l);Y.a.instance.mouseAction.mode!==Fn.a.MODE_NAVIGATION&&null!=c&&(c.isLock()||Y.a.isCropMode())},s.rollbackAction=function(){},s.recycle=function(){s.canvas=null},s.pageIdx=e,s.canvas=n,s.clientX=i,s.clientY=a,s.detail=o,s.renderAuto=!1,s}return z()(t,e),t}(K.b),ws=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this))).isPossibleInCropMode=!0,o.doSaveQueue=!1,o.changeDesign=function(){return!1},o.actionType=K.a.MOUSE_DBLCLICK,o.commitAction=function(e,n){var i=e.pages[o.pageIdx],a=n.pageController.getPageRenderer(i),s=Cn(o.clientX,o.clientY),r=s.outputX,l=s.outputY,c=a.getInRangeItem(r,l),u=Y.a.isCropMode();if((!a.isGroupSelected(r,l)||u||c instanceof q.a)&&!(Y.a.instance.mouseAction.mode===Fn.a.MODE_NAVIGATION||c&&c.isLock())){var d=t.getPhotoItem(c);if(d){var h=a.getInRangeItems(r,l,r,l);t.canPhotoCropCancel(d,h)?X.a.instance.dispatch(new Gn.d):d.tbpeId===c.tbpeId||h.includes(d)?u?X.a.instance.dispatch(new Gn.c):X.a.instance.dispatch(new Gn.b(d)):c instanceof Je.d?X.a.instance.dispatch(new Gn.c(d)):c instanceof ee.b?X.a.instance.dispatch(new Rn.i):X.a.instance.dispatch(new Gn.c(d))}else if(c instanceof ee.b&&c.getFrameColor()?X.a.instance.dispatch(new Rn.h(c)):c instanceof Z.a&&!c.isTextEditMode&&X.a.instance.dispatch(new Sn(c,r,l)),null!=c&&!Y.a.isCropMode())if(c instanceof q.a){var p=a.getPagePosition(o.clientX,o.clientY),m=p.x/n.zoomScale/i.editScale,f=p.y/n.zoomScale/i.editScale;c.isEditMode?X.a.instance.dispatch(new et.e(c,m,f,!1)):X.a.instance.dispatch(new et.c(c,m,f))}else;}},o.rollbackAction=function(){},o.recycle=function(){o.canvas=null},o.pageIdx=e,o.canvas=n,o.clientX=i,o.clientY=a,o}return z()(t,e),w()(t,null,[{key:"getPhotoItem",value:function(e){var t;t=1===Y.a.instance.activeItems.length&&Y.a.instance.activeItems[0]instanceof Je.d?Y.a.instance.activeItems[0]:null;var n=e&&e instanceof Je.d&&e.isBackground;return t=!t&&n?e:t}},{key:"canPhotoCropCancel",value:function(e,t){if(e.isEditMode){if(0===t.length)return!0;var n=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var r=o.value;if(r instanceof ee.b&&Y.a.isCropMode()&&(r=r.innerPhotoItem),e.tbpeId===r.tbpeId)return!1}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return!0}return!1}}]),t}(K.b),Ss=n(507),bs=function(e){function t(e,n){var i;L()(this,t),(i=V()(this,F()(t).call(this))).timeout=3e3,i.gridItem=e,i.deltaThickness=n,i.commitTime=(new Date).getTime(),i.rowThickness=[],i.colThickness=[];var a=!0,o=!1,s=void 0;try{for(var r,l=e.rows[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value;i.rowThickness.push(c.thickness)}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}var u=!0,d=!1,h=void 0;try{for(var p,m=e.cols[Symbol.iterator]();!(u=(p=m.next()).done);u=!0){var f=p.value;i.colThickness.push(f.thickness)}}catch(e){d=!0,h=e}finally{try{u||null==m.return||m.return()}finally{if(d)throw h}}i.gridItem.isTextEditMode&&Y.a.instance.pageController.getItemRenderer(i.gridItem).toggleEditMode(-1,-1);return i}return z()(t,e),w()(t,[{key:"recoveryOriginThicness",value:function(){var e=this;this.gridItem.cols.forEach(function(t,n){t.thickness=e.colThickness[n]}),this.gridItem.rows.forEach(function(t,n){t.thickness=e.rowThickness[n]}),this.gridItem.props.setLeft(this.oldLeft),this.gridItem.props.setTop(this.oldTop),this.gridItem.adjustSize(),this.gridItem.updateThicknessRatio()}}]),t}(kn),Rs=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,e,n))).actionType=K.a.GRID_CELL_THICKNESS,i.isActionGroupEquals=function(e){return null!=e&&e.actionType===i.actionType&&(!(e.commitTime-i.commitTime>i.timeout)&&(i.gridItem===e.gridItem&&i.colNo===e.colNo))},i.concat=function(e){return e instanceof t&&e.colNo===i.colNo&&e.gridItem===i.gridItem&&(i.deltaThickness+=e.deltaThickness,!0)},i.commitAction=function(e,t,n){(i.oldLeft=i.gridItem.props.getLeft(),i.oldTop=i.gridItem.props.getTop(),i.gridItem.unselectAllCell(),i.gridItem.isTextEditMode)&&t.pageController.getItemRenderer(i.gridItem).toggleEditMode(-1,-1);i.gridItem.positionTool.setColWidth(i.colNo,i.deltaThickness),i.gridItem.adjustRowThickness(),i.gridItem.adjustColThickness(i.colNo===i.gridItem.col?i.colNo-1:i.colNo),i.gridItem.adjustSize(),i.gridItem.updateThicknessRatio(),n.renderCanvas(e,t,[i.gridItem]),n.renderHandler(e,t,{type:$e.a.GRID_CELL_THICKNESS_RESIZE})},i.rollbackAction=function(e,t,n){i.recoveryOriginThicness(),n.renderCanvas(e,t,[i.gridItem]),n.renderHandler(e,t,{type:$e.a.GRID_CELL_THICKNESS_RESIZE})},i.recycle=function(){i.gridItem=null},i.colNo=i.gridItem.selectedColNo,i}return z()(t,e),t}(bs),As=function(e){function t(e,n){var i;L()(this,t),(i=V()(this,F()(t).call(this,e,n))).actionType=K.a.GRID_CELL_THICKNESS,i.oldFlags=[],i.isActionGroupEquals=function(e){return null!=e&&e.actionType===i.actionType&&(!(e.commitTime-i.commitTime>i.timeout)&&(i.gridItem===e.gridItem&&i.rowNo===e.rowNo))},i.concat=function(e){return e instanceof t&&e.rowNo===i.rowNo&&e.gridItem===i.gridItem&&(i.deltaThickness+=e.deltaThickness,!0)},i.commitAction=function(e,t,n){(i.oldLeft=i.gridItem.props.getLeft(),i.oldTop=i.gridItem.props.getTop(),i.gridItem.unselectAllCell(),i.gridItem.isTextEditMode)&&t.pageController.getItemRenderer(i.gridItem).toggleEditMode(-1,-1);var a=Math.max(0,i.rowNo-1),o=!0,s=!1,r=void 0;try{for(var l,c=i.gridItem.cells[a][Symbol.iterator]();!(o=(l=c.next()).done);o=!0){l.value.isResizedByHeightChange=!1}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}i.gridItem.positionTool.setRowHeight(i.rowNo,i.deltaThickness),i.gridItem.adjustRowThickness(i.rowNo===i.gridItem.row?i.rowNo-1:i.rowNo),i.gridItem.adjustColThickness(),i.gridItem.adjustSize(),i.gridItem.updateThicknessRatio(),n.renderCanvas(e,t,[i.gridItem]),n.renderHandler(e,t,{type:$e.a.GRID_CELL_THICKNESS_RESIZE})},i.rollbackAction=function(e,t,n){for(var a=Math.max(0,i.rowNo-1),o=0;o<i.oldFlags.length;o++){var s=i.oldFlags[o];i.gridItem.cells[a][o].isResizedByHeightChange=s}i.recoveryOriginThicness(),n.renderCanvas(e,t,[i.gridItem]),n.renderHandler(e,t,{type:$e.a.GRID_CELL_THICKNESS_RESIZE})},i.recycle=function(){i.gridItem=null,i.rowThickness=null,i.colThickness=null},i.rowNo=i.gridItem.selectedRowNo;var a=Math.max(0,i.rowNo-1),o=!0,s=!1,r=void 0;try{for(var l,c=i.gridItem.cells[a][Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;i.oldFlags.push(u.isResizedByHeightChange)}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}return i}return z()(t,e),t}(bs),Os=function(e){function t(e,n,i,a,o){var s;return L()(this,t),(s=V()(this,F()(t).call(this))).changeDesign=function(){return!1},s.isPossibleInCropMode=!0,s.doSaveQueue=!1,s.actionType=K.a.MOUSE_MOVE,s.commitAction=function(e,t,n){is.moveMouse(s.event.clientX,s.event.clientY);var i=Cn(s.event.clientX,s.event.clientY),a=i.outputX,o=i.outputY,r=Cn(t.mouseAction.baseX,t.mouseAction.baseY),l={absoluteX:a,absoluteY:o,absoluteBaseX:r.outputX,absoluteBaseY:r.outputY,moveX:(s.event.clientX-t.mouseAction.offsetX)/t.pageEditScale/t.zoomScale,moveY:(s.event.clientY-t.mouseAction.offsetY)/t.pageEditScale/t.zoomScale},c=Qe.b.getGroupItemsAddedArray(t.activeItems.slice());switch(s.doAction(e,t,n,l),t.mouseAction.offsetX=s.event.clientX,t.mouseAction.offsetY=s.event.clientY,e.pages.forEach(function(e){t.pageController.getPageRenderer(e).updateHoverLayer()}),t.mouseAction.mode){case Fn.a.MODE_NAVIGATION_DRAG:n.renderCanvas(e,t);break;case Fn.a.MODE_ITEM_DRAG:n.renderCanvas(e,t,c);break;case Fn.a.MODE_ITEM_ROTATE:n.renderCanvas(e,t,c),n.renderHandler(e,t,{type:$e.a.ROTATE});break;case Fn.a.MODE_HANDLER_RESIZE_T:case Fn.a.MODE_HANDLER_RESIZE_TR:case Fn.a.MODE_HANDLER_RESIZE_R:case Fn.a.MODE_HANDLER_RESIZE_BR:case Fn.a.MODE_HANDLER_RESIZE_B:case Fn.a.MODE_HANDLER_RESIZE_BL:case Fn.a.MODE_HANDLER_RESIZE_L:case Fn.a.MODE_HANDLER_RESIZE_TL:n.renderCanvas(e,t,c),n.renderHandler(e,t,{type:$e.a.RESIZE});break;case Fn.a.MODE_GUIDELINE_MOVE:break;case Fn.a.MODE_MOBILE_DOWN:t.mouseAction.mode=Fn.a.MODE_MOBILE_SCROLL;break;default:n.renderCanvas(e,t,c)}},s.rollbackAction=function(e,t){},s.recycle=function(){s.canvas=null},s.pageIdx=e,s.canvas=n,s.selectArea=i,s.event=a,s.isShiftKeyPush=o,s.renderAuto=!1,s}return z()(t,e),w()(t,[{key:"doAction",value:function(e,n,i,a){var o=t.HANDLER_MAP.get(n.mouseAction.mode);o?o(this,e,n,i,a):this.doDefaultAction(e,n,i,a)}},{key:"doDefaultAction",value:function(e,t,n,i){if(!je.a.isMobileDevice()){for(var a=e.pages[this.pageIdx],o=t.pageController.getPageRenderer(a),s=i.absoluteX*t.zoomScale,r=i.absoluteY*t.zoomScale,l=!0,c=0,u=e.pages.length;c<u;c++)if((o=t.pageController.getPageRenderer(e.pages[c])).isInRange(s,r)){a=e.pages[c],l=!1;break}a.getAllSingleItems().forEach(function(e){return e.hover=!1}),a.getAllGroupItems().forEach(function(e){return e.clearHoveredItem()});var d=o.getInRangeItem(i.absoluteX,i.absoluteY),h=!1,p=o.getInRangeGroup(i.absoluteX,i.absoluteY);if(!l&&p){var m=a.getAllSingleItems(),f=p.getAllSingleMembers();h=m.indexOf(f[f.length-1])>=m.indexOf(d)}Y.a.instance.activeItems;if(Y.a.isCropMode()||l)this.canvas.style.cursor="default";else if(h){var v=p.getSelectedItem();if(d===v&&v instanceof q.a&&v.isEditMode)this.canvas.style.cursor="text";else{var g=p.getAllSingleMembers();if(g[0].select)d&&(d.hover=!0);else{var E=!0,y=!1,T=void 0;try{for(var I,C=g[Symbol.iterator]();!(E=(I=C.next()).done);E=!0){I.value.hover=!0}}catch(e){y=!0,T=e}finally{try{E||null==C.return||C.return()}finally{if(y)throw T}}}d&&p.setHoveredItem(d)}}else if(d)if(1===t.activeItems.length&&d===t.activeItems[0]&&t.activeItems[0]instanceof q.a)t.activeItems[0].isEditArea(i.absoluteX,i.absoluteY)&&t.activeItems[0].isEditMode?this.canvas.style.cursor="text":this.canvas.style.cursor="default";else if(1===t.activeItems.length&&d===t.activeItems[0]&&d instanceof Z.a)d&&d.positionTool.getCell(i.absoluteX,i.absoluteY)===d.editingCell?this.canvas.style.cursor="text":this.canvas.style.cursor="default";else{d.hover=!0;var k=!1;if(this.isShiftKeyPush&&t.activeItems.length>0)(t.activeItems[0].isLock()||d.isLock())&&(k=!0);this.canvas.style.cursor=k?"not-allowed":""}else this.canvas.style.cursor="default"}}}]),t}(K.b);Os.SENSITIVITY=1,Os.HANDLER_MAP=new Map([[Fn.a.MODE_NAVIGATION_DRAG,function(e,t,n,i,a){var o=e.event.pageX-n.mouseAction.baseX,s=e.event.pageY-n.mouseAction.baseY;n.editorMainVC.moveScroll(-o,-s),n.mouseAction.baseX=e.event.pageX,n.mouseAction.baseY=e.event.pageY}],[Fn.a.MODE_SELECT_ONE_OR_DRAG,function(e,t,n,i,a){var o=Math.abs(n.mouseAction.offsetX-e.event.clientX),s=Math.abs(n.mouseAction.offsetY-e.event.clientY);if(o>Os.SENSITIVITY||s>Os.SENSITIVITY){var r=e.event;if(!Y.a.isCropMode()&&(r.ctrlKey||r.metaKey||r.altKey)){var l=n.activeItems.slice();J.a.unselectAllItems(),X.a.instance.dispatch(new xn(Y.a.instance.renderPageIdx,l)),X.a.instance.dispatch(new Vn(Y.a.instance.renderPageIdx,!1))}n.mouseAction.mode=Fn.a.MODE_ITEM_DRAG,e.doAction(t,n,i,a)}}],[Fn.a.MODE_GRID_HANDLER_DOWN,function(e,t,n,i,a){Os.HANDLER_MAP.get(Fn.a.MODE_ITEM_DRAG)(e,t,n,i,a)}],[Fn.a.MODE_ITEM_DRAG,function(e,t,n,i,a){n.mouseAction.mode=Fn.a.MODE_ITEM_DRAG,e.canvas.style.cursor="move",X.a.instance.dispatch(new On.g(a.moveX,a.moveY,e.isShiftKeyPush,!0));var o=n.activeItems;if(1===o.length&&o[0]instanceof Je.d){var s=o[0];if(s.belongsTo===Je.c.INDEPENDENT){var r=t.pages[n.renderPageIdx],l=n.pageController.getPageRenderer(r).getPagePosition(e.event.clientX,e.event.clientY);Ps.updateSvgImageframeImageSrc({store:n,photoItem:s,absoluteX:l.x/n.zoomScale,absoluteY:l.y/n.zoomScale,page:t.pages[n.renderPageIdx]})}}}],[Fn.a.MODE_MULTI_SELECT,function(e,t,n,i,a){var o=!0;t.pages.forEach(function(t){t.getAllSingleItems().forEach(function(i){i.hover=!1;var a=n.pageController.getPageRenderer(t);o&&a.isPageInRange(n.mouseAction.baseX,n.mouseAction.baseY,e.event.clientX,e.event.clientY)&&(o=!1)})});var s=i.canvasAreaVC.pagingManager.getSelectAreaOffset();if(e.selectArea.style.left="".concat(Math.min(e.event.clientX,n.mouseAction.baseX)-s.x,"px"),e.selectArea.style.top="".concat(Math.min(e.event.clientY,n.mouseAction.baseY)-s.y,"px"),e.selectArea.style.width="".concat(Math.abs(e.event.clientX-n.mouseAction.baseX),"px"),e.selectArea.style.height="".concat(Math.abs(e.event.clientY-n.mouseAction.baseY),"px"),!o){var r=n.mouseAction.mode===Fn.a.MODE_MULTI_SELECT&&Math.abs(a.absoluteBaseX-a.absoluteX)>5&&Math.abs(a.absoluteBaseY-a.absoluteY)>5,l=t.pages[e.pageIdx],c=n.pageController.getPageRenderer(l),u=c.getInRangeItems(a.absoluteBaseX,a.absoluteBaseY,a.absoluteX,a.absoluteY,r?-1:1);if(Math.abs(a.absoluteBaseX-a.absoluteX)>5&&Math.abs(a.absoluteBaseY-a.absoluteY)>5){var d=u.filter(function(e){return l.background.isSkinItem(e)});if(d.length>0){var h=d[0],p=new li.a(a.absoluteBaseX,a.absoluteBaseY,a.absoluteX,a.absoluteY);cs.a.isIncludeLtrbCoordinate(h.getLTRBCoordinate(),p)||u.splice(u.indexOf(h),1)}}var m=c.getInRangeGroups(a.absoluteBaseX,a.absoluteBaseY,a.absoluteX,a.absoluteY,r?-1:1),f=!0,v=!1,g=void 0;try{for(var E,y=u[Symbol.iterator]();!(f=(E=y.next()).done);f=!0){E.value.hover=!0}}catch(e){v=!0,g=e}finally{try{f||null==y.return||y.return()}finally{if(v)throw g}}var T=!0,I=!1,C=void 0;try{for(var k,L=m[Symbol.iterator]();!(T=(k=L.next()).done);T=!0){var _=k.value,w=!0,S=!1,b=void 0;try{for(var R,A=_.getAllSingleMembers()[Symbol.iterator]();!(w=(R=A.next()).done);w=!0){R.value.hover=!0}}catch(e){S=!0,b=e}finally{try{w||null==A.return||A.return()}finally{if(S)throw b}}}}catch(e){I=!0,C=e}finally{try{T||null==L.return||L.return()}finally{if(I)throw C}}}}],[Fn.a.MODE_HANDLER_RESIZE_T,function(e,t,n,i,a){var o=e.event;X.a.instance.dispatch(new On.h(Fn.a.MODE_HANDLER_RESIZE_T,t.pages,a.absoluteX,a.absoluteY,a.moveX,a.moveY,e.isShiftKeyPush,o.altKey||o.ctrlKey||o.metaKey))}],[Fn.a.MODE_HANDLER_RESIZE_TR,function(e,t,n,i,a){var o=e.event;X.a.instance.dispatch(new On.h(Fn.a.MODE_HANDLER_RESIZE_TR,t.pages,a.absoluteX,a.absoluteY,a.moveX,a.moveY,e.isShiftKeyPush,o.altKey||o.ctrlKey||o.metaKey))}],[Fn.a.MODE_HANDLER_RESIZE_R,function(e,t,n,i,a){var o=e.event;X.a.instance.dispatch(new On.h(Fn.a.MODE_HANDLER_RESIZE_R,t.pages,a.absoluteX,a.absoluteY,a.moveX,a.moveY,e.isShiftKeyPush,o.altKey||o.ctrlKey||o.metaKey))}],[Fn.a.MODE_HANDLER_RESIZE_BR,function(e,t,n,i,a){var o=e.event;X.a.instance.dispatch(new On.h(Fn.a.MODE_HANDLER_RESIZE_BR,t.pages,a.absoluteX,a.absoluteY,a.moveX,a.moveY,e.isShiftKeyPush,o.altKey||o.ctrlKey||o.metaKey))}],[Fn.a.MODE_HANDLER_RESIZE_B,function(e,t,n,i,a){var o=e.event;X.a.instance.dispatch(new On.h(Fn.a.MODE_HANDLER_RESIZE_B,t.pages,a.absoluteX,a.absoluteY,a.moveX,a.moveY,e.isShiftKeyPush,o.altKey||o.ctrlKey||o.metaKey))}],[Fn.a.MODE_HANDLER_RESIZE_BL,function(e,t,n,i,a){var o=e.event;X.a.instance.dispatch(new On.h(Fn.a.MODE_HANDLER_RESIZE_BL,t.pages,a.absoluteX,a.absoluteY,a.moveX,a.moveY,e.isShiftKeyPush,o.altKey||o.ctrlKey||o.metaKey))}],[Fn.a.MODE_HANDLER_RESIZE_L,function(e,t,n,i,a){var o=e.event;X.a.instance.dispatch(new On.h(Fn.a.MODE_HANDLER_RESIZE_L,t.pages,a.absoluteX,a.absoluteY,a.moveX,a.moveY,e.isShiftKeyPush,o.altKey||o.ctrlKey||o.metaKey))}],[Fn.a.MODE_HANDLER_RESIZE_TL,function(e,t,n,i,a){var o=e.event;X.a.instance.dispatch(new On.h(Fn.a.MODE_HANDLER_RESIZE_TL,t.pages,a.absoluteX,a.absoluteY,a.moveX,a.moveY,e.isShiftKeyPush,o.altKey||o.ctrlKey||o.metaKey))}],[Fn.a.MODE_ITEM_ROTATE,function(e,t,n,i,a){var o=t.pages[n.renderPageIdx],s=n.pageController.getPageRenderer(o).getPagePosition(e.event.clientX,e.event.clientY);X.a.instance.dispatch(new On.i(s.x/Y.a.instance.zoomScale/o.editScale,s.y/Y.a.instance.zoomScale/o.editScale,!0,e.isShiftKeyPush))}],[Fn.a.MODE_GRID_BORDER_VER_DRAG,function(e,t,n,i,a){e.canvas.style.cursor="row-resize";var o=n.activeItems,s=o[0];1===o.length&&s&&s instanceof Z.a&&!s.isLock()&&X.a.instance.dispatch(new As(s,a.moveY))}],[Fn.a.MODE_GRID_BORDER_HOR_DRAG,function(e,t,n,i,a){e.canvas.style.cursor="col-resize";var o=n.activeItems,s=o[0];1===o.length&&s&&s instanceof Z.a&&!s.isLock()&&X.a.instance.dispatch(new Rs(s,a.moveX))}],[Fn.a.MODE_GRID_CLICK,function(e,t,n,i,a){var o=n.activeItems;if(1===o.length&&o[0]instanceof Z.a&&!o[0].isLock()){var s=t.pages[e.pageIdx],r=n.pageController.getPageRenderer(s),l=r.getPagePosition(n.mouseAction.baseX,n.mouseAction.baseY),c=r.getPagePosition(e.event.clientX,e.event.clientY);X.a.instance.dispatch(new _n(o[0],l.x/n.zoomScale/n.pageEditScale,l.y/n.zoomScale/n.pageEditScale,c.x/n.zoomScale/n.pageEditScale,c.y/n.zoomScale/n.pageEditScale,e.isShiftKeyPush,e.event.ctrlKey,!0)),o[0].positionTool.getCell(a.absoluteBaseX,a.absoluteBaseY)!==o[0].positionTool.getCell(a.absoluteX,a.absoluteY)&&(n.mouseAction.mode=Fn.a.MODE_GRID_CELLS_SELECT)}}],[Fn.a.MODE_GRID_CELLS_SELECT,function(e,t,n,i,a){var o=t.pages[e.pageIdx],s=n.pageController.getPageRenderer(o),r=s.getInRangeItem(a.absoluteX,a.absoluteY);if(r instanceof Z.a&&r.select&&!r.isLock()){var l=s.getPagePosition(n.mouseAction.baseX,n.mouseAction.baseY),c=s.getPagePosition(e.event.clientX,e.event.clientY);X.a.instance.dispatch(new _n(r,l.x/n.zoomScale/n.pageEditScale,l.y/n.zoomScale/n.pageEditScale,c.x/n.zoomScale/n.pageEditScale,c.y/n.zoomScale/n.pageEditScale,e.isShiftKeyPush,e.event.ctrlKey))}}],[Fn.a.MODE_TEXT_EDIT,function(e,t,n,i,a){var o=t.pages[e.pageIdx],s=n.pageController.getPageRenderer(o),r=s.getInRangeItem(a.absoluteX,a.absoluteY);if(r instanceof q.a&&r.isEditArea(a.absoluteX,a.absoluteY))if(r.isEditMode){var l=s.getPagePosition(n.mouseAction.baseX,n.mouseAction.baseY),c=s.getPagePosition(e.event.clientX,e.event.clientY);X.a.instance.dispatch(new et.c(r,l.x/n.zoomScale/n.pageEditScale,l.y/n.zoomScale/n.pageEditScale,c.x/n.zoomScale/n.pageEditScale,c.y/n.zoomScale/n.pageEditScale,e.isShiftKeyPush)),n.mouseAction.mode=Fn.a.MODE_TEXT_SELECT}else is.isSamePoint||(n.mouseAction.mode=Fn.a.MODE_SELECT_ONE_OR_DRAG)}],[Fn.a.MODE_TEXT_SELECT,function(e,t,n,i,a){}]]);var Ps=function(){function e(){L()(this,e)}return w()(e,null,[{key:"isChangeContentsStates",value:function(e){return!this.lastParam||e.absoluteX!==this.lastParam.absoluteX||e.absoluteY!==this.lastParam.absoluteY}},{key:"setSvgImageframeStatus",value:function(e,t){switch(t){case ee.a.SET_SRC:case ee.a.SET_SRC_STABLE:return e?ee.a.SET_SRC_STABLE:ee.a.RESET_SRC;case ee.a.RESET_SRC:case ee.a.RESET_SRC_STABLE:return e?ee.a.SET_SRC:ee.a.RESET_SRC_STABLE;default:return null}}},{key:"updateSvgImageframeImageSrc",value:function(e){if(!Y.a.isCropMode()&&this.isChangeContentsStates(e)){var t=e.page.getAllSingleItems().filter(function(e){return e instanceof ee.b}),n=e.store.pageController.getItemRenderer(e.photoItem),i=new li.a(e.absoluteX,e.absoluteY,e.absoluteX,e.absoluteY);i.changeScaleReverse(e.page.lastRenderEditScale);var a=!0,o=!0,s=!1,r=void 0;try{for(var l,c=Yn()(t).reverse()[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;if(u.canInsertPhotoItem()){var d=u.isInRange(i),h=this.setSvgImageframeStatus(d&&a,u.getImageSrcStatus());d&&(a=!1,n.elements.container.style.opacity="0.3"),e.store.pageController.getItemRenderer(u).setImageSrcStatus(h,n.elements.imageElement)}}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}a&&(n.elements.container.style.opacity="1.0")}this.lastParam=e}}]),e}(),Ds=function(e){function t(e,n,i,a,o,s){var r;return L()(this,t),(r=V()(this,F()(t).call(this))).changeDesign=function(){return!1},r.isPossibleInCropMode=!0,r.doSaveQueue=!1,r.actionType=K.a.MOUSE_UP,r.outOfPage=!0,r.commitAction=function(e,t,n){is.upMouse();var i=!0,a=!1,o=void 0;try{for(var s,l=e.pages[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;if(t.pageController.getPageRenderer(c).isInRange(r.event.clientX,r.event.clientY)){t.renderPageIdx=c.pageIdx,r.outOfPage=!1;break}}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}var u=e.pages[r.pageIdx];u.getAllGroupItems().forEach(function(e){return e.initBoxDegree()});var d=Cn(r.event.clientX,r.event.clientY),h=d.outputX,p=d.outputY,m=Cn(t.mouseAction.baseX,t.mouseAction.baseY),f=m.outputX,v=m.outputY,g={absoluteX:h,absoluteY:p,absoluteBaseX:f,absoluteBaseY:v},E=t.pageController.getPageRenderer(u),y=E.getInRangeItem(h,p);t.mouseAction.mode===Fn.a.MODE_GRID_HANDLER_DOWN&&t.activeItems.filter(function(e){return e instanceof Z.a}).length>0&&(y=t.activeItems.filter(function(e){return e instanceof Z.a})[0]),r.doAction(e,t,n,g);var T=u.getAllSingleItems();if(T.filter(function(e){return e instanceof q.a}).forEach(function(e){e.isEditMode&&y!==e&&t.mouseAction.mode!==Fn.a.MODE_TEXT_SELECT&&t.mouseAction.mode!==Fn.a.MODE_NONE&&t.pageController.getItemRenderer(e).toggleEditMode()}),T.filter(function(e){return e instanceof Z.a}).forEach(function(e){if(y!==e&&(t.mouseAction.mode!==Fn.a.MODE_GRID_CELLS_SELECT||!e.select)){var n=t.pageController.getItemRenderer(e);e.isTextEditMode&&n.toggleEditMode(h,p),e.unselectAllCell(),n.renderViewAfter(null,t.pageEditScale)}}),!Y.a.isCropMode())if(t.activeItems.length){var I=!0,C=!1,k=void 0;try{for(var L,_=e.pages[Symbol.iterator]();!(I=(L=_.next()).done);I=!0){var w=L.value,S=w.getAllSingleItems();if(-1!==S.indexOf(t.activeItems[0])){t.renderPageIdx=w.pageIdx,t.activeItems=S.filter(function(e){return e.select});break}}}catch(e){C=!0,k=e}finally{try{I||null==_.return||_.return()}finally{if(C)throw k}}}else J.a.unselectAllItems();switch(r.selectArea.style.display="none",e.pages.forEach(function(e){t.pageController.getPageRenderer(e).updateHoverLayer()}),t.activeItems.forEach(function(e){e.setStatus(qe.g.STABLE)}),t.mouseAction.mode){case Fn.a.MODE_HANDLER_RESIZE_T:case Fn.a.MODE_HANDLER_RESIZE_TR:case Fn.a.MODE_HANDLER_RESIZE_R:case Fn.a.MODE_HANDLER_RESIZE_BR:case Fn.a.MODE_HANDLER_RESIZE_B:case Fn.a.MODE_HANDLER_RESIZE_BL:case Fn.a.MODE_HANDLER_RESIZE_L:case Fn.a.MODE_HANDLER_RESIZE_TL:n.renderCanvas(e,t,t.activeItems),n.renderHandler(e,t,{type:$e.a.RESIZE})}if(t.mouseAction.mode!==Fn.a.MODE_NAVIGATION){r.canvas.style.cursor="default";var b=E.getInRangeGroup(h,p),R=u.background.backgroundItem;if(b||!y||Y.a.isCropMode()||y!==R||E.isGroupSelected(h,p))t.mouseAction.mode=Fn.a.MODE_NONE;else g.absoluteBaseX!==g.absoluteX&&g.absoluteBaseY!==g.absoluteY&&t.mouseAction.mode!==Fn.a.MODE_SELECT_ONE_OR_DRAG&&t.mouseAction.mode!==Fn.a.MODE_MOBILE_DOWN?t.mouseAction.mode=Fn.a.MODE_NONE:(t.mouseAction.mode=Fn.a.MODE_BACKGROUND_SELECT,J.a.selectBackgroundItem(!je.a.isMobilePortraitSize()))}t.activeItems.length&&n.renderHandler(e,t)},r.rollbackAction=function(e,t){},r.recycle=function(){r.canvas=null},r.pageIdx=e,r.canvas=n,r.selectArea=i,r.event=a,r.isShiftKeyPush=o,r.isCtrlKeyPush=s,r}return z()(t,e),w()(t,[{key:"doAction",value:function(e,n,i,a){var o=t.HANDLER_MAP.get(n.mouseAction.mode);o?o(this,e,n,i,a):this.doDefaultAction(e,n,i,a)}},{key:"doDefaultAction",value:function(e,t,n,i){if(!Y.a.isCropMode()&&!this.outOfPage){var a=e.pages[this.pageIdx],o=Y.a.instance.pageController.getPageRenderer(a).getSelectedItemInfo(i.absoluteX,i.absoluteY),s=o.selectedSingleItem&&o.selectedSingleItem===a.background.backgroundItem,r=ss.a.isMultiSelectMode();t.activeItems.some(function(e){return!a.includesItem(e)})&&J.a.unselectAllItems(),this.isShiftKeyPush||this.isCtrlKeyPush||r&&(o.selectedSingleItem||!it.a.isEmpty(o.selectedGroupItems))?s||this.selectItemOnMultiSelectMode(o):(J.a.unselectAllItems(),s||this.selectItem(o)),ss.a.setMultiSelectMode(r&&Y.a.instance.activeItems.length>0).updateStateByActiveItems()}}},{key:"selectItemOnMultiSelectMode",value:function(e){it.a.isEmpty(e.selectedGroupItems)?e.selectedSingleItem&&(e.selectedSingleItem.select?J.a.unselectItem(e.selectedSingleItem):J.a.appendSelectedItem(e.selectedSingleItem)):e.selectedGroupItems[0].select?J.a.unselectItem(e.selectedGroupItems[0]):J.a.appendSelectedItems(e.selectedGroupItems)}},{key:"selectItem",value:function(e){it.a.isEmpty(e.selectedGroupItems)?e.selectedSingleItem&&J.a.appendSelectedItem(e.selectedSingleItem,!0):J.a.appendSelectedItems(e.selectedGroupItems,!0)}}]),t}(K.b);Ds.HANDLER_MAP=new Map([[Fn.a.MODE_NAVIGATION,function(e,t,n,i,a){n.mouseAction.mode=Fn.a.MODE_NAVIGATION}],[Fn.a.MODE_NAVIGATION_DRAG,function(e,t,n,i,a){n.mouseAction.mode=Fn.a.MODE_NAVIGATION}],[Fn.a.MODE_MOBILE_SCROLL,function(e,t,n,i,a){n.mouseAction.mode=Fn.a.MODE_NONE}],[Fn.a.MODE_MULTI_SELECT,function(e,t,n,i,a){for(var o=function(n,i){var a=t.pages[n],o=a.getAllSingleItems(),s=o.filter(function(e){return e.hover}),r=1===s.length;if(o.forEach(function(t){if(Kt.a.isItemSkinable(t,a.sheetSize));else if((e.isShiftKeyPush||e.isCtrlKeyPush)&&t.select){if(t.hover){J.a.unselectItem(t);var n=Qe.b.getRootGroup(t.groupId);if(n){var i=!0,o=!1,s=void 0;try{for(var l,c=n.getAllSingleMembers()[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){l.value.hover=!1}}catch(e){o=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}}}}else t.hover&&(r||t.props.isCanUserSelect()&&t.props.isCanUserMove()&&t.props.isCanUserResize())&&J.a.appendSelectedItem(t,!0);t.hover=!1}),s.length)return Y.a.instance.renderPageIdx=a.pageIdx,"break"},s=0,r=t.pages.length;s<r;s++){if("break"===o(s))break}}],[Fn.a.MODE_PHOTO_CROP_UI_SELECT,function(e,t,n,i,a){var o=n.activeItems;if(1===o.length&&!o[0].isLock()){var s=o[0];J.a.selectItem(s)}}],[Fn.a.MODE_GRID_CELLS_SELECT,function(e,t,n,i,a){var o=t.pages[e.pageIdx],s=n.pageController.getPageRenderer(o),r=s.getInRangeItem(a.absoluteX,a.absoluteY);if(r instanceof Z.a&&r.select&&!r.isLock()){var l=s.getPagePosition(n.mouseAction.baseX,n.mouseAction.baseY),c=s.getPagePosition(e.event.clientX,e.event.clientY);X.a.instance.dispatch(new _n(r,l.x/n.zoomScale/n.pageEditScale,l.y/n.zoomScale/n.pageEditScale,c.x/n.zoomScale/n.pageEditScale,c.y/n.zoomScale/n.pageEditScale,e.isShiftKeyPush,e.event.ctrlKey,!0))}}],[Fn.a.MODE_GRID_CLICK,function(e,t,n,i,a){var o=t.pages[e.pageIdx],s=n.pageController.getPageRenderer(o),r=s.getInRangeItem(a.absoluteX,a.absoluteY);if(r instanceof Z.a&&r.select&&!r.isLock()){var l=s.getPagePosition(n.mouseAction.baseX,n.mouseAction.baseY),c=s.getPagePosition(e.event.clientX,e.event.clientY);X.a.instance.dispatch(new _n(r,l.x/n.zoomScale/n.pageEditScale,l.y/n.zoomScale/n.pageEditScale,c.x/n.zoomScale/n.pageEditScale,c.y/n.zoomScale/n.pageEditScale,e.isShiftKeyPush,e.event.ctrlKey,!0))}e.renderAuto=!1}],[Fn.a.MODE_AFTER_MOVE_ITEM_TO_OTHER_PAGE,function(e,t,n,i,a){n.mouseAction.mode=Fn.a.MODE_NONE,J.a.unselectAllItems()}],[Fn.a.MODE_GRID_HANDLER_DOWN,function(e,t,n,i,a){Ds.HANDLER_MAP.get(Fn.a.MODE_GRID_BORDER_VER_DRAG)(e,t,n,i,a)}],[Fn.a.MODE_GRID_BORDER_HOR_DRAG,function(e,t,n,i,a){Ds.HANDLER_MAP.get(Fn.a.MODE_GRID_BORDER_VER_DRAG)(e,t,n,i,a)}],[Fn.a.MODE_GRID_BORDER_VER_DRAG,function(e,t,n,i,a){n.mouseAction.mode=Fn.a.MODE_NONE}],[Fn.a.MODE_ITEM_DRAG,function(e,t,n,i,a){var o=t.pages[e.pageIdx],s=n.activeItems,r=s.slice(),l=[];if(s.length){var c=!0,u=!1,d=void 0;try{for(var h,p=function(){var e=h.value,t=n.pageController.getPageRenderer(e);if(r.slice().forEach(function(e){var n=Y.a.instance.pageController.getItemRenderer(e).elements.container.getBoundingClientRect();t.isPageInRange(n.left,n.top,n.right,n.bottom)&&l.push(r.splice(r.indexOf(e),1)[0])}),!r.length)return"break"},m=t.pages[Symbol.iterator]();!(c=(h=m.next()).done);c=!0){if("break"===p())break}}catch(e){u=!0,d=e}finally{try{c||null==m.return||m.return()}finally{if(u)throw d}}var f=!0,v=!1,g=void 0;try{for(var E,y=function(){var e=E.value;if(-1===r.indexOf(e))return"continue";var t=Qe.b.getGroupItemsAddedArray([e]);t.some(function(e){return-1!==l.indexOf(e)})&&(r=r.filter(function(e){return-1===t.indexOf(e)}))},T=r.slice()[Symbol.iterator]();!(f=(E=T.next()).done);f=!0)y()}catch(e){v=!0,g=e}finally{try{f||null==T.return||T.return()}finally{if(v)throw g}}Y.a.isCropMode()||X.a.instance.dispatch(new An.a(r.slice(),e.pageIdx,!0))}if(s=s.filter(function(e){return-1===r.indexOf(e)}),i.canvasAreaVC.pagingManager.updateRenderPageIdx(new ns.a(a.absoluteX*n.zoomScale,a.absoluteY*n.zoomScale)),Y.a.isDefaultMode()&&e.pageIdx!==n.renderPageIdx)return n.mouseAction.mode=Fn.a.MODE_AFTER_MOVE_ITEM_TO_OTHER_PAGE,X.a.instance.dispatch(new On.m(t.pages[e.pageIdx],t.pages[n.renderPageIdx])),void(e.renderAuto=!1);if(!Y.a.isCropMode()&&1===s.length&&s[0]instanceof Je.d){var I=s[0];if(I.belongsTo===Je.c.INDEPENDENT){var C=o.getAllSingleItems().filter(function(e){return e instanceof ee.b}),k=!0,L=!1,_=void 0;try{for(var w,S=C[Symbol.iterator]();!(k=(w=S.next()).done);k=!0){var b=w.value;if(b.canInsertPhotoItem()){var R=b.getImageSrcStatus();if(R===ee.a.SET_SRC||R===ee.a.SET_SRC_STABLE)return X.a.instance.dispatch(new On.q(b,I)),void(e.renderAuto=!1)}}}catch(e){L=!0,_=e}finally{try{k||null==S.return||S.return()}finally{if(L)throw _}}}}Ds.HANDLER_MAP.get(Fn.a.MODE_ITEM_ROTATE)(e,t,n,i,a)}],[Fn.a.MODE_HANDLER_RESIZE_T,function(e,t,n,i,a){Ds.HANDLER_MAP.get(Fn.a.MODE_ITEM_ROTATE)(e,t,n,i,a)}],[Fn.a.MODE_HANDLER_RESIZE_TR,function(e,t,n,i,a){Ds.HANDLER_MAP.get(Fn.a.MODE_ITEM_ROTATE)(e,t,n,i,a)}],[Fn.a.MODE_HANDLER_RESIZE_R,function(e,t,n,i,a){Ds.HANDLER_MAP.get(Fn.a.MODE_ITEM_ROTATE)(e,t,n,i,a)}],[Fn.a.MODE_HANDLER_RESIZE_BR,function(e,t,n,i,a){Ds.HANDLER_MAP.get(Fn.a.MODE_ITEM_ROTATE)(e,t,n,i,a)}],[Fn.a.MODE_HANDLER_RESIZE_B,function(e,t,n,i,a){Ds.HANDLER_MAP.get(Fn.a.MODE_ITEM_ROTATE)(e,t,n,i,a)}],[Fn.a.MODE_HANDLER_RESIZE_BL,function(e,t,n,i,a){Ds.HANDLER_MAP.get(Fn.a.MODE_ITEM_ROTATE)(e,t,n,i,a)}],[Fn.a.MODE_HANDLER_RESIZE_L,function(e,t,n,i,a){Ds.HANDLER_MAP.get(Fn.a.MODE_ITEM_ROTATE)(e,t,n,i,a)}],[Fn.a.MODE_HANDLER_RESIZE_TL,function(e,t,n,i,a){Ds.HANDLER_MAP.get(Fn.a.MODE_ITEM_ROTATE)(e,t,n,i,a)}],[Fn.a.MODE_ITEM_RESIZE,function(e,t,n,i,a){Ds.HANDLER_MAP.get(Fn.a.MODE_ITEM_ROTATE)(e,t,n,i,a)}],[Fn.a.MODE_ITEM_ROTATE,function(e,t,n,i,a){var o=t.pages[e.pageIdx],s=n.pageController.getPageRenderer(o).getInRangeItem(a.absoluteX,a.absoluteY);if(n.activeItems.length>0&&n.activeItems[0]instanceof Z.a);else if(1===n.activeItems.length&&n.activeItems[0]instanceof q.a){var r=n.activeItems[0];if(r===s)return!r.isEditMode&&r.isEditArea(a.absoluteX,a.absoluteY)&&a.absoluteBaseX===a.absoluteX&&a.absoluteBaseY===a.absoluteY?X.a.instance.dispatch(new et.c(r,a.absoluteX/o.editScale,a.absoluteY/o.editScale)):r.isEditMode&&!r.isEditArea(a.absoluteX,a.absoluteY)&&X.a.instance.dispatch(new et.b(r)),void X.a.instance.cutActionQ();if(r.isEditMode)return void X.a.instance.dispatch(new et.b(r))}i.itemHandleVC.calculateRatio(),X.a.instance.cutActionQ()}],[Fn.a.MODE_TEXT_EDIT,function(e,t,n,i,a){if(!ss.a.isMultiSelectMode()){var o=t.pages[e.pageIdx],s=n.pageController.getPageRenderer(o),r=s.getInRangeItem(a.absoluteX,a.absoluteY),l=(je.a.isMobileDevice()?is.MOBILE_SENSITIVITY:is.SENSITIVITY)/n.zoomScale,c=Math.abs(a.absoluteBaseX-a.absoluteX),u=Math.abs(a.absoluteBaseY-a.absoluteY);if(r instanceof q.a&&!r.isEditMode&&c<=l&&u<=l){var d=s.getPagePosition(n.mouseAction.baseX,n.mouseAction.baseY),h=s.getPagePosition(e.event.clientX,e.event.clientY);X.a.instance.dispatch(new et.c(r,d.x/n.zoomScale/n.pageEditScale,d.y/n.zoomScale/n.pageEditScale,h.x/n.zoomScale/n.pageEditScale,h.y/n.zoomScale/n.pageEditScale,e.isShiftKeyPush))}}}],[Fn.a.MODE_TEXT_SELECT,function(e,t,n,i,a){}],[Fn.a.MODE_SELECT_ONE,function(e,t,n,i,a){t.pages[e.pageIdx].getAllSingleItems().forEach(function(t){e.isShiftKeyPush||e.isCtrlKeyPush||J.a.unselectItem(t),t.hover=!1}),e.doDefaultAction(t,n,i,a)}],[Fn.a.MODE_ITEM_MULTI_SELECT,function(e,t,n,i,a){n.activeItems.length>0||e.doDefaultAction(t,n,i,a)}]]);var Ms=n(392);function Ns(e){return"image/png"===e||"image/jpeg"===e||"image/jpg"===e||"image/svg+xml"===e}var xs=n(505),Bs=n(387),Vs="guideline",Us=function(){function e(t,n,i,a,o){L()(this,e),this.horGuidelineRenderers=[],this.verGuidelineRenderers=[],this.guidelineManager=t,this.pageIdx=n,this.makeElement(),this.setSize(a),i.appendChild(this.elementWrapper),this.addEventListeners(),this.registGuidelineInfos(o)}return w()(e,[{key:"makeElement",value:function(){var e=document.createElement("div");e.className="guideline_contents",Ke.a.getUserSetting().isGuidelineVisible?e.classList.remove(r.a.HIDE):e.classList.add(r.a.HIDE),Ke.a.getUserSetting().isGuidelineLock&&e.classList.add(r.a.LOCK),this.elementWrapper=e}},{key:"setSize",value:function(e){this.width=e.width,this.height=e.height,this.guidelineManager.verGuidelineFactory&&this.guidelineManager.horGuidelineFactory&&(this.guidelineManager.verGuidelineFactory.setMaxPosition(this.width/2),this.guidelineManager.horGuidelineFactory.setMaxPosition(this.height/2))}},{key:"addEventListeners",value:function(){var e=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=$(e.currentTarget).data(Vs);if(n&&!Bs.a.isHandlingGuideline()){t&&e.preventDefault();var i=n.elem.getBoundingClientRect();n.guideline.setViewPoint(i.left,i.top),Bs.a.onSelectCanvasAreaGuideline(n.guideline,t)}};$(this.elementWrapper).on("mouseenter",".".concat(Vs),e),$(this.elementWrapper).on("touchstart",".".concat(Vs),function(t){return e(t,!0)})}},{key:"setPageIdx",value:function(e){this.pageIdx=e}},{key:"convertDomAbsolutePointToGuidelinePosition",value:function(e){var t=this.elementWrapper.getBoundingClientRect(),n=new ns.a(t.width/2,t.height/2),i=Y.a.instance.pageEditScale*Y.a.instance.zoomScale;return new ns.a((-n.x-(t.left-e.x))/i,(-n.y-(t.top-e.y))/i)}},{key:"appendGuidelineAuto",value:function(e,t){if(!this.guidelineManager.canAddGuideline(e))return null;var n=e===R.d.HORIZONTAL?this.guidelineManager.horGuidelineFactory.makeGuidelineAuto(t?this.convertDomAbsolutePointToGuidelinePosition(t).y:0):this.guidelineManager.verGuidelineFactory.makeGuidelineAuto(t?this.convertDomAbsolutePointToGuidelinePosition(t).x:0);if(n){var i=new Fs(n);(e===R.d.HORIZONTAL?this.horGuidelineRenderers:this.verGuidelineRenderers).push(i),this.elementWrapper.appendChild(i.elem);var a=i.elem.getBoundingClientRect();n.setViewPoint(a.left,a.top)}return n}},{key:"changeGuidelinePosition",value:function(e,t){e&&t&&(e.direction===R.d.HORIZONTAL?this.guidelineManager.horGuidelineFactory.setGuidelinePosition(e,this.convertDomAbsolutePointToGuidelinePosition(t).y):this.guidelineManager.verGuidelineFactory.setGuidelinePosition(e,this.convertDomAbsolutePointToGuidelinePosition(t).x))}},{key:"removeLastGuidelineAuto",value:function(e){if(e===R.d.HORIZONTAL?this.guidelineManager.horGuidelineFactory.removeLastGuideline():this.guidelineManager.verGuidelineFactory.removeLastGuideline()){var t=(e===R.d.HORIZONTAL?this.horGuidelineRenderers:this.verGuidelineRenderers).pop();return this.elementWrapper.removeChild(t.elem),!0}return!1}},{key:"appendGuideline",value:function(e,t){var n=e===R.d.HORIZONTAL?this.guidelineManager.horGuidelineFactory.makeGuideline(e,t):this.guidelineManager.verGuidelineFactory.makeGuideline(e,t);if(n){var i=new Fs(n);return(e===R.d.HORIZONTAL?this.horGuidelineRenderers:this.verGuidelineRenderers).push(i),this.elementWrapper.appendChild(i.elem),!0}return!1}},{key:"clear",value:function(){$(this.elementWrapper).empty(),this.guidelineManager.horGuidelineFactory.init(),this.guidelineManager.verGuidelineFactory.init()}},{key:"registGuidelines",value:function(e,t){var n;e===R.d.HORIZONTAL?(this.horGuidelineRenderers=[],n=this.horGuidelineRenderers):(this.verGuidelineRenderers=[],n=this.verGuidelineRenderers);var i=!0,a=!1,o=void 0;try{for(var s,r=t[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value,c=new Fs(l);n.push(c),this.elementWrapper.appendChild(c.elem)}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}}},{key:"registGuidelineInfos",value:function(e){e?this.guidelineManager.registGuidelineInfos(e):this.guidelineManager.makeDefaultGuideLine(),this.registGuidelines(R.d.HORIZONTAL,this.guidelineManager.horGuidelineFactory.getGuidelines()),this.registGuidelines(R.d.VERTICAL,this.guidelineManager.verGuidelineFactory.getGuidelines())}},{key:"setZoomScale",value:function(e){var t=!0,n=!1,i=void 0;try{for(var a,o=this.horGuidelineRenderers[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){a.value.setZoomScale(e)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}var s=!0,r=!1,l=void 0;try{for(var c,u=this.verGuidelineRenderers[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){c.value.setZoomScale(e)}}catch(e){r=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(r)throw l}}}},{key:"show",value:function(){this.elementWrapper&&this.elementWrapper.classList.remove(r.a.HIDE)}},{key:"setGuidelineVisibility",value:function(e){e?this.show():this.hide()}},{key:"setGuidelineLock",value:function(e){e?this.lock():this.unlock()}},{key:"hide",value:function(){this.elementWrapper&&this.elementWrapper.classList.add(r.a.HIDE)}},{key:"lock",value:function(){this.elementWrapper&&this.elementWrapper.classList.add(r.a.LOCK)}},{key:"unlock",value:function(){this.elementWrapper&&this.elementWrapper.classList.remove(r.a.LOCK)}},{key:"changeGuidelineVisible",value:function(e,t){if(e){var n=e.direction===R.d.HORIZONTAL?this.horGuidelineRenderers:this.verGuidelineRenderers;if(n){var i=n.find(function(t){return t.guideline===e});i&&(i.elem.style.display=t?"":"none")}}}}]),e}(),Fs=function(){function e(t){L()(this,e),this.guideline=t,this.elem=document.createElement("div"),this.elem.classList.add(Vs,this.guideline.direction.toString().toLowerCase()),$(this.elem).data(Vs,this),this.render();var n=document.createElement("div");n.className="line",this.elem.appendChild(n)}return w()(e,[{key:"setZoomScale",value:function(e){e!==this.guideline.scale&&(this.guideline.setZoomScale(e),this.render())}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.guideline.direction===R.d.HORIZONTAL?this.elem.style.top="calc(50% + ".concat((this.guideline.lastPosition+e)*this.guideline.scale,"px)"):this.elem.style.left="calc(50% + ".concat((this.guideline.lastPosition+e)*this.guideline.scale,"px)")}}]),e}(),Gs=n(462),Hs=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getAlertInfo",value:function(e){return{type:e.getUnsupportedItemType(),icon:this.getIconElement(e)}}},{key:"getIconElement",value:function(e){var t=document.createElement("div");return t.className="unsupported_license_alert",t.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),Xo.c.showPusher(e.getUnsupportedItemType())}),t}},{key:"checkAlert",value:function(e){return e.isUnsupported()}}]),t}(function(){function e(){L()(this,e)}return w()(e,[{key:"setIconPosition",value:function(e,t,n,i,a){var o,s,r=t.getItemBound().centerPos,l=n-14,c=i-14;o=Ga.a.getValidNumber(r.x*a,14,l)-14,s=Ga.a.getValidNumber(r.y*a,14,c)-14,this.setElementLeftTopByPx(e,o,s)}},{key:"setElementLeftTopByPx",value:function(e,t,n){e.style.left="".concat(t,"px"),e.style.top="".concat(n,"px")}}]),e}()),Ws=function(){function e(){L()(this,e),this.alertList=[],this.itemGuideLayer=document.createElement("div"),this.itemGuideLayer.className="layer item_guide_layer",this.alertList.push(new Hs),this.itemGuideAlertMap=new Map}return w()(e,[{key:"getItemGuideLayer",value:function(){return this.itemGuideLayer}},{key:"render",value:function(e,t,n,i){var a=this;0!==e.length&&(this.itemGuideAlertMap.forEach(function(t,n){e.indexOf(n)<0&&a.removeGuide(n)}),e.forEach(function(e){a.alertList.forEach(function(o){o.checkAlert(e)?a.updateAlert(o,e,t,n,i):a.removeGuide(e)})}))}},{key:"updateAlert",value:function(e,t,n,i,a){var o=e.getAlertInfo(t),s=o.icon,r=this.itemGuideAlertMap.get(t);if(r){var l=!1;r.forEach(function(e){e.type===o.type&&(s=e.icon,l=!0)}),l||this.addAlert(t,o)}else this.createAlert(t,o);e.setIconPosition(s,t,n,i,a)}},{key:"createAlert",value:function(e,t){this.itemGuideAlertMap.set(e,[t]),this.itemGuideLayer.appendChild(t.icon)}},{key:"addAlert",value:function(e,t){var n=this.itemGuideAlertMap.get(e);n&&(n.push(t),this.itemGuideLayer.appendChild(t.icon))}},{key:"removeGuide",value:function(e){var t=this,n=this.itemGuideAlertMap.get(e);n&&(n.forEach(function(e){t.itemGuideLayer.removeChild(e.icon)}),this.itemGuideAlertMap.delete(e))}}]),e}(),zs=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e,[Zo.a.TEXT_EDIT,Zo.a.GUIDELINE,Zo.a.PRINTOUT,Zo.a.HANDLER,Zo.a.HOVER]))).itemGuideRenderer=new Ws,n.page.guidelineManager=new Gs.b,n.guidelineRenderer=new Us(n.page.guidelineManager,n.page.pageIdx,n.getLayerElement(Zo.a.GUIDELINE),n.page.sheetSize,n.page.guidelineFactoryInfos),n}var n;return z()(t,e),w()(t,[{key:"renderEx",value:(n=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.guidelineRenderer.setZoomScale(Y.a.instance.zoomScale*Y.a.instance.pageEditScale);try{Y.a.instance.editorMainVC&&(this.pageSettingVC.renderView(),this.setDesignGuide())}catch(e){console.error("아마 뷰어모드라서 오류. 일단 무시",e)}case 2:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"updateHoverLayer",value:function(){var e=this.getLayerElement(Zo.a.HOVER);if(e&&(e.querySelectorAll(".".concat(r.a.ITEM_HOVER_BOX)).forEach(function(t){e.removeChild(t)}),!Fn.a.isNavigation(Y.a.instance.mouseAction.mode))){var t=document.createDocumentFragment(),n=Y.a.instance.activeItems.length,i=Y.a.instance.option.showElementBordersInGroup;this.page.getAllSingleItems().forEach(function(e){var a=Y.a.instance.pageController.getItemRenderer(e);a&&a.updateHoverView();var o=Qe.b.getRootGroup(e.groupId),s=n>1,l=o?o.getHoveredItem()===e&&e.hover:e.hover,c=o?o.getSelectedItem()===e&&e.select:e.select,u=i&&o&&!l&&!c&&(e.hover||e.select||o.getSelectedItem());if(c&&(o||s)||!c&&l||u){var d=e instanceof Je.d,h=e.getLTRBCoordinate(!1),p=d?Math.ceil(h.getWidth()):h.getWidth(),m=d?Math.ceil(h.getHeight()):h.getHeight(),f=Y.a.instance.zoomScale*Y.a.instance.pageEditScale;h.changeScale(f);var v=document.createElement("div");v.style.left="".concat(h.left,"px"),v.style.top="".concat(h.top,"px"),v.style.width="".concat(p*f,"px"),v.style.height="".concat(m*f,"px"),v.style.transform="rotate(".concat(e.props.getRotate(),"deg)"),v.className=r.a.ITEM_HOVER_BOX,u&&v.classList.add("dot_hover_box"),t.appendChild(v)}}),e.appendChild(t)}}},{key:"hasMask",value:function(){return this.layers.getLayerView(Zo.a.ITEM_AREA).hasMask()}},{key:"updateMask",value:function(e){this.layers.getLayerView(Zo.a.ITEM_AREA).updateMask(e?9999:this.backgroundRenderer.background.backgroundItem?1:0)}},{key:"addMask",value:function(e){this.layers.getLayerView(Zo.a.ITEM_AREA).addMask(e)}},{key:"setDesignGuide",value:function(){var e=r.a.DESIGN_GUIDE_ON;Y.a.instance.option.showDesignGuide?document.body.classList.add(e):document.body.classList.remove(e)}},{key:"getSelectedItemInfo",value:function(e,t){var n={selectedSingleItem:this.getInRangeItem(e,t),selectedGroupItems:[]},i=this.getInRangeGroup(e,t);if(i){var a=i.getAllSingleMembers();if(a.indexOf(n.selectedSingleItem)<0||!i.getSelectedItem()){var o=this.page.getAllSingleItems(),s=o.indexOf(n.selectedSingleItem);o.indexOf(a[a.length-1])>=s&&(n.selectedSingleItem=null,n.selectedGroupItems=a)}}return n}},{key:"isGroupSelected",value:function(e,t){return!it.a.isEmpty(this.getSelectedItemInfo(e,t).selectedGroupItems)}},{key:"setPosition",value:function(){this.guidelineRenderer.setSize(this.page.sheetSize),this.guidelineRenderer.setPageIdx(this.page.pageIdx)}},{key:"setGuidelineVisible",value:function(e){e?this.guidelineRenderer.show():this.guidelineRenderer.hide()}},{key:"removeElement",value:function(){this.backgroundRenderer.removeElement(),he()(F()(t.prototype),"removeElement",this).call(this)}},{key:"appendLayers",value:function(){he()(F()(t.prototype),"appendLayers",this).call(this),this.layers.container!==this.itemGuideRenderer.getItemGuideLayer().parentElement&&this.layers.container.appendChild(this.itemGuideRenderer.getItemGuideLayer())}}]),t}(Cs.a),Ks=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0,void 0,"button"))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add("btn_add_page");new Le.a(this.container,Ge.a.T,{description:"페이지 추가하기"});var n=document.createElement("div");Object(ne.setToolsIcon)(n,ne.ToolsIcon.ADD),this.container.appendChild(n),this.container.addEventListener("mouseenter",function(){e.container.classList.add("hover")}),this.container.addEventListener("mouseleave",function(){e.container.classList.remove("hover")}),this.container.addEventListener("click",function(e){e.stopPropagation(),X.a.instance.dispatch(new Jn.a(Y.a.instance.lastPageIdx+1))}),this.container.addEventListener("mousedown",function(e){e.stopPropagation()}),this.container.addEventListener("mouseup",function(){Y.a.instance.activeItems=[]})}},{key:"onChangeViewState",value:function(e,t,n){this.setVisibility(!Y.a.isCropMode()&&!Y.a.isSpoidMode()&&t)}}]),t}(He.a),Ys=n(269),Xs=n(457),js=function(){function e(t,n,i){L()(this,e),this.itemTbpeId=t,this.itemPosition=n,this.alertGuides=i}return w()(e,[{key:"containsAlert",value:function(){return this.alertGuides.length>0}},{key:"setGuides",value:function(e){this.alertGuides=e}},{key:"getHighAlertLevel",value:function(){return this.alertGuides.some(function(e){return e.type===ae.a.WARNING})?ae.a.WARNING:this.alertGuides.some(function(e){return e.type===ae.a.CAUTION})?ae.a.CAUTION:this.alertGuides.some(function(e){return e.type===ae.a.RECOMMEND})?ae.a.RECOMMEND:ae.a.DELETE_ITEM}}]),e}(),Zs=function e(t){L()(this,e),this.guide=t,this.type=ae.a[t.alertType],this.title=t.title,this.contents=t.warningText,this.match=t.match.toString()},qs=n(382),$s=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).minDpi=e.minDpi,n}return z()(t,e),w()(t,[{key:"checkViolation",value:function(e){var t=e instanceof Je.d&&e.belongsTo===Je.c.INDEPENDENT,n=e instanceof ee.b&&!e.isDefaultImage();if(!t&&!n)return!1;var i=t?e:e.innerPhotoItem,a=qs.a.imgOriginSizeFinder.get(i.tbpeId),o=a.width,s=a.height,r=j.a.getPageSize().dpi,l=i.itemPosition.getWidth(),c=i.itemPosition.getHeight();return this.isLowResImage(l,o,r,this.minDpi)||this.isLowResImage(c,s,r,this.minDpi)}},{key:"isLowResImage",value:function(e,t,n,i){return t/e*n<=i}}]),t}(Zs),Qs=function(){function e(t,n,i){L()(this,e),this.ltrb=n,this.shapeType=t,this.inspection=i}return w()(e,[{key:"isInspectionChecked",value:function(){return this.inspection.check}}]),e}(),Js=n(521),er=n(352),tr=n(274),nr=function e(t,n,i,a,o,s){L()(this,e),this.pageShape=t,this.guideShape=n,this.pageLTRB=i,this.areaLTRB=a,this.pageSvg=o,this.areaSvg=s},ir=new(function(){function e(){L()(this,e),this.areaOutputInfoList=new Map}var t,n;return w()(e,[{key:"getGuideAreaPxLTRB",value:function(e){var t=new li.a(0,0,0,0);return X.a.instance.dispatch(new K.c(function(n,i){var a=i.option.pageSize,o=a.width,s=a.height,r=a.dpi,l=a.unit,c=new li.a(0,0,De.a.getPixel(o,r,l),De.a.getPixel(s,r,l)),u=n.pages[i.renderPageIdx].sheetSize,d=u.width/c.getWidth(),h=u.height/c.getHeight();t=new li.a(De.a.getPixel(e.left*d,r,l),De.a.getPixel(e.top*h,r,l),De.a.getPixel(e.right,r,l)*d,De.a.getPixel(e.bottom,r,l)*h)})),t}},{key:"isSameRstTypes",value:function(e,t){if(e.length===t.length)return e.forEach(function(e,n){if(e!==t[n])return!1}),!0}},{key:"setGuideAreaData",value:function(e){this.guideAreaData=e}},{key:"addImageMinDpiGuide",value:function(e){this.imgDpiGuideProps=new $s(e)}},{key:"getArea",value:function(e){var t=li.a.createFromRect(e.position),n=e.shape?tr.d[e.shape.type]:tr.d.SQUARE,i=this.getGuideAreaPxLTRB(t),a=e.inspection;return new Qs(n,i,a)}},{key:"initAreaShapeSvgElements",value:(n=s()(a.a.mark(function t(n){var i,o,s,r,l,c,u,d,h,p=this;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.areaOutputInfoList.clear(),i=S.a.getEditorOpenOption().getOutput(),o=i.getSize(),s=new li.a(0,0,o.getWidth(),o.getHeight()),r=!0,l=!1,c=void 0,t.prev=7,u=a.a.mark(function t(){var n,o,r,l,c,u,d,m;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=h.value,o=i.getShapes().find(function(e){return e.getMatch()===n.match.toString()}),r=o?o.getShape():new tr.a,t.next=5,e.getSvg(r,s);case 5:return l=t.sent,c=n.position,u=new li.a(c.left,c.top,c.right,c.bottom),(d=Object.assign(new tr.a,n.shape)).fixCompatibility(),t.next=12,e.getSvg(d,u);case 12:m=t.sent,p.areaOutputInfoList.set(n,new nr(r,d,s,u,l,m));case 14:case"end":return t.stop()}},t)}),d=n[Symbol.iterator]();case 10:if(r=(h=d.next()).done){t.next=15;break}return t.delegateYield(u(),"t0",12);case 12:r=!0,t.next=10;break;case 15:t.next=21;break;case 17:t.prev=17,t.t1=t.catch(7),l=!0,c=t.t1;case 21:t.prev=21,t.prev=22,r||null==d.return||d.return();case 24:if(t.prev=24,!l){t.next=27;break}throw c;case 27:return t.finish(24);case 28:return t.finish(21);case 29:case"end":return t.stop()}},t,this,[[7,17,21,29],[22,,24,28]])})),function(e){return n.apply(this,arguments)})},{key:"getListWithoutDuplicate",value:function(e){var t=new Array,n=!0,i=!1,a=void 0;try{for(var o,s=function(){var e=o.value;t.every(function(t){return t.title!==e.title&&t.contents!==e.contents})&&t.push(e)},r=e[Symbol.iterator]();!(n=(o=r.next()).done);n=!0)s()}catch(e){i=!0,a=e}finally{try{n||null==r.return||r.return()}finally{if(i)throw a}}return t}},{key:"getAreaSvgBySize",value:function(e){var t=this.areaOutputInfoList.get(e),n=Y.a.instance.option;if(!t.areaSvg||!n.pageSize)return null;var i=n.getPixelByDefaultDpi(n.pageSize.width),a=n.getPixelByDefaultDpi(n.pageSize.height),o="";er.a.getVectorPointsBySize(t.areaSvg,0,0,i,a).forEach(function(e){return o+="".concat(e.x," ").concat(e.y," ")});var s=t.areaSvg.cloneNode(!0);return s.setAttribute("viewBox","0 0 ".concat(i," ").concat(a)),s.querySelector("polygon").setAttribute("points",o),s}},{key:"getAreaOutputInfo",value:function(e){return this.areaOutputInfoList.has(e)?this.areaOutputInfoList.get(e):new nr(new tr.a,new tr.a,new li.a(0,0,0,0),new li.a(0,0,0,0),null,null)}}],[{key:"getSvg",value:(t=s()(a.a.mark(function e(t,n){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.getType(),e.next=e.t0===tr.d.ROUND_SQUARE?3:e.t0===tr.d.VECTOR?5:e.t0===tr.d.SQUARE?9:e.t0===tr.d.CIRCLE?9:(e.t0,tr.d.LINE,9);break;case 3:return i=Js.a.createRoundRectangleSvgWithPolygon(n,t.getRoundDepth(),t.getRoundCorners()),e.abrupt("break",10);case 5:return e.next=7,Js.a.getSvgElementByFormat(t.getVectorFormat(),t.getVector());case 7:return i=e.sent,e.abrupt("break",10);case 9:i=null;case 10:return e.abrupt("return",i?er.a.changePathToPolygonInSvg(i):i);case 11:case"end":return e.stop()}},e)})),function(e,n){return t.apply(this,arguments)})}]),e}()),ar=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return L()(this,t),(n=V()(this,F()(t).call(this,e))).vectorPoints=i,n.area=ir.getArea(e),n.inspectionType=ae.b[e.inspectionAreaType],i.length>0&&(n.boundRectOfPolygon=cs.a.getBoundRectOfPolygon(i)),n}return z()(t,e),w()(t,[{key:"checkViolation",value:function(e){var t=e.getItemBound(),n=t.degree,i=t.pureLTRB,a=i.getCenterPos(),o=ds.a.calcLocationByRotate(t.pureLTRB.getCenterPos(),t.centerPos,n),s=i.move(o.x-a.x,o.y-a.y),r=this.area,l=r.ltrb,c=r.shapeType;if(e.isOnlyOneItem()||!this.area.isInspectionChecked())return!1;var u=this.inspectionType,d=ae.b.IN,h=ae.b.BETWEEN,p=ae.b.OUT;if(c===tr.d.SQUARE){if(cs.a.isAllPointInsideRect(l,0,s,n))return!0;if(u===d)return cs.a.isInsideRect(s,n,l,0)||cs.a.isCollisionLine(s,n,l,0);if(u===h)return!cs.a.isInsideRect(s,n,l,0)||cs.a.isCollisionLine(s,n,l,0);if(u===p)return!cs.a.isInsideRect(s,n,l,0)}else if(c===tr.d.CIRCLE){var m=l,f=Math.min(m.getWidth(),m.getHeight())/2,v={center:m.getCenterPos(),radius:f};if(u===d)return cs.a.isCollisionWithCircle(v,s,t.degree);if(u===h)return!cs.a.isInCircle(v,s,t.degree);if(u===p)return!cs.a.isCollisionWithCircle(v,s,t.degree)}else{if(c===tr.d.LINE)return cs.a.isInsideRect(l,0,s,n)||cs.a.isCollisionLine(s,n,l,0);if([tr.d.ROUND_SQUARE,tr.d.VECTOR].includes(c))return!cs.a.isInsideRect(s,n,this.boundRectOfPolygon,0)||cs.a.isCollisionVector(s,n,this.vectorPoints)||cs.a.isLTRBOutsidePolygon(s,n,this.vectorPoints)}}}]),t}(Zs),or="${font_min_size}",sr=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).minFontSizePt=e.minHeight*t.PT_PER_MM,n.contents&&(n.contents=n.contents.replace(or,n.minFontSizePt.toFixed(1))),n}return z()(t,e),w()(t,[{key:"checkViolation",value:function(e){var n=[];if(e instanceof q.a)n=e.props.getSizes();else{if(!(e instanceof Z.a))return!1;e.getAllTextItemOfCells().forEach(function(e){return n=n.concat(e.props.getSizes())})}return t.isMinFontSize(this.minFontSizePt,n)}}],[{key:"isMinFontSize",value:function(e,n){for(var i=0;i<n.length;i++){if(Math.min.apply(Math,Yn()(n[i]))*t.PX_TO_PT_SCALE<e)return!0}return!1}}]),t}(Zs);sr.PX_TO_PT_SCALE=.75,sr.PT_PER_MM=2.8346;var rr=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,e))).minWidth=De.a.getPixelFromMilli(e.minWidth,n),i.minHeight=De.a.getPixelFromMilli(e.minHeight,n),i}return z()(t,e),w()(t,[{key:"checkViolation",value:function(e){var t=e.getWidth(),n=e.getHeight();return t<this.minWidth||n<this.minHeight}}]),t}(Zs),lr=function(){function e(){L()(this,e)}return w()(e,null,[{key:"getGuide",value:function(e,t,n){switch(e.type){case"AREA":return new ar(e,n);case"IMAGE_DPI":return new $s(e);case"FONT_SIZE":return new sr(e);case"ITEM_SIZE":return new rr(e,t);default:console.log("Unhandled guide",e)}}},{key:"equalsTextWithCase",value:function(e,t){return e===t}},{key:"getVectorPoints",value:function(e,t){var n=ir.getAreaOutputInfo(e);if(!n.areaSvg||!t)return new Array;var i=n.areaLTRB,a=t.getPixelByDefaultDpi(i.left),o=t.getPixelByDefaultDpi(i.top),s=t.getPixelByDefaultDpi(i.getWidth()),r=t.getPixelByDefaultDpi(i.getHeight());return er.a.getVectorPointsBySize(n.areaSvg,a,o,s,r)}},{key:"getNumberOfWarningAlert",value:function(e){return e.filter(function(e){return e.alertGuides.some(function(e){return e.type===ae.a.WARNING})}).length}},{key:"containsAreaAlert",value:function(e){return!!e&&e.alertGuides.some(function(e){return e instanceof ar})}},{key:"getNumberOfItemIncludingAlert",value:function(e){return e.filter(function(e){return e.containsAlert()}).length}},{key:"getNumberOfImageDpiAlert",value:function(e){return e.filter(function(e){return e.alertGuides.some(function(e){return e instanceof $s})}).length}},{key:"getGuideInspectionAreaType",value:function(e){return ae.b[e]}}]),e}(),cr=function(){function e(){L()(this,e)}return w()(e,null,[{key:"canApplyGuide",value:function(e,t){var n=!Number.isNaN(Number(e)),i="*"===e,a="EVEN"===e,o="ODD"===e;if(i)return!0;if(!(n||i||a||o))return!1;var s=t+1,r=s%2==0;return n?s===Number(e):r?a:o}}]),e}(),ur=function(){function e(t,n,i,a,o){L()(this,e),this.itemLTRB=t,this.degree=n,this.scaled=i,this.editWidth=a,this.editHeight=o}return w()(e,[{key:"getCenterPosition",value:function(){return this.itemLTRB.getCenterPos()}},{key:"updateScale",value:function(e,t,n){this.editWidth=e,this.editHeight=t,this.scaled=n}},{key:"getValidLTPosition",value:function(e){var t=e/2,n=this.getCenterPosition(),i=this.editWidth-t,a=this.editHeight-t,o=Ga.a.getValidNumber(n.x*this.scaled,t,i)-t,s=Ga.a.getValidNumber(n.y*this.scaled,t,a)-t;return new ns.a(o,s)}}]),e}(),dr=function(){function e(){L()(this,e)}return w()(e,null,[{key:"getItemPosition",value:function(e,t,n){var i=e.getItemBound(),a=Y.a.instance.pageEditScale*Y.a.instance.zoomScale;return new ur(i.itemLTRB,i.degree,a,t,n)}}]),e}(),hr=n(385),pr=function(){function e(){L()(this,e),this.itemPageIdList=new Map,this.alertGuides=new Array}return w()(e,[{key:"setCallbackReference",value:function(e){this.callbackReference=e}},{key:"init",value:function(e){var t=this;this.alertGuides=[];var n=Y.a.instance.option.pageSize.dpi;e.forEach(function(e){var i="AREA"===e.type?lr.getVectorPoints(e,Y.a.instance.option):[];t.alertGuides.push(lr.getGuide(e,n,i))})}},{key:"initItemInfo",value:function(e,t){var n=this;t.forEach(function(t){var i=t.tbpeId;hr.a.removeAlertOfItemId(i),n.itemPageIdList.set(i,e)})}},{key:"checkRestriction",value:function(e,t,n,i,a,o){this.initItemInfo(e,t);var s=this.getViolatedItemWarningAlerts(t,n,i,o);return hr.a.addAlertOfPageId(e,s),t.forEach(function(e){var t=s.find(function(t){return t.itemTbpeId===e.tbpeId});if(!t){var o=dr.getItemPosition(e,n,i);t=new js(e.tbpeId,o,[])}a.updateAlert(t)}),this.updateAlertVisibleOfItems(a,t),s}},{key:"getViolatedItemWarningAlerts",value:function(e,t,n,i){var a=this,o=new Array;return e.forEach(function(e){var s=a.getItemWarningAlert(e,t,n,i);s.containsAlert()&&o.push(s)}),o}},{key:"getItemWarningAlert",value:function(e,t,n,i){var a=new Array;this.alertGuides.forEach(function(t){cr.canApplyGuide(t.match,i)&&t.checkViolation(e)&&!e.unsupportedResource&&a.push(t)});var o=dr.getItemPosition(e,t,n);return new js(e.tbpeId,o,a)}},{key:"updateAlertVisibleOfItems",value:function(e,t){var n=[],i=[];t.forEach(function(e){e.isEditMode?i.push(e.tbpeId):n.push(e.tbpeId)}),e.setVisibleIcons(!0,n),e.setVisibleIcons(!1,i),e.render()}},{key:"getPageIdOfItem",value:function(e){return this.itemPageIdList.get(e)}},{key:"removePageIdOfItem",value:function(e){this.itemPageIdList.delete(e)}},{key:"updateDOMbyItems",value:function(t,n){var i=t.items;switch(t.itemStatus){case Xs.a.SELECT:this.selectItem(n,i);break;case Xs.a.REMOVE:this.removeItem(n,i);break;case Xs.a.CHANGE_POSITION:e.changePosition(n,i);break;case Xs.a.MOVE_OTHER_PAGE:this.moveToOtherPage(n,i);break;default:return void console.log("undefined ItemsStatus")}}},{key:"selectItem",value:function(e,t){e.setVisibleIcons(!0,te.getNoEditItemIdList(this.callbackReference.getActiveItems()))}},{key:"removeItem",value:function(e,t){var n=this;t&&0!==t.length&&t.forEach(function(t){var i=t.tbpeId;hr.a.removeAlertOfItemId(i),n.itemPageIdList.delete(i),e.removeAlert(i)})}},{key:"removeItemById",value:function(e,t){var n=this;t&&0!==t.length&&t.forEach(function(t){hr.a.removeAlertOfItemId(t),n.itemPageIdList.delete(t),e.removeAlert(t)})}},{key:"moveToOtherPage",value:function(e,t){t&&0!==t.length&&te.getNoEditItemIdList(t).forEach(function(t){e.removeAlert(t)})}}],[{key:"changePosition",value:function(e,t){if(t&&0!==t.length){var n=te.getNoEditItemIdList(t);e.setVisibleIcons(!1,n)}}}]),e}(),mr=function(){function e(){L()(this,e)}return w()(e,null,[{key:"getInnerSize",value:function(e,t){var n=e-2*t;return n>0?n:0}},{key:"isValidMarginSize",value:function(e,t){return t>=0&&2*t<e}},{key:"getInnerInfos",value:function(t,n,i,a){var o=i<a;return{element:t,left:o?0:n,top:o?n:0,width:o?i:e.getInnerSize(i,n),height:o?e.getInnerSize(a,n):a}}},{key:"getIconPosition",value:function(e,t,n,i){var a=e<t,o=n/2,s=a?e/2-o:i-o,r=a?i-o:t/2-o;return{left:s,top:r,right:s,bottom:r,width:n,height:n}}},{key:"getLtrbToRotatedInfos",value:function(e,t,n,i){return{element:e,left:t.left*i,top:t.top*i,width:t.getWidth()*i,height:t.getHeight()*i,degree:n}}},{key:"getInnerLTRBCoordinate",value:function(e,t,n){return new li.a(n,n,e-n,t-n)}},{key:"getItemPurePos",value:function(e,t){var n=t?t.leftTopPt.x:0,i=t?t.leftTopPt.y:0;return{left:e.left+n,top:e.top+i}}},{key:"getItemMBRInfos",value:function(e,t,n,i,a,o){return{element:e,left:i.left-t*o,top:i.top-n*o,degree:a,width:i.getWidth(),height:i.getHeight()}}},{key:"getInfos",value:function(e,t,n){return{element:e,left:0,top:0,width:t,height:n}}},{key:"getPureBoundInfos",value:function(e,t,n){return{element:e,left:t.leftTopPt.x*n,top:t.leftTopPt.y*n,width:t.width*n,height:t.height*n}}},{key:"getPureInfos",value:function(t,n,i,a){var o=n.getWidth()*i,s=n.getHeight()*i;return a?e.getPureBoundInfos(t,a,i):e.getInfos(t,o,s)}},{key:"getValidMarginValue",value:function(t,n){var i=t;if(!((i.match(/\./g)||[]).length<=1&&i.lastIndexOf(".")===i.length-1)){if(e.isIncludeDot(i)){var a=i.indexOf("."),o=i.substr(0,a);switch(n){case De.a.CM:i="".concat(o).concat(i.substr(a,2));break;case De.a.IN:i="".concat(o).concat(i.substr(a,3));break;default:i=o}}return Number(i)}}},{key:"isIncludeDot",value:function(e){return e.indexOf(".")>-1}}]),e}(),fr=function(){function e(){L()(this,e)}return w()(e,null,[{key:"makeItemBoundingArea",value:function(t,n){var i=Ys.a.makeDiv(e.HIGHLIGHT_BOUNDING_AREA),a=mr.getItemPurePos(n.itemLTRB,n.pureBound),o=a.left,s=a.top,r=mr.getItemMBRInfos(i,o,s,t,-n.degree,n.scale);return Ys.a.setRotatedLTPosition(r),i}},{key:"addHighlightElement",value:function(e,t,n,i){if(n>0&&i>0){var a=Ys.a.makeDiv(t);Ys.a.setElementSize(a,n,i),e.appendChild(a)}}},{key:"makePureWrapper",value:function(t,n,i){var a=Ys.a.makeDiv(e.HIGHLIGHT_PURE_GUIDE_WRAPPER),o=mr.getPureInfos(a,t,n,i);return Ys.a.setLTPosition(o),a}},{key:"setItemPos",value:function(e){Ys.a.setRotatedLTPosition(mr.getLtrbToRotatedInfos(e.element,e.itemLTRB,e.degree,e.scale))}},{key:"makeRestrictionWrapper",value:function(t,n){var i=Ys.a.makeDiv(e.PRINTOUT_INFO_RESTRICTIONS);return i.classList.add(n),t.appendChild(i),i}},{key:"showAlertRestrictionMap",value:function(e,t){t?t.forEach(function(t){if(e.has(t)){var n=e.get(t);Ys.a.fadeInElement(n.element),n.element.classList.remove(r.a.DISABLE)}}):e.forEach(function(e){Ys.a.fadeInElement(e.element),e.element.classList.remove(r.a.DISABLE)})}},{key:"hideAlertRestrictionMap",value:function(e,t){t?t.forEach(function(t){if(e.has(t)){var n=e.get(t);Ys.a.fadeOutElement(n.element),n.element.classList.add(r.a.DISABLE)}}):e.forEach(function(e){Ys.a.fadeOutElement(e.element),e.element.classList.add(r.a.DISABLE)})}}]),e}();fr.HIGHLIGHT_BOUNDING_AREA="pure_item_bounding_area",fr.HIGHLIGHT_PURE_GUIDE_WRAPPER="highlight_pure_wrapper",fr.PRINTOUT_INFO_RESTRICTIONS="restriction_contents";var vr=function(){function e(t){L()(this,e),this.ltrb=new li.a(0,0,0,0),this.wrapper=Ys.a.makeDiv(t)}return w()(e,[{key:"init",value:function(e,t){this.ltrb=e.ltrb.clone(),this.shapeType=e.shapeType,this.update(t)}},{key:"setParentElement",value:function(e){this.wrapper.parentElement||e.appendChild(this.wrapper)}},{key:"update",value:function(e){}},{key:"clear",value:function(){Ys.a.removeAllChild(this.wrapper)}},{key:"show",value:function(){this.wrapper.classList.add(e.ACTIVE)}},{key:"hide",value:function(){this.wrapper.classList.remove(e.ACTIVE)}}]),e}();vr.ACTIVE="active",vr.INACTIVE="inactive";var gr=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getLineInfos",value:function(e,t,n){var i=t.clone().changeScale(n);return{element:e,left:i.left,top:i.top,width:i.getWidth(),height:i.getHeight()}}},{key:"initLTRB",value:function(){if(this.shapeType===tr.d.CIRCLE){var e=this.ltrb.getWidth(),t=this.ltrb.getHeight();e<t?(this.ltrb.top+=(t-e)/2,this.ltrb.bottom=this.ltrb.top+e):(this.ltrb.left+=(e-t)/2,this.ltrb.right=this.ltrb.left+t)}}},{key:"init",value:function(e,n){he()(F()(t.prototype),"init",this).call(this,e,n),this.initLTRB()}},{key:"getCenterPosition",value:function(e,t){return e.clone().changeScale(t).getCenterPos()}}]),t}(vr),Er=n(407),yr=n(406),Tr=function(){function e(){L()(this,e)}return w()(e,null,[{key:"initSvgElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.removeAttribute("id"),e.setAttribute("preserveAspectRatio","none"),e.classList.add("shape");var n=e.querySelector("polygon");n&&t&&n.classList.add(t)}},{key:"getScaledSvgPath",value:function(e,t){var n=e.getAttribute("viewBox").split(" "),i=Number(n[2]),a=Number(n[3]),o=e.querySelector("polygon"),s=yr.a.makeSvgRenderedDataUnit(o)[0],r=t.getWidth()/i,l=t.getHeight()/a,c=t.left/r,u=t.top/l;return s.getPathString(r,l,c,u)}},{key:"getGuidePath",value:function(e,t,n){switch(t.getType()){case tr.d.SQUARE:return Er.a.createRectangle(n.left,n.top,n.right,n.bottom);case tr.d.ROUND_SQUARE:return Er.a.createRoundRectangle(n.left,n.top,n.getWidth(),n.getHeight(),t.getRoundDepth(),t.getRoundCorners());case tr.d.CIRCLE:return Er.a.createCircle(n.left,n.top,t.getRadius());case tr.d.VECTOR:return this.getScaledSvgPath(e,n);case tr.d.LINE:default:return""}}},{key:"getLineStyleScale",value:function(e,t,n){var i=e.getAttribute("viewBox");if(i){var a=i.split(" "),o=Number(a[2]),s=Number(a[3]),r=t.getWidth()/o,l=t.getHeight()/s;return 2/(o>=s?r:l)/n}}}]),e}(),Ir=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,t.DOTTED_GUIDE_AREA))).lineElement=[],n.svgShape=e,e?n.initSvgLineElements(e):n.initDefaultLineElements(),n}return z()(t,e),w()(t,[{key:"initDefaultLineElements",value:function(){this.lineElement.push(Ys.a.makeDiv(t.DARK_COLOR_DOTTED_LINE)),this.lineElement.push(Ys.a.makeDiv(t.BRIGHT_COLOR_DOTTED_LINE))}},{key:"initSvgLineElements",value:function(e){var n=e.cloneNode(!0);Tr.initSvgElement(n,t.DARK_COLOR_DOTTED_LINE_VECTOR);var i=e.cloneNode(!0);Tr.initSvgElement(i,t.BRIGHT_COLOR_DOTTED_LINE_VECTOR),this.lineElement.push(i),this.lineElement.push(n)}},{key:"init",value:function(e,n){var i=this;he()(F()(t.prototype),"init",this).call(this,e,n),this.wrapper.classList.add(e.shapeType),this.lineElement.forEach(function(e){return i.wrapper.appendChild(e)})}},{key:"update",value:function(e){var n=this;he()(F()(t.prototype),"update",this).call(this,e),this.lineElement.forEach(function(t){Ys.a.setLTPosition(n.getLineInfos(t,n.ltrb,e));var i=t.querySelector("polygon");i&&n.updatePolygonLineStyle(i,e)})}},{key:"updatePolygonLineStyle",value:function(e,n){var i=Tr.getLineStyleScale(this.svgShape,this.ltrb,n),a=i.toString(),o=(2*i).toString();e.classList.contains(t.DARK_COLOR_DOTTED_LINE_VECTOR)?(e.style.strokeWidth=a,e.style.strokeDasharray=o):(e.style.strokeWidth=a,e.style.strokeDasharray=o,e.style.strokeDashoffset=o)}}]),t}(gr);Ir.DOTTED_GUIDE_AREA="dotted_guide_area",Ir.DARK_COLOR_DOTTED_LINE="dark_color_dotted_line",Ir.BRIGHT_COLOR_DOTTED_LINE="bright_color_dotted_line",Ir.DARK_COLOR_DOTTED_LINE_VECTOR="dark_color_dotted_line_vector",Ir.BRIGHT_COLOR_DOTTED_LINE_VECTOR="bright_color_dotted_line_vector";var Cr=n(247),kr=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,"printout_highlight_wrapper"))).areaType=e,a.guide=i,e===ae.b.IN?a.initElementByInside(n.guideShape.getType(),n.areaSvg):a.initElementByOutside(n),a.element.classList.add("highlight_area"),a.wrapper.appendChild(a.element),a}return z()(t,e),w()(t,[{key:"init",value:function(e,n){this.areaType===ae.b.IN&&(he()(F()(t.prototype),"init",this).call(this,e,n),this.wrapper.classList.add(e.shapeType),this.update(n))}},{key:"update",value:function(e){this.areaType===ae.b.IN&&(he()(F()(t.prototype),"update",this).call(this,e),Ys.a.setLTPosition(this.getLineInfos(this.element,this.ltrb,e)))}},{key:"initElementByInside",value:function(e,t){e===tr.d.VECTOR?(this.element=t.cloneNode(!0),Tr.initSvgElement(this.element)):this.element=document.createElement("div")}},{key:"initElementByOutside",value:function(e){var n=document.createElementNS(Cr.a.SVG,"svg");n.appendChild(t.getAreaPathNode(e)),n.setAttribute("viewBox","0 0 ".concat(e.pageLTRB.getWidth()," ").concat(e.pageLTRB.getHeight())),this.element=n,this.element.style.width="100%",this.element.style.height="100%"}}],[{key:"getAreaPathNode",value:function(e){var n=document.createElementNS(Cr.a.SVG,"path");return n.setAttribute("d","".concat(t.getAreaPath(e))),n.setAttribute("fill-rule","evenodd"),n}},{key:"getAreaPath",value:function(e){var t=Tr.getGuidePath(e.pageSvg?e.pageSvg.cloneNode(!0):null,e.pageShape,e.pageLTRB),n=Tr.getGuidePath(e.areaSvg?e.areaSvg.cloneNode(!0):null,e.guideShape,e.areaLTRB);return"".concat(t," ").concat(n)}}]),t}(gr),Lr=function(e){function t(e){var n;L()(this,t);var i=(n=V()(this,F()(t).call(this,t.TEXT_GUIDE_WRAPPER))).container=Ys.a.makeDiv(t.TEXT_GUIDE_AREA);return n.container.appendChild(Ys.a.makeLabel(e,t.DISPLAY_TEXT)),n.subLine=Ys.a.makeDiv(t.SUB_LINE),n.wrapper.appendChild(i),n}return z()(t,e),w()(t,[{key:"init",value:function(e,n){this.isVerticalArea=e.ltrb.getWidth()<=e.ltrb.getHeight(),he()(F()(t.prototype),"init",this).call(this,e,n),e.shapeType===tr.d.LINE&&this.container.appendChild(this.subLine),this.isVerticalArea?this.wrapper.classList.add(t.VERTICAL):this.wrapper.classList.add(t.HORIZON)}},{key:"update",value:function(e){if(he()(F()(t.prototype),"update",this).call(this,e),this.isVerticalArea){var n=this.getCenterPosition(this.ltrb,e).x-50;this.container.style.left="".concat(n,"px")}else{var i=this.getCenterPosition(this.ltrb,e).y-12;this.container.style.top="".concat(i,"px")}}}]),t}(gr);Lr.TEXT_GUIDE_WRAPPER="text_guide_wrapper",Lr.TEXT_GUIDE_AREA="text_guide_area",Lr.DISPLAY_TEXT="display_text",Lr.SUB_LINE="sub_line",Lr.VERTICAL="vertical",Lr.HORIZON="horizon";var _r=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,t.SOLID_GUIDE_AREA))).lineElement=[],n.svgShape=e,e?n.initSvgLineElements(e):n.initDefaultLineElements(),n}return z()(t,e),w()(t,[{key:"initDefaultLineElements",value:function(){this.lineElement.push(Ys.a.makeDiv(t.SOLID_LINE))}},{key:"initSvgLineElements",value:function(e){var n=e.cloneNode(!0);Tr.initSvgElement(n,t.SOLID_LINE_VECTOR),this.lineElement.push(n)}},{key:"init",value:function(e,n){var i=this;he()(F()(t.prototype),"init",this).call(this,e,n),this.wrapper.classList.add(e.shapeType),this.lineElement.forEach(function(e){return i.wrapper.appendChild(e)})}},{key:"update",value:function(e){var n=this;he()(F()(t.prototype),"update",this).call(this,e),this.lineElement.forEach(function(t){Ys.a.setLTPosition(n.getLineInfos(t,n.ltrb,e));var i=t.querySelector("polygon");i&&n.updatePolygonLineStyle(i,e)})}},{key:"updatePolygonLineStyle",value:function(e,n){var i=Tr.getLineStyleScale(this.svgShape,this.ltrb,n).toString();e.classList.contains(t.SOLID_LINE_VECTOR)&&(e.style.strokeWidth=i)}}]),t}(gr);_r.SOLID_GUIDE_AREA="solid_guide_area",_r.SOLID_LINE="solid_line",_r.SOLID_LINE_VECTOR="solid_line_vector";var wr=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,t.INSIDE_SHAPE_DISPLAY_AREA))).color=e,a.svgShape=i,a.element=t.createElement(i),""===a.color&&(a.color=t.DEFAULT_FILL_COLOR),d.b.isEmpty(n)||new Le.a(a.element,Ge.a.T,{title:{name:n}},{title:{name:n}},{duration:0}).setVisibleinMobile(!0),a.wrapper.appendChild(a.element),a}return z()(t,e),w()(t,[{key:"init",value:function(e,n){he()(F()(t.prototype),"init",this).call(this,e,n),this.wrapper.classList.add(e.shapeType),this.svgShape?this.element.style.fill=this.color:this.element.style.backgroundColor=this.color,this.update(n)}},{key:"update",value:function(e){he()(F()(t.prototype),"update",this).call(this,e),Ys.a.setLTPosition(this.getLineInfos(this.element,this.ltrb,e))}}],[{key:"createElement",value:function(e){if(e){var n=e.cloneNode(!0);return Tr.initSvgElement(n,t.INSIDE_SHAPE_CONTAINER),n}return Ys.a.makeDiv(t.INSIDE_SHAPE_CONTAINER)}}]),t}(gr);wr.INSIDE_SHAPE_DISPLAY_AREA="inside_shape_display_area",wr.INSIDE_SHAPE_CONTAINER="inside_shape_container",wr.DEFAULT_FILL_COLOR="rgba(0, 204, 187, 0.3)";var Sr=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,t.OUTSIDE_SHAPE_DISPLAY_AREA))).highlightElements=[],n.color=e,""===n.color&&(n.color=t.DEFAULT_FILL_COLOR),n.highlightElements.push(Ys.a.makeDiv("left")),n.highlightElements.push(Ys.a.makeDiv("right")),n.highlightElements.push(Ys.a.makeDiv("top")),n.highlightElements.push(Ys.a.makeDiv("bottom")),n.highlightElements.forEach(function(e){return n.wrapper.appendChild(e)}),n}return z()(t,e),w()(t,[{key:"init",value:function(e,n){var i=this;he()(F()(t.prototype),"init",this).call(this,e,n),this.highlightElements.forEach(function(e){e.style.background=i.color}),this.update(n)}},{key:"update",value:function(e){if(he()(F()(t.prototype),"update",this).call(this,e),this.ltrb){var n=this.ltrb.clone().changeScale(e),i=n.left,a="".concat(i,"px"),o=n.top,s="".concat(o,"px");this.highlightElements[0].style.width=a,this.highlightElements[1].style.width="calc(100% - ".concat(n.right,"px)"),this.highlightElements[2].style.height=s,this.highlightElements[2].style.width="".concat(n.right-n.left,"px"),this.highlightElements[2].style.left=a,this.highlightElements[3].style.height="calc(100% - ".concat(n.bottom,"px)"),this.highlightElements[3].style.width="".concat(n.right-n.left,"px"),this.highlightElements[3].style.left=a}}}]),t}(gr);Sr.OUTSIDE_SHAPE_DISPLAY_AREA="outside_shape_display_area",Sr.DEFAULT_FILL_COLOR="rgba(0, 204, 187, 0.3)";var br=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"onMouseDown",value:function(e){e.stopPropagation(),this.props.onMouseDown&&this.props.onMouseDown()}},{key:"onMouseUp",value:function(e){e.stopPropagation(),e.preventDefault(),this.props.onMouseUp&&this.props.onMouseUp(this.props.itemWarningIcon.tbpeId)}},{key:"render",value:function(){return ra.a.createElement("div",{className:"warning_icon",style:{left:"".concat(this.props.itemWarningIcon.left,"px"),top:"".concat(this.props.itemWarningIcon.top,"px"),display:"".concat(this.props.itemWarningIcon.isVisible?"block":"none")},onMouseUp:this.onMouseUp.bind(this),onMouseDown:this.onMouseDown.bind(this),onTouchStart:this.onMouseDown.bind(this),onTouchEnd:this.onMouseUp.bind(this)},ra.a.createElement("i",{className:"tools_icon icon_error ".concat(this.props.itemWarningIcon.alertType)}))}}]),t}(sa.Component),Rr=function e(t){L()(this,e),this.isVisible=t,this.icons=new Array},Ar=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).state=new Rr(n.props.isVisible),n}return z()(t,e),w()(t,[{key:"setVisible",value:function(e){this.setState({isVisible:e})}},{key:"setIcons",value:function(e){this.setState({icons:e})}},{key:"render",value:function(){var e=this;return ra.a.createElement("div",{className:"warningIconWrapper",style:{display:"".concat(this.state.isVisible?"block":"none")}},this.state.icons.length>0&&this.state.icons.map(function(t){return ra.a.createElement(br,{key:t.tbpeId,itemWarningIcon:t,onMouseUp:e.props.onMouseUp,onMouseDown:e.props.onMouseDown})}))}}]),t}(sa.Component),Or=function e(t,n,i,a,o,s){L()(this,e),this.tbpeId=t,this.alertGuides=n,this.alertType=i,this.isVisible=a,this.left=o,this.top=s},Pr=function(){function e(){L()(this,e),this.icons=new Array,this.itemPositions=new Map}return w()(e,[{key:"getIcons",value:function(){return this.icons}},{key:"createIcon",value:function(e){var t=e.itemPosition.getValidLTPosition(qs.a.WARNING_ICON_SIZE),n=new Or(e.itemTbpeId,e.alertGuides,e.getHighAlertLevel(),!0,t.x,t.y);this.itemPositions.set(e.itemTbpeId,e.itemPosition),this.icons=this.icons.concat(n)}},{key:"updateScale",value:function(e,t,n){var i=this;this.updateAllIcons(function(a){var o=i.itemPositions.get(a.tbpeId);return o?(o.updateScale(e,t,n),a.left=o.getValidLTPosition(qs.a.WARNING_ICON_SIZE).x,a.top=o.getValidLTPosition(qs.a.WARNING_ICON_SIZE).y,a):a})}},{key:"removeIcon",value:function(e){this.icons=this.icons.filter(function(t){return t.tbpeId!==e}),this.itemPositions.delete(e)}},{key:"hasIcon",value:function(e){return this.icons.some(function(t){return t.tbpeId===e})}},{key:"getItemWarningIcon",value:function(e){return this.icons.find(function(t){return t.tbpeId===e})}},{key:"updateAllIcons",value:function(e){this.icons=this.icons.map(function(t){return e(t)})}},{key:"updateIcon",value:function(e,t){this.hasIcon(e)&&(this.icons=this.icons.map(function(n){return n.tbpeId===e?t(n):n}))}},{key:"clearIcons",value:function(){this.itemPositions.clear(),this.icons=new Array}}]),e}(),Dr=n(112),Mr=function(){function e(t,n,i,a,o){var s=this,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];L()(this,e),this.guideAreaViews=new Array,this.highlightGuideAreaViews=new Array,this.pusher=new Dr.a({}),this.lastZoomScale=-1,this.width=n,this.height=i,this.warningIconDC=new Pr,this.makeElement(),this.renderPrintOutWarningIconVC(r),a.forEach(function(e){cr.canApplyGuide(e.match.toString(),t)&&s.initAreaGuide(e)}),o&&cr.canApplyGuide(o.match.toString(),t)&&ir.addImageMinDpiGuide(o)}return w()(e,[{key:"makeElement",value:function(){var t=this.wrapper=Ys.a.makeDiv(e.PRINTOUT_INFO),n=Ys.a.makeDiv(e.PRINTOUT_INFO_CONTENTS);this.staticWrapper=fr.makeRestrictionWrapper(n,e.PRINTOUT_INFO_STATICS),this.dynamicWrapper=fr.makeRestrictionWrapper(n,e.PRINTOUT_INFO_DYNAMICS),t.appendChild(n)}},{key:"renderPrintOutWarningIconVC",value:function(e){var t=this,n={onMouseUp:function(e){return t.showAlertPopup(e)},onMouseDown:function(){return Y.a.instance.mouseAction.mode=Fn.a.MODE_ALERT_ICON_SELECT},isVisible:e};this.warningIconVC=La.render(ra.a.createElement(Ar,n),this.dynamicWrapper)}},{key:"initAreaGuide",value:function(e){e.inspection.check?this.addAlertGuideArea(e):this.addGuideArea(e)}},{key:"addAlertGuideArea",value:function(e){ir.setGuideAreaData(new ar(e)),this.addGuideArea(e),this.addAreaGuideHighlightView(e)}},{key:"addAreaGuideHighlightView",value:function(e){var t=ir.getAreaOutputInfo(e);if(t&&t.guideShape.getType()!==tr.d.LINE){var n=new kr(ae.b[e.inspectionAreaType],t,e);n.init(ir.getArea(e),Y.a.instance.zoomScale),this.highlightGuideAreaViews.push(n)}}},{key:"addGuideArea",value:function(e){var t=ir.getArea(e),n=Y.a.instance.zoomScale,i=this.getLineDisplayView(e.lineDisplay,ir.getAreaOutputInfo(e).areaSvg);if(i&&(i.init(t,n),this.guideAreaViews.push(i)),e.displayText&&!e.insideShapeDisplay){var a=new Lr(e.displayText);a.init(t,n),this.guideAreaViews.push(a)}if(e.insideShapeDisplay){var o=this.getDisplayType(e.insideShapeDisplay),s=new wr(o,e.displayText,ir.getAreaOutputInfo(e).areaSvg);s.init(t,n),this.guideAreaViews.push(s)}if(e.outsideShapeDisplay){var r=this.getDisplayType(e.outsideShapeDisplay),l=new Sr(r);l.init(t,n),this.guideAreaViews.push(l)}}},{key:"getDisplayType",value:function(e){var t=e.type;return"NONE"===t?"":"COLOR"===t?e.color:void 0}},{key:"getLineDisplayView",value:function(e,t){return e===ae.c.DOT?new Ir(t):e===ae.c.SOLID?new _r(t):null}},{key:"clear",value:function(){Ys.a.removeAllChild(this.staticWrapper),this.guideAreaViews=[],this.warningIconDC.clearIcons(),this.updateWarningIcons(),this.guideAreaViews.forEach(function(e){return e.clear()})}},{key:"updateWarningIcons",value:function(){this.warningIconVC?this.warningIconVC.setIcons(this.warningIconDC.getIcons()):this.renderPrintOutWarningIconVC(!0)}},{key:"appendElementTo",value:function(t){var n=t.getElementsByClassName(e.PRINTOUT_LAYER).item(0);n&&n.appendChild(this.wrapper)}},{key:"onStatusChanged",value:function(e,t){X.a.instance.dispatch(new K.c(function(n,i,a){ie.a.addItemAlert(e,t)}))}},{key:"addPopup",value:function(e){var t=document.createElement("span");Object(ne.setToolsIcon)(t,ne.ToolsIcon.ERROR).classList.add(e.type);var n={type:zo.b.CUSTOM,customTypeElement:t,title:e.title,content:e.contents};this.pusher.pushNotification(n)}},{key:"removeAlert",value:function(e){this.warningIconDC.removeIcon(e),this.updateWarningIcons(),this.highlightGuideAreaViews.forEach(function(e){return e.hide()})}},{key:"render",value:function(e){var t=this,n=Y.a.instance.zoomScale;if(this.lastZoomScale!==n){this.lastZoomScale=n;var i=Y.a.instance.pageEditScale*n;this.guideAreaViews.forEach(function(e){return e.update(i)}),this.highlightGuideAreaViews.forEach(function(e){return e.update(n*Y.a.instance.pageEditScale)}),this.warningIconDC.updateScale(this.width,this.height,i),this.updateWarningIcons()}this.guideAreaViews.forEach(function(e){return e.setParentElement(t.staticWrapper)}),this.highlightGuideAreaViews.forEach(function(e){return e.setParentElement(t.staticWrapper)}),this.setVisible(this.isShowGuide())}},{key:"isShowGuide",value:function(){return Y.a.instance.option.pageSize.unit!==De.a.PX}},{key:"setVisible",value:function(e){Ys.a.setElementVisible(this.wrapper,e)}},{key:"setSize",value:function(e,t){this.width=e,this.height=t}},{key:"setVisibleHighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(t){e?t.show():t.hide()}t.length>0?this.highlightGuideAreaViews.forEach(function(e){return t.includes(e.guide)?n(e):e.hide()}):this.highlightGuideAreaViews.forEach(function(e){return n(e)})}},{key:"onChangeAlertLevel",value:function(e,t){this.warningIconDC.updateIcon(e,function(e){return e.alertType=t,e}),this.updateWarningIcons()}},{key:"setVisibleIcons",value:function(e,t){var n=this,i=function(t){return t.isVisible=e,t};t?t.forEach(function(e){return n.warningIconDC.updateIcon(e,i)}):this.warningIconDC.updateAllIcons(i),this.updateWarningIcons()}},{key:"updateAlert",value:function(e){var t=e.itemTbpeId,n=e.containsAlert();e.itemPosition.updateScale(this.width,this.height,Y.a.instance.pageEditScale*Y.a.instance.zoomScale);var i=n&&!this.warningIconDC.hasIcon(t),a=n&&this.warningIconDC.hasIcon(t),o=!n&&this.warningIconDC.hasIcon(t);this.onStatusChanged(e.itemTbpeId,e.getHighAlertLevel()),i?(this.warningIconDC.createIcon(e),this.updateWarningIcons()):a?(this.warningIconDC.removeIcon(e.itemTbpeId),this.warningIconDC.createIcon(e),this.updateWarningIcons()):o&&this.removeAlert(t)}},{key:"showAlertPopup",value:function(e){var t=this;(this.closeAlertPopup(),this.warningIconDC.hasIcon(e))?ir.getListWithoutDuplicate(this.warningIconDC.getItemWarningIcon(e).alertGuides).forEach(function(e){return t.addPopup(e)}):console.error("요청한 itemTbpeId 에 해당하는 경고가 없습니다. : ".concat(e))}},{key:"closeAlertPopup",value:function(){this.pusher.closeAll()}}]),e}();Mr.PRINTOUT_INFO="printout_info",Mr.PRINTOUT_INFO_CONTENTS="contents",Mr.PRINTOUT_INFO_STATICS="statics",Mr.PRINTOUT_INFO_DYNAMICS="dynamics",Mr.PRINTOUT_LAYER="printout_layer";var Nr=function(){function e(){L()(this,e),this.guideVCMap=new Map,this.itemController=new pr,this.areaGuides=[],this.guidIconVisible=!je.a.isMobilePortrait()}var t,n,i,o;return w()(e,[{key:"setCallbackReference",value:function(e){this.callbackReference=e,this.itemController.setCallbackReference(e),hr.a.setListener(this)}},{key:"removeWarningAlertByItemId",value:function(e){this.callbackReference.removePrintoutGuideById(e)}},{key:"syncAlertList",value:function(){this.callbackReference.removeNotExistResultOfItem(),this.callbackReference.removeNotExistResultOfPage()}},{key:"setGuideInfo",value:(o=s()(a.a.mark(function e(t){var n=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.areaGuides=[],t.forEach(function(e){"AREA"===e.type?n.areaGuides.push(e):"IMAGE_DPI"===e.type?n.imageDpiGuide=e:"ITEM_SIZE"===e.type?n.itemSizeGuide=e:"FONT_SIZE"===e.type?n.fontSizeGuide=e:console.log("Unhandled guide",e)}),e.next=4,ir.initAreaShapeSvgElements(this.areaGuides);case 4:this.itemController.init(t);case 5:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"setGuideIconsVisible",value:function(e){this.guidIconVisible=e,this.guideVCMap.forEach(function(t){t.warningIconVC&&t.warningIconVC.setVisible(e)})}},{key:"render",value:(i=s()(a.a.mark(function e(t){var n,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(S.a.getPrintoutOption().checkRestriction){e.next=2;break}return e.abrupt("return");case 2:if(n=t.pageId,i=this.createGuideVC(n,t.pageIdx),o=this.callbackReference.getPageDOMPosition(),i.setSize(o.width,o.height),i.render(t.domRenderParam),t.pageWrapper&&!i.wrapper.parentElement&&i.appendElementTo(t.pageWrapper),!((s=Y.a.instance.activeItems).length>0)||t.pageItems.includes(s[0])||t.forceCheckPageItems||this.callbackReference.isPhotoCropMode()){e.next=12;break}return s[0]&&ie.a.addItemAlert(s[0].tbpeId,null),e.abrupt("return");case 12:return e.next=14,this.checkRestrictionOfItems({items:t.forceCheckPageItems?t.pageItems:s,pageWidth:t.pageSize.width,pageHeight:t.pageSize.height,pageId:n,pageIdx:t.pageIdx,pageItems:t.pageItems});case 14:this.setVisibleHighlight(i,s),this.setVisibleMobileAlert(s),this.updateRenderAfter(n);case 17:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"setVisibleMobileAlert",value:function(e){var t=this;X.a.instance.dispatch(new K.c(function(n,i,a){if(1===e.length){var o=e[0].tbpeId,s=t.inspectionResult.getItemWarningAlertOfItem(o),r=s&&s.containsAlert();a.itemGuideAlertMobile.showPrintoutAlertBtn(r,o)}else a.itemGuideAlertMobile.showPrintoutAlertBtn(!1)}))}},{key:"setVisibleHighlight",value:function(e,t){var n=this;if(this.guideVCMap.forEach(function(t){t!==e&&t.setVisibleHighlight(!1)}),0!==t.length){var i=[],a=t.some(function(e){var t=n.inspectionResult.getItemWarningAlertOfItem(e.tbpeId);return t&&t.alertGuides.forEach(function(e){"AREA"===e.guide.type&&i.push(e.guide)}),lr.containsAreaAlert(t)});e.setVisibleHighlight(a,i)}else e.setVisibleHighlight(!1)}},{key:"createGuideVC",value:function(e,t){if(this.guideVCMap.has(e))return this.guideVCMap.get(e);var n=this.callbackReference.getPageDOMPosition(),i=new Mr(t,n.width,n.height,this.areaGuides,this.imageDpiGuide,this.guidIconVisible);return this.guideVCMap.set(e,i),i}},{key:"closeAlertPopup",value:function(){this.guideVCMap.forEach(function(e){e.closeAlertPopup()})}},{key:"updateRenderAfter",value:function(e){this.updateLinkedDOMofItem(e),this.updateDOMGuideOnOffByPage(e),this.updateGuideVisible(),this.removeNotLinkedGuideDOM()}},{key:"updateLinkedDOMofItem",value:function(e){var t=this.callbackReference.getActiveItems();if(!t||0!==t.length){var n=this.itemController.getPageIdOfItem(t[0].tbpeId);if(n&&n.toLowerCase()!==e.toLowerCase()){var i=this.guideVCMap.get(n);if(i){var a=te.getItemIdList(t),o=!0,s=!1,r=void 0;try{for(var l,c=a[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;i.removeAlert(u),this.itemController.removePageIdOfItem(u)}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}}}}}},{key:"removeNotLinkedGuideDOM",value:function(){if(this.callbackReference.getPageCount()!==this.guideVCMap.size){var e=this.callbackReference.getAllPageIdList();this.guideVCMap.forEach(function(t,n,i){var a=!1,o=!0,s=!1,r=void 0;try{for(var l,c=e[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;if(n.toLowerCase()===u.toLowerCase()){a=!0;break}}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}a||i.delete(n)})}}},{key:"updateDOMGuideOnOffByPage",value:function(e){if(this.guideVCMap.has(e)){var t=this.guideVCMap.get(e),n=this.callbackReference.isShowPrintoutGuide(),i=t.wrapper.parentElement;i&&Ys.a.togglePageContentPrintAreaMode(i,n)}}},{key:"getGuideVC",value:function(){return this.guideVCMap.get(this.callbackReference.getRenderedPageId())}},{key:"updateDOM",value:function(e){if(S.a.getPrintoutOption().checkRestriction&&this.guideVCMap.has(e.pageId)){var t=this.guideVCMap.get(e.pageId),n=this.callbackReference.getPageDOMPosition();t.setSize(n.width,n.height),t.render(e.domRenderParam)}}},{key:"showAlertPopup",value:function(e,t){var n=this.guideVCMap.get(e);n&&n.showAlertPopup(t)}},{key:"updateGuideVisible",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(S.a.getPrintoutOption().checkRestriction){var e=this.getGuideVC();e&&(e.setVisibleIcons(!this.callbackReference.isPhotoCropMode()),this.showAllPageGuide())}}},{key:"removeGuideVCByPageId",value:function(e){if(S.a.getPrintoutOption().checkRestriction&&this.guideVCMap.has(e)){var t=this.guideVCMap.get(e);t.wrapper.parentElement&&t.wrapper.parentElement.removeChild(t.wrapper),ie.a.fetchAlerts(!0),this.guideVCMap.delete(e),this.inspectionResult.removeResultOfPageId(e)}}},{key:"removeAllGuideVC",value:function(){S.a.getPrintoutOption().checkRestriction&&(this.guideVCMap.forEach(function(e){e.clear(),e.wrapper.parentElement&&e.wrapper.parentElement.removeChild(e.wrapper)}),X.a.instance.dispatch(new K.c(function(){ie.a.clearAlerts()})),this.guideVCMap.clear())}},{key:"clearAllAlertGuide",value:function(){hr.a.clear(),this.removeAllGuideVC()}},{key:"showAllPageGuide",value:function(){this.guideVCMap.forEach(function(e){e.setVisible(!0)})}},{key:"hideAllPageGuide",value:function(){this.guideVCMap.forEach(function(e){e.setVisible(!1)})}},{key:"updateByItems",value:function(e){if(S.a.getPrintoutOption().checkRestriction){var t=e.pageId,n=t?this.guideVCMap.get(t):this.getGuideVC();n&&this.itemController.updateDOMbyItems(e,n)}}},{key:"removeItemById",value:function(e){if(S.a.getPrintoutOption().checkRestriction){var t=this.getGuideVC();t&&this.itemController.removeItemById(t,e)}}},{key:"checkRestrictionOfItems",value:(n=s()(a.a.mark(function e(t){var n,i,o,s=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(S.a.getPrintoutOption().checkRestriction&&!this.callbackReference.isPhotoCropMode()&&0!==t.items.length){e.next=2;break}return e.abrupt("return");case 2:return ir.pageWidth=t.pageWidth,ir.pageHeight=t.pageHeight,this.callbackReference.removeNotExistResultOfItem(),this.callbackReference.removeNotExistResultOfPage(),n=t.items,i=this.createGuideVC(t.pageId,t.pageIdx),e.next=10,qs.a.getImageOriginSizeFinderAddedItems(n);case 10:o=this.itemController.checkRestriction(t.pageId,n,t.pageWidth,t.pageHeight,i,t.pageIdx),n.forEach(function(e){var t=o.find(function(t){return t.itemTbpeId===e.tbpeId});t&&(i.updateAlert(t),s.itemController.updateAlertVisibleOfItems(i,n),(e.select||e.isOnlyOneItem())&&i.onChangeAlertLevel(e.tbpeId,t.getHighAlertLevel()))});case 12:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"checkRestrictionAllPage",value:(t=s()(a.a.mark(function e(t){var n,i,o,s,r,l,c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.inspectionResult.getAllAlerts().length>0&&this.clearAllAlertGuide(),n=!0,i=!1,o=void 0,e.prev=4,s=t[Symbol.iterator]();case 6:if(n=(r=s.next()).done){e.next=15;break}return l=r.value,c=l.getAllSingleItems(),u=l.sheetSize,e.next=12,this.checkRestrictionOfItems({items:c.slice(),pageWidth:u.width,pageHeight:u.height,pageId:l.pageId,pageIdx:l.pageIdx,pageItems:c});case 12:n=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),i=!0,o=e.t0;case 21:e.prev=21,e.prev=22,n||null==s.return||s.return();case 24:if(e.prev=24,!i){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(21);case 29:case"end":return e.stop()}},e,this,[[4,17,21,29],[22,,24,28]])})),function(e){return t.apply(this,arguments)})},{key:"inspectionResult",get:function(){return hr.a}}]),e}(),xr=n(381),Br=function(){function e(){L()(this,e)}return w()(e,null,[{key:"getPaginManager",value:function(e,t){return new Vr(t)}}]),e}(),Vr=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).type=xr.c.SCROLL,n.updateRenderPageIdx=function(e){Y.a.isCropMode()||X.a.instance.dispatch(new K.c(function(t){for(var n=0,i=t.pages.length;n<i;n++){var a=Y.a.instance.pageController.getPageRenderer(t.pages[n]).contents.getBoundingClientRect();if(a.left<=e.x&&a.right>=e.x&&a.top<=e.y&&a.bottom>=e.y){Y.a.instance.renderPageIdx=n;break}}}))},n.isCleanRegacyPageElement=function(){return!1},n.isRenderPageAll=function(){return!0},n.isChangePageByScroll=function(){return!0},n.isChangePageElementOffsetY=function(){return!0},n.whiteSpaceElementDisplay=function(){return"block"},n.isPageOffsetY=function(){return!0},n.getMouseOffsetY=function(){return Y.a.instance.getPageScrollOffset()},n}return z()(t,e),t}(function(){function e(t){var n=this;L()(this,e),this.isValidCachedCanvasSize=!1,this.getSelectAreaOffset=function(){var e=n.getCanvasBoundingRect();return new ns.a(e.left,e.top)},this.getHandlerOffset=function(){return{x:Y.a.instance.handlerOffsetX,y:Y.a.instance.handlerOffsetY+n.getMouseOffsetY()}},this.canvas=t.canvas}return w()(e,[{key:"refreshCache",value:function(){this.isValidCachedCanvasSize=!1}},{key:"getCanvasBoundingRect",value:function(){return this.isValidCachedCanvasSize?this.canvasSizeCache:(this.canvasSizeCache=this.canvas.getBoundingClientRect(),this.isValidCachedCanvasSize=!0,this.canvasSizeCache)}}]),e}()),Ur=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;L()(this,e),this.designDocWidth=t,this.designDocHeight=n,this.pageAbsoluteLeft=i,this.pageAbsoluteTop=a,this.pageWidth=o,this.pageHeight=s},Fr=function(){function e(){L()(this,e)}return w()(e,null,[{key:"getRenderedPages",value:function(t,n,i){var a=[],o=!0,s=!1,r=void 0;try{for(var l,c=t.pages[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value,d=n.pageController.getPageRenderer(u);e.isScrolledIntoView(d.element)&&a.push(u)}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}return a}},{key:"getPageHeight",value:function(e,t){return e.sheetSize.height*t.pageEditScale*t.zoomScale}},{key:"isScrolledIntoView",value:function(e){var t=e.getBoundingClientRect(),n=t.top,i=t.bottom;return n<window.innerHeight&&i>=0}},{key:"calcEditScale",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.MAX_PAGE_RENDER_SIZE_DEFAULT,i=Math.max(t.sheetSize.width,t.sheetSize.height);return n/Math.max(n,i)}}]),e}();Fr.MAX_PAGE_RENDER_SIZE_DEFAULT=800;var Gr=function(){function e(){L()(this,e),this.isOkayToCloseBrowser=!0}return w()(e,null,[{key:"setIsOkayToCloseBrowser",value:function(){e.instance.isOkayToCloseBrowser=!1}},{key:"canICloseThisWindow",value:function(){var t=e.instance.isOkayToCloseBrowser;return e.instance.isOkayToCloseBrowser=!0,t}}]),e}();Gr.instance=new Gr;var Hr=function e(t){L()(this,e),this.parent=t},Wr=function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;L()(this,e),this.visible=t,this.direction=n,this.pivotPoint=i,this.guidelinePoint=a},zr=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).hoverGuideline=ra.a.createRef(),n.guidelineTooltip=ra.a.createRef(),n.guidelineTooltipText=ra.a.createRef(),n.pageAreaSize=new Ur,n.sizeUnitText=De.a.PX.toLowerCase(),Bs.a.setHoverGuidelineVC(H()(n)),n.state=new Wr,n.onMouseDownGuideline=n.onMouseDownGuideline.bind(H()(n)),n.onMouseMoveGuideline=n.onMouseMoveGuideline.bind(H()(n)),n.onMouseMoveForCheckingToLeaveGuideline=n.onMouseMoveForCheckingToLeaveGuideline.bind(H()(n)),n.onMouseUpGuideline=n.onMouseUpGuideline.bind(H()(n)),n.onMouseLeaveGuideline=n.onMouseLeaveGuideline.bind(H()(n)),n.onTouchMoveGuideline=n.onTouchMoveGuideline.bind(H()(n)),n.onTouchEndGuideline=n.onTouchEndGuideline.bind(H()(n)),n}return z()(t,e),w()(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMouseDownGuideline)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMouseDownGuideline)}},{key:"componentDidUpdate",value:function(e,t,n){this.state.visible&&(this.hoverGuideline.current.addEventListener("mouseleave",this.onMouseLeaveGuideline),this.isHandlingFromRulerOrTouch&&(this.handlingGuideline=this.hoverGuideline.current,this.isClickedGuideline=!0,document.addEventListener("touchmove",this.onTouchMoveGuideline),document.addEventListener("touchend",this.onTouchEndGuideline)))}},{key:"onCreateGuideline",value:function(e,t){this.show(e,!0,t)}},{key:"onSelectGuideline",value:function(e,t){this.show(e,t)}},{key:"clearGuideline",value:function(){this.handlingGuideline=null,this.hide()}},{key:"onMouseDownGuideline",value:function(e){this.hoverGuideline.current&&(this.handlingGuideline=this.hoverGuideline.current,this.isClickedGuideline=!0,this.mouseDownedGuidelinePoint=new ns.a(e.clientX,e.clientY),Bs.a.onChangeGuidelineVisible(this.handlingCanvasGuideline,!1),document.addEventListener("mousemove",this.onMouseMoveGuideline),document.addEventListener("mouseup",this.onMouseUpGuideline))}},{key:"onMouseMoveGuideline",value:function(e){this.moveGuideline(e.clientX,e.clientY)}},{key:"onTouchMoveGuideline",value:function(e){this.moveGuideline(e.touches[0].clientX,e.touches[0].clientY)}},{key:"onMouseUpGuideline",value:function(e){this.stopGuideline(e.clientX,e.clientY),document.removeEventListener("mousemove",this.onMouseMoveGuideline),document.removeEventListener("mouseup",this.onMouseUpGuideline)}},{key:"onTouchEndGuideline",value:function(e){this.stopGuideline(e.changedTouches[0].clientX,e.changedTouches[0].clientY),this.onMouseLeaveGuideline(),document.removeEventListener("touchmove",this.onTouchMoveGuideline),document.removeEventListener("touchend",this.onTouchEndGuideline)}},{key:"onMouseLeaveGuideline",value:function(){this.isClickedGuideline||(this.handlingGuideline=null,Bs.a.onChangeGuidelineVisible(this.handlingCanvasGuideline,!0),this.handlingCanvasGuideline=null,this.hide(),document.removeEventListener("mousemove",this.onMouseMoveGuideline),document.removeEventListener("mousemove",this.onMouseMoveForCheckingToLeaveGuideline),document.removeEventListener("mouseup",this.onMouseUpGuideline))}},{key:"onMouseMoveForCheckingToLeaveGuideline",value:function(e){if(this.state.visible){if("none"===this.guidelineTooltip.current.style.display){var t=new ns.a(this.state.direction===R.d.HORIZONTAL?e.clientX:this.shownGuidelinePoint.x,this.state.direction===R.d.HORIZONTAL?this.shownGuidelinePoint.y:e.clientY);this.updateTooltipPosition(t)}var n=this.hoverGuideline.current.getBoundingClientRect();(e.clientX<n.left-1||e.clientX>n.right+1||e.clientY<n.top-1||e.clientY>n.bottom+1)&&(document.removeEventListener("mousemove",this.onMouseMoveForCheckingToLeaveGuideline),this.onMouseLeaveGuideline())}}},{key:"moveGuideline",value:function(e,n){if(this.handlingGuideline&&this.isClickedGuideline){this.updateTooltipPosition(new ns.a(e,n)),document.getElementById("canvas").style.cursor=this.state.direction===R.d.HORIZONTAL?"row-resize":"col-resize";var i=t.convertPointWithDirection(this.state.direction,e,n);this.handlingGuideline.style.transform="translate(".concat(i.x,"px, ").concat(i.y,"px)")}}},{key:"stopGuideline",value:function(e,t){if(this.isClickedGuideline=!1,this.handlingGuideline){var n=new ns.a(e,t);if(Bs.a.onChangeCanvasAreaGuidelinePosition(this.handlingCanvasGuideline,n),Bs.a.existGuideline(this.handlingCanvasGuideline)){this.mouseDownedGuidelinePoint&&n.equalsTo(this.mouseDownedGuidelinePoint)&&Bs.a.onChangeCanvasAreaGuidelinePosition(this.handlingCanvasGuideline,this.shownGuidelinePoint);var i=this.hoverGuideline.current.getBoundingClientRect();cs.a.isPtInLtrbCoordinate(new ns.a(n.x,n.y),new li.a(i.left,i.top,i.right,i.bottom))||this.onMouseLeaveGuideline()}else this.onMouseLeaveGuideline()}}},{key:"updateTooltipPosition",value:function(e){if(this.guidelineTooltip&&this.guidelineTooltip.current&&this.guidelineTooltipText.current){var t=Y.a.instance.option.pageSize,n=t.unit,i=t.dpi,a=De.a.changeUnit(e.x-this.pageAreaSize.pageAbsoluteLeft,De.a.PX,n,i)*this.coordinateScaleX,o=De.a.changeUnit(e.y-this.pageAreaSize.pageAbsoluteTop,De.a.PX,n,i)*this.coordinateScaleY,s=0===Number(a.toFixed(1))?"0":a.toFixed(1),r=0===Number(o.toFixed(1))?"0":o.toFixed(1);this.guidelineTooltipText.current.innerText="".concat(this.state.direction===R.d.HORIZONTAL?r:s," ").concat(this.sizeUnitText),this.guidelineTooltip.current.style.display=""}}},{key:"show",value:function(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;this.handlingCanvasGuideline=e,this.updateDesignSize(Bs.a.getPageAreaSize()),this.isHandlingFromRulerOrTouch=i;var o=this.props.parent.getBoundingClientRect(),s=t.convertPointWithDirection(e.direction,-o.left,-o.top),r=t.convertPointWithDirection(e.direction,e.getViewPoint().x,e.getViewPoint().y);e.direction===R.d.HORIZONTAL?r.y+=4:r.x+=4,this.shownGuidelinePoint=new ns.a(r.x,r.y),this.setState({visible:!0,direction:e.direction,pivotPoint:s,guidelinePoint:r}),document.addEventListener("mousemove",this.onMouseMoveForCheckingToLeaveGuideline),setTimeout(function(){return n.updateTooltipPosition(a||r)},0)}},{key:"hide",value:function(){this.setState(new Wr)}},{key:"isHandlingGuideline",value:function(){return Boolean(this.handlingCanvasGuideline)}},{key:"updateDesignSize",value:function(e){this.pageAreaSize=e;var t=Y.a.instance.option.pageSize,n=t.unit,i=t.dpi;this.sizeUnitText=n.toLowerCase(),this.coordinateScaleX=this.pageAreaSize.designDocWidth/De.a.changeUnit(this.pageAreaSize.pageWidth,De.a.PX,n,i),this.coordinateScaleY=this.pageAreaSize.designDocHeight/De.a.changeUnit(this.pageAreaSize.pageHeight,De.a.PX,n,i)}},{key:"render",value:function(){return ra.a.createElement(ra.a.Fragment,null,this.state.visible&&ra.a.createElement(ra.a.Fragment,null,ra.a.createElement("div",{className:"hover_guideline_area ".concat(this.state.direction.toLowerCase()),style:{left:"".concat(this.state.pivotPoint.x,"px"),top:"".concat(this.state.pivotPoint.y,"px")}},ra.a.createElement("div",{ref:this.hoverGuideline,className:"hover_guideline",style:{transform:"translate(".concat(this.state.guidelinePoint.x,"px, ").concat(this.state.guidelinePoint.y,"px)")}},ra.a.createElement("div",{className:"line"}),ra.a.createElement("div",{ref:this.guidelineTooltip,className:"hover_guideline_tooltip",style:{display:"none"}},ra.a.createElement("div",{ref:this.guidelineTooltipText,className:"hover_guideline_tooltip_text"}))))))}}],[{key:"convertPointWithDirection",value:function(e,t,n){return e===R.d.HORIZONTAL?new ns.a(0,n):new ns.a(t,0)}}]),t}(sa.Component),Kr=n(35),Yr=n.n(Kr),Xr=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).ruler=ra.a.createRef(),n.onMouseDown=n.onMouseDown.bind(H()(n)),n.onTouchStart=n.onTouchStart.bind(H()(n)),n}return z()(t,e),w()(t,[{key:"componentDidMount",value:function(){this.ruler.current.addEventListener("touchstart",this.onTouchStart)}},{key:"getAbsoluteLeft",value:function(){return this.ruler.current.getBoundingClientRect().left}},{key:"getAbsoluteTop",value:function(){return this.ruler.current.getBoundingClientRect().top}},{key:"onMouseDown",value:function(e){this.props.onMouseDown&&this.props.onMouseDown(this.props.direction,new ns.a(e.clientX,e.clientY))}},{key:"onTouchStart",value:function(e){e.preventDefault(),this.props.onMouseDown&&this.props.onMouseDown(this.props.direction,new ns.a(e.touches[0].clientX,e.touches[0].clientY))}},{key:"render",value:function(){return ra.a.createElement("div",{ref:this.ruler,className:this.props.direction===R.d.HORIZONTAL?"ruler_horizontal":"ruler_vertical",onMouseDown:this.onMouseDown},ra.a.createElement("div",{className:"ruler_line_container"},ra.a.createElement("div",{className:"ruler_line_box",style:{width:this.props.lineBlockWidth&&"".concat(this.props.lineBlockCount*this.props.lineBlockWidth,"px"),height:this.props.lineBlockHeight&&"".concat(this.props.lineBlockCount*this.props.lineBlockHeight,"px"),transform:"translate(".concat(this.props.lineLeft?this.props.lineLeft:0,"px, ").concat(this.props.lineTop?this.props.lineTop:0,"px)")}},ra.a.createElement(jr,{blockCount:this.props.lineBlockCount,width:this.props.lineBlockWidth,height:this.props.lineBlockHeight,gap:this.props.lineBlockGap,lineCount:this.props.lineCount}))))}}]),t}(sa.Component),jr=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"render",value:function(){var e=this;return ra.a.createElement(ra.a.Fragment,null,Array.from({length:this.props.blockCount}).map(function(t,n){var i=n===e.props.blockCount-1;return ra.a.createElement("div",{key:n,className:"ruler_line_block",style:{width:e.props.width&&"".concat(e.props.width,"px"),height:e.props.height&&"".concat(e.props.height,"px")}},ra.a.createElement("div",{className:"ruler_line_gap_number"},e.props.gap*n),ra.a.createElement("div",{className:"ruler_lines"},Array.from({length:e.props.lineCount}).map(function(t,n){var a=(e.props.lineCount+1)/2===n+1;return ra.a.createElement("div",{key:n,className:Yr()("ruler_line",{small:!a,large:a}),style:{display:i&&"none"}})})))}))}}]),t}(sa.Component),Zr=Xr,qr=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ur,n=arguments.length>1?arguments[1]:void 0;L()(this,e),this.pageAreaSize=t,this.onMouseDown=n},$r=function e(t){L()(this,e),this.pageAreaSize=t},Qr=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).horizontalRuler=ra.a.createRef(),n.verticalRuler=ra.a.createRef(),n.state=new $r(e.pageAreaSize||new Ur),n.onMouseDown=n.onMouseDown.bind(H()(n)),n}return z()(t,e),w()(t,[{key:"updateDesignSize",value:function(e){this.setState({pageAreaSize:e})}},{key:"calculateLineLeft",value:function(e){if(e&&e.current)return this.state.pageAreaSize.pageAbsoluteLeft-e.current.getAbsoluteLeft()}},{key:"calculateLineTop",value:function(e){if(e&&e.current)return this.state.pageAreaSize.pageAbsoluteTop-e.current.getAbsoluteTop()}},{key:"calculateLineBlockGap",value:function(e,t){if(0===e||0===t)return 0;return this.calculateGap([1,2,5],e,t)}},{key:"calculateGap",value:function(e,n,i){var a=e.slice().find(function(e){return t.calculateLineBlockLength(e,n,i)>=34});return a||this.calculateGap(e.map(function(e){return 10*e}),n,i)}},{key:"onMouseDown",value:function(e,t){this.props.onMouseDown&&this.props.onMouseDown(e,t)}},{key:"render",value:function(){var e=this.calculateLineBlockGap(this.state.pageAreaSize.designDocWidth,this.state.pageAreaSize.pageWidth),n=t.calculateLineBlockLength(e,this.state.pageAreaSize.designDocWidth,this.state.pageAreaSize.pageWidth),i=this.calculateLineBlockGap(this.state.pageAreaSize.designDocHeight,this.state.pageAreaSize.pageHeight),a=t.calculateLineBlockLength(i,this.state.pageAreaSize.designDocHeight,this.state.pageAreaSize.pageHeight);return ra.a.createElement(ra.a.Fragment,null,ra.a.createElement("div",{className:"ruler_corner_block"}),ra.a.createElement(Zr,{ref:this.horizontalRuler,direction:R.d.HORIZONTAL,onMouseDown:this.onMouseDown,lineBlockGap:e,lineBlockCount:t.calculateLineBlockCount(n,this.state.pageAreaSize.pageWidth),lineCount:t.calculateLineCount(e,this.state.pageAreaSize.designDocWidth),lineBlockWidth:n,lineLeft:this.calculateLineLeft(this.horizontalRuler)}),ra.a.createElement(Zr,{ref:this.verticalRuler,direction:R.d.VERTICAL,onMouseDown:this.onMouseDown,lineBlockGap:i,lineBlockCount:t.calculateLineBlockCount(a,this.state.pageAreaSize.pageHeight),lineCount:t.calculateLineCount(i,this.state.pageAreaSize.designDocHeight),lineBlockHeight:a,lineTop:this.calculateLineTop(this.verticalRuler)}))}}],[{key:"calculateLineBlockLength",value:function(e,t,n){return 0===e||0===t||0===n?0:n/(t/e)}},{key:"calculateLineBlockCount",value:function(e,t){return Math.ceil(t/e)+1}},{key:"calculateLineCount",value:function(e,t){if(0===e||0===t)return 0;return e/t>.02?3:9}}]),t}(sa.Component),Jr=function(e){function t(e,n,i,a,o,s,r,l){var c;return L()(this,t),(c=V()(this,F()(t).call(this))).renderdPageIdxs=e,c.pageCount=n,c.canvasWidth=i,c.canvasHeight=a,c.pageOffsetX=o,c.pageOffsetY=s,c.sheetWidth=r,c.sheetHeight=l,c}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){var t=this;return e.renderdPageIdxs.length!==this.renderdPageIdxs.length||!e.renderdPageIdxs.every(function(e,n){return e===t.renderdPageIdxs[n]})||e.pageCount!==this.pageCount||e.sheetWidth!==this.sheetWidth||e.sheetHeight!==this.sheetHeight||e.pageOffsetX!==this.pageOffsetX||e.pageOffsetY!==this.pageOffsetY||e.canvasWidth!==this.canvasWidth||e.canvasHeight!==this.canvasHeight}}]),t}(He.b),el=function(e){function t(e,n,i,a,o,s,r,l,c){var u;return L()(this,t),(u=V()(this,F()(t).call(this))).pageCount=e,u.zoomScale=n,u.editScale=i,u.tx=a,u.ty=o,u.sheetWidth=s,u.sheetHeight=r,u.canvasWidth=l,u.canvasHeight=c,u}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return e.pageCount!==this.pageCount||e.sheetWidth!==this.sheetWidth||e.sheetHeight!==this.sheetHeight||e.tx!==this.tx||e.ty!==this.ty||e.editScale!==this.editScale||e.zoomScale!==this.zoomScale||e.canvasWidth!==this.canvasWidth||e.canvasHeight!==this.canvasHeight}}]),t}(He.c),tl=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,!0,"canvas"))).pageVCS=[],e.isPinchAction=!1,e.mouseDblClickManager=new Ss.a,e.doReRender=!0,e.scrollFitAfterRenderer=!0,e.zoomFitAfterRender=!0,e.childViewListeners=new Array,e.printout=new Nr,b.a.setListener(H()(e)),e.initResizeObserver(),Bs.a.setCanvasAreaVC(H()(e)),e}var n,i,o,r;return z()(t,e),w()(t,[{key:"getAllEditTextVCByFont",value:(r=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(this.pageVCS.map(function(e){return e.getEditTextItemVCs()})).then(function(e){return e.reduce(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return e.concat(n.filter(function(e){return e.hasFont(t)}))},[])}).catch(function(e){return[]}));case 1:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this);var e=document.createElement("div");e.id="selectArea",this.container.appendChild(e),this.canvasContainer=document.createElement("div"),this.canvasContainer.className="canvas_container",this.hoverGuidelineContainer=document.createElement("div"),this.hoverGuidelineContainer.className="hover_guideline_container"}},{key:"onStartView",value:function(){var e=this;he()(F()(t.prototype),"onStartView",this).call(this),this.container.className="old",this.pageAddButtonView=new Ks,this.selectArea=document.getElementById("selectArea");var n=this.container.parentNode,i=this.rulerContainer=document.createElement("div");i.className="ruler_container",this.rulerVC=La.render(ra.a.createElement(Qr,new qr(void 0,function(t,n){e.updateRulerSize(),X.a.instance.dispatch(new Ls.c(t,n))})),i),this.setRulerVisible(Ke.a.getUserSetting().isRulerVisible),this.canvasContainer.appendChild(i),this.canvasContainer.appendChild(this.container);var a=new Ce.a(!0,!0);a.element.id=t.PAGE_SCROLL_ELEMENT,a.element.classList.add("crop_disable_area");var o=a.render(this.canvasContainer);o.style.width="100%",o.style.height="100%",this.hoverGuidelineVC=La.render(ra.a.createElement(zr,new Hr(this.hoverGuidelineContainer)),this.hoverGuidelineContainer),a.element.appendChild(this.hoverGuidelineContainer),n.insertBefore(o,n.childNodes.item(0)),this.scrollElement=a,this.updateCanvasSize(),this.addEventListeners(),this.contents=document.createElement("div"),this.contents.className="render_contents",this.wrap=document.createElement("div"),this.wrap.className="render_wrap",this.wrap.appendChild(this.contents),this.contents.appendChild(this.pageAddButtonView.getContainer()),this.container.insertBefore(this.wrap,this.container.childNodes.item(0)),this.container.appendChild(this.selectArea),this.updatePagingManager(),this.resizeObserver.observe(this.container),this.resizeObserver.observe(this.wrap)}},{key:"initResizeObserver",value:function(){var e=this;this.resizeObserver=new Is.a(function(t){t.find(function(t){return[e.container,e.wrap].includes(t.target)})&&Bs.a.onChangeCanvasDOMSize()})}},{key:"updatePagingManager",value:function(){this.pagingManager&&Y.a.instance.pageMode===this.pagingManager.type||(Y.a.instance.renderPageIdx=0,this.pagingManager=Br.getPaginManager(Y.a.instance.pageMode,{canvas:this.container})),this.pagingManager.refreshCache(),Y.a.pageScrollOffset=0,this.doReRender=!0}},{key:"updateScrollCenterOfCurrentPage",value:function(){this.scrollFitAfterRenderer=!0}},{key:"updateZoomFitAfterRender",value:function(){this.zoomFitAfterRender=!0}},{key:"updateCanvasSize",value:function(){var e=document.getElementById("playground").getBoundingClientRect();Y.a.instance.size.canvasWidth=e.width,Y.a.instance.size.canvasHeight=e.height}},{key:"updateRulerSize",value:function(){var e=this,t=this.pageVCS[Y.a.instance.renderPageIdx];t&&t.contents&&window.setTimeout(function(){var t=e.container.getBoundingClientRect(),n=e.wrap.getBoundingClientRect();e.rulerContainer.style.width=t.width<=n.width?"".concat(n.width,"px"):"".concat(t.width,"px"),e.rulerContainer.style.height="".concat(t.height,"px");var i=e.getPageAreaSize();e.rulerVC.updateDesignSize(i),e.hoverGuidelineVC.updateDesignSize(i)},0)}},{key:"getPageAreaSize",value:function(){var e=this.pageVCS[Y.a.instance.renderPageIdx];if(!e||!e.contents)return new Ur;var t=e.contents.getBoundingClientRect(),n=Y.a.instance.option.pageSize;return new Ur(n.width,n.height,t.left,t.top,t.width,t.height)}},{key:"setEditModeContents",value:function(e){e?this.contents.classList.add("edit_mode"):this.contents.classList.remove("edit_mode")}},{key:"addEventListeners",value:function(){var e=this;this.container.addEventListener("mousedown",function(t){return e.onMouseDown(t)}),this.container.addEventListener("touchstart",function(t){return e.onMouseDown(t,!0)}),this.container.addEventListener("mouseup",function(t){Fn.a.isGlobalMode(Y.a.instance.mouseAction.mode)||e.onMouseUp(t)}),this.container.addEventListener("touchend",function(t){Fn.a.isGlobalMode(Y.a.instance.mouseAction.mode)||e.onMouseUp(t,!0)}),document.addEventListener("mouseup",function(t){Fn.a.isGlobalMode(Y.a.instance.mouseAction.mode)&&e.onMouseUp(t)}),document.addEventListener("touchend",function(t){Fn.a.isGlobalMode(Y.a.instance.mouseAction.mode)&&e.onMouseUp(t,!0)}),je.a.isMobileDevice()&&je.a.isIOS()&&document.addEventListener("touchend",function(n){if(n.changedTouches&&n.changedTouches[0]){var i=n.changedTouches[0],a=new il((new Date).getTime(),i.clientX,i.clientY);e.lastTouchEnd&&a.touchTime-e.lastTouchEnd.touchTime<t.DOUBLE_TAP_VALID_INTERVAL&&Math.abs(a.offsetX-e.lastTouchEnd.offsetX)<t.DOUBLE_TAP_VALID_RANGE&&Math.abs(a.offsetY-e.lastTouchEnd.offsetY)<t.DOUBLE_TAP_VALID_RANGE&&n.cancelable&&(n.preventDefault(),n.target instanceof HTMLElement&&n.target.click()),e.lastTouchEnd=a}},!1),this.container.addEventListener("click",function(t){X.a.instance.dispatch(new _s(Y.a.instance.renderPageIdx,e.container,t.clientX,t.clientY,t.detail))}),this.container.addEventListener("mousemove",function(t){Fn.a.isGlobalMode(Y.a.instance.mouseAction.mode)||e.onMouseMove(t)},!1),this.container.addEventListener("touchmove",function(t){Fn.a.isGlobalMode(Y.a.instance.mouseAction.mode)||e.onMouseMove(t,!0)},!1),document.addEventListener("touchstart",function(e){e.touches.length>=2&&e.preventDefault()},{passive:!1}),document.addEventListener("mousemove",function(t){Fn.a.isGlobalMode(Y.a.instance.mouseAction.mode)&&e.onMouseMove(t)},{passive:!1}),document.addEventListener("touchmove",function(t){Fn.a.isGlobalMode(Y.a.instance.mouseAction.mode)&&Y.a.instance.mouseAction.mode!==Fn.a.MODE_MULTI_SELECT&&e.onMouseMove(t,!0)},{passive:!1}),document.addEventListener("dragover",function(e){Y.a.isDefaultMode()&&function(e){var t=e.dataTransfer.items[0];if(t&&"file"===t.kind&&Ns(t.type)){var n=Y.a.instance.editorMainVC;n.leftBarVC.isActive()||n.leftBarVC.setActive(!0);var i=n.leftPanelMainVC,a=i.getActivePanel();a&&a.getLeftPanelType()===So.b.MY_IMAGE_LIB||i.activePanel(So.b.MY_IMAGE_LIB),i.getPanel(So.b.MY_IMAGE_LIB).showDragToUploadLayer(),e.stopPropagation(),e.preventDefault()}}(e)}),document.addEventListener("dragleave",function(e){Y.a.isDefaultMode()&&function(e){var t=e.dataTransfer.items[0];if(t&&"file"===t.kind&&Ns(t.type)&&!document.contains(e.relatedTarget)){var n=Y.a.instance.editorMainVC.leftPanelMainVC;n.getPanel(So.b.MY_IMAGE_LIB).removeDragToUploadLayer(),n.activePanel(So.b.MY_IMAGE_LIB),e.stopPropagation(),e.preventDefault()}}(e)}),document.addEventListener("drop",function(e){ci.a.dispatchUploadUserFile(e.dataTransfer.files)}),this.container.addEventListener("drop",function(t){if(!(t.dataTransfer.files.length>0)){t.stopPropagation();var n=Y.a.instance.editorMainVC.leftPanelMainVC.getPanel(So.b.MY_IMAGE_LIB);n&&n.removeDragToUploadLayer(),e.pagingManager.updateRenderPageIdx(new ns.a(t.clientX,t.clientY));var i=t.dataTransfer.getData("text"),a=document.getElementById(i);if(a){var o=a.getAttribute("data-resource-key");X.a.instance.dispatch(new ui(Y.a.instance.renderPageIdx,t.clientX,t.clientY,o,null,!0))}J.a.unselectAllItems()}}),je.a.isMobileDevice()||window.addEventListener("resize",function(){e.updateCanvasSize(),X.a.instance.dispatch(new ks)}),window.addEventListener("beforeunload",function(e){Gr.canICloseThisWindow()||(e.preventDefault(),e.returnValue="")}),this.scrollElement.onAfterScroll=function(n){X.a.instance.dispatch(new K.c(function(i,a,o){if(e.pagingManager.isChangePageByScroll()&&(e.pagingManager.refreshCache(),a.mouseAction.mode===Fn.a.MODE_NONE||a.mouseAction.mode===Fn.a.MODE_BACKGROUND_SELECT)){for(var s,r=n.target.scrollHeight-n.target.clientHeight,l=n.target.scrollTop/r,c=a.renderPageIdx,u=i.pages.length,d=0;d<u;d++){if(l<=(d+1)/u||d===u-1){i.pages[a.renderPageIdx].unsetAllSingleItemHover(),s=d;break}}c!==s&&(t.updateBackgroundLib(i,a,o),Bs.a.onChangeRenderedPageIdx()),o.canvasAreaVC.renderAuto(i,a),o.renderLayer(i,a)}}))},this.container.addEventListener("wheel",function(e){if(e.ctrlKey){e.preventDefault();var t=e.deltaY<0?Hn.b.IN:Hn.b.OUT;Hn.a.zoomInOutByExtend(t)}})}},{key:"onMouseDown",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.target.tagName.toUpperCase();if(t||"IMG"!==n&&"DIV"!==n||e.target.isContentEditable||e.preventDefault(),t||2!==e.button){Y.a.instance.mouseAction.mode===Fn.a.MODE_NAVIGATION&&e.preventDefault();var i=Y.a.instance.renderPageIdx,a=t?e.touches[0]:e;this.pagingManager.updateRenderPageIdx(new ns.a(a.clientX,a.clientY));var o=this.pageVCS[Y.a.instance.renderPageIdx],s=o.isInRange(a.clientX,a.clientY);if(o.page.borderLine=s,i!==Y.a.instance.renderPageIdx&&Bs.a.onChangeRenderedPageIdx(),t){var r=e.touches;if(r.length>=2)return e.preventDefault(),ps.startPinch(r[0],r[1]),void(this.isPinchAction=!0);this.isPinchAction=!1;var l=Cn(a.clientX,a.clientY),c=l.outputX,u=l.outputY,d=o.getInRangeItem(c,u),h=Kt.a.isItemSkinable(d,o.page.sheetSize);Y.a.isCropMode()?e.preventDefault():s&&d&&!h?d.select?d.isBrowserDefaultAction()||e.preventDefault():Y.a.instance.mouseAction.mode=Fn.a.MODE_MOBILE_DOWN:(Y.a.instance.mouseAction.mode=Fn.a.MODE_MOBILE_DOWN,h||this.mouseDblClickManager.clear())}X.a.instance.dispatch(new ls(Y.a.instance.renderPageIdx,this.container,this.selectArea,a,e.shiftKey,e.ctrlKey,t))}}},{key:"onMouseUp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?e.changedTouches[0]:e,i=this.pageVCS[Y.a.instance.renderPageIdx],a=i.isInRange(n.clientX,n.clientY),o=Cn(n.clientX,n.clientY),s=o.outputX,r=o.outputY,l=i.getInRangeItem(s,r);if(!(t&&a&&e.cancelable)||l&&l.isBrowserDefaultAction()||e.preventDefault(),this.isPinchAction)return e.preventDefault(),X.a.instance.dispatch(new K.c(function(e,t,n){n.renderItemTools(e,t)})),void(0===e.touches.length&&(this.isPinchAction=!1));X.a.instance.dispatch(new Ds(Y.a.instance.renderPageIdx,this.container,this.selectArea,n,e.shiftKey,e.ctrlKey)),this.mouseDblClickManager.isDoubleClick()&&(X.a.instance.dispatch(new ws(Y.a.instance.renderPageIdx,this.container,n.clientX,n.clientY)),this.mouseDblClickManager.clear())}},{key:"onMouseMove",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(n&&e.touches.length>0&&t.isApplePencilSensitiveMove(e.touches[0],Y.a.instance.mouseAction))){var i=this.pageVCS[Y.a.instance.renderPageIdx],a=Cn(e.clientX,e.clientY),o=a.outputX,s=a.outputY;try{var r=i.getInRangeItem(o,s);if(n&&e.touches.length>=2&&(!r||!r.isBrowserDefaultAction())){e.preventDefault();var l=e.touches,c=ps.getPinchScale(l[0],l[1]),u=Y.a.instance,d=u.zoomScale*c*u.pageEditScale,h=S.a.getPageZoomNavigatorOption().zoomLimit?Hn.a.getFitScale():Hn.a.getLowestScale(),p=h*u.pageEditScale,m=Hn.a.getHighestScale()*u.pageEditScale;d<p?d=p:d>m&&(d=m);var f=ps.getCenterPosition(e.touches[0],e.touches[1]),v=!0,g=!1,E=void 0;try{for(var y,T=u.activeItems[Symbol.iterator]();!(v=(y=T.next()).done);v=!0){var I=y.value;if(I instanceof q.a&&I.isEditMode){f.x-=I.editModeParam.moveX*u.pageEditScale,f.y-=I.editModeParam.moveY*u.pageEditScale;break}}}catch(e){g=!0,E=e}finally{try{v||null==T.return||T.return()}finally{if(g)throw E}}return void X.a.instance.dispatch(new Ms.a(d,!0,f))}var C=n?e.touches[0]:e;X.a.instance.dispatch(new Os(Y.a.instance.renderPageIdx,this.container,this.selectArea,C,e.shiftKey))}catch(e){console.error(e),console.log("renderPageIdx=[ ".concat(Y.a.instance.renderPageIdx," ]"),i)}}}},{key:"renderPage",value:(o=s()(a.a.mark(function e(n,i){var o,s,r,l,c,u,d,h=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=!(h.length>2&&void 0!==h[2])||h[2],s=!(h.length>3&&void 0!==h[3])||h[3],h.length>4&&void 0!==h[4]?h[4]:[],r=h.length>5&&void 0!==h[5]&&h[5],l=this.pageVCS[n.pageIdx],s&&(i.zoomScale<1?this.contents.setAttribute(t.DATA_ZOOM_OUT,""+i.zoomScale):this.contents.removeAttribute(t.DATA_ZOOM_OUT)),n.editScale=Fr.calcEditScale(n),i.pageEditScale=n.editScale,c=i.activeItems[0]&&n.items.includes(i.activeItems[0]),!r||c){e.next=15;break}return l.removeLayers(),l.hideHeader(),e.abrupt("return",this);case 15:o&&((u=i.size).pageDeltaOffsetX=0,u.pageWidth=Math.floor(n.sheetSize.width*n.editScale),u.pageHeight=Math.floor(n.sheetSize.height*n.editScale),u.pageOffsetX=Math.floor((u.canvasWidth-u.pageWidth)/2),u.pageOffsetY=Math.floor(u.pageDeltaOffsetY+(u.canvasHeight-u.pageHeight)/2));case 16:return d=(new Date).getTime(),e.next=19,l.render(n.editScale,d);case 19:return l.showHeader(),e.abrupt("return",this);case 21:case"end":return e.stop()}},e,this)})),function(e,t){return o.apply(this,arguments)})},{key:"renderItemGuide",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=e.pages[0].sheetSize,i=t.zoomScale*t.pageEditScale,a=n.width*i,o=n.height*i,s=Y.a.instance.pageEditScale*Y.a.instance.zoomScale;this.pageVCS.forEach(function(e){e.itemGuideRenderer.render(e.page.getAllSingleItems(),a,o,s)})}},{key:"renderPrintout",value:(i=s()(a.a.mark(function e(t){var n=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n.length>1&&void 0!==n[1]?n[1]:[]).length>0)&&S.a.getPrintoutOption().checkRestriction){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.printout.render({pageWrapper:Y.a.instance.pageController.getPageRenderer(t).element,pageId:t.pageId,pageIdx:t.pageIdx,pageSize:t.sheetSize.clone(),pageItems:t.getAllSingleItems(),domRenderParam:{editScale:t.editScale,printAreaBgColor:t.background.color}});case 5:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"syncPageRenderers",value:function(e){var t=this,n=this.pageVCS.slice();this.pageVCS=[];var i=!0,a=!1,o=void 0;try{for(var s,r=n[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value;e.indexOf(l.page)>=0?this.pageVCS[l.page.pageIdx]=l:l.removeElement()}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}for(var c=0;c<e.length;c++){this.pageVCS[c]||(this.pageVCS[c]=new zs(e[c]))}this.childViewListeners=[this.pageAddButtonView],this.pageVCS.forEach(function(e){return t.childViewListeners.push(e.getListener())});var u=xs.a.canChangePageOrder(),d=xs.a.canAddPage(),h=xs.a.canRemovePage();this.childViewListeners.forEach(function(e){return e?e.onChangeViewState(u,d,h):null})}},{key:"renderSinglePage",value:function(e,n){var i=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return new Promise(function(){var c=s()(a.a.mark(function s(c,u){var d,h,p,m,f,v,g,E,y,T,I,C,k;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,d=null,h=!1,1===Qe.b.getGroupItemsAddedArray(n.activeItems).length&&n.activeItems[0].isRequireLiveEdit()?i.liveEditItem===n.activeItems[0]?i.liveEditItem.setReadyLiveEdit(!0):(d=i.liveEditItem,i.liveEditItem=n.activeItems[0],h=!0):i.liveEditItem&&(d=i.liveEditItem,i.liveEditItem=null),d&&(d.setReadyLiveEdit(!1),1,(p=n.pageController.getItemRenderer(d))&&p.renderLiveEdit(1,!1,!0).catch(function(e){return console.log(e)})),m=n.size,f=o||r,v=i.pageVCS[e.pageIdx],f||!(l.length>0||l.length>0&&i.liveEditItem&&i.liveEditItem.isReadyLiveEdit())){a.next=15;break}return v.syncItemRenderers(),g=i.pageVCS[e.pageIdx],E=1===l.length&&i.liveEditItem&&l[0].tbpeId===i.liveEditItem.tbpeId,g.renderItems(l,e.lastRenderEditScale,E,h).catch(function(e){return console.error(e)}),v.pageDOM.makeItemTree(v.itemViews,1),c(),a.abrupt("return");case 15:if(o&&(e.editScale=Fr.calcEditScale(e),n.pageEditScale=e.editScale,m.pageDeltaOffsetX=0,m.pageWidth=Math.floor(e.sheetSize.width*e.editScale),m.pageHeight=Math.floor(e.sheetSize.height*e.editScale),m.pageOffsetX=Math.floor((m.canvasWidth-m.pageWidth)/2),m.pageOffsetY=Math.floor(m.pageDeltaOffsetY+(m.canvasHeight-m.pageHeight)/2),i.pagingManager.isCleanRegacyPageElement()&&i.contentsStates))for(y=i.container.getElementsByClassName(Cs.a.PAGE_CLASS),T=y.length-1;T>=0;T--)(I=y.item(T)).parentElement&&I.parentElement.removeChild(I);return C=(new Date).getTime(),a.next=19,v.render(e.editScale,C);case 19:k=a.sent,r&&(n.zoomScale<1?i.contents.setAttribute(t.DATA_ZOOM_OUT,""+n.zoomScale):i.contents.removeAttribute(t.DATA_ZOOM_OUT)),k.parentElement!==i.contents&&i.contents.insertBefore(k,i.contents.childNodes.item(e.pageIdx)),c(),a.next=28;break;case 25:a.prev=25,a.t0=a.catch(0),u(a.t0);case 28:case"end":return a.stop()}},s,null,[[0,25]])}));return function(e,t){return c.apply(this,arguments)}}())}},{key:"renderAuto",value:(n=s()(a.a.mark(function e(n,i){var o,s,r,l,c,u,d,h,p,m,f,v,g,E,y,T,I,C,k,L,_,w,S,b,R,A,O,P,D,M,N,x,B,V,U,F,G=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=G.length>2&&void 0!==G[2]?G[2]:[],this.zoomFitAfterRender&&(Y.a.instance.pageEditScale=Fr.calcEditScale(n.pages[0]),Hn.a.initValues(n.pages[0].sheetSize,this.container.parentElement),Y.a.instance.zoomScale=Hn.a.getFitScale(),this.zoomFitAfterRender=!1),s=!1,this.pageVCS.length!==n.pages.length&&(this.syncPageRenderers(n.pages),s=!0),r=0;case 5:if(!(r<n.pages.length)){e.next=15;break}if(l=n.pages[r],c=this.pageVCS[r],l===c.page){e.next=12;break}return this.syncPageRenderers(n.pages),s=!0,e.abrupt("break",15);case 12:r++,e.next=5;break;case 15:for(u=this.scrollElement.contents.scrollTop,d=!0,h=!1,p=void 0,e.prev=19,m=this.pageVCS[Symbol.iterator]();!(d=(f=m.next()).done);d=!0)v=f.value,g=v.page,E=v.renderElement(g.editScale||Fr.calcEditScale(g)),(s||E.parentElement!==this.contents)&&this.contents.insertBefore(E,this.contents.childNodes.item(g.pageIdx));e.next=27;break;case 23:e.prev=23,e.t0=e.catch(19),h=!0,p=e.t0;case 27:e.prev=27,e.prev=28,d||null==m.return||m.return();case 30:if(e.prev=30,!h){e.next=33;break}throw p;case 33:return e.finish(30);case 34:return e.finish(27);case 35:if(this.scrollElement.contents.scrollTop=u,this.checkUpStatesChange(this.getRenderStates(n)),y=this.contentsStatesChanged||this.doReRender,T=this.positionStatesChanged||this.doReRender,!(o.length>0)&&this.pagingManager.isRenderPageAll()){e.next=47;break}return I=n.pages[i.renderPageIdx],e.next=43,this.renderSinglePage(I,i,y,T,o);case 43:return e.next=45,this.renderPrintout(I,i.activeItems);case 45:e.next=81;break;case 47:C=Fr.getRenderedPages(n,i,this.scrollElement),k=!0,L=!1,_=void 0,e.prev=51,w=n.pages[Symbol.iterator]();case 53:if(k=(S=w.next()).done){e.next=67;break}if(b=S.value,!(C.indexOf(b)>=0)){e.next=62;break}return e.next=58,this.renderPage(b,i,y,T);case 58:return e.next=60,this.renderPrintout(b);case 60:e.next=64;break;case 62:return e.next=64,this.renderPage(b,i,y,T,[],!0);case 64:k=!0,e.next=53;break;case 67:e.next=73;break;case 69:e.prev=69,e.t1=e.catch(51),L=!0,_=e.t1;case 73:e.prev=73,e.prev=74,k||null==w.return||w.return();case 76:if(e.prev=76,!L){e.next=79;break}throw _;case 79:return e.finish(76);case 80:return e.finish(73);case 81:if(this.renderItemGuide(n,i,i.activeItems),this.scrollFitAfterRenderer&&(this.scrollElement.moveScrollCenterX(),this.scrollToPage(i.renderPageIdx),this.scrollFitAfterRenderer=!1),!y){e.next=104;break}for(R=Fr.getRenderedPages(n,i,this.scrollElement),A=!0,O=!1,P=void 0,e.prev=88,D=R[Symbol.iterator]();!(A=(M=D.next()).done);A=!0)N=M.value,i.pageController.getPageRenderer(N).setPosition(),this.printout.updateDOM({pageId:N.pageId,domRenderParam:{editScale:N.editScale,printAreaBgColor:N.background.color}});e.next=96;break;case 92:e.prev=92,e.t2=e.catch(88),O=!0,P=e.t2;case 96:e.prev=96,e.prev=97,A||null==D.return||D.return();case 99:if(e.prev=99,!O){e.next=102;break}throw P;case 102:return e.finish(99);case 103:return e.finish(96);case 104:for(this.doReRender=!1,x=!0,B=!1,V=void 0,e.prev=108,U=this.pageVCS[Symbol.iterator]();!(x=(F=U.next()).done);x=!0)F.value.pageSettingVC.updateSizeBreakPoints();e.next=116;break;case 112:e.prev=112,e.t3=e.catch(108),B=!0,V=e.t3;case 116:e.prev=116,e.prev=117,x||null==U.return||U.return();case 119:if(e.prev=119,!B){e.next=122;break}throw V;case 122:return e.finish(119);case 123:return e.finish(116);case 124:return Y.a.isCropMode()||X.a.instance.dispatch(new K.c(function(e,n,i){t.updateBackgroundLib(e,n,i)})),this.renderMasking(),e.abrupt("return",this);case 127:case"end":return e.stop()}},e,this,[[19,23,27,35],[28,,30,34],[51,69,73,81],[74,,76,80],[88,92,96,104],[97,,99,103],[108,112,116,124],[117,,119,123]])})),function(e,t){return n.apply(this,arguments)})},{key:"scrollToPage",value:function(e){Y.a.instance.renderPageIdx=e;var t=Y.a.instance.getPageScrollOffset();this.scrollElement.setScrollY(t,200)}},{key:"getRenderStates",value:function(e){var t=e,n=t.pages[0].sheetSize,i=Y.a.instance,a=Fr.getRenderedPages(t,i,this.scrollElement),o=[],s=!0,r=!1,l=void 0;try{for(var c,u=a[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var d=c.value;o.push(d.pageIdx)}}catch(e){r=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(r)throw l}}return{contents:new Jr(o,t.pages.length,i.size.canvasWidth,i.size.canvasHeight,i.size.pageOffsetX,i.size.pageOffsetY,n.width,n.height),position:new el(t.pages.length,i.zoomScale,i.pageEditScale,i.size.pageDeltaOffsetX,i.size.pageDeltaOffsetY,n.width,n.height,i.size.canvasWidth,i.size.canvasHeight)}}},{key:"enableScrollMode",value:function(){document.getElementById(t.PAGE_SCROLL_ELEMENT).classList.add(t.MODE_CANVAS_SCROLL),Y.a.instance.editorMainVC.itemHandleVC.disableElementEvent()}},{key:"disableScrollMode",value:function(){document.getElementById(t.PAGE_SCROLL_ELEMENT).classList.remove(t.MODE_CANVAS_SCROLL),Y.a.instance.editorMainVC.itemHandleVC.enableElementEvent()}},{key:"toggleBtnShowVisibility",value:function(e){he()(F()(t.prototype),"enableStyle",this).call(this,e,this.container,"page_header_btn_show")}},{key:"updateRenderPage",value:function(e){it.a.isEmpty(this.pageVCS)||this.pageVCS.forEach(function(t){t.updateRenderPage(e)})}},{key:"renderMasking",value:function(){this.pageVCS.some(function(e){return!e.hasMask()})&&b.a.hasMasks()&&b.a.requestMasksInitialize()}},{key:"initializeMasks",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,a=this.pageVCS[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;o.contents.classList.add("mask");var s=b.a.getCopiedMaskFromPageIndex(o.page.pageIdx);s&&o.addMask(s)}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"getCanvasAreaScrollElement",value:function(){return this.scrollElement.contents}},{key:"setRulerVisible",value:function(e){this.rulerContainer&&(this.rulerContainer.style.display=e?"":"none",e&&this.updateRulerSize())}},{key:"getRenderedPage",value:function(){return this.pageVCS.find(function(e){return e.page.pageIdx===Y.a.instance.renderPageIdx})}}],[{key:"isApplePencilSensitiveMove",value:function(e,t){return e&&t&&"stylus"===e.touchType&&t.mode===Fn.a.MODE_MOBILE_DOWN&&Math.abs(t.offsetX-e.clientX)<this.APPLE_PENCIL_MOVE_SENSITIVE&&Math.abs(t.offsetY-e.clientY)<this.APPLE_PENCIL_MOVE_SENSITIVE}},{key:"updateBackgroundLib",value:function(e,t,n){var i=n.leftPanelMainVC.getPanel(So.b.BACKGROUND_LIB);i&&i.onDataChanged(e)}}]),t}(He.a);tl.MODE_CANVAS_SCROLL="mode_canvas_scroll",tl.PAGE_SCROLL_ELEMENT="page_scroll_element",tl.DATA_ZOOM_OUT="data-zoom-out",tl.APPLE_PENCIL_MOVE_SENSITIVE=10,tl.DOUBLE_TAP_VALID_INTERVAL=800,tl.DOUBLE_TAP_VALID_RANGE=60;var nl,il=function e(t,n,i){L()(this,e),this.touchTime=t,this.offsetX=n,this.offsetY=i},al=function(){function e(t,n){var i=this;L()(this,e);var a=this.buttonWrapper=Be.a.makeDivElement("guide_control_button");a.appendChild(Be.a.makeLabel("label","가이드"));var o=Be.a.makeDivElement("icon");a.appendChild(o),Object(ne.setToolsIcon)(o,ne.ToolsIcon.LIGHT_ON),Object(ne.setToolsIcon)(o,ne.ToolsIcon.LIGHT_OFF),this.setActive(t),a.addEventListener("click",function(e){e.stopPropagation(),i.setActive(!i.getActive()),n(i.getActive())})}return w()(e,[{key:"getActive",value:function(){return this.buttonWrapper.classList.contains("active")}},{key:"getButton",value:function(){return this.buttonWrapper}},{key:"show",value:function(e){Be.a.setVisible(this.buttonWrapper,e)}},{key:"setActive",value:function(e){Be.a.setActive(this.buttonWrapper,e)}}]),e}();!function(e){e[e.default=0]="default",e[e.top=1]="top"}(nl||(nl={}));var ol,sl,rl,ll=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"setFloatingPosition",value:function(e){this.enableStyle(e===nl.top,this.container,r.a.FLOATING_TOP)}}]),t}(He.a),cl=function(){function e(){L()(this,e)}return w()(e,null,[{key:"makeButton",value:function(t,n,i,a){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5?arguments[5]:void 0,r=arguments.length>6?arguments[6]:void 0,l=document.createElement("button");if(o&&(l.addEventListener("mouseenter",function(){l.classList.add("hover")}),l.addEventListener("mouseleave",function(){l.classList.remove("hover")})),t&&(l.className=t),l.type="button",a&&l.addEventListener("click",function(e){Y.a.isCropMode()||a(e)}),n&&Object(ne.setToolsIcon)(l,n),i&&l.classList.add(i),s&&r&&s.length===r.length)for(var c=0;c<s.length;c++){var u=e.makeButton(r[c],null,null,null,!1);u.innerText=s[c],l.appendChild(u)}return l}},{key:"makeChangeZoomScaleButtons",value:function(t,n,i){return e.makeButton(t,null,null,function(e){e.stopPropagation(),e.preventDefault(),i(),X.a.instance.dispatch(new Ms.a(n/100,!0))},!0,["".concat(n),"%"],["divScale","divPercent"])}}]),e}(),ul=n(450),dl=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this))).zoomScale=e,i.pageEditScale=n,i}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return e.zoomScale!==this.zoomScale||e.pageEditScale!==this.pageEditScale}}]),t}(He.b),hl=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,!0,"zoomSettingVC"))).isScreenMoveMode=!1,e.pageZoomInAction=new Jn.i,e.pageZoomOutAction=new Jn.j,e.pageZoomFitAction=new Jn.g,e.pageZoomFullAction=new Jn.h,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this);var n=cl.makeButton("btnZoomOut",ne.ToolsIcon.MINUS,null,function(){X.a.instance.dispatch(e.pageZoomOutAction)});this.btnZoomOut=n;var i=function(){e.isInputChange=!1;var t=Number(c.value)/100;isNaN(t)||(Hn.a.getLowestScale()*Y.a.instance.pageEditScale>t&&(t=Hn.a.getLowestScale()*Y.a.instance.pageEditScale),Hn.a.getHighestScale()*Y.a.instance.pageEditScale<t&&(t=Hn.a.getHighestScale()*Y.a.instance.pageEditScale),X.a.instance.dispatch(new Ms.a(t,!0)))},a=function t(){e.isInputChange&&i(),document.removeEventListener("click",t),e.container.classList.remove("activePopup")},o=function(t){t.stopPropagation(),t.preventDefault(),e.container.classList.contains("activePopup")?(e.container.classList.remove("activePopup"),document.removeEventListener("click",a)):(e.container.classList.add("activePopup"),document.addEventListener("click",a),e.inputSetZoomScale.focus())},s=cl.makeButton("btnZoomScale",null,null,o),l=cl.makeButton("btnZoomScalePercent",null,null,o);l.innerText="%";var c=document.createElement("input");c.className="inputSetZoomScale",c.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault()}),c.addEventListener("keypress",function(e){var t=e.keyCode;return e.shiftKey||e.ctrlKey||e.altKey?(e.returnValue=!1,!1):t>=48&&t<=57||8===t||46===t||37===t||39===t||13===t||27===t||(e.returnValue=!1,!1)}),c.addEventListener("keydown",function(t){e.isInputChange=!0,t.stopPropagation();var n=t.keyCode;13===n&&(i(),e.container.classList.remove("activePopup"),document.removeEventListener("click",a)),27===n&&(e.container.classList.remove("activePopup"),document.removeEventListener("click",a))}),c.addEventListener("focus",function(){return c.select()}),this.inputSetZoomScale=c;var u=this.navigatorButtonsLine=document.createElement("span");u.className="pageZoomNavigatorLine";var d=cl.makeButton("btnZoomIn",ne.ToolsIcon.PLUS,null,function(){X.a.instance.dispatch(e.pageZoomInAction)});this.btnZoomIn=d;var h=cl.makeButton("btnZoomFit",ne.ToolsIcon.SCREEN_FIT,null,function(){return X.a.instance.dispatch(e.pageZoomFitAction)});if(S.a.getPageZoomNavigatorOption().fitScreenViewType===ul.a.ICON||je.a.isMobileDevice())h.setAttribute("data-view-type",ul.a.ICON);else if(h.querySelector(".tools_icon").style.display="none",h.setAttribute("data-view-type",ul.a.TEXT),!je.a.isMobileDevice()){var p=document.createElement("label");p.innerText="화면맞춤",h.appendChild(p)}this.btnZoomFit=h;var m=document.createElement("div");m.className=r.a.PAGE_NAVIGATOR_BUTTONS,(S.a.getPageZoomNavigatorOption().customInput?[n,s,l,c,d,u,h]:[n,d,h]).forEach(function(e){return m.appendChild(e)}),this.container.appendChild(m),this.zoomScale=s,this.makeZoomPopupElement(a);var f=cl.makeButton("btnMoveToggle",ne.ToolsIcon.DRAG,null,function(){X.a.instance.dispatch(new K.c(function(t,n,i){n.mouseAction.mode!==Fn.a.MODE_NONE?(f.classList.remove("pushed"),n.mouseAction.mode=Fn.a.MODE_NONE,e.isScreenMoveMode=!1,Y.a.instance.editorMainVC.canvasAreaVC.disableScrollMode()):(f.classList.add("pushed"),n.mouseAction.mode=Fn.a.MODE_NAVIGATION,e.isScreenMoveMode=!0,Y.a.instance.editorMainVC.canvasAreaVC.enableScrollMode())},!0))});f.style.left=S.a.getPageZoomNavigatorOption().customInput?"176px":"154px",this.container.appendChild(f),this.btnMoveToggle=f}},{key:"renderView",value:function(){he()(F()(t.prototype),"renderView",this).call(this),Y.a.isCropMode()?this.container.classList.add(r.a.HIDE):this.container.classList.remove(r.a.HIDE),this.checkUpContentsChange(this.getRenderStates()),Hn.a.initValues(this.designDoc.pages[0].sheetSize,Y.a.instance.editorMainVC.canvasAreaVC.getCanvasAreaScrollElement()),this.contentsStatesChanged&&(this.zoomScale.innerText="".concat(Math.round(this.contentsStates.zoomScale*Y.a.instance.pageEditScale*100)),this.container.classList.add(r.a.ACTIVE),this.contentsStates.zoomScale===Hn.a.getFitScale()?this.container.classList.add("minWidth"):(this.container.classList.remove("minWidth"),as.a.instance.hide()),this.contentsStates.zoomScale>Hn.a.getFitScale()?this.btnMoveToggle.classList.add("enabled"):(this.btnMoveToggle.classList.remove("enabled"),Y.a.instance.mouseAction.mode===Fn.a.MODE_NAVIGATION&&(this.btnMoveToggle.classList.remove("pushed"),Y.a.instance.mouseAction.mode=Fn.a.MODE_NONE,this.isScreenMoveMode=!1,Y.a.instance.editorMainVC.canvasAreaVC.disableScrollMode())),Hn.a.isLowestScale(this.contentsStates.zoomScale)?(this.container.classList.add("disableZoomOut"),this.btnZoomOut.disabled=!0):(this.container.classList.remove("disableZoomOut"),this.btnZoomOut.disabled=!1),Hn.a.isHighestLowestScale(this.contentsStates.zoomScale)||Hn.a.isOverDefaultHighestScale(this.contentsStates.zoomScale)?(this.container.classList.add("disableZoomIn"),this.btnZoomIn.disabled=!0):(this.container.classList.remove("disableZoomIn"),this.btnZoomIn.disabled=!1),Y.a.instance.mouseAction.mode===Fn.a.MODE_NAVIGATION?this.btnMoveToggle.classList.add("pushed"):this.btnMoveToggle.classList.remove("pushed"),this.inputSetZoomScale.value="".concat(Math.round(this.contentsStates.zoomScale*Y.a.instance.pageEditScale*100)))}},{key:"makeZoomPopupElement",value:function(e){var t=this,n=this.createDivElement("popupElement"),i=!0,a=!1,o=void 0;try{for(var s,r=Hn.a.ZOOM_SCALE_PRESET_LIST[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value,c=cl.makeChangeZoomScaleButtons("btnChangeZoomScale",l,e);n.appendChild(c)}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}var u=document.createElement("div");u.className="pageZoomNavigatorPopupLine";var d=cl.makeButton("btnScreenFitPopup",null,null,function(){X.a.instance.dispatch(t.pageZoomFitAction)},!0,["화면 맞춤"],["btnScreenFitPopup"]),h=cl.makeButton("btnScreenFullPopup",null,null,function(){X.a.instance.dispatch(t.pageZoomFullAction)},!0,["화면 채우기"],["btnScreenFullPopup"]);n.appendChild(u),n.appendChild(d),n.appendChild(h),this.container.appendChild(n)}},{key:"scrollToCenter",value:function(){X.a.instance.dispatch(new K.c(function(e,t,n){n.canvasAreaVC.scrollElement.moveScrollCenterX()}))}},{key:"getRenderStates",value:function(){return new dl(Y.a.instance.zoomScale,Y.a.instance.pageEditScale)}}]),t}(ll),pl=n(296),ml=n(126),fl=new(function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"openNewTabByRawData",value:function(e){var t=le.a.get();this.openNewTab(e,t.getIdx(),t.getLatestDesignHistoryIdx(),f.a.getUser().email)}},{key:"openNewTabByEncrypting",value:function(e){var t=le.a.get();this.openNewTabEncrypted(e,t.getIdx(),t.getLatestDesignHistoryIdx())}},{key:"submitDesignToUrlAfterSavingDesign",value:function(e){var t=this;C.a.save({categoryIdx:Wt.a.getSaveCategoryIdx()}).then(function(){Ht.a.isSaveComplete()?t.submitToUrlAfterCheckingUserAuth(e):alert("문서가 완전히 저장되지 않았습니다.")}).catch(function(e){throw e})}}]),t}(n(121).a)),vl=n(252),gl=n(124),El=n(373),yl=[gl.a.PPT,gl.a.CARD_NEWS,gl.a.BROCHURE_CATALOG],Tl=[gl.a.YOUTUBE,gl.a.SNS],Il=[gl.a.DETAIL_PAGE,gl.a.EVENT_PAGE,gl.a.CARD_NEWS],Cl=[gl.a.SNS,gl.a.CARD_NEWS,gl.a.WEB_BANNER,gl.a.WEB_POSTER],kl=[gl.a.CARD_NEWS,gl.a.SNS,gl.a.WEB_BANNER,gl.a.WEB_POSTER],Ll=[gl.a.WEB_POSTER,gl.a.WEB_BANNER,gl.a.SNS,gl.a.EVENT_PAGE],_l=[gl.a.EVENT_PAGE,gl.a.WEB_BANNER,gl.a.WEB_POSTER],wl=[gl.a.WEB_BANNER,gl.a.WEB_POSTER,gl.a.SNS],Sl=[gl.a.STICKER,gl.a.HANGTAG,gl.a.BUSINESS_CARD],bl=[gl.a.BUSINESS_CARD],Rl=[gl.a.STICKER,gl.a.HANGTAG,gl.a.BUSINESS_CARD],Al=[gl.a.PLACARD,gl.a.BANNER,gl.a.BANNER_MINI,gl.a.STAND_SIGN],Ol=[gl.a.BANNER,gl.a.BANNER_MINI,gl.a.PLACARD,gl.a.STAND_SIGN],Pl=[gl.a.POSTER,gl.a.REAL_PRINT,gl.a.FLYER],Dl=[gl.a.REAL_PRINT,gl.a.POSTER,gl.a.FLYER],Ml=[gl.a.FLYER,gl.a.FLYER_MAGNET_PAPER,gl.a.FLYER_MAGNET,gl.a.POSTER],Nl=[gl.a.FLYER_MAGNET_PAPER,gl.a.FLYER,gl.a.FLYER_MAGNET],xl=[gl.a.FLYER_MAGNET,gl.a.FLYER_MAGNET_PAPER,gl.a.FLYER],Bl=[gl.a.MAGNET_OPENER,gl.a.FLYER_MAGNET,gl.a.FLYER_MAGNET_PAPER],Vl=[gl.a.HAND_FAN,gl.a.HOLDER],Ul=[gl.a.LEAFLET,gl.a.BROCHURE_CATALOG,gl.a.FLYER],Fl=[gl.a.BROCHURE_CATALOG,gl.a.LEAFLET,gl.a.PPT,gl.a.FLYER],Gl=[gl.a.HOLDER,gl.a.HAND_FAN,gl.a.TICKET],Hl=[gl.a.TICKET,gl.a.ENVELOPE,gl.a.FLYER],Wl=[gl.a.ENVELOPE,gl.a.TICKET,gl.a.STICKER],zl=[gl.a.REAL_PRINT,gl.a.BANNER,gl.a.STAND_SIGN],Kl=[gl.a.STAND_SIGN,gl.a.BANNER],Yl=[gl.a.CHARACTER,gl.a.BROCHURE_CATALOG],Xl=function(){function e(){L()(this,e)}return w()(e,null,[{key:"getSortMap",value:function(){return new Map([[El.a.PRESENTATION,yl],[El.a.YOUTUBE_COVER,Tl],[El.a.YOUTUBE_THUMB,Tl],[El.a.YOUTUBE_CHANNEL_LOGO,Tl],[El.a.DETAIL_PAGE,Il],[El.a.SOCIAL_MEDIA_SQUARE,Cl],[El.a.CARD_NEWS,kl],[El.a.WEB_POST_HOR_POSTER,Ll],[El.a.WEB_POST_VER_POSTER,Ll],[El.a.GROOBEE_BIG,_l],[El.a.WEB_BANNER_HOR,wl],[El.a.WEB_BANNER_VER,wl],[El.a.WEB_POST_SQUARE,wl],[El.a.WEB_POST_VER,wl],[El.a.DIGITAL_NAME_CARD_HOR,bl],[El.a.DIGITAL_NAME_CARD_VER,bl],[El.a.FANCY_BANNER_RECT,Sl],[El.a.FANCY_BANNER_SQUARE,Sl],[El.a.BUSINESS_CARD_HOR,bl],[El.a.BUSINESS_CARD_VER,bl],[El.a.STICKER_SQUARE,Rl],[El.a.STICKER_CIRCLE,Rl],[El.a.STICKER_RECT,Rl],[El.a.STICKER_OVAL,Rl],[El.a.STICKER_VERTICAL_RECT,Rl],[El.a.PLACARD_HOR,Al],[El.a.PLACARD_VER,Al],[El.a.PLACARD_SQUARE,Al],[El.a.PLACARD_POSTER_HOR,Al],[El.a.PLACARD_POSTER_VER,Al],[El.a.PLACARD_BANNER_VER,Al],[El.a.BANNER,Ol],[El.a.POSTER_HOR_PRINT,Pl],[El.a.POSTER_VER_PRINT,Pl],[El.a.REAL_PRINT_HOR,Dl],[El.a.REAL_PRINT_VER,Dl],[El.a.REAL_PRINT_VER_A0,Dl],[El.a.POSTER_A1_VER_594_841_FOR_SIZE_2,Dl],[El.a.POSTER_A2_VER_420_594_FOR_SIZE_2,Dl],[El.a.POSTER_A3_VER_297_420_FOR_SIZE_2,Dl],[El.a.FLYER_A4_VER_210_297_FOR_SIZE_2,Dl],[El.a.FLYER_A5_VER_148_210_FOR_SIZE_2,Dl],[El.a.REAL_PRINT_VER_B1,Dl],[El.a.REAL_PRINT_VER_B2,Dl],[El.a.REAL_PRINT_VER_B3,Dl],[El.a.POSTER_B4_VER_257_364_FOR_SIZE_2,Dl],[El.a.FLYER_B5_VER_182_257_FOR_SIZE_2,Dl],[El.a.FLYER_B6_VER_128_182_FOR_SIZE_2,Dl],[El.a.REAL_PRINT_HOR_A0,Dl],[El.a.POSTER_A1_HOR_841_594_FOR_SIZE_2,Dl],[El.a.POSTER_A2_HOR_594_420_FOR_SIZE_2,Dl],[El.a.POSTER_A3_HOR_420_297_FOR_SIZE_2,Dl],[El.a.FLYER_A4_HOR_297_210_FOR_SIZE_2,Dl],[El.a.FLYER_A5_HOR_210_148_FOR_SIZE_2,Dl],[El.a.REAL_PRINT_HOR_B1,Dl],[El.a.REAL_PRINT_HOR_B2,Dl],[El.a.REAL_PRINT_HOR_B3,Dl],[El.a.POSTER_B4_HOR_364_257_FOR_SIZE_2,Dl],[El.a.FLYER_B5_HOR_257_182_FOR_SIZE_2,Dl],[El.a.FLYER_B6_HOR_182_128_FOR_SIZE_2,Dl],[El.a.WEB_FLYER_SINGLE,Ml],[El.a.WEB_FLYER_DOUBLE,Ml],[El.a.FLYER_MAGNETIC_SINGLE,Nl],[El.a.FLYER_MAGNETIC_PAPER,Nl],[El.a.FLYER_MAGNET_CIRCLE,xl],[El.a.FLYER_MAGNET_ROUNDED_RECT,xl],[El.a.MAGNET_OPENER_CIRCLE,Bl],[El.a.MAGNET_OPENER_PET,Bl],[El.a.MAGNET_OPENER_TONGS,Bl],[El.a.HAND_FAN,Vl],[El.a.LEAFLET_2_STAGES,Ul],[El.a.LEAFLET_3_STAGES,Ul],[El.a.BROCHURE_CATALOGUE_HOR,Fl],[El.a.BROCHURE_CATALOGUE_VER,Fl],[El.a.L_HOLDER,Gl],[El.a.TICKET_HOR,Hl],[El.a.TICKET_VER,Hl],[El.a.TICKET_PERFORATION_HOR,Hl],[El.a.TICKET_PERFORATION_VER,Hl],[El.a.ENVELOPE_BIG,Wl],[El.a.ENVELOPE_JACKET,Wl],[El.a.ENVELOPE_SMALL,Wl],[El.a.ENVELOPE_TICKET,Wl],[El.a.LED_PANEL_HOR,zl],[El.a.LED_PANEL_VER,zl],[El.a.STAND_SIGN_SMALL,Kl],[El.a.STAND_SIGN_NORMAL,Kl],[El.a.STAND_SIGN_BIG,Kl],[El.a.COLORING_BOOK,Yl]])}},{key:"sortListDependingOnTemplateTypeId",value:function(e,t){if(e!==El.a.NONE&&!e)return t;var n=this.getSortMap();if(n.has(e)){var i=t.slice();return n.get(e).slice().reverse().forEach(function(e){var t=i.find(function(t){return t.type.toLowerCase()===gl.a[e].toLowerCase()});t&&(i.splice(i.indexOf(t),1),i.splice(3,0,t))}),i}return t}}]),e}(),jl=n(123),Zl=new(function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"submitToUrl",value:function(e){fl.submitDesignToUrlAfterSavingDesign(e)}},{key:"getItems",value:function(){var e=vl.a.getDesignDoc().templateType;return e?Xl.sortListDependingOnTemplateTypeId(El.a.getIdFrom(e.id),jl.a.fetchItemList()):jl.a.fetchItemList()}}]),t}(ml.a));sl=ol||(ol={}),rl=null,sl.ready=function(){document.body.classList.add(r.a.MOBILE_TUTORIAL_READY)},sl.getElement=function(){if(null==rl){(rl=document.createElement("div")).className=r.a.MOBILE_TUTORIAL;var e=document.createElement("div");e.className=r.a.BODY,e.innerText="템플릿&요소 추가하기!",rl.appendChild(e)}return rl},sl.close=function(){rl&&rl.parentElement&&(rl.parentElement.removeChild(rl),document.body.classList.remove(r.a.MOBILE_TUTORIAL_READY),rl=null)};var ql=n(104),$l=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"onShowDesignCommissionPopup",value:function(){Zl.onShowCommissionPopup()}}]),t}(ql.b),Ql=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dont_show_video_popup";return L()(this,t),(e=V()(this,F()(t).call(this))).provideDontShowAgain=n,e.preventBackgroundClose=i,e.showAgainAfterDay=a,e.cookieKey=o,e}return z()(t,e),w()(t,[{key:"useCookie",value:function(){return this.provideDontShowAgain||this.showAgainAfterDay&&this.showAgainAfterDay>0}},{key:"existCookie",value:function(){return Go.b.getCookie(this.cookieKey)===this.cookieKey}},{key:"canOpen",value:function(){return!this.useCookie()||!this.existCookie()}},{key:"renderDontShowAgain",value:function(){var e=this,t=document.createElement("div");t.className="dont_show_again",this.contentsWrap.appendChild(t),Object(ne.setToolsIcon)(t,ne.ToolsIcon.CLOSE);var n=document.createElement("label");n.innerText="다시 안볼래요",t.appendChild(n),t.addEventListener("click",function(){e.close(),Go.b.setCookie(e.cookieKey,e.cookieKey,36500)})}},{key:"isPreventBackgroundCloseEvent",value:function(){return this.preventBackgroundClose}},{key:"getId",value:function(){return t.VIDEO_POPUP_ID}},{key:"getContents",value:function(){var e=document.createElement("div");e.className="video_popup_contents";var t=document.createElement("iframe");t.width="1280",t.height="720";var n="https://www.youtube.com/embed/Cs-U1y9T54g?rel=0";return n=je.a.isMobileDevice()?n:"".concat(n,"&autoplay=1"),t.src=n,t.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",t.allowFullscreen=!0,e.appendChild(t),e}},{key:"updateUI",value:function(){}},{key:"open",value:function(e){return this.canOpen()?(he()(F()(t.prototype),"open",this).call(this,e),this.showAgainAfterDay&&Go.b.setCookie(this.cookieKey,this.cookieKey,this.showAgainAfterDay),this):(this.closeCallback(),this)}},{key:"close",value:function(){return he()(F()(t.prototype),"close",this).call(this),this.closeCallback&&this.closeCallback(),this}},{key:"setCloseCallback",value:function(e){this.closeCallback=e}}]),t}(u.a);Ql.VIDEO_POPUP_ID="videoPopup";var Jl,ec=n(96);!function(e){e.TITLE="title",e.MENU="help_popup_menu",e.MENU_LIST="help_popup_menu_list",e.MENU_ITEM="help_popup_menu_item"}(Jl||(Jl={}));var tc=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,t.POPUP_ID))).reactBgId="reactPopupBackground",e.addListener(),e}return z()(t,e),w()(t,[{key:"addListener",value:function(){ec.a.addListener(this)}},{key:"onClosePopup",value:function(){}},{key:"onChangePrevious",value:function(){this.openCustomerGuideView()}},{key:"setActionSet",value:function(e){this.actionSet=e}},{key:"makeMenuElement",value:function(){var e=this.makeMenuWrapperElement();return e.appendChild(this.makeTitleElement()),e.appendChild(this.makeMenuListElement()),e}},{key:"makeTitleElement",value:function(){var e=this,t=document.createElement("div");return t.className=Jl.TITLE,t.innerText="도움말",Object(ne.setToolsIcon)(t,ne.ToolsIcon.CLOSE).addEventListener("click",function(){return e.close()}),t}},{key:"makeMenuListElement",value:function(){var e=document.createElement("div");return e.className=Jl.MENU_LIST,this.appendMenuItemElementByOption(e),e}},{key:"openCustomerGuideView",value:function(){var e=this;if(!this.reactPopUpParentElement){var t=this.reactPopUpParentElement=document.createElement("div");t.id=this.reactBgId,t.addEventListener("click",function(t){t.target.id===e.reactBgId&&(e.customGuideVC.setVisibility(!1),e.close(),t.stopPropagation())}),this.renderCustomerGuide(t),document.body.appendChild(t)}this.reactPopUpParentElement.style.display="block",this.customGuideVC.setVisibility(!0)}},{key:"renderCustomerGuide",value:function(e){this.customGuideVC=La.render(ra.a.createElement(ql.b,this.getCustomerGuideProps()),e)}},{key:"getCustomerGuideProps",value:function(){return new ql.a(function(){return(new Ql).open()},this.close.bind(this))}},{key:"appendMenuItemElementByOption",value:function(e){S.a.getHelpCenterOption().bizhowsCenter?e.appendChild(this.makeBizhowsCustomerCenterMenuItemElement()):this.openCustomerGuideView()}},{key:"close",value:function(){var e=this;S.a.getHelpCenterOption().bizhowsCenter?he()(F()(t.prototype),"close",this).call(this):this.reactPopUpParentElement&&setTimeout(function(){e.reactPopUpParentElement.style.display="none"},300)}},{key:"makeMenuWrapperElement",value:function(){var e=this.menuWrap=document.createElement("div");return e.tabIndex=-1,e.className=Jl.MENU,e.addEventListener("keydown",function(e){return e.stopPropagation()}),e}},{key:"makeBizhowsCustomerCenterMenuItemElement",value:function(){var e=this;return this.makeMenuButtonElement("비즈하우스 고객센터",ne.ToolsIcon.OUTLINE,function(){e.actionSet&&e.actionSet.openBizhowsCenter()})}},{key:"makeMenuButtonElement",value:function(e,t,n){var i=this,a=document.createElement("button");a.classList.add(Jl.MENU_ITEM),a.addEventListener("click",function(){n(),i.close()}),Object(ne.setToolsIcon)(a,t);var o=document.createElement("span");return o.innerText=e,a.appendChild(o),a}},{key:"open",value:function(e){return S.a.getHelpCenterOption().bizhowsCenter?he()(F()(t.prototype),"open",this).call(this,e):void this.openCustomerGuideView()}},{key:"getContents",value:function(){var e=he()(F()(t.prototype),"getContents",this).call(this);return e.appendChild(this.makeMenuElement()),e}}]),t}(fe.a);tc.POPUP_ID="help_center_popup";var nc=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"addListener",value:function(){Zl.addListener(this)}},{key:"renderCustomerGuide",value:function(e){this.customGuideVC=La.render(ra.a.createElement($l,this.getCustomerGuideProps()),e)}}]),t}(tc),ic=n(45),ac=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0,"helpCenter","div",document.getElementById("helpCenter")))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.HELP_CENTER,Object(ne.setToolsIcon)(this.container,ne.ToolsIcon.MESSAGE_ROUNDED),document.body.appendChild(this.container),this.container.addEventListener("click",function(t){t.stopPropagation(),e.openHelpPopup(e.container)}),this.helpPopup=this.createHelpMenuView(),this.helpPopup.setActionSet({isMobileMode:function(){return je.a.isMobilePortraitSize()},openBizhowsCenter:function(){return window.open(t.HELP_CENTER_BIZHOWS_CUSTOMER_SERVICE_URL)},openCopyrightInfoPage:function(){return window.open(t.HELP_CENTER_COPYRIGHT_INFO_URL)},openPrintInfoPage:function(){return window.open(t.HELP_CENTER_PRINT_URL)},openFaqInfoPage:function(){return window.open(t.HELP_CENTER_FAQ_URL)},openStatusInfoPage:function(){return window.open(t.HELP_CENTER_STATUS_URL)},showZendesk:function(){return ic.a.show()}})}},{key:"createHelpMenuView",value:function(){return new tc}},{key:"openHelpPopup",value:function(e){var t=e?e.getBoundingClientRect():{left:0,top:0};this.helpPopup.open(t)}}]),t}(He.a);ac.HELP_CENTER_BIZHOWS_CUSTOMER_SERVICE_URL="http://www.bizhows.com/cms/%EA%B3%A0%EA%B0%9D%EC%84%BC%ED%84%B0",ac.HELP_CENTER_COPYRIGHT_INFO_URL="https://api.miricanvas.com/s/158",ac.HELP_CENTER_PRINT_URL="https://api.miricanvas.com/s/42",ac.HELP_CENTER_FAQ_URL="https://api.miricanvas.com/s/44",ac.HELP_CENTER_STATUS_URL="https://api.miricanvas.com/s/159";var oc=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"createHelpMenuView",value:function(){return new nc}}]),t}(ac),sc=n(167),rc=n(83),lc=n(289),cc=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).SAVE_LIMIT_COUNT=5,n}return z()(t,e),w()(t,[{key:"loadList",value:function(e){var t=this.templateTypeList=this.loadTemplateTypeListFromStorage();return e===tn.a.ALL?t:t.filter(function(t){return t.purpose===e})}},{key:"loadTemplateTypeListFromStorage",value:function(){var e=JSON.parse(this.getLocalStorage(Pn.b.RECENTLY_USED_ALL_TEMPLATE_TYPE_LIST));return e?e.map(function(e){return an.c.createFromObject(e)}):[]}},{key:"removeListTemplateType",value:function(e){var t=e[e.length-1].id,n=this.templateTypeList.findIndex(function(e){return e.id===t});this.templateTypeList.splice(n,1)}},{key:"addItem",value:function(e){var t=e.id,n=e.purpose;if(!this.isIncluded(t,n)){var i=this.loadList(n);i.length+1>this.SAVE_LIMIT_COUNT&&this.removeListTemplateType(i),this.templateTypeList.unshift(e),this.saveList(this.templateTypeList)}}},{key:"saveList",value:function(e){this.setLocalStorage(Pn.b.RECENTLY_USED_ALL_TEMPLATE_TYPE_LIST,JSON.stringify(e))}},{key:"isIncluded",value:function(e,t){return this.loadList(t).some(function(t){return t.id===e})}},{key:"isEmpty",value:function(e){return!this.loadList(e)||0===this.loadList(e).length}}]),t}(dn.a),uc=n(508),dc=n(169),hc=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,void 0,an.b.SHEET_SIZE,"적용하기",!0))).pageSizeSelectVCListener=e,n.recentUsedTemplates=new cc,n}return z()(t,e),w()(t,[{key:"setPlaceholder",value:function(){he()(F()(t.prototype),"setPlaceholder",this).call(this,t.SIZE_SEARCH_PRINT_PLACEHOLDER,t.SIZE_SEARCH_WEB_PLACEHOLDER)}},{key:"onSelectTemplateType",value:function(e){this.selectPageSize(e.getPageSize(),e),this.clearKeyword(),rc.a.dispatchTemplateTypeSelect(e),he()(F()(t.prototype),"onSelectTemplateType",this).call(this,e),this.pageSizeSelectVCListener&&this.pageSizeSelectVCListener.onSelectPageSize()}},{key:"fetchTemplateTypeList",value:function(e){this.noPageSizeResultView&&this.noPageSizeResultView.hideTooltip(),he()(F()(t.prototype),"fetchTemplateTypeList",this).call(this,e)}},{key:"onInputCustomSize",value:function(e){he()(F()(t.prototype),"onInputCustomSize",this).call(this,e),this.selectPageSize(e),rc.a.dispatchTemplateTypeSelect(new an.c(void 0,e.width,e.height)),this.pageSizeSelectVCListener&&this.pageSizeSelectVCListener.onSelectPageSize()}},{key:"selectPageSize",value:function(e,t){X.a.instance.dispatch(new lc.b(e,t));var n="".concat(e.width,"x").concat(e.height,", ").concat(e.unit);null!=e.dpi&&(n+=", ".concat(e.dpi," DPI")),Te.a.sendEvent("크기조정 클릭이벤트 비교","크기조정",n,!0)}},{key:"showNoResult",value:function(){this.noPageSizeResultView=new uc.a(this.selectedPrintType,this.onInputCustomSize.bind(this),this.updateTooltipAndWarning.bind(this),this.scrollElementWrapper,this.contentsStates.devMode),this.listWrap.appendChild(this.noPageSizeResultView.render()),this.scrollElement.updateScrollbar()}},{key:"onItemClick",value:function(e,n){he()(F()(t.prototype),"onItemClick",this).call(this,e,n),this.recentUsedTemplates.addItem(e),this.renderView()}},{key:"makeRecentUsePanel",value:function(){var e=document.createElement("div");if(this.recentUsePanel=e,this.recentUsedTemplates.isEmpty(this.selectedPrintType))return e;var t=this.createDivElement("text");e.className="recent_use_panel",t.innerText="최근 사용",e.appendChild(t);var n=an.c.classifyIntoGroups(this.recentUsedTemplates.loadList(this.selectedPrintType));return this.drawMenuItems(e,n,!1,!1,!0),e}},{key:"setHeaderVisibility",value:function(e){he()(F()(t.prototype),"setHeaderVisibility",this).call(this,e),this.recentUsePanel.style.display=e?"block":"none"}}]),t}(dc.a);hc.SIZE_SEARCH_PRINT_PLACEHOLDER="'A4'사이즈를 찾으시나요?",hc.SIZE_SEARCH_WEB_PLACEHOLDER="'배경화면'사이즈를 찾으시나요?";var pc=n(60),mc=n(94),fc=n(332),vc=n(374),gc=n(391),Ec=function(){function e(){L()(this,e)}return w()(e,null,[{key:"unmodifiedPageInspection",value:function(){var e=!1;return X.a.instance.dispatch(new K.c(function(t,n){e=t.pages.length>n.renderedPages.size})),e}},{key:"getUnmodifiedPageIndex",value:function(){var e=-1;return X.a.instance.dispatch(new K.c(function(t,n){e=t.pages.findIndex(function(e){return!n.renderedPages.has(e.pageIdx)})})),e}}]),e}(),yc=n(119),Tc=n(59),Ic=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).input=ra.a.createRef(),n.onChange=n.onChange.bind(H()(n)),n}return z()(t,e),w()(t,[{key:"componentDidMount",value:function(){this.input.current.checked=this.props.defaultChecked}},{key:"onChange",value:function(){this.props.onChange&&this.props.onChange(this.input.current.checked)}},{key:"render",value:function(){return ra.a.createElement("div",{className:"popup_checkbox_wrapper"},ra.a.createElement("label",{className:"popup_checkbox_label"},ra.a.createElement("input",{ref:this.input,type:"checkbox",onChange:this.onChange}),ra.a.createElement("span",{className:"popup_checkbox"},ra.a.createElement("i",{className:"".concat(ne.TOOLS_ICON_CLASS," ").concat(Object(ne.getToolsIconName)(ne.ToolsIcon.CHECK))})),this.props.children))}}]),t}(sa.Component),Cc=function(e){function t(e,n,i,a,o,s,r,l,c,u,d){var h;return L()(this,t),(h=V()(this,F()(t).call(this,e,n,i,a,o,s,r,l,c))).defaultChecked=u,h.checkButtonLabel=d,h}return z()(t,e),t}(Tc.a),kc=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).checked=null!=e.defaultChecked&&e.defaultChecked,n.onChangeCheckBox=n.onChangeCheckBox.bind(H()(n)),n}return z()(t,e),w()(t,[{key:"onChangeCheckBox",value:function(e){this.checked=e}},{key:"renderBodyContent",value:function(){return ra.a.createElement(ra.a.Fragment,null,he()(F()(t.prototype),"renderBodyContent",this).call(this),ra.a.createElement(Ic,{defaultChecked:this.props.defaultChecked,onChange:this.onChangeCheckBox},this.props.checkButtonLabel))}},{key:"getButtonOnClick",value:function(e){var t=this;return function(){e&&e(t.checked)}}}]),t}(Tc.c),Lc=n(38),_c=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"createProps",value:function(){return new Cc(this.imgType,this.title,this.subTitle,this.hide.bind(this),this.animationType,this.modal,this.showXCloseButton,this.showFromBottomOnMobile,this.buttons,this.defaultChecked,this.checkButtonLabel)}},{key:"getComponent",value:function(){return kc}},{key:"setCheckButtonLabel",value:function(e){return this.checkButtonLabel=e,this}},{key:"addButton",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Lc.b.PRIMARY,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=function(t){n&&n(t),e.closeAfterButtonClick(i)},l=new Lc.a(r.bind(this),a);return this.appendButton(t,l,o,s),this}},{key:"activateChecked",value:function(){return this.defaultChecked=!0,this}}]),t}(yc.a),wc=n(444),Sc=n(440),bc=n(515),Rc=n(118),Ac=new(function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"initTemplateType",value:function(){this.templateType=vl.a.getDesignDoc().templateType}},{key:"onRequestPrintoutProduction",value:function(e){Ye.a.openLoginPopup(Ie.a.PRINTOUT_PRODUCTION,function(){return fl.submitDesignToUrlAfterSavingDesign(e)})}},{key:"onRequestNewDesign",value:function(e){Ye.a.openLoginPopup(Ie.a.PRINTOUT_PRODUCTION,s()(a.a.mark(function t(){var n,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Ke.a.getUserSetting(),i=rc.a.getTemplateTypeList(an.b.SHEET_SIZE,tn.a.PRINT,n.devMode,n.adminMode),t.t0=Rc.a,t.t1=i.find(function(t){return t.id===e}),t.t2=Wt.a.getSaveCategoryIdx(),t.next=7,m.a.getSelectedTeamIndex(le.a.get().getIdx());case 7:return t.t3=t.sent,t.next=10,m.a.getSelectedTeamScope();case 10:t.t4=t.sent,t.t0.openDesignPageWithTemplateType.call(t.t0,t.t1,t.t2,t.t3,t.t4);case 12:case"end":return t.stop()}},t)})))}}]),t}(bc.a)),Oc=n(447),Pc=function e(t,n){L()(this,e),this.color=t,this.text=n},Dc=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"render",value:function(){return ra.a.createElement("label",{className:"color_label",style:{backgroundColor:this.props.color}},this.props.text)}}]),t}(sa.Component),Mc=function e(t,n,i,a,o,s){L()(this,e),this.onClick=t,this.id=n,this.title=i,this.className=a,this.icon=o,this.label=s},Nc=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).onClick=n.onClick.bind(H()(n)),n}return z()(t,e),w()(t,[{key:"onClick",value:function(){this.props.onClick&&this.props.onClick(this.props.id)}},{key:"render",value:function(){return ra.a.createElement("div",{className:"menu_item".concat(this.props.className?" ".concat(this.props.className):""),onClick:this.onClick},this.props.icon&&ra.a.createElement(la.a,{icon:this.props.icon}),ra.a.createElement("span",null,this.props.title),this.props.label&&ra.a.createElement(Dc,this.props.label))}}]),t}(sa.Component),xc=n(571),Bc=n.n(xc),Vc=function e(t,n,i){L()(this,e),this.menuItems=t,this.onClickBackground=n,this.viewOpenTrigger=i},Uc=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).popup=Object(sa.createRef)(),n.onClickBackground=n.onClickBackground.bind(H()(n)),n.updatePosition=n.updatePosition.bind(H()(n)),n}return z()(t,e),w()(t,[{key:"componentDidMount",value:function(){var e=this;this.updatePosition(),window.addEventListener("resize",this.updatePosition),setTimeout(function(){return e.popup.current.classList.remove("hidden_bottom")},0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updatePosition)}},{key:"onClickBackground",value:function(){this.props.onClickBackground&&this.props.onClickBackground()}},{key:"updatePosition",value:function(){var e=this.props.viewOpenTrigger?t.getOffsetFrom(this.props.viewOpenTrigger):null;this.popup.current.style.left=e?"".concat(e.x,"px"):"50%",this.popup.current.style.top=e?"".concat(e.y,"px"):"50%",this.popup.current.style.transform=e?"translate(0, 0)":"translate(-50%, -50%)",document.documentElement.clientWidth<this.popup.current.offsetWidth+this.popup.current.offsetLeft&&(this.popup.current.style.transform="translate(-100%, 0)")}},{key:"render",value:function(){return ra.a.createElement("div",{className:"menu_popup_container"},ra.a.createElement("div",{className:"menu_popup_background",onClick:this.onClickBackground}),ra.a.createElement("div",{className:"menu_popup_content hidden_bottom",ref:this.popup},this.props.menuItems.map(function(e,t){return ra.a.createElement(Nc,Bc()({key:t},e))})))}}],[{key:"getOffsetFrom",value:function(e){var t=e.getBoundingClientRect();return new ns.a(t.left+t.width,t.top+t.height+10)}}]),t}(sa.Component),Fc=n(100),Gc=n(509),Hc=n(22),Wc=n.n(Hc),zc=n(284),Kc=n(471);function Yc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Xc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yc(n,!0).forEach(function(t){Wc()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yc(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var jc=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,!0))).scrollLock=!1,i.state={history:[],currentPage:1,maximumPage:1},i.showHistoryCopyButton=e,i.designIdx=n,i}var n;return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.DESIGN_HISTORY;var n=document.createElement("div");n.className="".concat(r.a.TOOLS_TAB," ").concat(r.a.ACTIVE," ").concat(r.a.DESIGN_HISTORY_VIEW),n.appendChild(this.renderBackground()),n.appendChild(this.renderLayer()),this.container.appendChild(n),document.body.appendChild(this.container),s()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,me.fetchDesignHistory(e.designIdx);case 2:n=t.sent,e.setState(Xc({},e.state,{history:n.list,maximumPage:n.pagination.totalPage}));case 4:case"end":return t.stop()}},t)}))()}},{key:"setState",value:function(e,t){if(e){this.state=e;var n=!t;n&&(this.selectedHistory=null,t=this.state.history,this.updateButtons()),this.updateList(t,n)}}},{key:"updateList",value:function(e,t){var n=this;t&&(this.historyLogContainer.innerHTML=""),e.forEach(function(e){var t=n.renderRow(e);n.historyLogContainer.appendChild(t)})}},{key:"appendList",value:(n=s()(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.currentPage>=this.state.maximumPage)){e.next=2;break}return e.abrupt("return",[]);case 2:return t=this.state.currentPage+1,e.next=5,me.fetchDesignHistory(this.designIdx,t);case 5:return n=e.sent,this.scrollLock=!1,e.abrupt("return",n.list);case 8:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"renderBackground",value:function(){var e=document.createElement("div");return e.className="tab_background",e.addEventListener("click",this.destroy.bind(this)),e}},{key:"renderLayer",value:function(){return this.layer||(this.layer=document.createElement("div"),this.layer.id="designHistoryLayer",this.layer.className=r.a.DESIGN_HISTORY_LAYER,this.layer.appendChild(this.renderHeader()),this.layer.appendChild(this.renderBody()),this.layer.appendChild(this.renderFooter())),this.layer}},{key:"renderFooter",value:function(){var e=this,t=document.createElement("div");t.className=r.a.DESIGN_HISTORY_FOOTER;var n=this.btnCopy=document.createElement("button");n.className="button_copy",n.innerText="사본 만들기",n.addEventListener("click",s()(a.a.mark(function t(){var n,i,o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.selectedHistory,t.prev=1,t.next=4,m.a.getDefaultSelectedTeamData(f.a.getUser().accountId);case 4:return i=t.sent,t.next=7,me.copyDesignRevision(e.designIdx,n.designHistoryIdx,i);case 7:o=t.sent,window.open(Fc.a.getDesignUrl(o.idx)),t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(1),Kc.a.open("권한이 없습니다.","확인",void 0),t.abrupt("return");case 15:case"end":return t.stop()}},t,null,[[1,11]])})));var i=this.btnRevert=document.createElement("button");return i.className="button_revert",i.innerText="작업 되돌리기",i.addEventListener("click",s()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.selectedHistory){t.next=6;break}return Kc.a.open("복원할 작업을 선택해주세요.","확인",void 0),t.abrupt("return");case 6:zc.a.open({title:"선택한 작업을 불러오시겠습니까?",subTitle:"",subTitleHTML:"현재 작업중인 문서가 ".concat(n.username,"님이 <span>").concat(re.a.toFormattedString(new Date(n.createdDate)),"\n                    </span>에 작업한 내용으로 변경됩니다."),txtConfirmBtn:"불러오기",confirmAction:function(){var t=s()(a.a.mark(function t(){var i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,me.overwriteDesignWithRevision(e.designIdx,n.designHistoryIdx);case 3:return i=t.sent,t.next=6,I.b.load(i.idx);case 6:X.a.instance.dispatch(new se.d),$("#btnDesignHistory").toggleClass("active"),t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(0),Kc.a.open("권한이 없습니다.","확인",void 0),t.abrupt("return");case 14:case"end":return t.stop()}},t,null,[[0,10]])}));return function(){return t.apply(this,arguments)}}()});case 7:case"end":return t.stop()}},t)}))),t.appendChild(i),this.showHistoryCopyButton&&t.appendChild(n),t}},{key:"renderHeader",value:function(){var e=document.createElement("div");e.className=r.a.DESIGN_HISTORY_HEADER;var t=document.createElement("h1");return t.innerText="작업내역",e.appendChild(t),Object(ne.setToolsIcon)(e,ne.ToolsIcon.CLOSE,!0).addEventListener("click",this.destroy.bind(this)),e}},{key:"renderBody",value:function(){var e=this,t=new Ce.a(!1,!0,"399px");this.scrollElement=t;var n=t.contents;$(n).on("scroll",s()(a.a.mark(function t(){var i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n.scrollHeight-$(n).height()<n.scrollTop+1)){t.next=7;break}if(e.scrollLock||!(e.state.currentPage<e.state.maximumPage)){t.next=7;break}return e.scrollLock=!0,t.next=5,e.appendList();case 5:i=t.sent,e.setState(Xc({},e.state,{history:[].concat(Yn()(e.state.history),Yn()(i)),currentPage:e.state.currentPage+1}),i);case 7:case"end":return t.stop()}},t)})));var i=this.historyLogContainer=document.createElement("div");return i.className=r.a.DESIGN_HISTORY_LOG_CONTAINER,this.scrollElement.contents.appendChild(i),t.element}},{key:"renderRow",value:function(e){var t=this,n=document.createElement("div");n.className=r.a.DESIGN_HISTORY_ROW;var i=document.createElement("div");i.className=r.a.DESIGN_HISTORY_USER_PROFILE;var a=document.createElement("div");a.className=r.a.DESIGN_HISTORY_USER_PHOTO,Object(ne.setToolsIcon)(a,ne.ToolsIcon.USER_PROFILE);var o=document.createElement("div");o.className=r.a.DESIGN_HISTORY_USER_NAME,o.innerText="".concat(e.username),i.appendChild(a),i.appendChild(o);var s=document.createElement("div");s.className=r.a.DESIGN_HISTORY_DESIGN_LOG;var l=document.createElement("div");l.className=r.a.DESIGN_HISTORY_BOX,e.autoSaved||Object(ne.setToolsIcon)(l,ne.ToolsIcon.USER_CHECK);var c=document.createElement("span");return c.innerText=re.a.toFormattedString(new Date(e.createdDate)),l.appendChild(c),s.appendChild(l),n.addEventListener("click",function(i){t.toggleHistory(n,e)}),n.appendChild(i),n.appendChild(s),n}},{key:"toggleHistory",value:function(e,t){this.selectedHistory!==t?(this.selectedHistory=t,e.parentElement.childNodes.forEach(function(e){return e.classList.remove(r.a.ACTIVE)}),e.classList.add(r.a.ACTIVE)):(this.selectedHistory=null,e.classList.remove(r.a.ACTIVE)),this.updateButtons()}},{key:"updateButtons",value:function(){this.enableStyle(void 0!==this.selectedHistory,this.btnCopy,r.a.ACTIVE),this.enableStyle(void 0!==this.selectedHistory,this.btnRevert,r.a.ACTIVE)}}]),t}(He.a),Zc=n(448),qc=n(514),$c=function(){function e(t,n,i){L()(this,e),this.separatorOnTop=!1,this.destroyMenuOnSelect=!0,this.overLarge=!1,this.id=t,this.title=n,this.icon=i}return w()(e,[{key:"setSubtitle",value:function(e,t){return this.subTitle=e,this.subTitleDirection=t,this}},{key:"setClassName",value:function(e){return this.className=e,this}},{key:"setSeparatorOnTop",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.separatorOnTop=!0===e,this}},{key:"setOverLarge",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.overLarge=!0===e,this}},{key:"setBottomMargin",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.bottomMargin=!0===e,this}},{key:"setDestroyMenuOnSelect",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.destroyMenuOnSelect=!0===e,this}}]),e}(),Qc=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,e,n,void 0))).on=i,a.destroyMenuOnSelect=!1,a}return z()(t,e),t}($c),Jc=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,e,n,void 0))).destroyMenuOnSelect=!1,i}return z()(t,e),t}($c),eu=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,e,n,void 0))).radioItems=i,a.destroyMenuOnSelect=!1,a}return z()(t,e),t}($c),tu=function(e){function t(e,n,i,a,o,s,r){var l;return L()(this,t),(l=V()(this,F()(t).call(this,!0))).toggleCheckboxMap=new Map,l.anchorElement=e,l.viewKey=n,l.title=i,l.showBackButton=a,l.showCloseButton=o,l.menuItems=s,l.onSelect=r,l}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className="".concat(r.a.TOOLS_TAB," ").concat(r.a.ACTIVE," ").concat(this.viewKey),this.backgroundElement=this.createBackgroundElement(),this.container.insertBefore(this.backgroundElement,this.container.childNodes.item(0));var n=Be.a.makeDivElement("scroll_element_wrapper");this.container.appendChild(n);var i=document.createElement("div");i.className="menu_scroll_view",n.appendChild(i),this.title&&this.fillTitle(i),this.fillTopElement(i),this.menuItems.forEach(function(t,n){0===n&&t.setSeparatorOnTop(!0);var a=e.createMenuView(t);e.onMenuItemViewCreated(t,a),i.appendChild(a)})}},{key:"createMenuView",value:function(e){if(e instanceof Qc){var t=Re.createToggleMenuItemView(e,this.onSelect),n=t.btnWrap,i=t.checkbox;return e.id&&this.toggleCheckboxMap.set(e.id,i),n}return e instanceof Jc?Re.createDepthMenuItemView(e,this.onSelect):e instanceof eu?Re.createRadioMenuItemView(e,this.onSelect):Re.createMenuItemView(e,this.onSelect)}},{key:"onChangeToggleItemValue",value:function(e,t){this.toggleCheckboxMap.has(e)&&(this.toggleCheckboxMap.get(e).checked=t)}},{key:"fillTitle",value:function(e){var t=this.createTitleElement();e.appendChild(t)}},{key:"createTitleElement",value:function(){var e=this,n=document.createDocumentFragment(),i=document.createElement("div");if(i.className="popup_title",this.showBackButton){var a=document.createElement("div");a.className="back_button",Object(ne.setToolsIcon)(a,ne.ToolsIcon.GREATER_THAN,!0,"left",180),a.addEventListener("click",function(n){n.stopPropagation(),e.onSelect(t.MI_BACK)}),i.appendChild(a)}return i.appendChild(Re.makeParagraph("menu_title",this.title)),this.showCloseButton&&(this.btnClose=Object(ne.setToolsIcon)(n,ne.ToolsIcon.CLOSE,!0),this.btnClose.addEventListener("click",this.closeHandler)),n.appendChild(i),n}},{key:"createBackgroundElement",value:function(){var e=this,n=document.createElement("div");return n.className="tab_background",this.closeHandler=function(n){n.stopPropagation(),e.onSelect(t.MI_CLOSE)},n.addEventListener("click",this.closeHandler),n}},{key:"fillTopElement",value:function(e){}},{key:"onMenuItemViewCreated",value:function(e,t){}},{key:"destroy",value:function(){he()(F()(t.prototype),"destroy",this).call(this),this.btnClose&&(this.closeHandler&&this.btnClose.removeEventListener("click",this.closeHandler),this.btnClose.parentElement&&this.btnClose.parentElement.removeChild(this.btnClose)),this.backgroundElement&&(this.closeHandler&&this.backgroundElement.removeEventListener("click",this.closeHandler),this.backgroundElement.parentElement&&this.backgroundElement.parentElement.removeChild(this.backgroundElement)),this.closeHandler=null,this.btnClose=null,this.backgroundElement=null}}]),t}(He.a);tu.MI_BACK=new $c("BACK",void 0,void 0),tu.MI_CLOSE=new $c("CLOSE",void 0,void 0);var nu,iu=function(){function e(){L()(this,e)}return w()(e,[{key:"showMenu",value:function(e,t){return this.onSelect=t,this.anchorElement=e,this.menuView=this.createMenuView(),document.body.appendChild(this.menuView.getContainer()),this.menuView}},{key:"refreshmenu",value:function(){this.destroyMenu(),this.showMenu(this.anchorElement,this.onSelect)}},{key:"setMenuVisibility",value:function(e){void 0!==this.menuView&&this.menuView.setVisibility(e)}},{key:"destroyMenu",value:function(){void 0!==this.menuView&&(this.menuView.destroy(),this.menuView=void 0),this.destroySubmenu()}},{key:"destroySubmenu",value:function(){void 0!==this.subMenuView&&(this.subMenuView.destroy(),this.subMenuView=void 0)}},{key:"createMenuItems",value:function(){var e=new Array;return this.fillMenuItems(e),e}},{key:"onSelectMenuItem",value:function(e,t){switch(e.destroyMenuOnSelect&&this.destroyMenu(),e.id){case tu.MI_CLOSE.id:case tu.MI_BACK.id:this.destroyMenu()}this.onSelect&&this.onSelect(e)}},{key:"onSelectMenuitemOnSubmenu",value:function(e,t){switch(e.id){case tu.MI_BACK.id:this.destroySubmenu(),this.setMenuVisibility(!0);break;case tu.MI_CLOSE.id:this.destroyMenu()}}}]),e}();!function(e){e.HEADER_RIGHT="header_right",e.BTN_SAVE_MY_LIBRARY="btn_save_my_library",e.BTN_MINI_SAVE_MY_LIBRARY="btn_mini_save_my_library",e.BTN_SAVE_CART="btn_save_cart",e.BTN_MINI_SAVE_CART="btn_mini_save_cart",e.BTN_DONE_UPDATE="btn_done_update",e.BTN_MINI_DONE_UPDATE="btn_mini_done_update",e.ICON_DDDOT="icon_dddot"}(nu||(nu={}));var au=n(77),ou=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"createMenuView",value:function(){return new tu(this.anchorElement,"editor_env_menu_view","에디터 환경",!0,!0,this.createMenuItems(),this.onSelectMenuItem.bind(this))}},{key:"fillMenuItems",value:function(e){e.push(new Qc(t.MI_SNAPGUIDE,"스냅 가이드",Ke.a.getUserSetting().isSnapGuideVisible)),e.push(new Qc(t.MI_SHOWONLYEDITAREA,"편집영역만 보기",Ke.a.getUserSetting().isOnlyShowEditorArea)),S.a.getAppHeaderOption().showElementBordersInGroup&&e.push(new Qc(t.MI_SHOWBORDERINGROUP,"그룹 내 요소 테두리 표시",!1)),e.push(new eu(t.MI_PAGINATIONMODE,"좌측 리스트 방식",[new be.a("스크롤",au.a.SCROLL,Ke.a.getUserSetting().leftPanelPaginationMode===au.a.SCROLL),new be.a("페이지",au.a.BUTTON,Ke.a.getUserSetting().leftPanelPaginationMode===au.a.BUTTON)]).setSeparatorOnTop())}},{key:"onSelectMenuItem",value:function(e,n){switch(he()(F()(t.prototype),"onSelectMenuItem",this).call(this,e,n),e.id){case t.MI_SNAPGUIDE:Ke.a.setSnapGuideVisible(n);break;case t.MI_SHOWONLYEDITAREA:Ke.a.setIsOnlyShowEditArea(n);break;case t.MI_SHOWBORDERINGROUP:X.a.instance.dispatch(new K.c(function(e,t){t.option.showElementBordersInGroup=n;var i=t.pageController.getPageRenderer(e.pages[t.renderPageIdx]);i&&i.updateHoverLayer()}));break;case t.MI_PAGINATIONMODE:Ke.a.setLeftPanelPaginationMode(n)}}}]),t}(iu);ou.MI_SNAPGUIDE="SNAPGUIDE",ou.MI_SHOWONLYEDITAREA="SHOWONLYEDITAREA",ou.MI_SHOWBORDERINGROUP="SHOWBORDERINGROUP",ou.MI_PAGINATIONMODE="PAGINATIONMODE";var su=new ou,ru=function(e){function t(){var e;return L()(this,t),e=V()(this,F()(t).call(this)),Ke.a.addListener(H()(e)),e}return z()(t,e),w()(t,[{key:"onChangeUserSetting",value:function(e,n){switch(n){case Yo.b.FIELD_IS_GUIDELINE_VISIBLE:this.menuView&&this.menuView.onChangeToggleItemValue(t.MI_SHOWGUIDELINE,e.isGuidelineVisible);break;case Yo.b.FIELD_IS_GUIDELINE_LOCK:this.menuView&&this.menuView.onChangeToggleItemValue(t.MI_LOCKGUIDELINE,e.isGuidelineLock)}}},{key:"createMenuView",value:function(){return new tu(this.anchorElement,"guideline_menu_view","가이드선",!0,!0,this.createMenuItems(),this.onSelectMenuItem.bind(this))}},{key:"fillMenuItems",value:function(e){e.push(new Qc(t.MI_SHOWGUIDELINE,"가이드선 보기",Ke.a.getUserSetting().isGuidelineVisible).setSubtitle("Ctrl + ;","left")),e.push(new Qc(t.MI_LOCKGUIDELINE,"가이드선 잠금",Ke.a.getUserSetting().isGuidelineLock).setSubtitle("Ctrl + Alt + ;","left")),Ke.a.getUserSetting().adminMode&&(e.push(new $c(t.MI_ADDHORIZGUIDELINE,"가로 가이드선 추가",void 0).setSeparatorOnTop().setDestroyMenuOnSelect(!1)),e.push(new $c(t.MI_ADDVERTGUIDELINE,"세로 가이드선 추가",void 0).setDestroyMenuOnSelect(!1))),e.push(new $c(t.MI_REMOVEGUIDELINE,"가이드선 초기화",void 0).setDestroyMenuOnSelect(!1))}},{key:"onSelectMenuItem",value:function(e,n){switch(he()(F()(t.prototype),"onSelectMenuItem",this).call(this,e,n),e.id){case t.MI_SHOWGUIDELINE:Ke.a.setIsGuidelineVisible(n);break;case t.MI_LOCKGUIDELINE:Ke.a.setIsGuidelineLock(n);break;case t.MI_ADDHORIZGUIDELINE:X.a.instance.dispatch(new Ls.c(R.d.HORIZONTAL)),Te.a.sendEvent("가이드선","가이드선 추가",e.title,!0);break;case t.MI_ADDVERTGUIDELINE:X.a.instance.dispatch(new Ls.c(R.d.VERTICAL)),Te.a.sendEvent("가이드선","가이드선 추가",e.title,!0);break;case t.MI_REMOVEGUIDELINE:X.a.instance.dispatch(new Ls.d),Te.a.sendEvent("가이드선","가이드선 전체 삭제",e.title,!0)}}}]),t}(iu);ru.MI_SHOWGUIDELINE="SHOWGUIDELINE",ru.MI_LOCKGUIDELINE="LOCKGUIDELINE",ru.MI_ADDHORIZGUIDELINE="ADDHORIZGUIDELINE",ru.MI_ADDVERTGUIDELINE="ADDVERTGUIDELINE",ru.MI_REMOVEGUIDELINE="REMOVEGUIDELINE";var lu=new ru,cu=function(e){function t(){var e;return L()(this,t),e=V()(this,F()(t).call(this)),Ke.a.addListener(H()(e)),e}return z()(t,e),w()(t,[{key:"onChangeUserSetting",value:function(e,n){if(this.menuView)switch(n){case Yo.b.FIELD_IS_LAYER_VISIBLE:this.menuView.onChangeToggleItemValue(t.MI_LAYER,e.isLayerVisible);break;case Yo.b.FIELD_IS_RULER_VISIBLE:this.menuView.onChangeToggleItemValue(t.MI_RULER,e.isRulerVisible)}}},{key:"createMenuView",value:function(){return new tu(this.anchorElement,r.a.SETTINGS_MENU_VIEW,"설정",!1,!0,this.createMenuItems(),this.onSelectMenuItem.bind(this))}},{key:"fillMenuItems",value:function(e){e.push(new Qc(t.MI_DARKMODE,"다크모드",Ke.a.getUserSetting().unicornTheme===Yo.a.BLACK)),e.push(new Qc(t.MI_LAYER,"레이어",Ke.a.getUserSetting().isLayerVisible).setSubtitle("Ctrl + Shift + Y","left").setClassName("show_layer_button").setSeparatorOnTop()),e.push(new Qc(t.MI_RULER,"눈금자 보기",Ke.a.getUserSetting().isRulerVisible).setSubtitle("Ctrl + Alt + R","left").setClassName("show_ruler_button").setSeparatorOnTop()),e.push(new Jc(t.MI_GUIDELINE,"가이드선")),e.push(new Jc(t.MI_EDITORENV,"에디터 환경")),S.a.getSettingOption().isAutoSaveVisible&&f.a.getUser().isLogin()&&e.push(new Qc(t.MI_AUTOSAVE,"자동 저장",Ke.a.getUserSetting().isAutoSave).setSeparatorOnTop()),S.a.getSettingOption().showPrintoutGuideSetting&&e.push(new Qc(t.MI_PRINTSAFETYGUIDE,"인쇄 안전 가이드",Y.a.instance.option.showPrintOutGuide).setSeparatorOnTop()),f.a.getUser().isAdmin()&&e.push(new Qc(t.MI_ADMINMODE,"관리자 모드",Ke.a.getUserSetting().adminMode).setSeparatorOnTop()),Ke.a.getUserSetting().adminMode&&e.push(new $c(t.MI_OPENTEMPLATEPROJECT,"템플릿 프로젝트 열기...",void 0).setSubtitle("Ctrl + Alt + E","right")),f.a.getUser().isAdmin()&&e.push(new Qc(t.MI_DEVMODE,"개발 모드",Ke.a.getUserSetting().devMode).setSeparatorOnTop())}},{key:"onSelectMenuItem",value:function(e,n){var i=this;switch(he()(F()(t.prototype),"onSelectMenuItem",this).call(this,e,n),e.id){case t.MI_DARKMODE:Ke.a.setUnicornTheme(n?Yo.a.BLACK:Yo.a.DEFAULT),X.a.instance.dispatch(new K.c(function(e,t,n){n.renderItemToolsByItem(t.activeItems,t)}));break;case t.MI_LAYER:Ke.a.setIsLayerVisible(n);break;case t.MI_RULER:Ke.a.setIsRulerVisible(n);break;case t.MI_GUIDELINE:this.setMenuVisibility(!1),this.subMenuView=lu.showMenu(this.anchorElement,this.onSelectMenuitemOnSubmenu.bind(this));break;case t.MI_EDITORENV:this.setMenuVisibility(!1),this.subMenuView=su.showMenu(this.anchorElement,this.onSelectMenuitemOnSubmenu.bind(this));break;case t.MI_AUTOSAVE:Ke.a.setAutoSave(n),Ke.a.getUserSetting().isAutoSave=n,Ke.a.getUserSetting().isAutoSaveForView=n;break;case t.MI_PRINTSAFETYGUIDE:Uo.setPrintoutGuideVisibility(n);break;case t.MI_ADMINMODE:Ke.a.setIsAdmin(n),this.refreshmenu();break;case t.MI_DEVMODE:Ke.a.setIsDev(n),X.a.instance.dispatch(new K.c(function(e,t,a){n?a.renderAuto(e,t):(Y.a.instance.option.showPrintOutGuide=!1,t.option.showPageMaskGuide=!1,a.canvasAreaVC.printout.hideAllPageGuide()),a.canvasAreaVC.printout.updateGuideVisible(),i.refreshmenu()}));break;case t.MI_OPENTEMPLATEPROJECT:X.a.instance.dispatch(new K.c(function(e,t,n){n.showTemplateProjectPanel()}))}}}]),t}(iu);cu.MI_DARKMODE="DARKMODE",cu.MI_LAYER="LAYER",cu.MI_RULER="RULER",cu.MI_GUIDELINE="GUIDELINE",cu.MI_EDITORENV="EDITORENV",cu.MI_AUTOSAVE="AUTOSAVE",cu.MI_PRINTSAFETYGUIDE="PRINTSAFETYGUIDE",cu.MI_ADMINMODE="ADMINMODE",cu.MI_OPENTEMPLATEPROJECT="OPENTEMPLATEPROJECT",cu.MI_DEVMODE="DEVMODE";var uu=new cu,du=n(127),hu=new(function(){function e(){L()(this,e)}return w()(e,[{key:"start",value:function(){void 0===this.mailboxVC&&(this.mailboxVC=new du.a(!1))}},{key:"getMailboxFloatingButton",value:function(){return this.mailboxVC&&this.mailboxVC.getMailboxFloatingButton()}},{key:"showMailboxIfRequired",value:function(){this.mailboxVC&&this.mailboxVC.setActive(S.a.getCanvasAreaOption().showMessageBoxBtn)}},{key:"openMailbox",value:function(){this.mailboxVC&&this.mailboxVC.open()}}]),e}()),pu=n(120),mu=n(34),fu=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;L()(this,e),this.defaultValue="",this.globalCloseEventName="click.".concat(d.b.random()),this.changeAction=t,this.maxLength=n,this.makeElement(),this.bindEvent()}return w()(e,[{key:"setDefaultValue",value:function(e){this.defaultValue=e}},{key:"makeElement",value:function(){this.element=document.createElement("div"),this.element.className=r.a.CONTENT_EDITABLE_ELEMENT,this.editableElement=document.createElement("p"),this.element.appendChild(this.editableElement),Object(ne.setToolsIcon)(this.element,ne.ToolsIcon.PENCIL,!0)}},{key:"bindEvent",value:function(){var e=this;$(this.editableElement).on("click",function(t){t.stopPropagation(),e.startEdit()}).on("keydown",function(t){t.stopPropagation(),13===t.keyCode&&e.endEdit()}).on("focusout",function(){return e.endEdit()})}},{key:"startEdit",value:function(){var e=this;$(document.body).off(this.globalCloseEventName).trigger("click"),$(document.body).on(this.globalCloseEventName,function(){return e.endEdit()}),"true"!==this.editableElement.contentEditable&&(this.editableElement.contentEditable="true",this.editableElement.classList.add(r.a.CONTENTEDITABLE),this.editableElement.focus(),document.execCommand("selectAll"))}},{key:"endEdit",value:function(){$(document.body).off(this.globalCloseEventName),window.getSelection().removeAllRanges(),this.editableElement.blur(),this.editableElement.scrollLeft=0,this.editableElement.contentEditable="false",this.editableElement.classList.remove(r.a.CONTENTEDITABLE);var e=this.editableElement.innerText;e.length>this.maxLength&&(e=e.substring(0,this.maxLength)),this.inputValue!==e&&(this.render(e),this.changeAction(e))}},{key:"render",value:function(e){return e&&(this.inputValue=e,this.editableElement.innerText=e,this.editableElement.title=e,e===this.defaultValue?this.element.classList.add("default_value"):this.element.classList.remove("default_value")),this.element}}]),e}(),vu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return L()(this,t),(e=V()(this,F()(t).call(this,!0))).text=n,e.container.className="default_profile",e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.textElem=document.createElement("div"),this.textElem.className="default_profile_text",this.textElem.innerText=this.text?this.text.substring(0,2):"",this.setColorClass(this.text),this.container.appendChild(this.textElem)}},{key:"addEventListener",value:function(e,t){this.container.addEventListener(e,t)}},{key:"setColorClass",value:function(e){this.container.className="default_profile","유니콘"===e?this.container.classList.add("unicorn"):"비즈하우스"===e?this.container.classList.add("bizhows"):"스마일캣"===e?this.container.classList.add("smilecat"):"미리디"===e&&this.container.classList.add("miridih")}}]),t}(He.a),gu=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this,e,r.a.FILE_MENU_VIEW,void 0,!1,!1,n,i))).designSaveStatusViewList=[],o.onChangeDesignDocTitle=a,o}var n;return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.createProfileElement()}},{key:"onMenuItemViewCreated",value:function(e,n){if(e.id===t.MI_SAVE||e.id===t.MI_SAVEINDESGINLIBRARY)this.designSaveStatusViewList.push({menuItem:e,menuItemView:n});else if(e.id===t.MI_MAILBOX){var i=pu.a.createUnreadIcon();pu.a.addCommonUnreadIcon(i,!0),n.appendChild(i)}}},{key:"fillTopElement",value:function(e){var n=this;this.userAndTitleContainer=document.createElement("div"),this.userAndTitleContainer.className=r.a.USER_INFO,this.requireLoginLabel=document.createElement("div"),this.requireLoginLabel.innerText="로그인하기",this.requireLoginLabel.className="require_login",this.docInfoContainer=document.createElement("div"),this.docInfoContainer.className="doc_info_wrap",this.editTextDocTitle=new fu(function(e){return n.onChangeDesignDocTitle(e)}),this.editTextDocTitle.render().classList.add("doc_title"),this.docSize=document.createElement("div"),this.docSize.className="doc_size",this.docInfoContainer.appendChild(this.editTextDocTitle.render()),this.docInfoContainer.appendChild(this.docSize),this.userAndTitleContainer.appendChild(this.docInfoContainer),this.userAndTitleContainer.addEventListener("click",function(){f.a.getUser().isLogin()||n.onSelect(t.MI_LOGIN)}),e.appendChild(this.userAndTitleContainer)}},{key:"createProfileElement",value:(n=s()(a.a.mark(function e(){var n,i,o,s,r,l=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.a.getUser().isLogin(),(i=document.createElement("button")).type="button",e.prev=3,!n){e.next=10;break}return e.next=7,m.a.fetchSelTeamDetail(f.a.getUser().accountId);case 7:e.t0=e.sent.getName(),e.next=11;break;case 10:e.t0=null;case 11:o=e.t0,e.next=18;break;case 14:e.prev=14,e.t1=e.catch(3),console.error(e.t1),o=n?f.a.getUser().getName():null;case 18:if(s=this.makeAvatar(n,o),i.appendChild(s),this.userAndTitleContainer.innerHTML="",this.userAndTitleContainer.appendChild(i),i.addEventListener("click",function(){return l.onSelect(t.MI_USER)}),n){e.next=26;break}return this.userAndTitleContainer.appendChild(this.requireLoginLabel),e.abrupt("return");case 26:this.editTextDocTitle.render(le.a.get().getTitle()),this.docSize.innerHTML="",Y.a.instance.option.pageSize&&(this.docSize.appendChild(us.a.makeSpan(Y.a.instance.option.pageSize.toString())),this.userAndTitleContainer.appendChild(this.docInfoContainer)),this.userAndTitleContainer.appendChild(this.docInfoContainer),m.a.getSelectedTeamScope()===mu.b.TEAM&&((r=document.createElement("div")).className="doc_type",r.setAttribute("data-type",m.a.getSelectedTeamScope()),this.userAndTitleContainer.appendChild(r));case 31:case"end":return e.stop()}},e,this,[[3,14]])})),function(){return n.apply(this,arguments)})},{key:"updateDesignSaveStatus",value:function(){var e=this,t=f.a.getUser().isLogin()?Ht.a.getSaveStatusDisplayTitle():"";this.designSaveStatusViewList.forEach(function(n){var i=n.menuItem,a=n.menuItemView;if(a.parentElement){i.setSubtitle(t,i.subTitleDirection);var o=e.createMenuView(i);a.parentElement.insertBefore(o,a),a.parentElement.removeChild(a),n.menuItemView=o}})}},{key:"makeAvatar",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=document.createElement("div");if(n.className=e?"avatar ".concat(r.a.LOGIN_USER):"favicon",e){var i=new vu(t).getContainer();n.appendChild(i)}else Object(ne.setToolsIcon)(n,ne.ToolsIcon.USER_PROFILE);return n}},{key:"destroy",value:function(){he()(F()(t.prototype),"destroy",this).call(this),this.designSaveStatusViewList=null}}]),t}(tu);gu.MI_USER=new $c("USER",void 0,void 0),gu.MI_LOGIN=new $c("LOGIN",void 0,void 0),gu.MI_NEWDESIGN="btnNewDesign",gu.MI_COPYDESIGN="btnCopyDesign",gu.MI_SAVE="btnSave",gu.MI_PRINTOUTPRODUCTION="fileTabMakePrint",gu.MI_DOWNLOAD="fileTabDownload",gu.MI_SHARE="fileTabShare",gu.MI_NEWPROJECT="btnNewProject",gu.MI_CHANGEPAGESIZE="fileTabResizeSheet",gu.MI_SAVEINDESGINLIBRARY="SAVEINDESGINLIBRARY",gu.MI_SAVEINCART="SAVEINCART",gu.MI_UPDATEDONE="UPDATEDONE",gu.MI_DESIGNHISTORY="fileTabDesignHistory",gu.MI_SLIDESHOW="fileTabPresent",gu.MI_SETTING="fileTabSetting",gu.MI_MAILBOX="MAILBOX",gu.MI_HELPCENTER="btnCenterMenu",gu.MI_MYSPACE="btnMyspace";var Eu=new(function(e){function t(){var e;return L()(this,t),e=V()(this,F()(t).call(this)),Ht.a.addListener(H()(e)),e}var n;return z()(t,e),w()(t,[{key:"createMenuView",value:function(){return new gu(this.anchorElement,this.createMenuItems(),this.onSelectMenuItem.bind(this),this.onChangeDesignDocTitle.bind(this))}},{key:"fillMenuItems",value:function(e){S.a.getAppHeaderOption().makeNewDocument&&e.push(new $c(gu.MI_NEWDESIGN,"새 문서 만들기",ne.ToolsIcon.NEW_FILE)),S.a.getAppHeaderOption().copyDocument&&e.push(new $c(gu.MI_COPYDESIGN,"복사본 만들기",ne.ToolsIcon.COPY)),S.a.getAppHeaderOption().saveToMySpace&&e.push(new $c(gu.MI_SAVE,"저장하기",ne.ToolsIcon.SAVE).setSubtitle(Ht.a.getSaveStatusDisplayTitle(),"left")),S.a.getAppHeaderOption().printoutProduction&&e.push(new $c(gu.MI_PRINTOUTPRODUCTION,"인쇄물 제작하기",ne.ToolsIcon.CART_OUTLINE).setSeparatorOnTop()),S.a.getAppHeaderOption().download&&e.push(new $c(gu.MI_DOWNLOAD,"다운로드",ne.ToolsIcon.DOWNLOAD).setOverLarge()),S.a.getAppHeaderOption().share&&e.push(new $c(gu.MI_SHARE,"공유하기",ne.ToolsIcon.SHARE).setOverLarge()),f.a.getUser().isAdmin()&&e.push(new $c(gu.MI_NEWPROJECT,"새 프로젝트 만들기",ne.ToolsIcon.PROJECT).setSeparatorOnTop()),S.a.getAppHeaderOption().resizePage&&e.push(new $c(gu.MI_CHANGEPAGESIZE,"크기조정",ne.ToolsIcon.RULER).setSeparatorOnTop().setOverLarge()),S.a.getAppHeaderOption().saveToDesignLibrary&&e.push(new $c(gu.MI_SAVEINDESGINLIBRARY,"저장",ne.ToolsIcon.INBOX_OUTLINE).setClassName(nu.BTN_SAVE_MY_LIBRARY).setSubtitle(Ht.a.getSaveStatusDisplayTitle(),"left").setSeparatorOnTop()),S.a.getAppHeaderOption().saveToCart&&e.push(new $c(gu.MI_SAVEINCART,"장바구니 추가",ne.ToolsIcon.CART_OUTLINE).setClassName(nu.BTN_SAVE_CART)),(S.a.getAppHeaderOption().saveUpdatedFromDesignLibrary||S.a.getAppHeaderOption().saveUpdatedFromCart)&&e.push(new $c(gu.MI_UPDATEDONE,"수정 완료",ne.ToolsIcon.CHECK).setClassName(nu.BTN_DONE_UPDATE).setSubtitle(Ht.a.getSaveStatusDisplayTitle(),"left").setSeparatorOnTop()),e.push(new $c(gu.MI_DESIGNHISTORY,"작업내역",ne.ToolsIcon.RESTORE).setSeparatorOnTop()),S.a.getAppHeaderOption().presentation&&e.push(new $c(gu.MI_SLIDESHOW,"슬라이드 쇼",ne.ToolsIcon.PRESENTATION)),e.push(new $c(gu.MI_SETTING,"설정",ne.ToolsIcon.SETTINGS).setSeparatorOnTop(!je.a.isMobilePortraitSize()).setOverLarge()),S.a.getAppHeaderOption().messageBox&&e.push(new $c(gu.MI_MAILBOX,"우편함",ne.ToolsIcon.EMAIL).setSeparatorOnTop().setOverLarge()),je.a.isMobilePortraitSize()&&e.push(new $c(gu.MI_HELPCENTER,"도움말",ne.ToolsIcon.HELP).setClassName(r.a.HELP_CENTER)),S.a.getAppHeaderOption().moveToMySpace&&e.push(new $c(gu.MI_MYSPACE,"마이 스페이스",ne.ToolsIcon.USER_OUTLINE).setSeparatorOnTop().setBottomMargin())}},{key:"onSelectMenuItem",value:function(e,n){switch(he()(F()(t.prototype),"onSelectMenuItem",this).call(this,e,n),e.id){case gu.MI_LOGIN.id:f.a.getUser().isLogin()||Ye.a.openLoginPopup(Ie.a.USER_MENU);break;case gu.MI_USER.id:f.a.getUser().isLogin()&&(location.href=l.d.getUrlWithHash(f.a.getUser().accountId));break;case gu.MI_NEWDESIGN:this.onNewDesignDocSelected();break;case gu.MI_COPYDESIGN:this.onSelectCopyDesign();break;case gu.MI_SAVE:Ye.a.openLoginPopup(Ie.a.SAVE)||C.a.save({categoryIdx:Wt.a.getSaveCategoryIdx()});break;case gu.MI_PRINTOUTPRODUCTION:Lu.onSelectPrintoutProduction();break;case gu.MI_DOWNLOAD:Lu.onSelectDownload();break;case gu.MI_SHARE:Lu.onSelectShare();break;case gu.MI_NEWPROJECT:this.onSelectNewProject();break;case gu.MI_CHANGEPAGESIZE:this.onSelectChangePageSize();break;case gu.MI_SAVEINDESGINLIBRARY:Lu.onSelectSave();break;case gu.MI_SAVEINCART:Lu.onSelectSaveToCart();break;case gu.MI_UPDATEDONE:Lu.onSelectUpdateDone();break;case gu.MI_DESIGNHISTORY:this.onSelectDesignHistory();break;case gu.MI_SLIDESHOW:this.onSelectSlideShow();break;case gu.MI_MAILBOX:hu.openMailbox();break;case gu.MI_HELPCENTER:X.a.instance.dispatch(new K.c(function(e,t,n){n.helpCenterVC.openHelpPopup()}));break;case gu.MI_MYSPACE:Ye.a.openLoginPopup(Ie.a.MOVE_MYSPACE)||(location.href=l.d.getUrlWithHash(f.a.getUser().accountId));break;case gu.MI_SETTING:this.destroyMenu(),uu.showMenu(this.anchorElement)}}},{key:"onChangeDesignSaveStatus",value:function(e){this.menuView&&this.menuView.updateDesignSaveStatus()}},{key:"onChangeDocumentTitle",value:function(e){}},{key:"onSelectCopyDesign",value:function(){gc.a.check(Xo.b.COPY_DESIGN,s()(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ye.a.openLoginPopup(Ie.a.COPY_DESIGN)){e.next=8;break}if((t=le.a.get()).isLoaded()&&Ht.a.isSaveComplete()){e.next=7;break}return alert("디자인을 저장 중입니다. 잠시 후 다시 복사해 주세요."),e.next=6,C.a.save({categoryIdx:Wt.a.getSaveCategoryIdx()});case 6:return e.abrupt("return");case 7:Gc.a.openCopyDesignWindow(t.getIdx(),f.a.getUser().accountId).catch(function(e){0});case 8:case"end":return e.stop()}},e)})))}},{key:"onSelectChangePageSize",value:function(){var e=this;if(this.destroyMenu(),je.a.isMobilePortraitSize()){this.pageSizeSettingVCContainer=document.createElement("div"),this.pageSizeSettingVCContainer.className="".concat(r.a.TOOLS_TAB," ").concat(r.a.RESIZE_SHEET_VIEW," ").concat(r.a.ACTIVE),this.pageSizeSettingVCContainer.addEventListener("touchend",function(e){return e.stopPropagation()});var t=document.createElement("div");t.className="tab_background",t.addEventListener("click",this.onSelectPageSize.bind(this)),this.pageSizeSettingVCContainer.appendChild(t),this.pageSizeSettingVC=new hc(this),this.pageSizeSettingVC.loadTemplateTypeList(Ke.a.getUserSetting().adminMode?an.b.ALL:an.b.SHEET_SIZE,function(){setTimeout(s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.a.instance.dispatch(new K.c(function(t,n){e.pageSizeSettingVC.dispatchSheetSizeUpdate(Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().adminMode,t.pages[0].sheetSize,n.option.pageSize),t.templateType&&e.pageSizeSettingVC.selectTemplateType(new an.c(t.templateType.id),!1,Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().adminMode)}));case 2:case"end":return t.stop()}},t)})))}),this.pageSizeSettingVCContainer.appendChild(this.pageSizeSettingVC.getContainer()),document.body.appendChild(this.pageSizeSettingVCContainer)}}},{key:"onSelectPageSize",value:function(){y.a.scrollOn(),this.pageSizeSettingVC&&(this.pageSizeSettingVC.destroy(),this.pageSizeSettingVC=null),this.pageSizeSettingVCContainer&&this.pageSizeSettingVCContainer.parentElement&&(this.pageSizeSettingVCContainer.parentElement.removeChild(this.pageSizeSettingVCContainer),this.pageSizeSettingVCContainer=null)}},{key:"onSelectNewProject",value:function(){Ye.a.openLoginPopup(Ie.a.NEW_PROJECT)||s()(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Zc.a.createDesignProject({title:"제목을 입력해주세요."},f.a.getUser().accountId);case 3:t=e.sent,window.open(Fc.a.getDesignProjectUrl(t.idx),"_blank"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),alert("디자인 프로젝트 생성에 실패하였습니다.\n잠시후 다시 시도해 주시기 바랍니다.");case 11:case"end":return e.stop()}},e,null,[[0,7]])}))()}},{key:"onSelectSlideShow",value:function(){gc.a.check(Xo.b.PRESENTATION,function(){X.a.instance.dispatch(new K.c(function(e){(new qc.a).play(e).catch(function(e){return console.error(e)})}))})}},{key:"onChangeDesignDocTitle",value:function(e){this.destroyMenu(),d.b.isEmpty(e.trim())&&(e=le.a.get().getTitle()),Ye.a.openLoginPopup(Ie.a.CHANGE_PROJECT_TITLE,function(){C.a.setTitle(e,le.a.get().getTitle())})}},{key:"onSelectDesignHistory",value:function(){var e=this;Ye.a.openLoginPopup(Ie.a.HISTORY,s()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==(n=le.a.get().getIdx())){t.next=5;break}return t.next=4,C.a.save({categoryIdx:Wt.a.getSaveCategoryIdx()});case 4:n=le.a.get().getIdx();case 5:0===n?alert("문서가 저장되지 않았습니다."):new jc(S.a.getAppHeaderOption().showHistoryCopyButton,n).moveBelowElement(e.anchorElement);case 6:case"end":return t.stop()}},t)})))}},{key:"onNewDesignDocSelected",value:(n=s()(a.a.mark(function e(){var t,n,i,o,s=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.templateTypeSelectVC=new dc.a(this,an.b.SHEET_SIZE,"새 디자인 만들기",!1),this.templateTypeSelectVCContainer=document.createElement("div"),this.templateTypeSelectVCContainer.className=r.a.NEW_DESIGN_SIZE_VIEW,this.templateTypeSelectVCContainer.tabIndex=-1,this.templateTypeSelectVCContainer.appendChild(this.templateTypeSelectVC.getContainer()),document.body.appendChild(this.templateTypeSelectVCContainer),e.next=8,X.a.instance.dispatch(new K.c(function(e,t){s.templateTypeSelectVC.dispatchSheetSizeUpdate(Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().adminMode,e.pages[0].sheetSize,t.option.pageSize)}));case 8:y.a.scrollOff(),t="click.".concat(d.b.random()),n="mousedown.".concat(d.b.random()),i="mousedown.".concat(d.b.random()),this.templateTypeSelectVCContainer.classList.add(r.a.ACTIVE),o=!1,$(this.templateTypeSelectVCContainer).on(i,function(e){e.stopPropagation(),o=!0}),$(this.templateTypeSelectVCContainer).on("click keydown",function(e){return e.stopPropagation()}),this.templateTypeSelectVCContainer.focus({preventScroll:!0}),$(document.body).on(n,function(){o=!1}),$(document.body).on(t,function(){o||(y.a.scrollOn(),$(document.body).off(t).off(n).trigger("click"),$(s.templateTypeSelectVCContainer).off(i),s.templateTypeSelectVCContainer.classList.remove(r.a.ACTIVE),s.templateTypeSelectVCContainer.parentElement&&s.templateTypeSelectVCContainer.parentElement.removeChild(s.templateTypeSelectVCContainer))}),this.initTemplateTypeList(!0);case 20:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"initTemplateTypeList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Ke.a.getUserSetting().adminMode?an.b.ALL:an.b.SHEET_SIZE,n=e?No.c.get(No.b.TEMPLATE_TYPE_ID):void 0;this.templateTypeSelectVC.initTemplateTypeList(t,n)}},{key:"onSelectTemplateType",value:function(e,t){y.a.scrollOn(),this.templateTypeSelectVCContainer.classList.remove(r.a.ACTIVE);var n=e.getPixelLimitMax(xo.a.getMaxSheetSize(Ke.a.getUserSetting().devMode)),i=(new No.a).set(No.b.SHEET_W,String(n.width)).set(No.b.SHEET_H,String(n.height)).set(No.b.TEMPLATE_TYPE_ID,t?t.id:"");e.unit!==De.a.PX&&i.set(No.b.SIZE_UNIT,e.unit).set(No.b.DPI,String(e.dpi)),window.open("".concat(S.a.getUrlBasePath(),"design?").concat(i.serialize()),"_blank")}}]),t}(iu)),yu=n(72),Tu=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ns.a(0,0),a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"320px",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"454px";return L()(this,t),(n=V()(this,F()(t).call(this,"전문가에게 교정 요청하기",i,a,void 0,o,s))).onClickButton=e,n.openOffset=i,n}return z()(t,e),t}(yu.a),Iu=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).state=new yu.b,n.onClickButton=n.onClickButton.bind(H()(n)),n}return z()(t,e),w()(t,[{key:"onClickButton",value:function(){this.props.onClickButton&&this.props.onClickButton()}},{key:"getUniqueClassName",value:function(){return"design_retouching_service"}},{key:"getCssStyle",value:function(){return{left:"auto",top:"60px",right:"16px",bottom:"auto",transform:"none",width:this.props.width,height:this.props.height}}},{key:"renderBody",value:function(){return ra.a.createElement("div",{className:yu.c},ra.a.createElement(pa.a,null,ra.a.createElement("div",null,ra.a.createElement("div",null,ra.a.createElement("img",{src:"".concat(fs.a.RESOURCE_DOMAIN,"image/popup/design_retouching_service/디자인교정요청.jpg"),alt:"디자인 이미지"})),ra.a.createElement("div",{className:"design_retouching_service_title"},ra.a.createElement("span",null,"디자인 리터치 서비스"),ra.a.createElement(Dc,{color:"#00ccbb",text:"추천"})),ra.a.createElement("div",{className:"design_retouching_service_contents"},"현재 편집중이거나 완성된 디자인도 최상의 퀄리티로 바꿔드려요! 전문가의 완성도 높은 리터치를 받아보세요!"),ra.a.createElement(Lc.c,{onClick:this.onClickButton,buttonStyle:Lc.b.PRIMARY,bold:!0},"디자인 교정 요청하기"))))}}]),t}(yu.e),Cu=function(){function e(){L()(this,e)}return w()(e,[{key:"onSelectExportMenuItem",value:function(t){switch(this.closeExportMenuPopup(),t){case e.MI_SPECIFICPRINTOUTPRODUCTION:Lu.onSelectPrintoutProduction(this.productionType);break;case e.MI_DOWNLOAD:Lu.onSelectDownload();break;case e.MI_SHARE:Lu.onSelectShare();break;case e.MI_SLIDESHOW:Eu.onSelectSlideShow();break;case e.MI_PRINTOUTPRODUCTION:Lu.onSelectPrintoutProduction();break;case e.MI_DESIGNRETOUCHINGSERVICE:this.onSelectDesignRetouchingService()}}},{key:"onSelectDesignRetouchingService",value:function(){var e=new Fo.a(document.body,Iu,new Tu(function(){Ye.a.openLoginPopup(Ie.a.DESIGN_RETOUCHING_SERVICE,function(){return fl.submitDesignToUrlAfterSavingDesign("".concat("http://www.bizhows.com","/mall/option/design_request_option.jsp?pog_seq=1456&site_map_idx=40302"))}),e.destroy()},void 0,function(){return e.destroy()}),!0)}},{key:"makeSpecificPrintoutProductionMenuItem",value:function(t,n,i){return new Mc(this.onSelectExportMenuItem.bind(this),e.MI_SPECIFICPRINTOUTPRODUCTION,"".concat(n," 제작하기"),fc.a.getTypeStringWithLowerCase(t),void 0,i)}},{key:"makeDownloadMenuItem",value:function(){return new Mc(this.onSelectExportMenuItem.bind(this),e.MI_DOWNLOAD,"다운로드",void 0,ne.ToolsIcon.DOWNLOAD)}},{key:"makeShareMenuItem",value:function(){return new Mc(this.onSelectExportMenuItem.bind(this),e.MI_SHARE,"공유하기",void 0,ne.ToolsIcon.SHARE)}},{key:"makeSlideShowMenuItem",value:function(){return new Mc(this.onSelectExportMenuItem.bind(this),e.MI_SLIDESHOW,"슬라이드쇼 보기",void 0,ne.ToolsIcon.PRESENTATION)}},{key:"makePrintoutProductionMenuItem",value:function(t){return new Mc(this.onSelectExportMenuItem.bind(this),e.MI_PRINTOUTPRODUCTION,"인쇄물 제작하기",void 0,ne.ToolsIcon.CART_OUTLINE,t)}},{key:"makeDesignRetouchingServiceMenuItem",value:function(t){return new Mc(this.onSelectExportMenuItem.bind(this),e.MI_DESIGNRETOUCHINGSERVICE,"전문가에게 교정 요청하기",void 0,ne.ToolsIcon.PEN_RULER,t)}},{key:"createMenuItems",value:function(e,t){var n=new Array;return e?(n.push(this.makeSpecificPrintoutProductionMenuItem(e,t,new Pc("#00ccbb","추천"))),n.push(this.makeDownloadMenuItem()),n.push(this.makeShareMenuItem()),n.push(this.makeSlideShowMenuItem()),n.push(this.makePrintoutProductionMenuItem()),n.push(this.makeDesignRetouchingServiceMenuItem())):(n.push(this.makePrintoutProductionMenuItem(new Pc("#a058ff","인기"))),n.push(this.makeDesignRetouchingServiceMenuItem(new Pc("#00ccbb","추천"))),n.push(this.makeDownloadMenuItem()),n.push(this.makeShareMenuItem()),n.push(this.makeSlideShowMenuItem())),n}},{key:"closeExportMenuPopup",value:function(){this.reactDomView&&this.reactDomView.destroy()}},{key:"openExportMenuPopup",value:function(e,t,n){this.productionType=t,this.reactDomView=new Fo.a(document.body,Uc,new Vc(this.createMenuItems(t,n),this.closeExportMenuPopup.bind(this),e),!0)}}]),e}();Cu.MI_SPECIFICPRINTOUTPRODUCTION="specificPrintoutProduction",Cu.MI_DOWNLOAD="download",Cu.MI_SHARE="share",Cu.MI_SLIDESHOW="slideShow",Cu.MI_PRINTOUTPRODUCTION="printoutProduction",Cu.MI_DESIGNRETOUCHINGSERVICE="designRetouchingService";var ku=new Cu,Lu=new(function(){function e(){L()(this,e),this.disabledUnmodifiedPagePopup=!1,Ht.a.addListener(this)}var t;return w()(e,[{key:"setHeaderBarLeftVC",value:function(e){this.headerBarLeftVC=e}},{key:"setHeaderBarRightVC",value:function(e){this.headerBarRightVC=e}},{key:"onChangeDesignSaveStatus",value:function(e){this.headerBarRightVC&&this.headerBarRightVC.renderView()}},{key:"onChangeDocumentTitle",value:function(e){this.headerBarLeftVC&&this.headerBarLeftVC.renderView()}},{key:"leaveEditor",value:function(){Y.a.instance.checkConfirmWhenLeaveEditor=!1,S.a.getAppHeaderOption().historyBack?window.history.back():window.location.href="/myspace"}},{key:"onSelectBack",value:function(e){var t=this;if(Ht.a.isSaveRequire()){if(!Y.a.instance.checkConfirmWhenLeaveEditor)return;var n=function(){var e=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ye.a.openLoginPopup(Ie.a.BACK)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,C.a.save({categoryIdx:Wt.a.getSaveCategoryIdx()});case 4:t.leaveEditor();case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();(new mc.a).setImg(pc.b.ARGO_EMBARRASSED).setSubtitle("저장하지 않고 페이지를 나가면\n현재까지 작업한 디자인이 사라져요.").addButton("저장하지 않고 나가기",this.leaveEditor,!0,Lc.b.SECONDARY,3).addButton("저장하고 나가기",n,!0,Lc.b.PRIMARY,2.5).activateXCloseButton().activateShowingUpFromBottomOnMobile().show()}else S.a.getAppHeaderOption().historyBack?window.history.back():Ye.a.openLoginPopup(Ie.a.BACK)||(e.href="/myspace"),e.style.pointerEvents="none",window.setTimeout(function(){e&&(e.style.pointerEvents="")},1e3)}},{key:"onSelectDownload",value:function(){var e=this;ze.instance.addDownloadButtonEventListener(function(){wc.a.instance.addStartEventListener(function(){e.headerBarRightVC&&e.headerBarRightVC.updateDownloadingStatus(!0)}),wc.a.instance.addCancelEventListener(function(){e.headerBarRightVC&&e.headerBarRightVC.updateDownloadingStatus(!1),Sc.a.cancel()}),Sc.a.addDownloadDoneEventList(function(){e.headerBarRightVC&&e.headerBarRightVC.updateDownloadingStatus(!1),wc.a.instance.close()})}),gc.a.check(Xo.b.DOWNLOAD,function(){ze.instance.setPositionOffsetElement(e.headerBarRightVC.getBtnDownload()),ze.instance.setOnPrintoutButtonClickListener(function(){e.onSelectPrintoutProduction()}),X.a.instance.dispatch(new K.c(function(t){ze.instance.open(Be.a.calculatePopupOffset(e.headerBarRightVC.getBtnDownload()),t.pages.length)}))})}},{key:"onSelectShare",value:function(){var e=this;gc.a.check(Xo.b.SHARE,function(){vc.a.setPositionOffsetElement(e.headerBarRightVC.getBtnShare());var t=Be.a.calculatePopupOffset(e.headerBarRightVC.getBtnShare());f.a.getUser().isLogin()&&s()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.save({categoryIdx:Wt.a.getSaveCategoryIdx()});case 2:Ht.a.isSaveComplete()?(n=le.a.get().getIdx(),vc.a.open(n,t)):alert("문서가 완전히 저장되지 않았습니다.");case 3:case"end":return e.stop()}},e)}))(),vc.a.open(null,t)})}},{key:"onSelectSave",value:(t=s()(a.a.mark(function e(){var t=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:gc.a.check(Xo.b.SAVE,s()(a.a.mark(function e(){var n,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.save({categoryIdx:Wt.a.getSaveCategoryIdx()});case 2:if(Ht.a.isSaveComplete()){e.next=5;break}return alert("문서가 완전히 저장되지 않았습니다."),e.abrupt("return");case 5:n=document.createElement("span"),(i=document.createElement("div")).classList.add("round_icon"),Object(ne.setToolsIcon)(i,ne.ToolsIcon.CHECK),n.appendChild(i),t.pusher=t.pusher?t.pusher:new Dr.a({allowSameType:!1}),o={type:zo.b.CUSTOM,customTypeElement:n,title:"저장 완료",content:"저장한 디자인은 나의 디자인함에서 확인할 수 있어요."},t.pusher.pushNotification(o,5e3);case 13:case"end":return e.stop()}},e)})));case 1:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)})},{key:"onSelectSaveToCart",value:function(){this.checkUnmodifiedPage()||gc.a.check(Xo.b.SAVE,function(){Y.a.instance.editorMainVC.showPrintoutConfirmView()})}},{key:"onSelectPrintoutProduction",value:function(e){Ac.onShowPrintoutProductionPopup(this.headerBarRightVC.getBtnPrintoutProduction(),e)}},{key:"onSelectExport",value:function(e){var t=vl.a.getDesignDoc(),n=t?t.templateType:void 0,i=n?fc.a.getTypeFromTemplateTypeId(n.id):void 0,a=Oc.a.getProductionNameByType(i);ku.openExportMenuPopup(e,i,a)}},{key:"onSelectUpdateDone",value:function(){this.checkUnmodifiedPage()||Y.a.instance.editorMainVC.showPrintoutConfirmView()}},{key:"onSelectUndo",value:function(){X.a.instance.dispatch(new K.c(function(){var e=s()(a.a.mark(function e(t,n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return X.a.instance.rollback(),Ht.a.initStatusByAction(),e.next=4,(new se.d).commitAction(t,n,i);case 4:return e.next=6,i.renderAll(t,n);case 6:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}()))}},{key:"onSelectRedo",value:function(){X.a.instance.dispatch(new K.c(function(){var e=s()(a.a.mark(function e(t,n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return X.a.instance.redo(),Ht.a.initStatusByAction(),e.next=4,i.renderAll(t,n);case 4:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}()))}},{key:"checkUnmodifiedPage",value:function(){var e=this;if(!S.a.getPopupOption().findUnmodifiedPage||!Ec.unmodifiedPageInspection()||this.disabledUnmodifiedPagePopup)return!1;var t=Y.a.instance.editorMainVC.canvasAreaVC.pageVCS[Ec.getUnmodifiedPageIndex()].page.title||"";return(new _c).setImg(pc.b.ARGO_STOP).setTitle("아직 편집하지 않은 디자인이 있어요!").setSubtitle('"'.concat(t,'" 디자인을 확인해주세요.')).setAnimationType(pc.a.BOUNCE).setCheckButtonLabel("더 이상 보지 않기").addButton("확인하러 가기",function(t){e.gotoUnmodifiedPage(),e.disabledUnmodifiedPagePopup=t}).activateModal().show(),!0}},{key:"gotoUnmodifiedPage",value:function(){X.a.instance.dispatch(new K.c(function(e,t,n){n.canvasAreaVC.scrollToPage(Ec.getUnmodifiedPageIndex())}))}}]),e}()),_u=function(e){function t(){var e;return L()(this,t),e=V()(this,F()(t).call(this,!0)),Lu.setHeaderBarLeftVC(H()(e)),e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className="header_left",je.a.isMobileDevice()&&this.container.classList.add(r.a.MOBILE);var n=document.createElement("a");n.className="back_btn large",Object(ne.setToolsIcon)(n,ne.ToolsIcon.MOVE_LEFT),n.addEventListener("click",function(){return Lu.onSelectBack(n)});var i=document.createElement("a");i.className="back_btn small",Object(ne.setToolsIcon)(i,ne.ToolsIcon.GREATER_THAN,!1,"",180),i.addEventListener("click",function(){return Lu.onSelectBack(i)});var a=document.createElement("div");a.className="back_btn_area",a.appendChild(n),a.appendChild(i),this.container.appendChild(a);var o=document.createElement("div");o.className="logo";var s=new Image;s.src="https://resource.miricanvas.com/image/logo_miri.png";var l=new Image;l.src="https://resource.miricanvas.com/image/logo/mobile_logo_m.svg";var c=document.createElement("a");c.className="small_logo",S.a.getAppHeaderOption().mainPageOpenInNewTab?c.addEventListener("click",function(){window.open("/")}):c.href="/",c.appendChild(l),o.appendChild(c),this.logoContainer=document.createElement("a"),this.logoContainer.className="default_logo",S.a.getAppHeaderOption().mainPageOpenInNewTab?this.logoContainer.addEventListener("click",function(){window.open("/")}):this.logoContainer.href="/",this.logoContainer.appendChild(s),o.appendChild(this.logoContainer),this.container.appendChild(o);var u=Re.createMenuItemView(new $c("btnFileMenuitem","파일",void 0),function(){return Eu.showMenu(u)});this.container.appendChild(u);var d=Re.createMenuItemView(new $c("btnSettingMenuitem","설정",void 0),function(){return uu.showMenu(d)});this.container.appendChild(d);var h=document.createElement("div");this.btnShowSheetResizePopup=this.createPageSizeSettingButtonAndVC(),h.appendChild(this.btnShowSheetResizePopup);var p=document.createElement("div");p.className="".concat(r.a.TOOLS_TAB," ").concat(r.a.RESIZE_SHEET_VIEW),p.appendChild(this.makeTabBackground()),this.pageSizeSelectVC=new hc(this),p.appendChild(this.pageSizeSelectVC.getContainer()),h.appendChild(p),this.container.appendChild(h),this.btnUndo=Re.createMenuItemView(new $c("btnUndo",void 0,ne.ToolsIcon.UNDO),Lu.onSelectUndo.bind(this)),this.container.appendChild(this.btnUndo),this.btnRedo=Re.createMenuItemView(new $c("btnRedo",void 0,ne.ToolsIcon.REDO),Lu.onSelectRedo.bind(this)),this.container.appendChild(this.btnRedo);var m=this.designTitleElem=new fu(function(t){return e.onChangeDesignDocTitle(t)});m.setDefaultValue(le.a.getDefaultTitle()),this.container.appendChild(m.render()),S.a.getAppHeaderOption().showEditingTitle||(m.render().style.display="none"),I.b.addDesignDocDCListener(this),X.a.instance.setActionQueueListener(this),vl.a.addDesignDocListener(this)}},{key:"onStartView",value:function(){he()(F()(t.prototype),"onStartView",this).call(this),this.initTemplateTypeList(!0),this.renderView()}},{key:"onChangeDesignMeta",value:function(e){this.renderView()}},{key:"onChangeActionQueue",value:function(){this.renderView()}},{key:"onChangeDesignSize",value:function(e){this.renderView()}},{key:"onDesignDocResourceFetchEnd",value:function(e){}},{key:"onDesignDocResourceFetchStart",value:function(e){}},{key:"renderView",value:function(){he()(F()(t.prototype),"renderView",this).call(this),Y.a.instance.option.pageSize&&(this.labelSheetSize.innerText=Y.a.instance.option.pageSize.toString()),this.setLogo(Y.a.instance.option.logo),this.designTitleElem.render(le.a.get().getTitle()),this.initTemplateTypeList(),Y.a.isCropMode()?(this.btnUndo.classList.add(r.a.DISABLE),this.btnRedo.classList.add(r.a.DISABLE),this.btnUndo.style.pointerEvents="none",this.btnRedo.style.pointerEvents="none"):(this.enableStyle(X.a.instance.actionQ.length<=0,this.btnUndo,r.a.DISABLE),this.enableStyle(X.a.instance.redoQ.length<=0,this.btnRedo,r.a.DISABLE),this.btnUndo.style.pointerEvents="",this.btnRedo.style.pointerEvents="")}},{key:"setLogo",value:function(e){var t=null;"MiriCanvas"===e?(t=new Image).src="".concat(fs.a.RESOURCE_DOMAIN,"image/logo/miri_logo.svg"):(t=document.createElement("h1")).innerText=e,this.logoContainer.innerHTML="",this.logoContainer.appendChild(t)}},{key:"initTemplateTypeList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Ke.a.getUserSetting().adminMode?an.b.ALL:an.b.SHEET_SIZE,n=e?No.c.get(No.b.TEMPLATE_TYPE_ID):void 0;this.pageSizeSelectVC.initTemplateTypeList(t,n)}},{key:"makeTabBackground",value:function(){var e=this,t=document.createElement("div");return t.className="tab_background",t.addEventListener("click",function(){return e.hidePopup()}),t}},{key:"createPageSizeSettingButtonAndVC",value:function(){var e=this,t=this.btnResizeSheet=document.createElement("button");t.classList.add(r.a.BUTTON_TOOL_TAB_TOGGLE),t.type="button",t.id="btnResizeSheet",S.a.getAppHeaderOption().resizePage||t.classList.add(r.a.HIDE);var n=this.labelSheetSize=document.createElement("span");return t.appendChild(n),Object(ne.setToolsIcon)(t,ne.ToolsIcon.GREATER_THAN,!0,"right",90),$(t).on("click",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.hidePopup(),t.next=3,X.a.instance.dispatch(new K.c(function(t,n){e.pageSizeSelectVC.dispatchSheetSizeUpdate(Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().adminMode,t.pages[0].sheetSize,n.option.pageSize)}));case 3:return t.next=5,X.a.instance.dispatch(new K.c(function(t){t.templateType&&e.pageSizeSelectVC.selectTemplateType(new an.c(t.templateType.id),!1,Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().adminMode)}));case 5:y.a.scrollOff();case 6:case"end":return t.stop()}},t)}))),t}},{key:"onSelectPageSize",value:function(){y.a.scrollOn(),this.btnShowSheetResizePopup.classList.remove(r.a.ACTIVE)}},{key:"hidePopup",value:function(){y.a.scrollOn(),Eu.destroyMenu(),uu.destroyMenu(),this.btnShowSheetResizePopup.classList.remove(r.a.ACTIVE)}},{key:"onChangeDesignDocTitle",value:function(e){var t=this;d.b.isEmpty(e.trim())&&(e=le.a.get().getTitle()),Ye.a.openLoginPopup(Ie.a.CHANGE_PROJECT_TITLE,function(){C.a.setTitle(e,le.a.get().getTitle())},function(){t.designTitleElem.render(le.a.getDefaultTitle())}),this.designTitleElem.render(e)}}]),t}(He.a),wu=function(){function e(){L()(this,e)}return w()(e,null,[{key:"makeLoginButton",value:function(){var e=document.createElement("div");e.className="login_button_wrapper";var t=document.createElement("div");t.className="sign_in_button";var n=document.createElement("div");n.className="sign_in_label",n.innerText="로그인",Object(ne.setToolsIcon)(t,ne.ToolsIcon.USER),t.appendChild(n),t.addEventListener("click",function(){f.a.getUser().isLogin()||Ye.a.openLoginPopup(Ie.a.USER_MENU)}),e.appendChild(t);var i=document.createElement("div");return i.className="sign_up_label",i.innerText="회원가입",i.addEventListener("click",function(e){f.a.getUser().isLogin()||c.a.openSignUp(Ie.a.USER_MENU)}),e.appendChild(i),e}}]),e}(),Su=function(){function e(){L()(this,e)}return w()(e,null,[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("span");t.className=r.a.RING_LOADER,t.appendChild(document.createElement("span")),t.appendChild(document.createElement("span")),t.appendChild(document.createElement("span")),t.appendChild(document.createElement("span"));var n=document.createElement("label");return n.innerText=e,t.appendChild(n),t}}]),e}(),bu=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,!0))).option=S.a.getAppHeaderOption(),Lu.setHeaderBarRightVC(H()(e)),e}return z()(t,e),w()(t,[{key:"getBtnDownload",value:function(){return this.btnDownload}},{key:"getBtnShare",value:function(){return this.btnShare}},{key:"getBtnPrintoutProduction",value:function(){return this.btnPrintoutProduction}},{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onStartView",this).call(this),this.container=document.createElement("div"),this.container.className="header_right",this.btnLogin=wu.makeLoginButton(),this.option.loginView||this.btnLogin.classList.add(r.a.HIDE),this.container.appendChild(this.btnLogin),this.designSaveStatus=document.createElement("div"),this.designSaveStatus.className=r.a.DESIGN_SAVE_STATUS;var n=document.createElement("p");n.className=r.a.SAVE_REQUIRE,n.innerText="변경사항 있음",this.designSaveStatus.appendChild(n);var i=document.createElement("p");i.className=r.a.SAVE_FAILED,i.innerText="저장 실패",this.designSaveStatus.appendChild(i);var a=document.createElement("p");a.className=r.a.SAVE_REQUEST,a.appendChild(Su.create("저장 중...")),this.designSaveStatus.appendChild(a);var o=document.createElement("p");o.className=r.a.SAVE_COMPLETE;var s=document.createElement("span");s.innerText=this.option.useTempSaveStatusText?"임시저장완료":"저장완료",Object(ne.setToolsIcon)(o,ne.ToolsIcon.CHECK),o.appendChild(s),this.designSaveStatus.appendChild(o);var l=document.createElement("p");if(l.className=r.a.SAVE_WAIT,l.innerText="저장대기중...",this.designSaveStatus.appendChild(l),this.container.appendChild(this.designSaveStatus),this.btnSaveDesign=this.createSaveDesignButton(),this.option.saveToMySpace||this.btnSaveDesign.classList.add(r.a.HIDE),this.container.appendChild(this.btnSaveDesign),this.option.saveToDesignLibrary){var c=this.createSaveButton();c.classList.add(r.a.ROW_BORDER_TOP),this.container.appendChild(c)}if(this.option.saveToCart&&this.container.appendChild(this.createSaveToCartButton()),this.option.saveUpdatedFromDesignLibrary||this.option.saveUpdatedFromCart){var u=this.createDoneUpdatedButton();u.classList.add(r.a.ROW_BORDER_TOP),this.container.appendChild(u)}this.btnMobileFileMenuitem=document.createElement("div"),this.btnMobileFileMenuitem.className="icon_dddot",this.option.useSpecialTheme&&this.btnMobileFileMenuitem.classList.add("border"),this.btnMobileFileMenuitem.addEventListener("click",function(){return Eu.showMenu(e.btnMobileFileMenuitem)}),this.container.appendChild(this.btnMobileFileMenuitem),this.mobileMailboxUnreadIcon=pu.a.createUnreadIcon(),pu.a.addCommonUnreadIcon(this.mobileMailboxUnreadIcon,!1),this.btnMobileFileMenuitem.appendChild(this.mobileMailboxUnreadIcon),vc.a.setHostUrl(""),vc.a.addPublicShareListener(function(t,n){le.a.get().sharedPublic=n,e.updateSharingStatus(n)}),this.btnShare=Re.createMenuItemView(new $c("btnShare",void 0,ne.ToolsIcon.SHARE),function(){return Lu.onSelectShare()}),this.updateSharingStatus(),this.option.share||this.btnShare.classList.add(r.a.HIDE),this.container.appendChild(this.btnShare),this.btnDownload=Re.createMenuItemView(new $c("btnDownload","다운로드",ne.ToolsIcon.DOWNLOAD),function(){return Lu.onSelectDownload()}),this.option.useSpecialTheme&&this.btnDownload.classList.add("special_theme"),this.option.download||this.btnDownload.classList.add(r.a.HIDE),this.container.appendChild(this.btnDownload),this.option.saveToDesignLibrary&&this.container.appendChild(this.createMiniSaveButton()),this.option.saveToCart&&this.container.appendChild(this.createMiniSaveToCartButton()),(this.option.saveUpdatedFromDesignLibrary||this.option.saveUpdatedFromCart)&&this.container.appendChild(this.createMiniDoneUpdatedButton()),this.btnSmallExport=document.createElement("div"),this.btnSmallExport.className="btn_small_export",this.option.useSpecialTheme&&this.btnSmallExport.classList.add("special_theme"),Object(ne.setToolsIcon)(this.btnSmallExport,ne.ToolsIcon.UPLOAD),this.btnSmallExport.addEventListener("click",function(){S.a.getExecutionMode().isBizhowsChannelAndDesignPurpose()?Lu.onSelectDownload():Lu.onSelectExport(e.btnSmallExport)}),this.option.download||this.btnSmallExport.classList.add(r.a.HIDE),this.container.appendChild(this.btnSmallExport),this.btnPrintoutProduction=document.createElement("div"),this.btnPrintoutProduction.id="btnPrintoutProduction",this.container.appendChild(this.btnPrintoutProduction),vl.a.addDesignDocListener(this),f.a.addOnLoginListener(this.onLogin.bind(this)),I.b.addDesignDocDCListener(this)}},{key:"onDesignDocResourceFetchStart",value:function(e){this.updateDownloadBtnUI(e)}},{key:"onDesignDocResourceFetchEnd",value:function(e){this.updateDownloadBtnUI(e)}},{key:"onChangeDesignSize",value:function(e){this.renderView()}},{key:"onLogin",value:function(e){this.renderView()}},{key:"onChangeDesignMeta",value:function(e){this.renderView()}},{key:"renderView",value:function(){he()(F()(t.prototype),"renderView",this).call(this);var e=vl.a.getDesignDoc();this.updateDownloadBtnUI(e),this.updatePrintoutProductionBtn(e);var n=Ht.a.getSaveStatus();this.designSaveStatus.setAttribute("data-status",n),this.enableStyle(n===I.a.SAVE_COMPLETE&&this.option.useTempSaveStatusText,this.designSaveStatus,r.a.LEFT),this.updateSharingStatus(le.a.get().sharedPrivate||le.a.get().sharedPublic),this.enableStyle(!f.a.getUser().isLogin(),this.btnLogin,r.a.SHOW),this.enableStyle(!f.a.getUser().isLogin(),this.designSaveStatus,r.a.HIDE)}},{key:"createSaveDesignButton",value:function(){return Re.createMenuItemView(new $c("btnSaveDesign",void 0,ne.ToolsIcon.SAVE_OUTLINE),function(){Ye.a.openLoginPopup(Ie.a.SAVE_ICON)||C.a.save({categoryIdx:Wt.a.getSaveCategoryIdx()})})}},{key:"createSaveButton",value:function(){return Re.createMenuItemView(new $c(void 0,"저장",ne.ToolsIcon.INBOX_OUTLINE).setClassName(nu.BTN_SAVE_MY_LIBRARY),s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lu.onSelectSave();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})))}},{key:"createMiniSaveButton",value:function(){return Re.createMenuItemView(new $c(void 0,void 0,ne.ToolsIcon.INBOX_OUTLINE).setClassName(nu.BTN_MINI_SAVE_MY_LIBRARY),s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lu.onSelectSave();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})))}},{key:"createSaveToCartButton",value:function(){return Re.createMenuItemView(new $c(void 0,"장바구니 추가",ne.ToolsIcon.CART_OUTLINE).setClassName(nu.BTN_SAVE_CART),function(){return Lu.onSelectSaveToCart()})}},{key:"createMiniSaveToCartButton",value:function(){return Re.createMenuItemView(new $c(void 0,void 0,ne.ToolsIcon.CART_OUTLINE).setClassName(nu.BTN_MINI_SAVE_CART),function(){return Lu.onSelectSaveToCart()})}},{key:"createDoneUpdatedButton",value:function(){return Re.createMenuItemView(new $c(void 0,"수정 완료",ne.ToolsIcon.CHECK).setClassName(nu.BTN_DONE_UPDATE),function(){return Lu.onSelectUpdateDone()})}},{key:"createMiniDoneUpdatedButton",value:function(){return Re.createMenuItemView(new $c(void 0,"수정 완료",ne.ToolsIcon.CHECK).setClassName(nu.BTN_MINI_DONE_UPDATE),function(){return Lu.onSelectUpdateDone()})}},{key:"createDefaultPrintoutProductionButton",value:function(){return Re.createMenuItemView(new $c("btnDefaultPrintoutProduction","인쇄물 제작",ne.ToolsIcon.CART_OUTLINE),function(){return Lu.onSelectPrintoutProduction()})}},{key:"createCustomPrintoutProductionButton",value:function(e,t){var n=new $c("btnCustomPrintoutProduction",t,void 0);n.setSubtitle("제작","right");var i=Re.createMenuItemView(n,function(){return Lu.onSelectPrintoutProduction(e)});return i.setAttribute("data-id",fc.a.getTypeStringWithUpperCase(e)),i}},{key:"createExportButton",value:function(){var e=Re.createMenuItemView(new $c("btnExport","",ne.ToolsIcon.DDDOT),function(){return Lu.onSelectExport(e)});return e}},{key:"updateDownloadBtnUI",value:function(e){if(void 0!==e){var t=e.pages.some(function(e){return e.isStatusLoading()});this.enableStyle(t,this.btnSmallExport,r.a.DISABLE),this.enableStyle(t,this.btnDownload,r.a.DISABLE),this.btnDownload.classList.toggle("short",null!=e.templateType&&null!=fc.a.getTypeFromTemplateTypeId(e.templateType.id))}}},{key:"updatePrintoutProductionBtn",value:function(e){this.setPrintoutProductionButton(e?e.templateType:void 0),this.btnPrintoutProduction&&this.enableStyle(!this.option.printoutProduction,this.btnPrintoutProduction,r.a.HIDE)}},{key:"updateSharingStatus",value:function(e){this.enableStyle(e,this.btnShare,"sharing"),this.enableStyle(this.option.printoutProduction,this.btnShare,"short")}},{key:"updateDownloadingStatus",value:function(e){this.enableStyle(e,this.btnDownload,r.a.DISABLE)}},{key:"setPrintoutProductionButton",value:function(e){this.btnPrintoutProduction||(this.btnPrintoutProduction=document.createElement("div"),this.btnPrintoutProduction.id="btnPrintoutProduction",this.container.appendChild(this.btnPrintoutProduction));var t=e?fc.a.getTypeFromTemplateTypeId(e.id):void 0,n=this.btnPrintoutProduction.getAttribute("data-type");if(fc.a.getTypeStringWithUpperCase(t)!==n&&(t||n&&"undefined"!==n)||0===this.btnPrintoutProduction.childElementCount){this.btnPrintoutProduction.setAttribute("data-type",fc.a.getTypeStringWithUpperCase(t));var i=Oc.a.getProductionNameByType(t);this.btnPrintoutProduction.innerHTML="",t?this.btnPrintoutProduction.appendChild(this.createCustomPrintoutProductionButton(t,i)):this.btnPrintoutProduction.appendChild(this.createDefaultPrintoutProductionButton()),this.btnPrintoutProduction.appendChild(this.createExportButton())}}}]),t}(He.a),Ru=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0,sc.a.appHeader,"header",document.getElementById(sc.a.appHeader)))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.innerHTML="";var e=document.createElement("div");e.className="header_wrap",this.headerBarLeftVC=new _u;var n=new bu;e.appendChild(this.headerBarLeftVC.getContainer()),e.appendChild(n.getContainer()),this.container.appendChild(e)}},{key:"onStartView",value:function(){he()(F()(t.prototype),"onStartView",this).call(this),this.container&&this.container.addEventListener("click",function(){X.a.instance.dispatch(new Gn.d)}),this.headerBarLeftVC.onStartView()}}]),t}(He.a),Au=function(e){function t(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return L()(this,t),(i=V()(this,F()(t).call(this,!0,void 0,"li"))).clickOnContainer=!0,i.leftMenuType=e,i.icon=n,i.isVisibleOnlyAdmin=a,i.isVisibleOnlyDev=o,i}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this);var e=document.createElement("div"),n=this.icon;n&&Object(ne.setToolsIcon)(e,n);var i=document.createElement("p");i.innerText=So.b.getNameResourceKey(this.leftMenuType),e.appendChild(i),this.setVisibility(this.needVisible()),this.container.appendChild(e)}},{key:"needVisible",value:function(){return!(this.isVisibleOnlyAdmin||this.isVisibleOnlyDev)||this.isVisibleOnlyAdmin&&Ke.a.getUserSetting().adminMode||this.isVisibleOnlyDev&&Ke.a.getUserSetting().devMode}}]),t}(He.a),Ou=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this))).isAdminMode=e,i.isDevMode=n,i}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return e.isAdminMode!==this.isAdminMode||e.isDevMode!==this.isDevMode}}]),t}(He.b),Pu=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,!0,sc.a.librarySection,"section",document.getElementById(sc.a.librarySection)))).leftPanelBtnMap=new Map,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add("expand_library"),this.container.appendChild(this.makeBackground()),this.container.appendChild(this.makeNavElement()),this.container.appendChild(this.makeContentsElement()),this.makeExpandBtn(),this.makeLeftPanelButtons()}},{key:"makeLeftPanelButtons",value:function(){var e=this,t=S.a.getLeftPanelOption().showBizTemplateAndVideo;[{type:So.b.TEMPLATE_LIB,icon:ne.ToolsIcon.TEMPLATE},t?{type:So.b.BIZ_TEMPLATE_LIB,icon:ne.ToolsIcon.BIZ,admin:!0,dev:!0}:null,{type:So.b.DESIGN_LIB,icon:ne.ToolsIcon.MY_DESIGN},{type:So.b.PHOTO_LIB,icon:ne.ToolsIcon.IMAGE},{type:So.b.ITEM_LIB,icon:ne.ToolsIcon.LIBRARY_ELEMENT},{type:So.b.TEXT_LIB,icon:ne.ToolsIcon.LIBRARY_TEXT},t?{type:So.b.VIDEO_PANEL,icon:ne.ToolsIcon.PLAY_CIRCLE_OUTLINE,dev:!0}:null,{type:So.b.BACKGROUND_LIB,icon:ne.ToolsIcon.LIBRARY_SKIN},{type:So.b.MY_IMAGE_LIB,icon:ne.ToolsIcon.ADD_PHOTO_OUTLINE},{type:So.b.FAVORITE_LIB,icon:ne.ToolsIcon.HEART_FILL},{type:So.b.ADMIN_TOOL,icon:ne.ToolsIcon.GOSTY,admin:!0,dev:!0}].forEach(function(t){return t&&e.addLeftPanelButton(new Au(t.type,t.icon,t.admin,t.dev))})}},{key:"addLeftPanelButton",value:function(e){e.setOnClickListener(this),this.leftPanelBtnMap.set(e.leftMenuType,e),this.navTopElement.appendChild(e.getContainer())}},{key:"onClick",value:function(e){this.selectListener&&this.selectListener.onSelect(e.leftMenuType)}},{key:"setSelectListener",value:function(e){this.selectListener=e}},{key:"makeExpandBtn",value:function(){var e=this,t=this.expandBtn=document.createElement("div");t.className="library_expend_button",t.classList.add(r.a.ACTIVE),t.addEventListener("click",function(){return e.toggleExpand()}),Object(ne.setToolsIcon)(t,ne.ToolsIcon.MUCH_GREATER_THAN),this.navBottomElement.appendChild(t)}},{key:"makeBackground",value:function(){var e=this,t=document.createElement("div");return t.className="library_background",t.addEventListener("click",function(){return e.toggleActive()}),t}},{key:"makeNavElement",value:function(){var e=document.createElement("div");e.className="library_list",e.setAttribute("data-split","3");var t=document.createElement("div");this.navTopElement=document.createElement("ul"),this.navTopElement.className="nav_top",t.appendChild(this.navTopElement);var n=new Ce.a(!1,!0,"calc(100% - 100px)").render(t);return n.style.minWidth="100%",e.appendChild(n),this.navBottomElement=document.createElement("ul"),this.navBottomElement.className="nav_bottom",e.appendChild(this.navBottomElement),e}},{key:"makeContentsElement",value:function(){return this.contentsElement=document.createElement("div"),this.contentsElement.className="library_contents",this.contentsElement}},{key:"setActivePanelContents",value:function(e,t){this.onCreateViewIfNotCreated(),t.parentElement&&t.parentElement===this.contentsElement||this.contentsElement.appendChild(t),this.inactiveLeftPanelContents(),this.leftPanelBtnMap.forEach(function(t){return t.setActive(t.leftMenuType===e)})}},{key:"inactiveLeftPanelContents",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,a=this.contentsElement.children[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){i.value.classList.remove(r.a.ACTIVE)}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"renderView",value:function(){var e=this;he()(F()(t.prototype),"renderView",this).call(this),this.checkUpStatesChange(this.getRenderStates()),this.contentsStatesChanged&&this.leftPanelBtnMap.forEach(function(t){var n=t.needVisible();t.setVisibility(n),!n&&t.isActive()&&(e.inactiveLeftPanelContents(),je.a.isMobilePortraitSize()?e.setActive(!1):e.toggleExpand())})}},{key:"getRenderStates",value:function(){return{contents:new Ou(Ke.a.getUserSetting().adminMode,Ke.a.getUserSetting().devMode),position:void 0}}},{key:"toggleActive",value:function(){return he()(F()(t.prototype),"toggleActive",this).call(this)}},{key:"setActive",value:function(e){return he()(F()(t.prototype),"setActive",this).call(this,e),e?(y.a.scrollOff(),this.expand()):y.a.scrollOn(),Y.a.instance.editorMainVC.setRotateSpecialBtn(e),this}},{key:"toggleExpand",value:function(){this.container.classList.contains("expand_library")?this.contract():this.expand()}},{key:"expand",value:function(){this.expandBtn.classList.add(r.a.ACTIVE),this.container.classList.add("expand_library"),this.expandAnimation(!0)}},{key:"contract",value:function(){this.expandBtn.classList.remove(r.a.ACTIVE),this.container.classList.remove("expand_library"),this.expandAnimation(!1)}},{key:"expandAnimation",value:function(e){var t=e?0:-this.contentsElement.offsetWidth;$(this.contentsElement).stop().animate({"margin-left":"".concat(t,"px")},{duration:300,complete:function(){Y.a.instance.editorMainVC.canvasAreaVC.pagingManager.refreshCache()}})}}]),t}(He.a),Du=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,function(e,t){if(1===t.activeItems.length){var n=Qe.b.getGroup(t.activeItems[0].groupId);n.clearSelectedItem();var i=n.getRootGroup();i.clearSelectedItem();var a=i.getAllSingleMembers(),o=e.pages[t.renderPageIdx].getAllSingleItems().filter(function(e){return a.find(function(t){return t.tbpeId===e.tbpeId})});o.forEach(function(e){e.hover=!1,t.pageController.getItemRenderer(e).updateBorderStyle(0)}),e.pages.forEach(function(e){t.pageController.getPageRenderer(e).updateHoverLayer()}),J.a.selectItems(o)}},!0))}return z()(t,e),t}(K.c),Mu=n(281),Nu=function(){function e(){var t=this;L()(this,e),this.btnDelete=new xa(function(){X.a.instance.dispatch(new oi.d),Y.a.instance.mouseAction.mode=Fn.a.MODE_NONE},{icon:ne.ToolsIcon.DELETE}),new Le.a(this.btnDelete.container,Ge.a.TL,{title:{name:"배경 삭제"}}).renderView();var n=(new ia.g).setBorderBottom().addCustomClass(r.a.ROW_BACKGROUND_DELETE);n.add((new ia.f).add(this.btnDelete));var i=new ia.g("패턴 크기");this.patternSizeTool=new Na.a(function(n){return X.a.instance.dispatch(new ri.h(t.currentItem,Ga.a.getNewRangeValue(n,e.TRACKBAR_MIN_PATTERN_COUNT_RATIO,e.TRACKBAR_MAX_PATTERN_COUNT_RATIO,Mu.b.MIN_PATTERN_COUNT_RATIO,Mu.b.MAX_PATTERN_COUNT_RATIO)))},"",e.TRACKBAR_MIN_PATTERN_COUNT_RATIO,e.TRACKBAR_MAX_PATTERN_COUNT_RATIO,1),i.add(this.patternSizeTool),this.backgroundDeleteRow=n,this.patternCountRatioRow=i}return w()(e,[{key:"makeMobileToolbox",value:function(){this.toolTopContents=aa.a.makeToolboxTopContentsWrapper();var e=this.patternSizeMenu=aa.a.makeButtonShowToolsRow("패턴 크기",this.patternCountRatioRow);return this.toolTopContents.appendChild(e),this.toolTopContents}},{key:"updateUI",value:function(t,n){var i=new Map,a=!0,o=!1,s=void 0;try{for(var r,l=this.currentItem.getEditableOriginColors()[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value;this.currentItem.props.setCurrentOriginColor(c),i.set(c,this.currentItem.props.getColor())}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}t.isBackground;var u=t.svgData.type===Xt.g.BACKGROUND_PATTERN,d=Ga.a.getNewRangeValue(t.props.patternCountRatio,Mu.b.MIN_PATTERN_COUNT_RATIO,Mu.b.MAX_PATTERN_COUNT_RATIO,e.TRACKBAR_MIN_PATTERN_COUNT_RATIO,e.TRACKBAR_MAX_PATTERN_COUNT_RATIO);this.patternSizeTool.updateUI({value:Math.round(d),active:!t.isLock()}),this.patternSizeTool.setDisplay(u),this.btnDelete.setDisplay(u)}},{key:"isDefaultColor",value:function(e){return e===Mu.a.RGB}},{key:"isDefaultSize",value:function(e){return e===Mu.a.NUMBER}},{key:"makeToolboxRowContents",value:function(){return[{row:this.patternCountRatioRow,priority:700,viewType:0}]}},{key:"updateToolboxRowContents",value:function(e,t){var n=t.renderedItem&&t.renderedItem instanceof qo.a,i=(n&&!t.isAdminEditView&&t.renderedItem.getEditableOriginColors().length,n&&!t.isAdminEditView&&t.renderedItem&&t.renderedItem.isOnlyOneItem());this.patternCountRatioRow.rowVisible=i,this.backgroundDeleteRow.rowVisible=n&&!t.isAdminEditView&&t.renderedItem&&t.renderedItem.isOnlyOneItem();var a=n&&!t.isAdminEditView&&!t.renderedItem.isBackground,o=n&&!t.isAdminEditView&&!t.renderedItem.isLock();return aa.a.setContentsVisible(this.toolTopContents,o),aa.a.setContentsVisible(this.patternSizeMenu,i),aa.a.setContentsVisible(this.effectMenu,a),n?(this.currentItem=t.renderedItem,this.updateUI(this.currentItem,t.isAdminEditView)):this.currentItem=null,!0}}]),e}();Nu.TRACKBAR_MIN_PATTERN_COUNT_RATIO=1,Nu.TRACKBAR_MAX_PATTERN_COUNT_RATIO=50;var xu=new(function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getGradationMaskPresets",value:function(){return D.a.getResourceStyles(Ji.c.STYLE_IMAGE_GRADATION)}},{key:"getImageFilterPresets",value:function(){return D.a.getResourceStyles(Ji.c.STYLE_IMAGE_FILTER)}}]),t}(dn.a)),Bu=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0))).style=e,n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container=document.createElement("button"),this.container.setAttribute("data-key",this.style.value),this.container.setAttribute("data-status",this.style.status);var e=document.createElement("div");e.className=r.a.IMAGE_WRAP;var n=new Image;if(this.style.thumb&&(n.src=this.style.thumb.replace(/^http:\/\//i,"https://")),this.container.appendChild(n),this.container.appendChild(e),this.style.name){var i=document.createElement("p");i.innerText=this.style.name,this.container.appendChild(i)}}}]),t}(He.a),Vu=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"없음",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return L()(this,t),(n=V()(this,F()(t).call(this,"div",[r.a.IMAGE_LIST_ITEM]))).buttons=[],n.listener=e,n.defaultItemName=i,n.colCount=a,n.suffix=o,n.optSuffix=n.suffix,2===a&&n.container.classList.add(r.a.IMAGE_LIST_COL2),n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.imageListWrap=document.createElement("div"),this.imageListWrap.className=r.a.IMAGE_LIST_WRAP,this.container.appendChild(this.imageListWrap);var n=document.createElement("div");n.setAttribute("data-mode",xr.b.EASY_FLOATING),this.select=document.createElement("select");var i=Uu(ne.ToolsIcon.PREV,r.a.QUICK_PREV,function(t){var n=e.select.selectedIndex>0?e.select.selectedIndex-1:e.select.options.length-1;e.doChange(e.select.options.item(n).value)}),a=Uu(ne.ToolsIcon.NEXT,r.a.QUICK_NEXT,function(t){var n=e.select.selectedIndex<e.select.options.length-1?e.select.selectedIndex+1:0;e.doChange(e.select.options.item(n).value)});n.appendChild(i),n.appendChild(this.select),n.appendChild(a),this.renderFilterPresets(xu.getImageFilterPresets()),this.container.appendChild(n),this.addEventListener()}},{key:"renderFilterPresets",value:function(e){var t=this;void 0!==e&&(this.itemList=e.reverse(),this.itemList&&this.itemList.forEach(function(e,n){var i=new Bu(e).getContainer();e.name&&e.name===t.defaultItemName&&(t.defaultKey=e.value),t.imageListWrap.appendChild(i),t.buttons.push(i);var a=document.createElement("option");a.value=e.value,a.innerText="".concat(t.optSuffix).concat(n+1),t.select.appendChild(a)}))}},{key:"updateUI",value:function(e){var n=this;if(this.onCreateViewIfNotCreated(),this.itemList){this.selectedItem=this.itemList.find(function(t){return t.value===e.value});var i=this.select.children.item(0);if(e.selectDefault)this.select.value=this.defaultKey;else if(this.selectedItem)i.value===t.NONE_KEY&&i.parentNode.removeChild(i),this.select.value=this.selectedItem.value;else{if(i.value!==t.NONE_KEY){var a=document.createElement("option");a.value=t.NONE_KEY;var o=this.suffix;a.innerText="".concat(o,"선택안함"),i.parentNode.insertBefore(a,i)}this.select.value=t.NONE_KEY}this.buttons.forEach(function(t){!1===e.active?(t.disabled=!0,t.style.opacity=".3"):(t.removeAttribute("disabled"),t.style.opacity="1");var i=t.getAttribute("data-key");e.selectDefault&&i===n.defaultKey||i===e.value?t.classList.add(r.a.ACTIVE):t.classList.remove(r.a.ACTIVE)})}}},{key:"updateSelectedItem",value:function(e){var n=this;e&&this.defaultKey?(this.select.value=this.defaultKey,this.buttons.forEach(function(e){e.getAttribute("data-key")===n.defaultKey?e.classList.add(r.a.ACTIVE):e.classList.remove(r.a.ACTIVE)})):(this.select.value=t.NONE_KEY,$(this.container).children().children().removeClass(r.a.ACTIVE))}},{key:"addEventListener",value:function(){var e=this;$(this.container).on("click","button",function(){var t=$(this).data("key");t&&e.doChange(t)}),$(this.select).on("change",function(){var t=$(this).val();t&&e.doChange(t)})}},{key:"doChange",value:function(e){this.select.value=e,this.listener&&this.listener(e)}}]),t}(Da.a);function Uu(e,t,n){var i=document.createElement("button");return i.type="button",i.addEventListener("click",n),Object(ne.setToolsIcon)(i,e),i.classList.add(t),i}Vu.NONE_KEY="none";var Fu=n(359),Gu=function(){function e(){L()(this,e)}return w()(e,null,[{key:"isDefaultColor",value:function(e){return e===Fu.b.RGB}},{key:"isDefaultSize",value:function(e){return e===Fu.b.NUMBER}},{key:"useImageEffectMapper",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];X.a.instance.dispatch(new Un.b(e,e,t.actionType,t.groupName,t.name,n,i,t.timeout))}},{key:"applyPreset",value:function(e,t){X.a.instance.dispatch(new na(e,Ei.b.PHOTO,t))}},{key:"updateBackgroundColorUI",value:function(e){X.a.instance.dispatch(new K.c(function(t,n){var i=t.pages[n.renderPageIdx].background.color;i&&e.updateUI({value:i})}))}}]),e}(),Hu=function(){function e(){L()(this,e)}return w()(e,[{key:"setCurrentItem",value:function(e){this.currentItem=e}},{key:"updateUI",value:function(e){this.filterRow.updateAccordionUI(),this.preset.updateUI({value:e.getPreset(),selectDefault:e.isFilterValuesAllDefault()}),this.brightness.updateUI({value:e.getBrightness()}),this.contrast.updateUI({value:e.getContrast()}),this.saturation.updateUI({value:e.getSaturation()}),this.tint.updateUI({value:e.getTint()}),this.colorTone.updateUI({value:e.getColorTone()}),this.temperature.updateUI({value:e.getTemperature()}),this.blur.updateUI({value:e.getBlur()}),this.vignette.updateUI({value:e.getVignette()})}},{key:"addToolboxRowContents",value:function(e){e.push({row:this.presetRowItem,priority:600,viewType:0}),e.push({row:this.directAdjustmentRowItem,priority:700,viewType:0}),e.push({row:this.filterRow,priority:502,viewType:0})}},{key:"setVisible",value:function(e){if(this.filterRow.setRowsVisible(e),this.presetRowItem.rowVisible=e&&je.a.isMobilePortraitSize(),this.directAdjustmentRowItem.rowVisible=e&&je.a.isMobilePortraitSize(),je.a.isMobilePortraitSize()){var t=this.filterRow.getSectionRowWrap("preset"),n=this.filterRow.getSectionRowWrap("direct_adjustment");this.presetRowItem.container.contains(t)||this.presetRowItem.container.appendChild(t),this.directAdjustmentRowItem.container.contains(n)||this.directAdjustmentRowItem.container.appendChild(n)}else this.filterRow.setSectionRowWrap("preset"),this.filterRow.setSectionRowWrap("direct_adjustment")}},{key:"makePresetRow",value:function(){var e=this;return this.preset=new Vu(function(t){var n=e.currentItem;n&&n.props.setPreset(""+t),Gu.applyPreset(t)}),(new ia.g).add(this.preset)}},{key:"getPresetRowItem",value:function(){return this.presetRowItem}},{key:"getDirectAdjustmentRowItem",value:function(){return this.directAdjustmentRowItem}},{key:"makeDirectAdjustmentRows",value:function(){var e=[];return this.brightness=this.makeRangeTool(Li),e.push(new ia.g("밝기").add(this.brightness)),this.contrast=this.makeRangeTool(_i),e.push(new ia.g("대비").add(this.contrast)),this.saturation=this.makeRangeTool(Si),e.push(new ia.g("채도").add(this.saturation)),this.colorTone=this.makeRangeTool(Ri),this.colorTone.setRangeBgCustomClass(r.a.RAINBOW_LINE),e.push(new ia.g("컬러톤").add(this.colorTone)),this.temperature=this.makeRangeTool(Ai),this.temperature.setRangeBgCustomClass(r.a.TEMPERATURE_LINE),e.push(new ia.g("온도").add(this.temperature)),this.blur=this.makeRangeTool(Oi),e.push(new ia.g("흐리기").add(this.blur)),this.vignette=this.makeRangeTool(Pi,0),e.push(new ia.g("비네트").add(this.vignette)),this.tint=this.makeRangeTool(bi),this.tint.setRangeBgCustomClass(r.a.RAINBOW_LINE),e.push(new ia.g("* 색상 (관리자용").add(this.tint).addCustomClass(r.a.ADMIN_UI)),e}},{key:"makeRowContents",value:function(){this.filterRow=new ia.b("필터",r.a.TOOLS_FILTER),this.presetRowItem=(new ia.g).addCustomClass(r.a.TOOLS_PRESET_FILTER_ROW),this.directAdjustmentRowItem=(new ia.g).addCustomClass(r.a.TOOLS_DIRECT_FILTER_ROW),this.filterRow.addSection([this.makePresetRow()],"preset","필터 효과",ne.ToolsIcon.MAGIC_WAND),this.filterRow.addSection(this.makeDirectAdjustmentRows(),"direct_adjustment","직접 조정",ne.ToolsIcon.TUNE2)}},{key:"makeRangeTool",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-100,i=new Na.a(function(n){Gu.useImageEffectMapper([t.currentItem],e,n),t.updatePreset()},"",n,100,1);return i.onStartView(),i}},{key:"updatePreset",value:function(){this.currentItem&&(this.preset.updateSelectedItem(this.currentItem.props.isFilterValuesAllDefault()),this.currentItem.props.setPreset(""))}}]),e}(),Wu=function(){function e(){L()(this,e)}return w()(e,[{key:"accordionRowListener",value:function(e){this.shadowCheckedEvent(e)}},{key:"getRowItem",value:function(){return this.shadowRow}},{key:"makeRowContents",value:function(){var e=this;this.shadowRow=new ia.c("그림자",function(t){return e.accordionRowListener(t)}).setFlex().setBorderBottom(),this.shadowColor=this.makeColorPickerTool(),this.shadowAngle=this.makeRangeTool(Yi,"방향",360,"°"),this.shadowAlpha=this.makeRangeTool(Xi,"투명도",100,"%"),this.shadowDistance=this.makeRangeTool(ji,"거리"),this.shadowBlur=this.makeRangeTool(Zi,"흐림"),this.shadowRow.appendElement(this.shadowColor.getContainer()).add(this.shadowAngle,this.shadowAlpha,this.shadowDistance,this.shadowBlur)}},{key:"makeColorPickerTool",value:function(){var e=this;return new Pa.a(function(t){e.shadowCheckedEvent(!0,t)},ne.ToolsIcon.PENCIL,"색상",!1,!0).addClass(r.a.ACCORDION_ROW_COLOR)}},{key:"makeRangeTool",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,a=arguments.length>3?arguments[3]:void 0;return new Na.a(function(t){Gu.useImageEffectMapper([n.currentItem],e,t)},t,0,i,1,a)}},{key:"setCurrentItem",value:function(e){this.currentItem=e}},{key:"addToolboxRowContents",value:function(e){e.push({row:this.shadowRow,priority:517,viewType:0})}},{key:"setVisible",value:function(e){this.shadowRow.rowVisible=e}},{key:"updateUI",value:function(e){var t=e.isActiveShadow();this.shadowRow.updateUI(t),this.shadowColor.updateUI({value:e.getShadowColor(!0),active:!0}),this.shadowAngle.updateUI({value:e.getShadowAngle(!0),active:t}),this.shadowAlpha.updateUI({value:e.getShadowAlpha(!0),active:t}),this.shadowDistance.updateUI({value:e.getShadowDistance(!0),active:t}),this.shadowBlur.updateUI({value:e.getShadowBlur(!0),active:t})}},{key:"shadowCheckedEvent",value:function(e,t){var n=this;this.currentItem&&X.a.instance.groupingAction(function(){var i=n.currentItem;!0===e&&Gu.isDefaultColor(i.props.getShadowColor(!0))&&Gu.isDefaultSize(i.props.getShadowAngle(!0))&&Gu.isDefaultSize(i.props.getShadowDistance(!0))&&Gu.isDefaultSize(i.props.getShadowBlur(!0))&&(Gu.useImageEffectMapper([i],Yi,315,!1),Gu.useImageEffectMapper([i],Xi,50,!1),Gu.useImageEffectMapper([i],ji,12,!1),Gu.useImageEffectMapper([i],Zi,8,!1)),Gu.useImageEffectMapper([i],zi,e),t&&Gu.useImageEffectMapper([n.currentItem],Ki,t)})}}]),e}(),zu=function(e){function t(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return L()(this,t),(i=V()(this,F()(t).call(this,"div",[r.a.PRESET_ITEM]))).listener=e,i.title=n,i.suffix=a,i.optSuffix=i.suffix,i}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this);var n=Ku(ne.ToolsIcon.PREV,r.a.QUICK_PREV,function(){var t=e.select.selectedIndex>0?e.select.selectedIndex-1:e.select.options.length-1;e.doChange(e.select.options.item(t).value)}),i=Ku(ne.ToolsIcon.NEXT,r.a.QUICK_NEXT,function(){var t=e.select.selectedIndex<e.select.options.length-1?e.select.selectedIndex+1:0;e.doChange(e.select.options.item(t).value)});this.container.appendChild(n),this.container.appendChild(i);var a=document.createElement("label");a.innerText=this.title,this.container.appendChild(a);var o=document.createElement("div");o.className=r.a.VALUE_ELEMENT,this.select=document.createElement("select"),this.renderGradationMasksPresets(xu.getGradationMaskPresets()),o.appendChild(this.select),this.container.appendChild(o),this.addEventListener()}},{key:"renderGradationMasksPresets",value:function(e){var t=this;this.itemList=e,e&&e.forEach(function(e){var n=document.createElement("option");n.value=e.value,n.innerText=t.optSuffix+e.title,t.select.appendChild(n)})}},{key:"updateUI",value:function(e){if(this.onCreateViewIfNotCreated(),this.itemList){var n=this.itemList.find(function(t){return t.value===e.value});n?this.select.value=n.value:this.itemList.length>0?this.select.value=this.itemList[0].value:this.select.value=t.NONE_KEY,this.select.disabled=!e.active}}},{key:"addEventListener",value:function(){var e=this;$(this.select).on("change",function(){var t=$(this).val();t&&e.doChange(t)})}},{key:"doChange",value:function(e){this.select.value=e,this.listener&&this.listener(e)}}]),t}(Da.a);function Ku(e,t,n){var i=document.createElement("button");return i.type="button",i.addEventListener("click",n),Object(ne.setToolsIcon)(i,e),i.classList.add(t),i}zu.NONE_KEY="none";var Yu=function(){function e(){L()(this,e)}return w()(e,[{key:"accordionRowListener",value:function(e){var t=this.currentItem.props.getGradationMaskPresetKey();d.b.isEmpty(t)?e&&this.gradationMaskPreset.itemList.length>1?this.gradationMaskPreset.doChange(this.gradationMaskPreset.itemList[1].value):(this.gradationMaskPreset.doChange("-1"),Gu.useImageEffectMapper([this.currentItem],Gi,e)):Gu.useImageEffectMapper([this.currentItem],Gi,e)}},{key:"makePreset",value:function(e){var t=this;this.gradationMaskPreset=new zu(function(n){if(t.currentItem.props.setGradationMaskPresetKey(n),parseInt(n)>0){var i={name:"active",actionType:K.a.IMAGE_GRADATION_ACTIVE,callback:e};Gu.applyPreset(n,i)}},"프리셋","그라데이션")}},{key:"makeDirectionTool",value:function(){var e=this,t=new Ma(function(t){Gu.useImageEffectMapper([e.currentItem],Hi,t),e.gradationMaskPreset.doChange("-1")},[{value:Fu.a.T,icon:ne.ToolsIcon.ARROW_UP},{value:Fu.a.L,icon:ne.ToolsIcon.ARROW_BACK},{value:Fu.a.B,icon:ne.ToolsIcon.ARROW_DOWN},{value:Fu.a.R,icon:ne.ToolsIcon.ARROW_FORWARD}],0,"방향");return t.container.classList.add(r.a.GRADATION_MASK),this.gradationMaskDirection=t,t}},{key:"makeDepthTool",value:function(){var e=this,t=new Na.a(function(t){Gu.useImageEffectMapper([e.currentItem],Wi,t),e.gradationMaskPreset.doChange("-1")},"범위",0,100,1,"%");return this.gradationMaskDepth=t,t}},{key:"getRowItem",value:function(){return this.gradationRow}},{key:"makeRowContents",value:function(e){var t=this;this.gradationRow=new ia.c("그라데이션 마스크",function(e){return t.accordionRowListener(e)}).setFlex().setBorderBottom(),this.makePreset(e),this.gradationRow.add(this.makeDirectionTool()),this.gradationRow.add(this.makeDepthTool())}},{key:"setCurrentItem",value:function(e){this.currentItem=e}},{key:"addToolboxRowContents",value:function(e){e.push({row:this.gradationRow,priority:518,viewType:0})}},{key:"setVisible",value:function(e){this.gradationRow.rowVisible=e}},{key:"updateUI",value:function(e){this.gradationRow.updateUI(e.isActiveGradationMask()),this.gradationMaskPreset.updateUI({value:e.getGradationMaskPresetKey(),active:e.isActiveGradationMask()}),this.gradationMaskDirection.updateUI({value:e.getGradationMaskDirection(!0),active:e.isActiveGradationMask()}),this.gradationMaskDepth.updateUI({value:e.getGradationMaskDepth(!0),active:e.isActiveGradationMask()})}}]),e}(),Xu=function(){function e(){L()(this,e)}return w()(e,[{key:"makeRowContents",value:function(){var e=this;this.backgroundColorRow=(new ia.g).setFlex().setBorderBottom().addCustomClass(r.a.ROW_BACKGROUND_SOLID_COLOR),this.backgroundColorTool=new Pa.a(function(t){e.backgroundColorTool.updateUI({value:t});X.a.instance.dispatch(new oi.c(Y.a.instance.renderPageIdx,t,!1))},null,"색상").addClass(r.a.BACKGROUND_SOLID_COLOR_PICKER),this.backgroundColorTool.updateUI({value:"#ffffff"}),this.backgroundColorRow.add(this.backgroundColorTool)}},{key:"addToolboxRowContents",value:function(e){e.push({row:this.backgroundColorRow,priority:501,viewType:0})}},{key:"getBackgroundColorTool",value:function(){return this.backgroundColorTool}},{key:"setVisible",value:function(e){this.backgroundColorRow.rowVisible=e,!je.a.isMobilePortraitSize()&&this.backgroundColorRow.container&&(this.backgroundColorRow.container.appendChild(this.backgroundColorTool.container),this.backgroundColorTool.canNotAppend=!1)}},{key:"updateUI",value:function(e){this.backgroundColorTool.setDisplay(!0),e&&Gu.updateBackgroundColorUI(this.backgroundColorTool)}}]),e}(),ju=function(){function e(){var t=this;L()(this,e),this.backgroundManager=new Xu,this.filterManager=new Hu,this.shadowManager=new Wu,this.gradationManager=new Yu,this.backgroundManager.makeRowContents(),this.filterManager.makeRowContents(),this.shadowManager.makeRowContents(),this.makeSvgEffectRow(),this.gradationManager.makeRowContents(function(){return t.updateUI()}),this.colorPickerRow=(new ia.g).addCustomClass(r.a.COLOR_PICKER_ROW);var n=this.shadowManager.getRowItem(),i=this.gradationManager.getRowItem();n.addCustomClass(r.a.EFFECT_TOOLS),i.addCustomClass(r.a.EFFECT_TOOLS),n.setPrevCallback(function(){return t.effectMenu.click()}),i.setPrevCallback(function(){return t.effectMenu.click()})}return w()(e,[{key:"makeSvgEffectRow",value:function(){var e=this;this.imageEffecRow=(new ia.g).addCustomClass(r.a.ACCORDION_EFFECT_ROW),this.shadowMenu=new Ba.a("그림자",function(){return e.showShadowMenu.click()},function(t){return e.shadowManager.accordionRowListener(t)}),this.gradationMenu=new Ba.a("그라데이션 마스크",function(){return e.showGradationMenu.click()},function(t){return e.gradationManager.accordionRowListener(t)}),this.imageEffecRow.add(this.shadowMenu,this.gradationMenu)}},{key:"makeMobileToolbox",value:function(){this.toolTopContents=aa.a.makeToolboxTopContentsWrapper();var e=this.backgroundManager.getBackgroundColorTool();this.toolTopContents.appendChild(e.container),aa.a.setEventColorTool(e,this.colorPickerRow);var t=this.afterColorMenu=aa.a.makeIconButtonShowToolsRow(ne.ToolsIcon.MAGIC_WAND,this.filterManager.getPresetRowItem());this.toolTopContents.appendChild(t);var n=aa.a.makeIconButtonShowToolsRow(ne.ToolsIcon.TUNE2,this.filterManager.getDirectAdjustmentRowItem());return this.toolTopContents.appendChild(n),this.effectMenu=aa.a.makeButtonShowToolsRow("효과",this.imageEffecRow),this.toolTopContents.appendChild(this.effectMenu),this.showShadowMenu=aa.a.makeButtonShowToolsAccordionRow("그림자",this.shadowManager.getRowItem()),this.showShadowMenu.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.showShadowMenu),this.showGradationMenu=aa.a.makeButtonShowToolsAccordionRow("마스크",this.gradationManager.getRowItem()),this.showGradationMenu.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.showGradationMenu),this.toolTopContents}},{key:"updateUI",value:function(){var e=this.currentItem;this.backgroundManager.updateUI(e.isBackground),this.filterManager.updateUI(e.props),this.shadowManager.updateUI(e.props),this.gradationManager.updateUI(e.props),this.shadowMenu.updateUI(e.props.isActiveShadow()),this.gradationMenu.updateUI(e.props.isActiveGradationMask())}},{key:"makeToolboxRowContents",value:function(){var e=[];return this.backgroundManager.addToolboxRowContents(e),this.filterManager.addToolboxRowContents(e),this.shadowManager.addToolboxRowContents(e),this.gradationManager.addToolboxRowContents(e),e.push({row:this.imageEffecRow,priority:810,viewType:0}),e.push({row:this.colorPickerRow,priority:820,viewType:0}),e}},{key:"updateToolboxRowContents",value:function(e,t){var n=t.renderedItem&&t.renderedItem instanceof Je.d&&!t.renderedItem.isUnsupported();n?(this.setCurrentItem(t.renderedItem),this.updateUI()):this.setCurrentItem(null);var i=n&&!t.isAdminEditView,a=this.currentItem&&this.currentItem.isBackground;if(je.a.isMobilePortraitSize()){var o=this.backgroundManager.getBackgroundColorTool();this.toolTopContents.insertBefore(o.container,this.afterColorMenu),o.canNotAppend=!0}this.backgroundManager.setVisible(i&&a),this.filterManager.setVisible(i),this.shadowManager.setVisible(i&&!a),this.gradationManager.setVisible(i),this.shadowMenu.setVisible(i&&!a);var s=i&&!t.renderedItem.isLock();return this.imageEffecRow.rowVisible=i&&je.a.isMobilePortraitSize(),this.colorPickerRow.rowVisible=i&&a&&je.a.isMobilePortraitSize(),aa.a.setContentsVisible(this.toolTopContents,s),aa.a.setContentsVisible(this.backgroundManager.getBackgroundColorTool().container,a),!0}},{key:"setCurrentItem",value:function(e){this.currentItem=e,this.filterManager.setCurrentItem(e),this.shadowManager.setCurrentItem(e),this.gradationManager.setCurrentItem(e)}}]),e}(),Zu=function(){function e(){L()(this,e)}return w()(e,[{key:"makeToolboxRowContents",value:function(){return[]}},{key:"makeMobileToolbox",value:function(){var e=this;this.toolTopContents=aa.a.makeToolboxTopContentsWrapper();var t=aa.a.makeLabelContents("그룹화");return t.addEventListener("click",function(){"그룹화"===e.btnGroupMenu.innerText?X.a.instance.dispatch(new On.a):X.a.instance.dispatch(new On.d)}),this.btnGroupMenu=t,this.toolTopContents.appendChild(this.btnGroupMenu),this.toolTopContents}},{key:"updateToolboxRowContents",value:function(e,t){return Qe.b.getGroupItemsAddedArray(e).length>1?(this.btnGroupMenu.classList.remove(r.a.HIDE),this.btnGroupMenu.innerText=e.length>1&&!Qe.b.isSameGroup(e)?"그룹화":"그룹해제"):this.btnGroupMenu.classList.add(r.a.HIDE),!0}}]),e}(),qu=n(340),$u=n.n(qu),Qu=n(375),Ju=n(268),ed=n(376),td=function(){function e(){var t=this;L()(this,e),this.svgColorRow=(new ia.g).setBorderBottom(),this.svgColorPickerTool=new Qu.a(function(e,n){X.a.instance.groupingAction(function(){t.svgItems.forEach(function(t){var i=t,a=i.getEditableOriginColors(),o=i.props.getColorMap(),s=!0,r=!1,l=void 0;try{for(var c,u=o[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var d=$u()(c.value,2),h=d[0],p=d[1];e.toLowerCase()===p.toLowerCase()&&a.indexOf(h.toLowerCase())>=0&&X.a.instance.dispatch(new ri.e(h,n,t))}}catch(e){r=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(r)throw l}}}),t.svgColorPickerTool.setOriginColor(n)})},"색상"),this.svgColorRow.add(this.svgColorPickerTool),this.colorPickerRow=(new ia.g).addCustomClass(r.a.COLOR_PICKER_ROW),this.colorRow=(new ia.g).addCustomClass(r.a.ROW_MULTI_COLOR).setBorderBottom();this.color=new Pa.a(function(e){X.a.instance.groupingAction(function(){t.textItems.forEach(function(t){Ha.useTextItemCharPropMapper(rt,e,t)}),t.svgItems.forEach(function(t){var n=t.getEditableOriginColors(),i=!0,a=!1,o=void 0;try{for(var s,r=n[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value;X.a.instance.dispatch(new ri.e(l,e,t))}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}})})},rt.icon,"색상",!1,!0).addClass(r.a.MULTI_COLOR_PICKER),this.colorRow.add(this.color),this.makeShadowRow(),this.makeEffectRow()}return w()(e,[{key:"makeEffectRow",value:function(){var e=this;this.multiEffecRow=(new ia.g).addCustomClass(r.a.ACCORDION_EFFECT_ROW),this.shadowMenu=new Ba.a("그림자",function(){return e.showShadowMenu.click()},function(t){return e.shadowCheckedEvent(t)}),this.multiEffecRow.add(this.shadowMenu)}},{key:"shadowCheckedEvent",value:function(t,n){var i=this;X.a.instance.groupingAction(function(){if(!0===t){var a=i.getDefaultShadowValueItems(i.textItems);e.useItemGraphicEffectMapper(a,Rt,315,!1),e.useItemGraphicEffectMapper(a,bt,50,!1),e.useItemGraphicEffectMapper(a,At,12,!1),e.useItemGraphicEffectMapper(a,Ot,8,!1);var o=i.getDefaultShadowValueItems(i.photoItems);e.useItemGraphicEffectMapper(o,Yi,315,!1),e.useItemGraphicEffectMapper(o,Xi,50,!1),e.useItemGraphicEffectMapper(o,ji,12,!1),e.useItemGraphicEffectMapper(o,Zi,8,!1);var s=i.getDefaultShadowValueItems(i.svgItems);e.useItemGraphicEffectMapper(s,ed.c,315,!1),e.useItemGraphicEffectMapper(s,ed.b,50,!1),e.useItemGraphicEffectMapper(s,ed.f,12,!1),e.useItemGraphicEffectMapper(s,ed.d,8,!1)}e.useItemGraphicEffectMapper(i.textItems,wt,t),e.useItemGraphicEffectMapper(i.photoItems,zi,t),e.useItemGraphicEffectMapper(i.svgItems,ed.a,t),n&&(e.useItemGraphicEffectMapper(i.textItems,St,n),e.useItemGraphicEffectMapper(i.photoItems,Ki,n),e.useItemGraphicEffectMapper(i.svgItems,ed.e,n))})}},{key:"makeMobileToolbox",value:function(){return this.toolTopContents=aa.a.makeToolboxTopContentsWrapper(),this.toolTopContents.appendChild(this.svgColorPickerTool.container),aa.a.setEventSvgColorTool(this.svgColorPickerTool,this.colorPickerRow),this.toolTopContents.appendChild(this.color.container),aa.a.setEventColorTool(this.color,this.colorPickerRow),this.effectMenu=aa.a.makeButtonShowToolsRow("효과",this.multiEffecRow),this.toolTopContents.appendChild(this.effectMenu),this.showShadowMenu=aa.a.makeButtonShowToolsAccordionRow("그림자",this.accordionShadow),this.showShadowMenu.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.showShadowMenu),this.toolTopContents}},{key:"makeShadowRow",value:function(){var t=this,n=new ia.c("그림자",function(e){return t.shadowCheckedEvent(e)}).setFlex().setBorderBottom();this.shadowColor=new Pa.a(function(e){t.shadowCheckedEvent(!0,e)},ne.ToolsIcon.PENCIL,"색상").addClass(r.a.ACCORDION_ROW_COLOR),this.shadowAngle=new Na.a(function(n){e.useItemGraphicEffectMapper(t.textItems,Rt,n),e.useItemGraphicEffectMapper(t.photoItems,Yi,n),e.useItemGraphicEffectMapper(t.svgItems,ed.c,n)},"방향",0,360,1,"°"),this.shadowAlpha=new Na.a(function(n){e.useItemGraphicEffectMapper(t.textItems,bt,n),e.useItemGraphicEffectMapper(t.photoItems,Xi,n),e.useItemGraphicEffectMapper(t.svgItems,ed.b,n)},"투명도",0,100,1,"%"),this.shadowDistance=new Na.a(function(n){e.useItemGraphicEffectMapper(t.textItems,At,n),e.useItemGraphicEffectMapper(t.photoItems,ji,n),e.useItemGraphicEffectMapper(t.svgItems,ed.f,n)},"거리",0,100,1),this.shadowBlur=new Na.a(function(n){e.useItemGraphicEffectMapper(t.textItems,Ot,n),e.useItemGraphicEffectMapper(t.photoItems,Zi,n),e.useItemGraphicEffectMapper(t.svgItems,ed.d,n)},"흐림",0,100,1),n.addCustomClass(r.a.EFFECT_TOOLS),n.setPrevCallback(function(){return t.effectMenu.click()}),n.appendElement(this.shadowColor.getContainer()).add(this.shadowAngle,this.shadowAlpha,this.shadowDistance,this.shadowBlur),this.accordionShadow=n}},{key:"updateUI",value:function(e,t,n){if((n||1===e.length)&&this.color.updateUI({value:e[0],isMultiColor:n}),t&&!n&&1!==e.length){var i=new Map,a=!0,o=!1,s=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value;i.set(c,c)}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}this.svgColorPickerTool.updateUI({colorMap:i,hideTransparent:!1,hideChangeSameColors:!1})}this.color.setDisplay(n||1===e.length),this.svgColorPickerTool.setDisplay(t&&!n&&1!==e.length);var u=this.textItems[0]||this.photoItems[0]||this.svgItems[0];u&&(this.accordionShadow.updateUI(u.props.isActiveShadow()),this.shadowColor.updateUI({value:u.props.getShadowColor(!0),active:!0}),this.shadowAngle.updateUI({value:u.props.getShadowAngle(!0),active:u.props.isActiveShadow()}),this.shadowAlpha.updateUI({value:u.props.getShadowAlpha(!0),active:u.props.isActiveShadow()}),this.shadowDistance.updateUI({value:u.props.getShadowDistance(!0),active:u.props.isActiveShadow()}),this.shadowBlur.updateUI({value:u instanceof q.a?u.props.getShadowDistance(!0):u.props.getShadowBlur(!0),active:u.props.isActiveShadow()}),this.shadowMenu.updateUI(u.props.isActiveShadow()))}},{key:"makeToolboxRowContents",value:function(){return[{row:this.colorRow,priority:600,viewType:0},{row:this.svgColorRow,priority:601,viewType:0},{row:this.accordionShadow,priority:602,viewType:0},{row:this.multiEffecRow,priority:700,viewType:0},{row:this.colorPickerRow,priority:820,viewType:0}]}},{key:"updateToolboxRowContents",value:function(e,t){var n=e.filter(function(e){return e instanceof q.a}),i=e.filter(function(e){return e instanceof Ju.a}),a=e.filter(function(e){return e instanceof Je.d}),o=e.some(function(e){return!(e instanceof q.a)&&e.props.isCanActiveShadow()}),s=e.length>1&&!t.isAdminEditView,r=0!==n.length||0!==i.length,l=0===n.length&&0===a.length,c=!1,u=[];if(n.length===e.length&&(r=!1),!s)return this.notValidAction(),!0;if(s&&r){var d=!0,h=!1,p=void 0;try{for(var m,f=n[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var v=m.value.props.getDuplicateValExcludedColors()[0].toLowerCase();if(u.length){if(u[0]!==v){c=!0;break}}else u.push(v)}}catch(e){h=!0,p=e}finally{try{d||null==f.return||f.return()}finally{if(h)throw p}}var g=0===u.length,E=!0,y=!1,T=void 0;try{for(var I,C=i[Symbol.iterator]();!(E=(I=C.next()).done);E=!0){var k=I.value;if(c)break;var L=k.getEditableOriginColors(),_=k.props.getColorMap(),w=!0,S=!1,b=void 0;try{for(var R,A=L[Symbol.iterator]();!(w=(R=A.next()).done);w=!0){var O=R.value,P=_.get(O.toLowerCase()).toLowerCase();if(g)u.push(P);else if(u.indexOf(P)<0){c=!0;break}}}catch(e){S=!0,b=e}finally{try{w||null==A.return||A.return()}finally{if(S)throw b}}g=0===u.length}}catch(e){y=!0,T=e}finally{try{E||null==C.return||C.return()}finally{if(y)throw T}}u.length||(r=!1)}var D=s&&!e[0].isLock();if(aa.a.setContentsVisible(this.toolTopContents,D),je.a.isMobilePortraitSize()?(this.toolTopContents.insertBefore(this.color.container,this.effectMenu),this.toolTopContents.insertBefore(this.svgColorPickerTool.container,this.effectMenu),this.color.canNotAppend=!0,this.svgColorPickerTool.canNotAppend=!0):(this.colorRow.container.appendChild(this.color.container),this.svgColorRow.container.appendChild(this.svgColorPickerTool.container),this.color.canNotAppend=!1,this.svgColorPickerTool.canNotAppend=!1),s){this.textItems=n,this.svgItems=i,this.photoItems=a;var M=s&&r&&(c||1===u.length);this.colorRow.rowVisible=M&&!je.a.isMobilePortraitSize(),this.colorPickerRow.rowVisible=M&&je.a.isMobilePortraitSize();var N=s&&r&&l&&!c&&1!==u.length;this.svgColorRow.rowVisible=N,this.accordionShadow.rowVisible=s&&o&&!je.a.isMobilePortraitSize(),this.multiEffecRow.rowVisible=s&&o&&je.a.isMobilePortraitSize(),this.updateUI(u,l,c),aa.a.setContentsVisible(this.svgColorMenu,N),aa.a.setContentsVisible(this.effectMenu,o)}else this.notValidAction();return!0}},{key:"notValidAction",value:function(){this.colorRow.rowVisible=!1,this.svgColorRow.rowVisible=!1,this.accordionShadow.rowVisible=!1,this.multiEffecRow.rowVisible=!1,this.colorPickerRow.rowVisible=!1,this.textItems=null,this.svgItems=null,this.photoItems=null,aa.a.setContentsVisible(this.toolTopContents,!1)}},{key:"isDefaultColor",value:function(e,t){return e instanceof q.a?t===Ii.e.RGB:e instanceof Je.d?t===Fu.b.RGB:e instanceof Ju.a&&t===Mu.a.RGB}},{key:"isDefaultSize",value:function(e,t){return e instanceof q.a?t===Ii.e.NUMBER:e instanceof Je.d?t===Fu.b.NUMBER:e instanceof Ju.a&&t===Mu.a.NUMBER}},{key:"getDefaultShadowValueItems",value:function(e){var t=this;return e.filter(function(e){return t.isDefaultColor(e,e.props.getShadowColor(!0))&&e instanceof q.a?e.props.isShadowAngleDefault():t.isDefaultSize(e,e.props.getShadowAngle(!0))&&t.isDefaultSize(e,e.props.getShadowDistance(!0))&&t.isDefaultSize(e,e instanceof q.a?e.props.getShadowDistance(!0):e.props.getShadowBlur(!0))})}}],[{key:"useItemGraphicEffectMapper",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e&&e.length&&X.a.instance.dispatch(new Un.b(e,e,t.actionType,t.groupName,t.name,n,i,t.timeout))}}]),e}(),nd=n(377),id=function(){function e(){var t=this;L()(this,e),this.btnReset=new xa(function(){X.a.instance.dispatch(new Rn.g(t.currentItem))},{icon:ne.ToolsIcon.ITEM_PHOTO}),new Le.a(this.btnReset.container,Ge.a.TR,{title:{name:"속성 초기화"}}).renderView(),this.btnPhotoCrop=new xa(function(){X.a.instance.dispatch(new Rn.h(t.currentItem))},{icon:ne.ToolsIcon.CROP}),new Le.a(this.btnPhotoCrop.container,Ge.a.TR,{title:{name:"사진 위치조정",shortcut:"더블클릭"}}).renderView(),this.btnToPhoto=new xa(function(){X.a.instance.dispatch(new Rn.b(t.currentItem))},{icon:ne.ToolsIcon.FRAME_SEPERATE}),new Le.a(this.btnToPhoto.container,Ge.a.TR,{title:{name:"사진 빼내기"}}).renderView(),this.btnDeletePhoto=new xa(function(){X.a.instance.dispatch(new Rn.a(t.currentItem))},{icon:ne.ToolsIcon.ICON_DEL_PHOTO}),new Le.a(this.btnDeletePhoto.container,Ge.a.TR,{title:{name:"사진 삭제"}}).renderView();var n=(new ia.g).setBorderBottom().addCustomClass(r.a.ROW_PHOTO_EDIT);n.add((new ia.f).add(this.btnReset,this.btnPhotoCrop,this.btnToPhoto,this.btnDeletePhoto)),this.photoButtonsRow=n;var i=(new ia.g).setBorderBottom();this.svgColorPickerTool=new Qu.a(function(e,n){return X.a.instance.dispatch(new ri.e(e,n,t.currentItem))},"색상",!1,function(){return t.onStartChangeColor()},function(){return t.onFinishChangeColor()}),i.add(this.svgColorPickerTool),this.colorPickerRow=(new ia.g).addCustomClass(r.a.COLOR_PICKER_ROW),this.svgColorRow=i,this.makeFilterRow(),this.makeAccordionShadowRow(),this.makeSvgEffectRow()}return w()(e,[{key:"makeSvgEffectRow",value:function(){var e=this;this.svgEffecRow=(new ia.g).addCustomClass(r.a.ACCORDION_EFFECT_ROW),this.shadowMenu=new Ba.a("그림자",function(){return e.showShadowMenu.click()},function(t){return e.shadowCheckedEvent(t)}),this.svgEffecRow.add(this.shadowMenu)}},{key:"onStartChangeColor",value:function(){this.currentItem.setStatus(qe.g.LAZY)}},{key:"onFinishChangeColor",value:function(){this.currentItem.setStatus(qe.g.CHANGE)}},{key:"makeMobileToolbox",value:function(){this.toolTopContents=aa.a.makeToolboxTopContentsWrapper(),this.mobileBtnImageframePhotoLock=aa.a.makeLabelContents(""),this.mobileBtnImageframePhotoLock.addEventListener("click",function(){return X.a.instance.dispatch(new Rn.c)}),this.toolTopContents.appendChild(this.mobileBtnImageframePhotoLock);var e=this.presetFilterMenu=aa.a.makeIconButtonShowToolsRow(ne.ToolsIcon.MAGIC_WAND,this.presetRow);this.toolTopContents.appendChild(e);var t=this.directFilterMenu=aa.a.makeIconButtonShowToolsRow(ne.ToolsIcon.TUNE2,this.directAdjustmentRowItem);return this.toolTopContents.appendChild(t),this.toolTopContents.appendChild(this.svgColorPickerTool.container),aa.a.setEventSvgColorTool(this.svgColorPickerTool,this.colorPickerRow),this.effectMenu=aa.a.makeButtonShowToolsRow("효과",this.svgEffecRow),this.toolTopContents.appendChild(this.effectMenu),this.showShadowMenu=aa.a.makeButtonShowToolsAccordionRow("그림자",this.accordionShadow),this.showShadowMenu.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.showShadowMenu),this.toolTopContents}},{key:"updateUI",value:function(t,n){this.currentItem=t;var i=new Map,a=!0,o=!1,s=void 0;try{for(var r,l=t.getEditableOriginColors()[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value;t.props.setCurrentOriginColor(c),i.set(c,t.props.getColor())}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}this.svgColorPickerTool.updateUI({colorMap:i}),this.svgColorPickerTool.setDisplay(!n),this.accordionFilterRow.updateAccordionUI(),this.preset.updateUI({value:t.innerPhotoItem.props.getPreset(),selectDefault:t.innerPhotoItem.props.isFilterValuesAllDefault()}),this.brightness.updateUI({value:t.innerPhotoItem.props.getBrightness()}),this.contrast.updateUI({value:t.innerPhotoItem.props.getContrast()}),this.saturation.updateUI({value:t.innerPhotoItem.props.getSaturation()}),this.tint.updateUI({value:t.innerPhotoItem.props.getTint()}),this.colorTone.updateUI({value:t.innerPhotoItem.props.getColorTone()}),this.temperature.updateUI({value:t.innerPhotoItem.props.getTemperature()}),this.blur.updateUI({value:t.innerPhotoItem.props.getBlur()}),this.vignette.updateUI({value:t.innerPhotoItem.props.getVignette()}),this.accordionShadow.updateUI(t.props.isActiveShadow()),this.shadowColor.updateUI({value:t.props.getShadowColor(!0),active:!0}),this.shadowAngle.updateUI({value:t.props.getShadowAngle(!0),active:t.props.isActiveShadow()}),this.shadowAlpha.updateUI({value:t.props.getShadowAlpha(!0),active:t.props.isActiveShadow()}),this.shadowDistance.updateUI({value:t.props.getShadowDistance(!0),active:t.props.isActiveShadow()}),this.shadowBlur.updateUI({value:t.props.getShadowBlur(!0),active:t.props.isActiveShadow()}),this.shadowMenu.updateUI(t.props.isActiveShadow()),this.btnReset.setDisplay(!0),this.btnPhotoCrop.setDisplay(!0);var u=Y.a.instance.activeItems[0]&&!Qe.b.isInGroup(Y.a.instance.activeItems[0]);this.btnPhotoCrop.updateUI({active:u,isSelected:!1}),this.btnToPhoto.setDisplay(!0),this.btnDeletePhoto.setDisplay(!0);var d=e.isVisiblePhotoLockBtn(t);this.mobileBtnImageframePhotoLock.style.display=d?"inline-block":"none",d&&(this.mobileBtnImageframePhotoLock.innerText=t.props.canInsertPhotoItem?"사진 잠금":"사진 잠금 해제")}},{key:"isDefaultColor",value:function(e){return e===Mu.a.RGB}},{key:"isDefaultSize",value:function(e){return e===Mu.a.NUMBER}},{key:"makeToolboxRowContents",value:function(){return[{row:this.svgColorRow,priority:500,viewType:0},{row:this.accordionFilterRow,priority:502,viewType:0},{row:this.accordionShadow,priority:800,viewType:0},{row:this.presetRow,priority:600,viewType:0},{row:this.directAdjustmentRowItem,priority:700,viewType:0},{row:this.svgEffecRow,priority:810,viewType:0},{row:this.colorPickerRow,priority:820,viewType:0}]}},{key:"updateToolboxRowContents",value:function(e,t){var n=t.renderedItem,i=t.renderedItem&&n instanceof ee.b;if(je.a.isMobilePortraitSize()?(this.toolTopContents.insertBefore(this.svgColorPickerTool.container,this.effectMenu),this.svgColorPickerTool.canNotAppend=!0):(this.svgColorRow.container.appendChild(this.svgColorPickerTool.container),this.svgColorPickerTool.canNotAppend=!1),je.a.isMobilePortraitSize()){var a=this.accordionFilterRow.getSectionRowWrap("preset"),o=this.accordionFilterRow.getSectionRowWrap("direct_adjustment");this.presetRow.container.contains(a)||this.presetRow.container.appendChild(a),this.directAdjustmentRowItem.container.contains(o)||this.directAdjustmentRowItem.container.appendChild(o)}else this.accordionFilterRow.setSectionRowWrap("preset"),this.accordionFilterRow.setSectionRowWrap("direct_adjustment");this.photoButtonsRow.rowVisible=i&&!t.isAdminEditView&&!n.isDefaultImage()&&!n.isLock();var s=i&&!t.isAdminEditView&&n.getEditableOriginColors().length>0;this.svgColorRow.rowVisible=s;var r=i&&!t.isAdminEditView&&!n.isDefaultImage();this.filterDevRow.rowVisible=r,this.accordionFilterRow.setRowsVisible(r&&!je.a.isMobilePortraitSize()),this.presetRow.rowVisible=r&&je.a.isMobilePortraitSize(),this.directAdjustmentRowItem.rowVisible=r&&je.a.isMobilePortraitSize(),this.svgEffecRow.rowVisible=i&&!t.isAdminEditView&&je.a.isMobilePortraitSize(),this.colorPickerRow.rowVisible=s&&je.a.isMobilePortraitSize(),this.accordionShadow.rowVisible=i&&!t.isAdminEditView;var l=i&&!t.isAdminEditView&&!t.renderedItem.isLock();return aa.a.setContentsVisible(this.toolTopContents,l),aa.a.setContentsVisible(this.presetFilterMenu,r),aa.a.setContentsVisible(this.directFilterMenu,r),aa.a.setContentsVisible(this.colorMenu,s),i?(this.currentItem=t.renderedItem,this.updateUI(this.currentItem,t.isAdminEditView)):this.currentItem=null,!0}},{key:"makeFilterRow",value:function(){var t=this;this.accordionFilterRow=new ia.b("필터",r.a.TOOLS_FILTER),this.preset=new Vu(function(e){X.a.instance.dispatch(new K.c(function(n,i){var a=t.currentItem.innerPhotoItem;a&&a.props.setPreset(""+e)})),t.applyPreset(e)}),this.presetRow=(new ia.g).addCustomClass(r.a.TOOLS_PRESET_FILTER_ROW),this.accordionFilterRow.addSection([(new ia.g).add(this.preset)],"preset","필터 효과",ne.ToolsIcon.MAGIC_WAND),this.filterDevRow=new ia.g,this.activeLive=new xa(function(e){X.a.instance.dispatch(new K.c(function(t,n,i){n.activeItems[0].isActiveLiveEdit=!0===e,n.activeItems[0].props.updateRevision()},!0))},{titleString:"liveEdit",icon:ne.ToolsIcon.CHECK},{titleString:"liveEdit",icon:ne.ToolsIcon.CLOSE}),this.activeWebGL=new xa(function(e){X.a.instance.dispatch(new K.c(function(t,n,i){n.activeItems[0].isActiveWebGLFilter=!0===e,n.activeItems[0].props.updateRevision()},!0))},{titleString:"WebGL",icon:ne.ToolsIcon.CHECK},{titleString:"WebGL",icon:ne.ToolsIcon.CLOSE}),this.filterDevRow.add(this.activeLive,this.activeWebGL),this.brightness=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem.innerPhotoItem],[t.currentItem],Li,n),t.updatePreset()},"",-100,100,1),this.brightnessRow=new ia.g("밝기").add(this.brightness),this.contrast=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem.innerPhotoItem],[t.currentItem],_i,n),t.updatePreset()},"",-100,100,1),this.contrastRow=new ia.g("대비").add(this.contrast),this.saturation=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem.innerPhotoItem],[t.currentItem],Si,n),t.updatePreset()},"",-100,100,1),this.saturationRow=new ia.g("채도").add(this.saturation),this.tint=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem.innerPhotoItem],[t.currentItem],bi,n),t.updatePreset()},"",-100,100,1),this.tint.setRangeBgCustomClass(r.a.RAINBOW_LINE),this.tintRow=new ia.g("* 색상 (관리자용)").add(this.tint).addCustomClass(r.a.ADMIN_UI),this.colorTone=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem.innerPhotoItem],[t.currentItem],Ri,n),t.updatePreset()},"",-100,100,1),this.colorTone.setRangeBgCustomClass(r.a.RAINBOW_LINE),this.colorToneRow=new ia.g("컬러톤").add(this.colorTone),this.temperature=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem.innerPhotoItem],[t.currentItem],Ai,n),t.updatePreset()},"",-100,100,1),this.temperature.setRangeBgCustomClass(r.a.TEMPERATURE_LINE),this.temperatureRow=new ia.g("온도").add(this.temperature),this.blur=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem.innerPhotoItem],[t.currentItem],Oi,n),t.updatePreset()},"",-100,100,1),this.blurRow=new ia.g("흐리기").add(this.blur),this.vignette=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem.innerPhotoItem],[t.currentItem],Pi,n),t.updatePreset()},"",0,100,1),this.vignetteRow=new ia.g("비네트").add(this.vignette);var n=[];n.push(this.brightnessRow),n.push(this.contrastRow),n.push(this.saturationRow),n.push(this.colorToneRow),n.push(this.temperatureRow),n.push(this.blurRow),n.push(this.vignetteRow),n.push(this.tintRow),this.directAdjustmentRowItem=(new ia.g).addCustomClass(r.a.TOOLS_DIRECT_FILTER_ROW),this.accordionFilterRow.addSection(n,"direct_adjustment","직접 조정",ne.ToolsIcon.TUNE2)}},{key:"shadowCheckedEvent",value:function(t,n){var i=this;X.a.instance.groupingAction(function(){!0===t&&i.isDefaultColor(i.currentItem.props.getShadowColor(!0))&&i.isDefaultSize(i.currentItem.props.getShadowAngle(!0))&&i.isDefaultSize(i.currentItem.props.getShadowDistance(!0))&&i.isDefaultSize(i.currentItem.props.getShadowBlur(!0))&&(e.useSvgImageframeEffectMapper([i.currentItem],[i.currentItem],ed.c,315,!1),e.useSvgImageframeEffectMapper([i.currentItem],[i.currentItem],ed.b,50,!1),e.useSvgImageframeEffectMapper([i.currentItem],[i.currentItem],ed.f,12,!1),e.useSvgImageframeEffectMapper([i.currentItem],[i.currentItem],ed.d,8,!1)),e.useSvgImageframeEffectMapper([i.currentItem],[i.currentItem],ed.a,t),n&&e.useSvgImageframeEffectMapper([i.currentItem],[i.currentItem],ed.e,n)})}},{key:"makeAccordionShadowRow",value:function(){var t=this,n=new ia.c("그림자",function(e){return t.shadowCheckedEvent(e)}).setFlex().setBorderBottom();this.shadowColor=new Pa.a(function(e){t.shadowCheckedEvent(!0,e)},ne.ToolsIcon.PENCIL,"색상",!1,!0).addClass(r.a.ACCORDION_ROW_COLOR),this.shadowAngle=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem],[t.currentItem],ed.c,n)},"방향",0,360,1,"°"),this.shadowAlpha=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem],[t.currentItem],ed.b,n)},"투명도",0,100,1,"%"),this.shadowDistance=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem],[t.currentItem],ed.f,n)},"거리",0,100,1),this.shadowBlur=new Na.a(function(n){e.useSvgImageframeEffectMapper([t.currentItem],[t.currentItem],ed.d,n)},"흐림",0,100,1),n.addCustomClass(r.a.EFFECT_TOOLS),n.setPrevCallback(function(){return t.effectMenu.click()}),n.appendElement(this.shadowColor.getContainer()).add(this.shadowAngle,this.shadowAlpha,this.shadowDistance,this.shadowBlur),this.accordionShadow=n}},{key:"updatePreset",value:function(){this.preset.updateSelectedItem(this.currentItem.innerPhotoItem.props.isFilterValuesAllDefault()),this.currentItem.innerPhotoItem.props.setPreset("")}},{key:"applyPreset",value:function(e,t){this.currentItem.props.updateRevision(!0),X.a.instance.dispatch(new na(e,Ei.b.PHOTO,t,null,null,[this.currentItem.innerPhotoItem]))}}],[{key:"isVisiblePhotoLockBtn",value:function(e){return e&&e instanceof ee.b&&!e.isLock()&&!e.isDefaultImage()}},{key:"useSvgImageframeEffectMapper",value:function(e,t,n,i){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];X.a.instance.dispatch(new Un.b(e,t,n.actionType,n.groupName,n.name,i,a,n.timeout))}}]),e}(),ad=n(301),od=function(){function e(){var t=this;L()(this,e);var n=(new ia.g).setBorderBottom();this.svgColorPickerTool=new Qu.a(function(e,n){return X.a.instance.dispatch(new ri.e(e,n,t.currentItem))},"색상",!1,function(){return t.onStartChangeColor()},function(){return t.onFinishChangeColor()}),n.add(this.svgColorPickerTool),this.colorPickerRow=(new ia.g).addCustomClass(r.a.COLOR_PICKER_ROW);var i=new ia.c("그림자",function(e){return t.shadowCheckedEvent(e)}).setFlex().setBorderBottom();this.shadowColor=new Pa.a(function(e){t.shadowCheckedEvent(!0,e)},ne.ToolsIcon.PENCIL,"색상",!1,!0).addClass(r.a.ACCORDION_ROW_COLOR),this.shadowAngle=new Na.a(function(n){e.useSvgGraphicEffectMapper([t.currentItem],ed.c,n)},"방향",0,360,1,"°"),this.shadowAlpha=new Na.a(function(n){e.useSvgGraphicEffectMapper([t.currentItem],ed.b,n)},"투명도",0,100,1,"%"),this.shadowDistance=new Na.a(function(n){e.useSvgGraphicEffectMapper([t.currentItem],ed.f,n)},"거리",0,100,1),this.shadowBlur=new Na.a(function(n){e.useSvgGraphicEffectMapper([t.currentItem],ed.d,n)},"흐림",0,100,1),i.addCustomClass(r.a.EFFECT_TOOLS),i.setPrevCallback(function(){return t.effectMenu.click()}),i.appendElement(this.shadowColor.getContainer()).add(this.shadowAngle,this.shadowAlpha,this.shadowDistance,this.shadowBlur),this.svgColorRow=n,this.accordionShadow=i,this.makeShadowEffectRow()}return w()(e,[{key:"shadowCheckedEvent",value:function(t,n){var i=this;X.a.instance.groupingAction(function(){!0===t&&i.isDefaultColor(i.currentItem.props.getShadowColor(!0))&&i.isDefaultSize(i.currentItem.props.getShadowAngle(!0))&&i.isDefaultSize(i.currentItem.props.getShadowDistance(!0))&&i.isDefaultSize(i.currentItem.props.getShadowBlur(!0))&&(e.useSvgGraphicEffectMapper([i.currentItem],ed.c,315,!1),e.useSvgGraphicEffectMapper([i.currentItem],ed.b,50,!1),e.useSvgGraphicEffectMapper([i.currentItem],ed.f,12,!1),e.useSvgGraphicEffectMapper([i.currentItem],ed.d,8,!1)),e.useSvgGraphicEffectMapper([i.currentItem],ed.a,t),n&&e.useSvgGraphicEffectMapper([i.currentItem],ed.e,n)})}},{key:"makeShadowEffectRow",value:function(){var e=this;this.shadowEffecRow=(new ia.g).addCustomClass(r.a.ACCORDION_EFFECT_ROW),this.shadowMenu=new Ba.a("그림자",function(){return e.showShadowMenu.click()},function(t){return e.shadowCheckedEvent(t)}),this.shadowEffecRow.add(this.shadowMenu)}},{key:"makeMobileToolbox",value:function(){return this.toolTopContents=aa.a.makeToolboxTopContentsWrapper(),this.toolTopContents.appendChild(this.svgColorPickerTool.container),aa.a.setEventSvgColorTool(this.svgColorPickerTool,this.colorPickerRow),this.effectMenu=aa.a.makeButtonShowToolsRow("효과",this.shadowEffecRow),this.toolTopContents.appendChild(this.effectMenu),this.showShadowMenu=aa.a.makeButtonShowToolsAccordionRow("그림자",this.accordionShadow),this.showShadowMenu.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.showShadowMenu),this.toolTopContents}},{key:"updateUI",value:function(e,t){var n=new Map,i=!0,a=!1,o=void 0;try{for(var s,r=this.currentItem.getEditableOriginColors()[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value;this.currentItem.props.setCurrentOriginColor(l),n.set(l,this.currentItem.props.getColor())}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}this.svgColorPickerTool.updateUI({colorMap:n,hideTransparent:!0,hideChangeSameColors:!1}),this.svgColorPickerTool.setDisplay(!t),this.accordionShadow.updateUI(e.props.isActiveShadow()),this.shadowColor.updateUI({value:e.props.getShadowColor(!0),active:!0}),this.shadowAngle.updateUI({value:e.props.getShadowAngle(!0),active:e.props.isActiveShadow()}),this.shadowAlpha.updateUI({value:e.props.getShadowAlpha(!0),active:e.props.isActiveShadow()}),this.shadowDistance.updateUI({value:e.props.getShadowDistance(!0),active:e.props.isActiveShadow()}),this.shadowBlur.updateUI({value:e.props.getShadowBlur(!0),active:e.props.isActiveShadow()}),this.shadowMenu.updateUI(e.props.isActiveShadow())}},{key:"isDefaultColor",value:function(e){return e===Mu.a.RGB}},{key:"isDefaultSize",value:function(e){return e===Mu.a.NUMBER}},{key:"makeToolboxRowContents",value:function(){return[{row:this.svgColorRow,priority:600,viewType:0},{row:this.accordionShadow,priority:800,viewType:0},{row:this.shadowEffecRow,priority:810,viewType:0},{row:this.colorPickerRow,priority:820,viewType:0}]}},{key:"updateToolboxRowContents",value:function(e,t){var n=t.renderedItem&&t.renderedItem instanceof ad.a,i=n&&!t.isAdminEditView&&t.renderedItem.getEditableOriginColors().length>0;this.svgColorRow.rowVisible=i;var a=n&&!t.isAdminEditView&&t.renderedItem&&t.renderedItem.isOnlyOneItem(),o=n&&!t.isAdminEditView&&!t.renderedItem.isBackground;this.accordionShadow.rowVisible=o,this.shadowEffecRow.rowVisible=o&&je.a.isMobilePortraitSize(),this.colorPickerRow.rowVisible=i&&je.a.isMobilePortraitSize(),je.a.isMobilePortraitSize()?(this.toolTopContents.insertBefore(this.svgColorPickerTool.container,this.effectMenu),this.svgColorPickerTool.canNotAppend=!0):(this.svgColorRow.container.appendChild(this.svgColorPickerTool.container),this.svgColorPickerTool.canNotAppend=!1);var s=n&&!t.isAdminEditView&&!t.renderedItem.isLock();return aa.a.setContentsVisible(this.toolTopContents,s),aa.a.setContentsVisible(this.colorMenu,i),aa.a.setContentsVisible(this.patternSizeMenu,a),aa.a.setContentsVisible(this.effectMenu,o),n?(this.currentItem=t.renderedItem,this.updateUI(this.currentItem,t.isAdminEditView)):this.currentItem=null,!0}},{key:"onStartChangeColor",value:function(){this.currentItem.setStatus(qe.g.LAZY)}},{key:"onFinishChangeColor",value:function(){try{this.currentItem.setStatus(qe.g.CHANGE)}catch(e){console.error(e)}}}],[{key:"useSvgGraphicEffectMapper",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];X.a.instance.dispatch(new Un.b(e,e,t.actionType,t.groupName,t.name,n,i,t.timeout))}}]),e}(),sd={groupName:"outline",name:"active",actionType:K.a.SVG_GRAPHIC_OUTLINE_ACTIVE},rd={groupName:"outline",name:"color",actionType:K.a.SVG_GRAPHIC_OUTLINE_COLOR,timeout:3e3},ld={groupName:"outline",name:"size",actionType:K.a.SVG_GRAPHIC_OUTLINE_SIZE,timeout:3e3},cd={groupName:"outline",name:"type",actionType:K.a.SVG_GRAPHIC_OUTLINE_TYPE,timeout:3e3},ud=n(335),dd=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0))).lineList=[],n.isStyleTemplateProp=!1,n.listener=e,n.container.className="".concat(r.a.TOOLS_ITEM," ").concat(r.a.SELECT_ITEM," item_stroke_type"),n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e,n;he()(F()(t.prototype),"onCreateView",this).call(this);var i=document.createElement("button");i.classList.add("title"),i.textContent="종류";var a=document.createElement("button");a.classList.add("strokeListBtn");var o=document.createElement("button");o.classList.add("currentStrokeType");var s=document.createElement("button");s.classList.add("solid"),o.appendChild(s),Object(ne.setToolsIcon)(o,ne.ToolsIcon.GREATER_THAN,!0),a.appendChild(o);var r=document.createElement("button");r.classList.add("popupList");var l=document.createElement("button");(e=l.classList).add.apply(e,["lineTypeBtn","solidBtn"]),l.setAttribute(t.LI_TAG_VALUE_ATTR_NAME,"solid");var c=document.createElement("button");c.classList.add("solid"),l.appendChild(c);var u=document.createElement("button");(n=u.classList).add.apply(n,["lineTypeBtn","dashBtn"]),u.setAttribute(t.LI_TAG_VALUE_ATTR_NAME,"dash");var d=document.createElement("button");d.classList.add("dash"),u.appendChild(d),r.appendChild(l),r.appendChild(u),a.appendChild(r),this.currentStrokeLine=s,this.strokeListBtn=a,this.popupList=r,this.lineList.push(l),this.lineList.push(u),this.container.appendChild(i),this.container.appendChild(a),this.addEventListener()}},{key:"updateUI",value:function(e){var t=e.value;this.currentStrokeLine.className=t}},{key:"hidePopup",value:function(){this.popupList.classList.remove(t.POPUP_ACTIVE)}},{key:"showPopup",value:function(){this.popupList.classList.add(t.POPUP_ACTIVE)}},{key:"addEventListener",value:function(){var e=this,n=function t(){e.hidePopup(),document.removeEventListener("click",t)};this.strokeListBtn.addEventListener("click",function(i){i.stopPropagation(),i.preventDefault(),e.popupList.classList.contains(t.POPUP_ACTIVE)?(e.hidePopup(),document.removeEventListener("click",n)):(e.showPopup(),document.addEventListener("click",n))});var i=!0,a=!1,o=void 0;try{for(var s,r=function(){var n=s.value;n.addEventListener("mouseenter",function(){n.classList.add("hover")}),n.addEventListener("mouseleave",function(){n.classList.remove("hover")}),n.addEventListener("click",function(){e.listener(n.getAttribute(t.LI_TAG_VALUE_ATTR_NAME))})},l=this.lineList[Symbol.iterator]();!(i=(s=l.next()).done);i=!0)r()}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}}}]),t}(He.a);dd.POPUP_ACTIVE="active",dd.LI_TAG_VALUE_ATTR_NAME="data-value";var hd,pd=function(){function e(){var t=this;L()(this,e);var n=(new ia.g).setBorderBottom();this.svgColorPickerTool=new Qu.a(function(e,n){return X.a.instance.dispatch(new ri.e(e,n,t.currentItem))},"색상",!1,function(){return t.onStartChangeColor()},function(){return t.onFinishChangeColor()}),n.add(this.svgColorPickerTool),this.colorPickerRow=(new ia.g).addCustomClass(r.a.COLOR_PICKER_ROW),this.svgColorRow=n,this.makeAccordionOutlineRow(),this.makeAccordionShadowRow(),this.makeSvgEffectRow()}return w()(e,[{key:"makeSvgEffectRow",value:function(){var e=this;this.svgEffecRow=(new ia.g).addCustomClass(r.a.ACCORDION_EFFECT_ROW),this.outlineMenu=new Ba.a("외곽선",function(){return e.showOutlineMenu.click()},function(t){return e.outlineCheckedEvent(t)}),this.shadowMenu=new Ba.a("그림자",function(){return e.showShadowMenu.click()},function(t){return e.shadowCheckedEvent(t)}),this.svgEffecRow.add(this.outlineMenu,this.shadowMenu)}},{key:"makeMobileToolbox",value:function(){return this.toolTopContents=aa.a.makeToolboxTopContentsWrapper(),this.toolTopContents.appendChild(this.svgColorPickerTool.container),aa.a.setEventSvgColorTool(this.svgColorPickerTool,this.colorPickerRow),this.effectMenu=aa.a.makeButtonShowToolsRow("효과",this.svgEffecRow),this.toolTopContents.appendChild(this.effectMenu),this.showOutlineMenu=aa.a.makeButtonShowToolsAccordionRow("외곽선",this.accordionOutline),this.showOutlineMenu.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.showOutlineMenu),this.showShadowMenu=aa.a.makeButtonShowToolsAccordionRow("그림자",this.accordionShadow),this.showShadowMenu.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.showShadowMenu),this.toolTopContents}},{key:"makeAccordionOutlineRow",value:function(){var t=this,n=new ia.c("외곽선",function(e){return t.outlineCheckedEvent(e)}).setFlex().setBorderBottom();this.outlineType=new dd(function(n){e.useSvgShapePropMapper(cd,n,[t.currentItem])}),this.outlineColor=new Pa.a(function(e){t.outlineCheckedEvent(!0,e)},ne.ToolsIcon.PENCIL,"색상",!1,!0).addClass(r.a.ACCORDION_ROW_COLOR),this.outlineSize=new Na.a(function(n){e.useSvgShapePropMapper(ld,n,[t.currentItem])},"두께",1,25,1),n.addCustomClass(r.a.EFFECT_TOOLS),n.setPrevCallback(function(){return t.effectMenu.click()}),n.appendElement(this.outlineColor.getContainer()).add(this.outlineType,this.outlineSize),this.accordionOutline=n}},{key:"outlineCheckedEvent",value:function(t,n){var i=this;X.a.instance.groupingAction(function(){e.useSvgShapePropMapper(sd,t,[i.currentItem]),n&&e.useSvgShapeEffectMapper([i.currentItem],rd,n)})}},{key:"shadowCheckedEvent",value:function(t,n){var i=this;X.a.instance.groupingAction(function(){!0===t&&i.isDefaultColor(i.currentItem.props.getShadowColor(!0))&&i.isDefaultSize(i.currentItem.props.getShadowAngle(!0))&&i.isDefaultSize(i.currentItem.props.getShadowDistance(!0))&&i.isDefaultSize(i.currentItem.props.getShadowBlur(!0))&&(e.useSvgShapeEffectMapper([i.currentItem],ed.c,315,!1),e.useSvgShapeEffectMapper([i.currentItem],ed.b,50,!1),e.useSvgShapeEffectMapper([i.currentItem],ed.f,12,!1),e.useSvgShapeEffectMapper([i.currentItem],ed.d,8,!1)),e.useSvgShapeEffectMapper([i.currentItem],ed.a,t),n&&e.useSvgShapeEffectMapper([i.currentItem],ed.e,n)})}},{key:"makeAccordionShadowRow",value:function(){var t=this,n=new ia.c("그림자",function(e){return t.shadowCheckedEvent(e)}).setFlex().setBorderBottom();this.shadowColor=new Pa.a(function(e){t.shadowCheckedEvent(!0,e)},ne.ToolsIcon.PENCIL,"색상",!1,!0).addClass(r.a.ACCORDION_ROW_COLOR),this.shadowAngle=new Na.a(function(n){e.useSvgShapeEffectMapper([t.currentItem],ed.c,n)},"방향",0,360,1,"°"),this.shadowAlpha=new Na.a(function(n){e.useSvgShapeEffectMapper([t.currentItem],ed.b,n)},"투명도",0,100,1,"%"),this.shadowDistance=new Na.a(function(n){e.useSvgShapeEffectMapper([t.currentItem],ed.f,n)},"거리",0,100,1),this.shadowBlur=new Na.a(function(n){e.useSvgShapeEffectMapper([t.currentItem],ed.d,n)},"흐림",0,100,1),n.addCustomClass(r.a.EFFECT_TOOLS),n.setPrevCallback(function(){return t.effectMenu.click()}),n.appendElement(this.shadowColor.getContainer()).add(this.shadowAngle,this.shadowAlpha,this.shadowDistance,this.shadowBlur),this.accordionShadow=n}},{key:"updateUI",value:function(e,t){var n=new Map,i=!0,a=!1,o=void 0;try{for(var s,r=this.currentItem.getEditableOriginColors()[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value;this.currentItem.props.setCurrentOriginColor(l),n.set(l,this.currentItem.props.getColor())}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}this.svgColorPickerTool.updateUI({colorMap:n}),this.svgColorPickerTool.setDisplay(!t),this.accordionOutline.updateUI(e.props.isActiveOutline()),this.outlineColor.updateUI({value:e.props.getOutlineColor(),active:!0}),this.outlineSize.updateUI({value:e.props.getOutlineSize(),active:e.props.isActiveOutline()}),this.outlineType.updateUI({value:e.props.getOutlineType(),active:e.props.isActiveOutline()}),this.accordionShadow.updateUI(e.props.isActiveShadow()),this.shadowColor.updateUI({value:e.props.getShadowColor(!0),active:!0}),this.shadowAngle.updateUI({value:e.props.getShadowAngle(!0),active:e.props.isActiveShadow()}),this.shadowAlpha.updateUI({value:e.props.getShadowAlpha(!0),active:e.props.isActiveShadow()}),this.shadowDistance.updateUI({value:e.props.getShadowDistance(!0),active:e.props.isActiveShadow()}),this.shadowBlur.updateUI({value:e.props.getShadowBlur(!0),active:e.props.isActiveShadow()}),this.shadowMenu.updateUI(e.props.isActiveShadow()),this.outlineMenu.updateUI(e.props.isActiveOutline())}},{key:"onStartChangeColor",value:function(){this.currentItem.setStatus(qe.g.LAZY)}},{key:"onFinishChangeColor",value:function(){try{this.currentItem.setStatus(qe.g.CHANGE)}catch(e){console.error(e)}}},{key:"isDefaultColor",value:function(e){return e===Mu.a.RGB}},{key:"isDefaultSize",value:function(e){return e===Mu.a.NUMBER}},{key:"makeToolboxRowContents",value:function(){return[{row:this.svgColorRow,priority:600,viewType:0},{row:this.accordionOutline,priority:650,viewType:0},{row:this.accordionShadow,priority:800,viewType:0},{row:this.svgEffecRow,priority:810,viewType:0},{row:this.colorPickerRow,priority:820,viewType:0}]}},{key:"updateToolboxRowContents",value:function(e,t){var n=t.renderedItem&&t.renderedItem instanceof ud.a,i=n&&!t.isAdminEditView&&t.renderedItem.getEditableOriginColors().length>0;this.svgColorRow.rowVisible=i,this.accordionOutline.rowVisible=n&&!t.isAdminEditView,this.accordionShadow.rowVisible=n&&!t.isAdminEditView,this.svgEffecRow.rowVisible=n&&!t.isAdminEditView&&je.a.isMobilePortraitSize(),this.colorPickerRow.rowVisible=i&&je.a.isMobilePortraitSize(),je.a.isMobilePortraitSize()?(this.toolTopContents.insertBefore(this.svgColorPickerTool.container,this.effectMenu),this.svgColorPickerTool.canNotAppend=!0):(this.svgColorRow.container.appendChild(this.svgColorPickerTool.container),this.svgColorPickerTool.canNotAppend=!1);var a=n&&!t.isAdminEditView&&!t.renderedItem.isLock();return aa.a.setContentsVisible(this.toolTopContents,a),aa.a.setContentsVisible(this.colorMenu,i),n?(this.currentItem=t.renderedItem,this.updateUI(this.currentItem,t.isAdminEditView)):this.currentItem=null,!0}}],[{key:"useSvgShapePropMapper",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];X.a.instance.dispatch(new Un.d(e.actionType,e.groupName,e.name,t,i,e.timeout,!0,n))}},{key:"useSvgShapeEffectMapper",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];X.a.instance.dispatch(new Un.b(e,e,t.actionType,t.groupName,t.name,n,i,t.timeout))}}]),e}(),md=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.a.instance.activeItems.slice();return L()(this,t),(e=V()(this,F()(t).call(this))).isActionGroupEquals=function(e){return!1},e.changeDesign=function(){return!0},e.movePositions=[],e.doSaveQueue=!0,e.commitAction=function(t,n,i){if(e.doSaveQueue){var a=t.pages[e.pageIdx];e.pageId=a.pageId,e.pageWidth=a.sheetSize.width,e.pageHeight=a.sheetSize.height,e.movePositions=[],e.commitAlignAction(e.selectedItems,i.itemHandleVC.getLTRB())}},e.rollbackAction=function(t,n,i){if(e.movePositions.length===e.selectedItems.length){for(var a=0;a<e.movePositions.length;a++)e.selectedItems[a].move(-e.movePositions[a].x,-e.movePositions[a].y);var o=t.pages[n.renderPageIdx];e.pageId===o.pageId&&J.a.selectItems(e.selectedItems)}},e.recycle=function(){e.movePositions=null,e.selectedItems=null},e.selectedItems=n,e.pageIdx=Y.a.instance.renderPageIdx,e}return z()(t,e),t}(K.b),fd=function(){function e(){L()(this,e)}return w()(e,null,[{key:"getPosition",value:function(e,t){if(!e)return 0;var n=e.getLTRBCoordinate(!0);switch(t){case hd.LEFT:return n.left;case hd.TOP:return n.top;case hd.RIGHT:return n.right;case hd.BOTTOM:return n.bottom;default:return 0}}},{key:"removeLastItems",value:function(e,t){e.forEach(function(n){var i=Qe.b.getRootGroup(n.groupId);(n===t||i&&i.has(t))&&e.splice(e.indexOf(n),1)})}},{key:"isSameItemsToSort",value:function(e,t){var n=Qe.b.getRootGroup(e.groupId);return e===t||n&&n.has(t)}},{key:"sortItems",value:function(t,n){var i=t.slice();return i.sort(function(t,i){var a=e.getPosition(t,n),o=e.getPosition(i,n);return a>o?1:a<o?-1:0}),n!==hd.RIGHT&&n!==hd.BOTTOM||i.reverse(),e.getItemsToSort(i)}},{key:"getItemsToSort",value:function(e){var t=[],n=[],i=!0,a=!1,o=void 0;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value,c=Qe.b.getRootGroup(l.groupId);c?n.indexOf(c.getGroupId())<0&&(t.push(l),n.push(c.getGroupId())):t.push(l)}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}return t}},{key:"getItemsCountToSort",value:function(t){return e.getItemsToSort(t).length}}]),e}();!function(e){e[e.LEFT=0]="LEFT",e[e.TOP=1]="TOP",e[e.RIGHT=2]="RIGHT",e[e.BOTTOM=3]="BOTTOM"}(hd||(hd={}));var vd,gd=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe.b.getGroupItemsAddedArray(Y.a.instance.activeItems.slice());return L()(this,t),(e=V()(this,F()(t).call(this))).groupMoveMap=new Map,e.groupLTRBMap=new Map,e.recycle=function(){e.groupLTRBMap=null,e.groupMoveMap=null},e.selectedItems=n,n.length<2&&(e.doSaveQueue=!1),e}return z()(t,e),w()(t,[{key:"getItemLTRBCoorinate",value:function(e){var t=Qe.b.getRootGroup(e.groupId);if(t){var n=t.getLTRBCoordinate(!0);return this.groupLTRBMap.has(t.getGroupId())||this.groupLTRBMap.set(t.getGroupId(),n),n}return e.getLTRBCoordinate(!0)}},{key:"sumDistributeItemWidth",value:function(e){var t=0,n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var r=o.value;t+=this.getItemLTRBCoorinate(r).getWidth()}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return t}},{key:"sumDistributeItemHeight",value:function(e){var t=0,n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var r=o.value;t+=this.getItemLTRBCoorinate(r).getHeight()}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return t}}]),t}(md),Ed=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_LEFT,n.commitAlignAction=function(e,t){var i=!0,a=!1,o=void 0;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value,c=n.getItemLTRBCoorinate(l),u=t.left-c.left,d=Qe.b.getRootGroup(l.groupId);d&&(n.groupMoveMap.has(d.getGroupId())?u=n.groupMoveMap.get(d.getGroupId()).x:n.groupMoveMap.set(d.getGroupId(),new ns.a(u,0))),n.movePositions.push(new ns.a(u,0)),l.move(u,0)}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}},n}return z()(t,e),t}(gd),yd=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_RIGHT,n.commitAlignAction=function(e,t){var i=!0,a=!1,o=void 0;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value,c=n.getItemLTRBCoorinate(l),u=t.right-c.right,d=Qe.b.getRootGroup(l.groupId);d&&(n.groupMoveMap.has(d.getGroupId())?u=n.groupMoveMap.get(d.getGroupId()).x:n.groupMoveMap.set(d.getGroupId(),new ns.a(u,0))),n.movePositions.push(new ns.a(u,0)),l.move(u,0)}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}},n}return z()(t,e),t}(gd),Td=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_TOP,n.commitAlignAction=function(e,t){var i=!0,a=!1,o=void 0;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value,c=n.getItemLTRBCoorinate(l),u=t.top-c.top,d=Qe.b.getRootGroup(l.groupId);d&&(n.groupMoveMap.has(d.getGroupId())?u=n.groupMoveMap.get(d.getGroupId()).y:n.groupMoveMap.set(d.getGroupId(),new ns.a(0,u))),n.movePositions.push(new ns.a(0,u)),l.move(0,u)}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}},n}return z()(t,e),t}(gd),Id=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_BOTTOM,n.commitAlignAction=function(e,t){var i=!0,a=!1,o=void 0;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value,c=n.getItemLTRBCoorinate(l),u=t.bottom-c.bottom,d=Qe.b.getRootGroup(l.groupId);d&&(n.groupMoveMap.has(d.getGroupId())?u=n.groupMoveMap.get(d.getGroupId()).y:n.groupMoveMap.set(d.getGroupId(),new ns.a(0,u))),n.movePositions.push(new ns.a(0,u)),l.move(0,u)}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}},n}return z()(t,e),t}(gd),Cd=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_CENTER,n.commitAlignAction=function(e){var t=n.selectedItems.reduce(function(e,t){return e.getLTRBCoordinate().getRotatedLTRB(e.props.getRotate()).left>t.getLTRBCoordinate().getRotatedLTRB(t.props.getRotate()).left?t:e}),i=n.selectedItems.reduce(function(e,t){return e.getLTRBCoordinate().getRotatedLTRB(e.props.getRotate()).right<t.getLTRBCoordinate().getRotatedLTRB(t.props.getRotate()).right?t:e}),a=(t.getLTRBCoordinate().getRotatedLTRB(t.props.getRotate()).left+i.getLTRBCoordinate().getRotatedLTRB(i.props.getRotate()).right)/2,o=!0,s=!1,r=void 0;try{for(var l,c=e[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value,d=n.getItemLTRBCoorinate(u),h=-(d.left-(a-d.getWidth()/2)),p=Qe.b.getRootGroup(u.groupId);p&&(n.groupMoveMap.has(p.getGroupId())?h=n.groupMoveMap.get(p.getGroupId()).x:n.groupMoveMap.set(p.getGroupId(),new ns.a(h,0))),n.movePositions.push(new ns.a(h,0)),u.move(h,0)}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}},n}return z()(t,e),t}(gd),kd=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_MIDDLE,n.commitAlignAction=function(e){var t=n.selectedItems.reduce(function(e,t){return e.getLTRBCoordinate().getRotatedLTRB(e.props.getRotate()).top>t.getLTRBCoordinate().getRotatedLTRB(t.props.getRotate()).top?t:e}),i=n.selectedItems.reduce(function(e,t){return e.getLTRBCoordinate().getRotatedLTRB(e.props.getRotate()).bottom<t.getLTRBCoordinate().getRotatedLTRB(t.props.getRotate()).bottom?t:e}),a=(t.getLTRBCoordinate().getRotatedLTRB(t.props.getRotate()).top+i.getLTRBCoordinate().getRotatedLTRB(i.props.getRotate()).bottom)/2,o=!0,s=!1,r=void 0;try{for(var l,c=e[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value,d=n.getItemLTRBCoorinate(u),h=-(d.top-(a-d.getHeight()/2)),p=Qe.b.getRootGroup(u.groupId);p&&(n.groupMoveMap.has(p.getGroupId())?h=n.groupMoveMap.get(p.getGroupId()).y:n.groupMoveMap.set(p.getGroupId(),new ns.a(0,h))),n.movePositions.push(new ns.a(0,h)),u.move(0,h)}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}},n}return z()(t,e),t}(gd),Ld=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"initMovePositions",value:function(e){for(var t=0,n=e.length;t<n;t++)this.movePositions[t]=new ns.a(0,0)}},{key:"itemMoveX",value:function(e,t,n){for(var i=Qe.b.getRootGroup(t.groupId),a=0,o=e.length;a<o;a++){var s=e[a];(s.tbpeId===t.tbpeId||i&&i.has(s))&&(this.movePositions[a]=new ns.a(n,0),s.move(n,0))}}},{key:"itemMoveY",value:function(e,t,n){for(var i=Qe.b.getRootGroup(t.groupId),a=0,o=e.length;a<o;a++){var s=e[a];(s.tbpeId===t.tbpeId||i&&i.has(s))&&(this.movePositions[a]=new ns.a(0,n),s.move(0,n))}}},{key:"getHorizontalInterval",value:function(e,t,n){var i=e.length-(n?0:1);return(t-(this.sumDistributeItemWidth(e)-(n?t:0)))/i}},{key:"getVerticalInterval",value:function(e,t,n){var i=e.length-(n?0:1);return(t-(this.sumDistributeItemHeight(e)-(n?t:0)))/i}}]),t}(gd),_d=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.DISTRIBUTE_HORIZONTALLY,n.commitAlignAction=function(e){var t=fd.sortItems(e,hd.LEFT);n.initMovePositions(e);var i=t[0],a=fd.sortItems(e,hd.RIGHT)[0],o=fd.isSameItemsToSort(i,a),s=n.getItemLTRBCoorinate(a).right-n.getItemLTRBCoorinate(i).left,r=n.getHorizontalInterval(t,s,o);o||fd.removeLastItems(t,a);for(var l=1,c=t.length;l<c;l++){var u=t[l],d=n.getItemLTRBCoorinate(t[l-1]),h=n.getItemLTRBCoorinate(u).left,p=(o&&1===l?d.left:d.right)+r-h;n.itemMoveX(e,u,p)}},n}return z()(t,e),t}(Ld),wd=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.DISTRIBUTE_VERTICALLY,n.commitAlignAction=function(e){var t=fd.sortItems(e,hd.TOP);n.initMovePositions(e);var i=t[0],a=fd.sortItems(e,hd.BOTTOM)[0],o=fd.isSameItemsToSort(i,a),s=n.getItemLTRBCoorinate(a).bottom-n.getItemLTRBCoorinate(i).top,r=n.getVerticalInterval(t,s,o);o||fd.removeLastItems(t,a);for(var l=1,c=t.length;l<c;l++){var u=t[l],d=n.getItemLTRBCoorinate(t[l-1]),h=n.getItemLTRBCoorinate(u).top,p=(o&&1===l?d.top:d.bottom)+r-h;n.itemMoveY(e,u,p)}},n}return z()(t,e),t}(Ld),Sd=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.a.instance.activeItems.slice();if(L()(this,t),(e=V()(this,F()(t).call(this))).selectedItems=n,1===n.length||Qe.b.isSameGroup(n)){if(1===n.length){var i=Qe.b.getRootGroup(n[0].groupId);i&&i.getAllSingleMembers().forEach(function(e){n.indexOf(e)<0&&n.push(e)})}}else e.doSaveQueue=!1;return e}return z()(t,e),t}(md),bd=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_LEFT,n.commitAlignAction=function(e,t){var i=Number.MAX_VALUE,a=!0,o=!1,s=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value.getLTRBCoordinate(!0).left;i=i<c?i:c}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}var u=-i,d=!0,h=!1,p=void 0;try{for(var m,f=e[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var v=m.value;n.movePositions.push(new ns.a(u,0)),v.move(u,0)}}catch(e){h=!0,p=e}finally{try{d||null==f.return||f.return()}finally{if(h)throw p}}},n}return z()(t,e),t}(Sd),Rd=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_RIGHT,n.commitAlignAction=function(e,t){var i=Number.MIN_VALUE,a=!0,o=!1,s=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value.getLTRBCoordinate(!0).right;i=i>c?i:c}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}var u=n.pageWidth-i,d=!0,h=!1,p=void 0;try{for(var m,f=e[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var v=m.value;n.movePositions.push(new ns.a(u,0)),v.move(u,0)}}catch(e){h=!0,p=e}finally{try{d||null==f.return||f.return()}finally{if(h)throw p}}},n}return z()(t,e),t}(Sd),Ad=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_TOP,n.commitAlignAction=function(e,t){var i=Number.MAX_VALUE,a=!0,o=!1,s=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value.getLTRBCoordinate(!0).top;i=i<c?i:c}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}var u=-i,d=!0,h=!1,p=void 0;try{for(var m,f=e[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var v=m.value;n.movePositions.push(new ns.a(0,u)),v.move(0,u)}}catch(e){h=!0,p=e}finally{try{d||null==f.return||f.return()}finally{if(h)throw p}}},n}return z()(t,e),t}(Sd),Od=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_BOTTOM,n.commitAlignAction=function(e,t){var i=Number.MIN_VALUE,a=!0,o=!1,s=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value.getLTRBCoordinate(!0).bottom;i=i>c?i:c}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}var u=n.pageHeight-i,d=!0,h=!1,p=void 0;try{for(var m,f=e[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var v=m.value;n.movePositions.push(new ns.a(0,u)),v.move(0,u)}}catch(e){h=!0,p=e}finally{try{d||null==f.return||f.return()}finally{if(h)throw p}}},n}return z()(t,e),t}(Sd),Pd=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_CENTER,n.commitAlignAction=function(e){var t=Number.MAX_VALUE,i=Number.MIN_VALUE,a=!0,o=!1,s=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value.getLTRBCoordinate(!0),u=c.left;t=t<u?t:u;var d=c.right;i=i>d?i:d}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}var h=(t+i)/2,p=n.pageWidth/2-h,m=!0,f=!1,v=void 0;try{for(var g,E=e[Symbol.iterator]();!(m=(g=E.next()).done);m=!0){var y=g.value;n.movePositions.push(new ns.a(p,0)),y.move(p,0)}}catch(e){f=!0,v=e}finally{try{m||null==E.return||E.return()}finally{if(f)throw v}}},n}return z()(t,e),t}(Sd),Dd=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).actionType=K.a.ALIGN_MIDDLE,n.commitAlignAction=function(e){var t=Number.MAX_VALUE,i=Number.MIN_VALUE,a=!0,o=!1,s=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value.getLTRBCoordinate(!0),u=c.top;t=t<u?t:u;var d=c.bottom;i=i>d?i:d}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}var h=(t+i)/2,p=n.pageHeight/2-h,m=!0,f=!1,v=void 0;try{for(var g,E=e[Symbol.iterator]();!(m=(g=E.next()).done);m=!0){var y=g.value;n.movePositions.push(new ns.a(0,p)),y.move(0,p)}}catch(e){f=!0,v=e}finally{try{m||null==E.return||E.return()}finally{if(f)throw v}}},n}return z()(t,e),t}(Sd),Md=function(){function e(){L()(this,e)}return w()(e,null,[{key:"canChangeOrderToForward",value:function(e,t){return this.canChangeOrder(e,t,function(e,t,n,i){return e!==t&&n<i})}},{key:"canChangeOrderToBackward",value:function(e,t){return this.canChangeOrder(e,t,function(e,t,n,i){return e!==t&&n>i&&!t.isOnlyOneItem()})}},{key:"canChangeOrder",value:function(e,t,n){var i=this;if(1===t.length)return!1;var a=$o.a.getAllSingleItems(e),o=$o.a.getAllSingleItems(t);return a.some(function(e){var t=o.indexOf(e),s=o.filter(function(i,a){return n(e,i,t,a)});return i.existNotIncludeTargetItems(s,a)})}},{key:"existNotIncludeTargetItems",value:function(e,t){return e.filter(function(e){return!t.includes(e)}).length>0}}]),e}(),Nd=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).actionType=K.a.EXPORT_PHOTO,n.changeDesign=function(){return!0},n.renderAuto=!1,n.commitAction=function(){var e=s()(a.a.mark(function e(i,o,s){var r,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.item)&&r.isBackground&&!Qe.b.isInGroup(r)){e.next=3;break}return e.abrupt("return");case 3:if(l=n.backupPage?n.backupPage:n.backupPage=Qo.a.getItemIncludedPage(i.pages,r)){e.next=6;break}return e.abrupt("return");case 6:return n.doExport(l.sheetSize,l.editScale),t.changeItemOrderToLast(l,r),J.a.selectItem(r),n.backupBgColor=l.background.color,o.pageController.getPageRenderer(l).backgroundRenderer.initDefaultColor(),e.next=14,s.renderAuto(i,o);case 14:s.renderHandler(i,o),s.renderLayerThumb([r]);case 16:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),n.rollbackAction=function(){var e=s()(a.a.mark(function e(i,o,s){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=n.item).setLTRBCoordinate(n.backupLTRB),r.itemPosition=n.backupImgLTRB.clone(),r.orgType=n.backupOriginType,r.backgroundState=n.backupBackgroundState,r.photoCrop.isCropped=n.backupIsCropped,t.changeItemOrderToFirst(n.backupPage,r),r.props.updateRevision(),J.a.selectItem(r),o.pageController.getPageRenderer(n.backupPage).backgroundRenderer.updateColor(n.backupBgColor),e.next=13,s.renderAuto(i,o);case 13:s.renderHandler(i,o),s.renderLayerThumb([r]);case 15:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),n.recycle=function(){n.item=null,n.backupLTRB=null,n.backupImgLTRB=null,n.backupPage=null},n.item=e,n.item&&(n.backupLTRB=e.getLTRBCoordinate(),n.backupImgLTRB=e.itemPosition.clone(),n.backupOriginType=e.orgType,n.backupBackgroundState=e.backgroundState,n.backupIsCropped=e.photoCrop.isCropped),n}return z()(t,e),w()(t,[{key:"doExport",value:function(e,t){var n=this.item,i=M.b.getData(n.props.getPhotoKey()),a=Qo.a.getOffsetBaseRect(!1,e,t,0,0,i.width,i.height);n.setLTRBCoordinate(a),n.itemPosition=a.clone(),n.disableCrop(),n.backgroundState=Je.a.BACKGROUND_TO_PHOTO,n.props.updateRevision()}}],[{key:"changeItemOrderToLast",value:function(e,t){var n=e.background.backgroundItem?e.background.backgroundItem:t;e.removeItem(n),e.addItem(t)}},{key:"changeItemOrderToFirst",value:function(e,t){e.removeItem(t);var n=e.background.backgroundItem?e.background.backgroundItem:t;e.addItem(n,0)}}]),t}(K.b),xd=function(){function e(t,n){var i=this;L()(this,e),this.contents=document.createElement("div"),this.wrapper=document.createElement("div"),this.btnShowPopup=t,this.wrapper.className="tools_popup",this.wrapper.appendChild(this.contents),this.wrapper.addEventListener("click",function(e){i.close()}),this.wrapper.classList.add(r.a.HIDE),this.contents.className="tools_popup_wrapper",this.contents.addEventListener("click",function(e){return e.stopPropagation()}),this.contents.classList.add(n)}return w()(e,[{key:"getWrapper",value:function(){return this.wrapper}},{key:"addContents",value:function(e){this.contents.appendChild(e)}},{key:"open",value:function(){if(this.btnShowPopup){this.btnShowPopup.classList.add(r.a.ACTIVE);var e=this.btnShowPopup.getBoundingClientRect().bottom+4,t=this.btnShowPopup.getBoundingClientRect().left;this.wrapper.style.left="".concat(t,"px"),this.wrapper.style.top="".concat(e,"px")}this.wrapper.classList.remove(r.a.HIDE)}},{key:"isOpen",value:function(){return!this.wrapper.classList.contains(r.a.HIDE)}},{key:"close",value:function(){this.btnShowPopup.classList.remove(r.a.ACTIVE),this.wrapper.classList.add(r.a.HIDE)}}]),e}(),Bd=function(){function e(t,n){L()(this,e),this.buttons=[],this.btnShowPopup=t,this.topWrap=n,this.makePhotoButtons(),this.makeFrameBottoms(),this.buttons.push(this.btnExportPhotoFromBackground),this.buttons.push(this.btnExportFramePhoto),this.buttons.push(this.btnPhotoToBackground),this.buttons.push(this.btnReset),this.buttons.push(this.btnFramePhotoReset),this.makePopup()}return w()(e,[{key:"makePhotoButtons",value:function(){var e=this;this.btnReset=aa.a.makeLabelContents("이미지 초기화"),this.btnReset.addEventListener("click",function(e){e.stopPropagation(),X.a.instance.dispatch(new Gn.e)}),this.btnExportPhotoFromBackground=aa.a.makeLabelContents("사진 빼내기"),this.btnExportPhotoFromBackground.addEventListener("click",function(t){e.currentItem&&(t.stopPropagation(),e.photoPopup.close(),X.a.instance.dispatch(new Nd(e.currentItem)))}),this.btnPhotoToBackground=aa.a.makeLabelContents("배경으로 만들기"),this.btnPhotoToBackground.addEventListener("click",function(t){t.stopPropagation(),e.photoPopup.close(),e.currentItem&&X.a.instance.dispatch(new oi.b(e.currentItem))})}},{key:"makeFrameBottoms",value:function(){var e=this;this.btnFramePhotoReset=aa.a.makeLabelContents("이미지 초기화"),this.btnFramePhotoReset.addEventListener("click",function(t){e.currentFrameItem&&(t.stopPropagation(),X.a.instance.dispatch(new Rn.g(e.currentFrameItem)))}),this.btnExportFramePhoto=aa.a.makeLabelContents("사진 빼내기"),this.btnExportFramePhoto.addEventListener("click",function(t){e.currentFrameItem&&(t.stopPropagation(),e.photoPopup.close(),X.a.instance.dispatch(new Rn.b(e.currentFrameItem)))})}},{key:"openPopup",value:function(){this.photoPopup.open()}},{key:"initButtons",value:function(){this.setVisibleAllButtons(!1),je.a.isMobilePortraitSize()?this.addButtonsInTopWrap():this.addButtonsInPopup()}},{key:"addButtonsInTopWrap",value:function(){var e=this;this.buttons.forEach(function(t){e.topWrap.appendChild(t)})}},{key:"addButtonsInPopup",value:function(){var e=this;this.buttons.forEach(function(t){e.photoPopup.addContents(t)})}},{key:"makePopup",value:function(){this.photoPopup=new xd(this.btnShowPopup,"photo_popup"),this.addButtonsInPopup()}},{key:"updatePhotoUI",value:function(e){this.initButtons(),this.currentItem=e;var t=e.isBackground;aa.a.setContentsDisable(this.btnPhotoToBackground,Boolean(e.groupId)),aa.a.setContentsVisible(this.btnReset,!0),aa.a.setContentsVisible(this.btnExportPhotoFromBackground,t),aa.a.setContentsVisible(this.btnPhotoToBackground,e.canChangeToBackground())}},{key:"setVisibleAllButtons",value:function(e){aa.a.setContentsVisible(this.btnReset,e),aa.a.setContentsVisible(this.btnExportPhotoFromBackground,e),aa.a.setContentsVisible(this.btnPhotoToBackground,e),aa.a.setContentsVisible(this.btnExportFramePhoto,e),aa.a.setContentsVisible(this.btnFramePhotoReset,e)}},{key:"updateImageFrameUI",value:function(e){this.setVisibleAllButtons(!1),this.currentFrameItem=e,aa.a.setContentsVisible(this.btnExportFramePhoto,!0),aa.a.setContentsVisible(this.btnFramePhotoReset,!0)}}]),e}(),Vd=n(512),Ud=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,"div",[r.a.LABEL_ITEM]))).listener=e,a.title=n,a.icon=i,a}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.label=document.createElement("div"),this.label.innerText=this.title,this.container.addEventListener("click",function(t){t.stopPropagation(),e.listener()}),this.icon&&(this.container.classList.add(r.a.ICON_LABEL_ITEM),Object(ne.setToolsIcon)(this.container,this.icon)),this.container.appendChild(this.label)}},{key:"updateUI",value:function(e){}}]),t}(Da.a),Fd=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,"div",[r.a.INPUT_ITEM]))).enabledOnBlur=!0,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.renderHeaderLabel(),this.renderInput(),this.renderInputUnit()}},{key:"renderHeaderLabel",value:function(){if(!d.b.isEmpty(this.headerLabel)){var e=document.createElement("label");e.className="input_header",e.innerText=this.headerLabel,this.container.appendChild(e)}}},{key:"renderInput",value:function(){var e=this,t=this.input=document.createElement("input");this.placeholder&&this.placeholder.length>0&&(t.placeholder=this.placeholder),t.addEventListener("input",function(e){return e.stopPropagation()}),(this.onFocus||this.enabledSelectTextWhenFocus)&&t.addEventListener("focus",function(){e.onFocus&&e.onFocus(),e.enabledSelectTextWhenFocus&&e.input.select()}),this.onBlur&&t.addEventListener("blur",function(){e.enabledOnBlur&&e.latestValue!==t.value?(e.onBlur(t.value),e.latestValue=t.value,e.enabledOnBlur=!0):e.enabledOnBlur=!0}),this.onEnterKey&&t.addEventListener("keypress",function(n){n.stopPropagation(),"ENTER"===n.key.toUpperCase()&&e.latestValue!==t.value&&(e.onEnterKey(t.value),e.latestValue=t.value)}),t.addEventListener("keydown",function(e){return e.stopPropagation()}),this.container.appendChild(t)}},{key:"renderInputUnit",value:function(){if(!d.b.isEmpty(this.unitLabel)&&!this.inputLabel){var e=this.inputLabel=document.createElement("label");e.className="input_unit_label",e.innerText=this.unitLabel,this.container.appendChild(e)}}},{key:"updateUI",value:function(e){}},{key:"setEnable",value:function(e){this.container&&this.enableStyle(!e,this.container,r.a.DISABLE)}},{key:"setChangable",value:function(e){this.input&&this.setActive(e),e||this.input.blur()}},{key:"getInputValue",value:function(){return this.input?this.input.value:void 0}},{key:"setInputValue",value:function(e){return this.input&&this.input.value!==e&&(this.input.value=e,this.latestValue=e),this}},{key:"setHeaderLabel",value:function(e){return this.headerLabel=e,this}},{key:"setPlaceholder",value:function(e){return this.placeholder=e,this}},{key:"setUnitLabel",value:function(e){return this.unitLabel=e,this.inputLabel||this.renderInputUnit(),this.inputLabel.innerText=e,this}},{key:"setOnEnterKey",value:function(e){return this.onEnterKey=e,this}},{key:"setOnFocus",value:function(e){return this.onFocus=e,this}},{key:"setOnBlur",value:function(e){return this.onBlur=e,this}},{key:"setOnSelectTextWhenFocus",value:function(){return this.enabledSelectTextWhenFocus=!0,this}},{key:"onSelectText",value:function(){this.input.select()}},{key:"onFocusOut",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.enabledOnBlur=e,this.input.blur()}}]),t}(Da.a);!function(e){e[e.TEXT=0]="TEXT",e[e.NUMBER=1]="NUMBER"}(vd||(vd={}));var Gd,Hd=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).rendered=!1,n.listener=e,n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){this.makeElement()}},{key:"makeElement",value:function(){var e=this;this.isGrouped=!1;var t=document.createElement("button");t.className=r.a.BTN_IMAGE_UPLOAD,t.addEventListener("click",function(){e.isGrouped=!e.isGrouped,e.listener(e.isGrouped)}),this.accordionButton=t,Object(ne.setToolsIcon)(t,ne.ToolsIcon.ITEM_GROUP,!0);var n=document.createElement("div");n.innerText="그룹으로 만들기",t.appendChild(n);var i=document.createElement("div");i.className=r.a.BUTTON_WRAP,i.appendChild(t),this.container.className=this.getStyleClass(r.a.TOOLS_ROW),this.container.appendChild(i)}},{key:"getContainer",value:function(){return this.onCreateViewIfNotCreated(),this.rendered=!0,this.container}},{key:"updateUI",value:function(e){this.isGrouped=e,this.accordionButton.getElementsByTagName("div")[0].innerHTML=this.isGrouped?"그룹 해제하기":"그룹으로 만들기"}}]),t}(ia.g),Wd=n(469),zd=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,"div",[r.a.SIZE_INPUT_ITEM]))).isFixSizeRatio=!1,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this);var n=this.widthInput=this.renderInputView(this.widthHeaderLabel,function(t){return e.onChangeInputSize(e.widthInput,!0,t,e.latestSize.width)}),i=document.createElement("div");i.appendChild(n.getContainer()),this.container.appendChild(i),this.renderFixRatioButton();var a=this.heightInput=this.renderInputView(this.heightHeaderLabel,function(t){return e.onChangeInputSize(e.heightInput,!1,t,e.latestSize.height)}),o=document.createElement("div");o.appendChild(a.getContainer()),this.container.appendChild(o)}},{key:"renderInputView",value:function(e,t){return(new Fd).setHeaderLabel(e).setUnitLabel(this.unitLabel.toLowerCase()).setOnSelectTextWhenFocus().setOnBlur(t).setOnEnterKey(t)}},{key:"renderFixRatioButton",value:function(){var e=this,n=this.fixRatioContainer=document.createElement("div");n.className="fix_ratio";var i=function(){e.changeFixRatio(!e.isFixSizeRatio),e.onChangeFixRatio&&e.onChangeFixRatio(e.isFixSizeRatio)},a=this.btnDisableFixRatio=Object(ne.setToolsIcon)(n,ne.ToolsIcon.LOCK_ON);a.addEventListener("click",i),t.setVisibilityElement(this.isFixSizeRatio,a);var o=this.btnEnableFixRatio=Object(ne.setToolsIcon)(n,ne.ToolsIcon.LOCK_OFF);o.addEventListener("click",i),t.setVisibilityElement(!this.isFixSizeRatio,o),this.setFixRatioEnabled(this.isFixSizeRatio),this.container.appendChild(n)}},{key:"onChangeInputSize",value:function(e,t,n,i){if(Number.isNaN(Number(n)))e.setInputValue(0===i?this.defaultText:i.toString());else{var a=this.convertValueToNumberByUnit(n);i!==a?(this.latestSize=new Nn.a(t?a:0,t?0:a),this.onChangeSize&&this.onChangeSize(this.latestSize),e.onFocusOut(!1)):i!==Number(n)&&e.setInputValue(i.toString())}}},{key:"convertValueToNumberByUnit",value:function(e){var t=Number(e);if(Number.isNaN(t))return NaN;switch(this.latestSizeUnit){case De.a.CM:return Number(t.toFixed(1));case De.a.IN:return Number(t.toFixed(2));default:return Math.round(t)}}},{key:"updateUI",value:function(e){}},{key:"updateSize",value:function(e){this.latestSize=e.clone(),this.widthInput.setInputValue(e&&0!==e.width?e.width.toString():this.defaultText),this.heightInput.setInputValue(e&&0!==e.height?e.height.toString():this.defaultText)}},{key:"setDefaultSize",value:function(e){return this.latestSize=e.clone(),this}},{key:"setDefaultFixRatio",value:function(e){return this.isFixSizeRatio=e,this}},{key:"setDefaultTextWhenSetInvalidValue",value:function(e){return this.defaultText=e,this}},{key:"setHeaderLabel",value:function(e,t){return this.widthHeaderLabel=e,this.heightHeaderLabel=t,this}},{key:"setUnitLabel",value:function(e){return this.unitLabel=e,this}},{key:"setOnChangeSize",value:function(e){return this.onChangeSize=e,this}},{key:"setOnChangeFixRatio",value:function(e){return this.onChangeFixRatio=e,this}},{key:"setEnable",value:function(e){this.widthInput&&this.widthInput.setEnable(e),this.heightInput&&this.heightInput.setEnable(e),this.setFixRatioEnabled(e)}},{key:"setFixRatioEnabled",value:function(e){e?this.fixRatioContainer.classList.remove("disabled"):this.fixRatioContainer.classList.add("disabled")}},{key:"changeSizeUnit",value:function(e){this.latestSizeUnit=e,this.widthInput.setUnitLabel(e.toLowerCase()),this.heightInput.setUnitLabel(e.toLowerCase())}},{key:"changeFixRatio",value:function(e){this.isFixSizeRatio=e,t.setVisibilityElement(this.isFixSizeRatio,this.btnDisableFixRatio),t.setVisibilityElement(!this.isFixSizeRatio,this.btnEnableFixRatio)}}],[{key:"setVisibilityElement",value:function(e,t){t.style.display=e?"":"none"}}]),t}(Da.a),Kd=function(){function e(){L()(this,e),Wd.a.setListener(this),this.onCreateView()}return w()(e,[{key:"onCreateView",value:function(){var e=this,t=this.sizeInputView=(new zd).setDefaultSize(new Nn.a).setDefaultFixRatio(!1).setDefaultTextWhenSetInvalidValue("―").setHeaderLabel("가로 크기","세로 크기").setUnitLabel(Y.a.instance.option.pageSize.unit.toLowerCase()).setOnChangeSize(function(e){return Wd.a.changeSizeOfItems(Y.a.instance.activeItems,e)}).setOnChangeFixRatio(function(e){Qe.b.convertSinglesToItems(Y.a.instance.activeItems).forEach(function(t){return Wd.a.setFixRatioEnabled(t.getItemKey(),e)})}),n=function(t){var n=Number(t);if(Number.isNaN(n)||n<0||n>360)return Wd.a.fetchFromActiveItems(),void e.rotateInputView.onFocusOut(!1);Wd.a.changeRotateOfItems(Y.a.instance.activeItems,Math.round(n)),e.rotateInputView.onFocusOut(!1)},i=this.rotateInputView=(new Fd).setHeaderLabel("회전").setUnitLabel("°").setOnSelectTextWhenFocus().setOnBlur(n).setOnEnterKey(n);this.sizeToolRow=(new ia.g).addCustomClass(r.a.ROW_ITEM_SIZE).add(t,i).setBorderBottom()}},{key:"getRowView",value:function(){return this.sizeToolRow}},{key:"updateRowContent",value:function(e,t){var n=1===e.length&&(e[0].getItemType()===Ei.b.TEXT||e[0].isOnlyOneItem());this.sizeToolRow.rowVisible=t&&Ke.a.getUserSetting().adminMode&&!n,this.updateSizeInput(e)}},{key:"updateSizeInput",value:function(t){if(this.sizeToolRow.rowVisible){var n=Y.a.instance.option.pageSize.unit;if(this.sizeInputView.changeSizeUnit(n),0!==t.length){var i,a,o=t.some(function(e){return!e.select});if(1===t.length||o){var s=o?t.find(function(e){return e.select}):t[0];i=e.getSizeByUnit(new Nn.a(s.getWidth(),s.getHeight()),n),a=e.convertRotateBetween0And360(s.props.getRotate()).toString()}else{i=e.getItemSizeByUnitInMultipleItems(t,n);var r=t[0].props.getRotate(),l=Qe.b.convertSinglesToItems(t);a=1===l.length&&l[0].getItemType()===Ei.b.GROUP?Wd.a.getGroupItemRotate(l[0].getItemKey()).toString():t.every(function(e){return e.props.getRotate()===r})?e.convertRotateBetween0And360(r).toString():"―"}this.sizeInputView.updateSize(i),this.rotateInputView.setInputValue(a),this.updateInputEnabled(t)}}}},{key:"updateInputEnabled",value:function(t){var n=Qe.b.convertSinglesToItems(t),i=e.shouldApplyFixRatio(n),a=i;if(1===n.length){var o=n[0],s=Wd.a.getFixRatioEnabled(o.getItemKey());void 0===s?Wd.a.setFixRatioEnabled(o.getItemKey(),a):a=s}this.sizeInputView.changeFixRatio(a),this.sizeInputView.setEnable(!Boolean(t.find(function(e){return e.getItemType()===Ei.b.TEXT}))),this.rotateInputView.setEnable(!Boolean(t.find(function(e){return!e.canRotate()}))),t.some(function(e){return!e.select})&&(this.sizeInputView.setEnable(!1),this.rotateInputView.setEnable(!1)),this.sizeInputView.setFixRatioEnabled(!i)}},{key:"onChangeSize",value:function(e){this.updateSizeInput(Y.a.instance.activeItems)}}],[{key:"shouldApplyFixRatio",value:function(e){return e.some(function(e){return e instanceof ee.b||e.getItemType()===Ei.b.GROUP})}},{key:"getSizeByUnit",value:function(e,t){return new Nn.a(Wd.a.getFixedPointByUnit(De.a.changeUnit(e.width,De.a.PX,t,96),t),Wd.a.getFixedPointByUnit(De.a.changeUnit(e.height,De.a.PX,t,96),t))}},{key:"getItemSizeByUnitInMultipleItems",value:function(t,n){var i=t.every(function(e){return d.b.isEmpty(e.groupId)})?e.calculateItemsSizeWhenSameSizeLength(t,n):e.getWholeSizeOfSingleAndGroupItemsWhenSameGroup(t);return e.getSizeByUnit(i,n)}},{key:"convertRotateBetween0And360",value:function(e){return(e+360)%360}},{key:"calculateItemsSizeWhenSameSizeLength",value:function(e,t){var n=e[0].getLTRBCoordinate();return new Nn.a(e.every(function(e){return Wd.a.getFixedPointByUnit(e.getWidth(),t)===Wd.a.getFixedPointByUnit(n.getWidth(),t)})?n.getWidth():0,e.every(function(e){return Wd.a.getFixedPointByUnit(e.getHeight(),t)===Wd.a.getFixedPointByUnit(n.getHeight(),t)})?n.getHeight():0)}},{key:"getWholeSizeOfSingleAndGroupItemsWhenSameGroup",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Qe.b.convertSinglesToItems(e),i=Qe.b.isSameGroup(e,n),a=Qe.b.getRootGroup(e[0].groupId,n),o=i&&a?a.getLTRBCoordinate(t):null;return o?new Nn.a(o.getWidth(),o.getHeight()):new Nn.a}}]),e}(),Yd=function(){function e(){L()(this,e),this.popupBackground=document.createElement("div"),this.lastUpdateStatus={targetItemCount:0},this.toolTopContents=aa.a.makeToolboxTopContentsWrapper(),this.toolTopContents.classList.add("common"),this.makeAlignButtons(),this.makeOrderButtons(),this.makeFlipButtons(),this.makeCommonTool(),this.makeOpacityTool(),this.makeHyperlinkTool(),this.makeHyperlinkRow(),this.makeGroupRow(),this.itemSizeToolVC=new Kd}return w()(e,[{key:"makeAlignButtons",value:function(){var e=this;this.btnAlignLeft=aa.a.makeIconContents("왼쪽",ne.ToolsIcon.GROUP_ALIGN_LEFT),this.btnAlignLeft.addEventListener("click",function(){1===e.lastUpdateStatus.targetItemCount?X.a.instance.dispatch(new bd):X.a.instance.dispatch(new Ed)}),this.btnAlignCenter=aa.a.makeIconContents("가운데",ne.ToolsIcon.GROUP_ALIGN_CENTER),this.btnAlignCenter.addEventListener("click",function(){1===e.lastUpdateStatus.targetItemCount?X.a.instance.dispatch(new Pd):X.a.instance.dispatch(new Cd)}),this.btnAlignRight=aa.a.makeIconContents("오른쪽",ne.ToolsIcon.GROUP_ALIGN_RIGHT),this.btnAlignRight.addEventListener("click",function(){1===e.lastUpdateStatus.targetItemCount?X.a.instance.dispatch(new Rd):X.a.instance.dispatch(new yd)}),this.btnAlignDHC=aa.a.makeIconContents("가로 간격",ne.ToolsIcon.GROUP_DISTRIBUTE_HORIZON),this.btnAlignDHC.classList.add("border_top"),this.btnAlignDHC.addEventListener("click",function(){e.lastUpdateStatus.targetItemCount>2&&X.a.instance.dispatch(new _d)}),this.btnAlignTop=aa.a.makeIconContents("상단",ne.ToolsIcon.GROUP_ALIGN_TOP),this.btnAlignTop.addEventListener("click",function(){1===e.lastUpdateStatus.targetItemCount?X.a.instance.dispatch(new Ad):X.a.instance.dispatch(new Td)}),this.btnAlignMiddle=aa.a.makeIconContents("중간",ne.ToolsIcon.GROUP_ALIGN_MIDDLE),this.btnAlignMiddle.addEventListener("click",function(){1===e.lastUpdateStatus.targetItemCount?X.a.instance.dispatch(new Dd):X.a.instance.dispatch(new kd)}),this.btnAlignBottom=aa.a.makeIconContents("하단",ne.ToolsIcon.GROUP_ALIGN_BOTTOM),this.btnAlignBottom.addEventListener("click",function(){1===e.lastUpdateStatus.targetItemCount?X.a.instance.dispatch(new Od):X.a.instance.dispatch(new Id)}),this.btnAlignDVC=aa.a.makeIconContents("세로 간격",ne.ToolsIcon.GROUP_DISTRIBUTE_VERTICAL),this.btnAlignDVC.classList.add("border_top"),this.btnAlignDVC.addEventListener("click",function(){e.lastUpdateStatus.targetItemCount>2&&X.a.instance.dispatch(new wd)})}},{key:"makeOrderButtons",value:function(){this.btnOrderFirst=aa.a.makeIconContents("맨 앞으로",ne.ToolsIcon.LAYER_FRONT),this.btnOrderFirst.addEventListener("click",function(){return X.a.instance.dispatch(new jn)}),this.btnOrderForward=aa.a.makeIconContents("앞으로",ne.ToolsIcon.LAYER_FORWARD),this.btnOrderForward.addEventListener("click",function(){return X.a.instance.dispatch(new Zn)}),this.btnOrderBackward=aa.a.makeIconContents("뒤로",ne.ToolsIcon.LAYER_BACKWARD),this.btnOrderBackward.addEventListener("click",function(){return X.a.instance.dispatch(new qn)}),this.btnOrderLast=aa.a.makeIconContents("맨 뒤로",ne.ToolsIcon.LAYER_BACK),this.btnOrderLast.addEventListener("click",function(){return X.a.instance.dispatch(new $n)})}},{key:"makeFlipButtons",value:function(){this.btnFlipHorizon=aa.a.makeIconContents("좌우 반전",ne.ToolsIcon.FLIP_HORIZON),this.btnFlipHorizon.addEventListener("click",function(){return X.a.instance.dispatch(new On.e)}),this.btnFlipVertical=aa.a.makeIconContents("상하 반전",ne.ToolsIcon.FLIP_VERTICAL),this.btnFlipVertical.addEventListener("click",function(){return X.a.instance.dispatch(new On.f)})}},{key:"makeOpacityTool",value:function(){this.opacityTool=new Na.a(function(e){return X.a.instance.dispatch(new On.n(Number(e)/100*255))},"",0,100,1,"%"),this.opacityToolRow=new ia.g("투명도").addCustomClass(r.a.ROW_OPACITY).add(this.opacityTool).setBorderBottom()}},{key:"makeAlignPopup",value:function(){this.alignPopup=new xd(this.btnShowAlign.container,"common_align_popup");var e=aa.a.makePopupWrapper("horizontal_align");e.appendChild(this.btnAlignLeft),e.appendChild(this.btnAlignCenter),e.appendChild(this.btnAlignRight),e.appendChild(this.btnAlignDHC);var t=aa.a.makePopupWrapper("vertical_align");t.appendChild(this.btnAlignTop),t.appendChild(this.btnAlignMiddle),t.appendChild(this.btnAlignBottom),t.appendChild(this.btnAlignDVC),this.alignPopup.addContents(e),this.alignPopup.addContents(t)}},{key:"makeOrderPopup",value:function(){this.orderPopup=new xd(this.btnShowOrder.container,"common_order_popup");var e=aa.a.makePopupWrapper("order_forward");e.appendChild(this.btnOrderForward),e.appendChild(this.btnOrderFirst);var t=aa.a.makePopupWrapper("order_backward");t.appendChild(this.btnOrderBackward),t.appendChild(this.btnOrderLast),this.orderPopup.addContents(e),this.orderPopup.addContents(t)}},{key:"makeFlipPopup",value:function(){this.flipPopup=new xd(this.btnShowFlip.container,"common_flip_popup");var e=aa.a.makePopupWrapper("horizontal_flip");e.appendChild(this.btnFlipHorizon);var t=aa.a.makePopupWrapper("vertical_flip");t.appendChild(this.btnFlipVertical),this.flipPopup.addContents(e),this.flipPopup.addContents(t)}},{key:"makeHyperlinkTool",value:function(){var e=this;this.hyperlinkToolRow=new ia.c("링크",function(t){return e.onHyperlinkChecked(t)}).setBorderBottom();var t=this.hyperlinkInputView=(new Fd).setPlaceholder("http://"),n=this.hyperlinkButtonView=new Vd.a("적용");this.hyperlinkToolRow.add(t,n),t.setOnFocus(function(){t.setChangable(!0),n.setChangable(!0)}),n.setOnClick(function(){var e=t.getInputValue().trim();e.length>0&&0!==e.indexOf("http://")&&0!==e.indexOf("https://")&&(e="http://".concat(e));var i=Y.a.instance.activeItems,a=1===i.length?i[0].props:Qe.b.getRootGroup(i[0].groupId).props;X.a.instance.dispatch(new On.k({active:a.isActiveHyperlink(),type:a.getHyperlinkType(!0),value:e})),t.setChangable(0===e.length),t.setInputValue(e),n.setChangable(!1)}),this.hyperlinkToolRow.addCustomClass(r.a.EFFECT_TOOLS,r.a.HYPERLINK_TOOLS),this.hyperlinkToolRow.setPrevCallback(function(){return e.btnTopShowHyperlinkMenu.click()})}},{key:"onHyperlinkChecked",value:function(e){var t=Y.a.instance.activeItems,n=1===t.length?t[0].props:Qe.b.getRootGroup(t[0].groupId).props;X.a.instance.dispatch(new On.k({active:e,type:n.getHyperlinkType(!0),value:n.getHyperlinkValue(!0)})),this.hyperlinkInputView.setActive(0===n.getHyperlinkValue(!0).length)}},{key:"makeHyperlinkRow",value:function(){var e=this;this.hyperlinkRow=(new ia.g).addCustomClass(r.a.ACCORDION_EFFECT_ROW),this.hyperlinkMenu=new Ba.a("링크",function(){return e.btnTopShowHyperlink.click()},function(t){return e.onHyperlinkChecked(t)}),this.hyperlinkRow.add(this.hyperlinkMenu)}},{key:"togglePopupEvent",value:function(e){if(this.commonToolRow.container){var t=e.isOpen();e.getWrapper().parentElement||this.commonToolRow.container.appendChild(e.getWrapper()),this.popupBackground.parentElement||this.commonToolRow.container.insertBefore(this.popupBackground,this.commonToolRow.container.firstChild),this.closeAllPopupEvent(),t||(e.open(),this.popupBackground.classList.remove(r.a.HIDE))}}},{key:"closeAllPopupEvent",value:function(){this.popupBackground.parentElement&&this.popupBackground.parentElement.childNodes.forEach(function(e){e.classList.contains("tools_popup")?e.classList.add(r.a.HIDE):e.childNodes.forEach(function(e){return e.classList.remove(r.a.ACTIVE)})}),this.popupBackground.classList.add(r.a.HIDE)}},{key:"makeCommonTool",value:function(){var e=this;this.popupBackground.className="popup_background",this.popupBackground.addEventListener("click",function(){return e.closeAllPopupEvent()}),this.btnShowAlign=new Ud(function(){return e.togglePopupEvent(e.alignPopup)},"정렬"),this.btnShowOrder=new Ud(function(){return e.togglePopupEvent(e.orderPopup)},"순서"),this.btnShowFlip=new Ud(function(){return e.togglePopupEvent(e.flipPopup)},"반전"),this.btnCutting=new Ud(function(){return X.a.instance.dispatch(new Gn.b)},"자르기"),this.btnImageFrameCutting=new Ud(function(){e.currentImageFrameItem&&X.a.instance.dispatch(new Rn.h(e.currentImageFrameItem))},"자르기"),this.btnMore=new Ud(function(){return e.togglePopupEvent(e.photoTools.photoPopup)},"더보기",ne.ToolsIcon.GREATER_THAN),this.photoTools=new Bd(this.btnMore.container,this.toolTopContents),this.makeAlignPopup(),this.makeOrderPopup(),this.makeFlipPopup(),this.commonToolRow=(new ia.g).addCustomClass(r.a.ROW_ITEM_COMMON).add((new ia.f).add(this.btnShowAlign,this.btnShowOrder,this.btnShowFlip,this.btnCutting,this.btnImageFrameCutting,this.btnMore))}}]),w()(e,[{key:"makeToolboxRowContents",value:function(){return[{row:this.commonToolRow,priority:100,viewType:0},{row:this.itemSizeToolVC.getRowView(),priority:101,viewType:0},{row:this.opacityToolRow,priority:500,viewType:0},{row:this.hyperlinkToolRow,priority:900,viewType:0},{row:this.hyperlinkRow,priority:1e3,viewType:0},{row:this.groupRow,priority:1100,viewType:0}]}},{key:"makeMobileToolbox",value:function(){var e=this;return this.btnTopCutting=aa.a.makeLabelContents("자르기"),this.btnTopCutting.addEventListener("click",function(){return X.a.instance.dispatch(new Gn.b)}),this.toolTopContents.appendChild(this.btnTopCutting),this.btnTopImageFrameCutting=aa.a.makeLabelContents("자르기"),this.btnTopImageFrameCutting.addEventListener("click",function(){e.currentImageFrameItem&&X.a.instance.dispatch(new Rn.h(e.currentImageFrameItem))}),this.toolTopContents.appendChild(this.btnTopImageFrameCutting),this.toolTopContents.appendChild(aa.a.makeButtonShowToolsRow("투명도",this.opacityToolRow,function(){return e.closeAllPopupEvent()})),this.btnTopShowAlign=aa.a.makeButtonShowToolsRow("정렬",this.commonToolRow,function(){return e.togglePopupEvent(e.alignPopup)}),this.toolTopContents.appendChild(this.btnTopShowAlign),this.btnTopShowOrder=aa.a.makeButtonShowToolsRow("순서",this.commonToolRow,function(){return e.togglePopupEvent(e.orderPopup)}),this.toolTopContents.appendChild(this.btnTopShowOrder),this.btnTopShowFlip=aa.a.makeButtonShowToolsRow("반전",this.commonToolRow,function(){return e.togglePopupEvent(e.flipPopup)}),this.toolTopContents.appendChild(this.btnTopShowFlip),this.btnTopShowHyperlinkMenu=aa.a.makeButtonShowToolsRow("링크",this.hyperlinkRow,function(){return e.closeAllPopupEvent()}),this.toolTopContents.appendChild(this.btnTopShowHyperlinkMenu),this.btnTopShowHyperlink=aa.a.makeButtonShowToolsAccordionRow("링크",this.hyperlinkToolRow),this.btnTopShowHyperlink.classList.add(r.a.HIDE),this.toolTopContents.appendChild(this.btnTopShowHyperlink),this.toolTopContents}},{key:"updateCommonTools",value:function(e,t){var n=!(t.renderedItem&&t.renderedItem.isOnlyOneItem());aa.a.setContentsVisible(this.btnShowAlign.container,n),aa.a.setContentsVisible(this.btnShowOrder.container,n),aa.a.setContentsVisible(this.btnTopShowAlign,n),aa.a.setContentsVisible(this.btnTopShowOrder,n);var i=this.lastUpdateStatus.targetItemCount>=3;aa.a.setContentsVisible(this.btnAlignDHC,i),aa.a.setContentsVisible(this.btnAlignDVC,i);var a=e.every(function(e){return e.canFlip()});aa.a.setContentsVisible(this.btnShowFlip.container,a),aa.a.setContentsVisible(this.btnTopShowFlip,a);var o=this.getItemIncludedPage(e[0]),s=!Md.canChangeOrderToForward(e,o.items);aa.a.setContentsDisable(this.btnOrderFirst,s),aa.a.setContentsDisable(this.btnOrderForward,s);var r=!Md.canChangeOrderToBackward(e,o.items);aa.a.setContentsDisable(this.btnOrderLast,r),aa.a.setContentsDisable(this.btnOrderBackward,r)}},{key:"updatePhotoPopup",value:function(e){var t=e.renderedItem,n=!e.isAdminEditView;this.photoTools.setVisibleAllButtons(!1);var i=t&&t instanceof Je.d&&n;i&&this.photoTools.updatePhotoUI(t);var a=t&&t instanceof ee.b&&n&&!t.isDefaultImage()&&!t.isLock();a?(this.currentImageFrameItem=e.renderedItem,this.photoTools.updateImageFrameUI(t)):this.currentImageFrameItem=null,aa.a.setContentsVisible(this.btnMore.container,i||a),aa.a.setContentsVisible(this.btnCutting.container,i),aa.a.setContentsVisible(this.btnTopCutting,i),aa.a.setContentsVisible(this.btnImageFrameCutting.container,a),aa.a.setContentsVisible(this.btnTopImageFrameCutting,a)}},{key:"updateHyperlinkRow",value:function(e){this.hyperlinkToolRow.updateUI(e.props.isActiveHyperlink()),this.hyperlinkMenu.updateUI(e.props.isActiveHyperlink()),this.hyperlinkInputView.setEnable(e.props.isActiveHyperlink()),this.hyperlinkInputView.setChangable(0===e.props.getHyperlinkValue(!0).length),this.hyperlinkInputView.setInputValue(e.props.getHyperlinkValue(!0)),this.hyperlinkButtonView.setEnable(e.props.isActiveHyperlink()),this.hyperlinkButtonView.setChangable(!1)}},{key:"updateToolboxRowContents",value:function(e,t){this.updatePhotoPopup(t);var n=e;e=Qe.b.getGroupItemsAddedArray(e);var i=!t.isAdminEditView;this.commonToolRow.rowVisible=i,this.opacityToolRow.rowVisible=i,this.groupRow.rowVisible=i;var a=i&&S.a.getItemOption().showHyperlinkProps&&(1===e.length&&e[0].canDisplayHyperlink()||Qe.b.isSameGroup(e));if(this.hyperlinkToolRow.rowVisible=a,this.btnTopShowHyperlinkMenu.classList.toggle(r.a.HIDE,!a),this.hyperlinkRow.rowVisible=a,this.hyperlinkMenu.rowVisible=a,this.itemSizeToolVC.updateRowContent(e,i),t.isAdminEditView)return this.lastUpdateStatus.targetItemCount=0,!0;var o=new Set;e.forEach(function(e){var t=Qe.b.getRootGroup(e.groupId);o.add(t?t.getGroupId():e.tbpeId)}),this.lastUpdateStatus.targetItemCount=o.size;var s=t.renderedItem;if(s)this.opacityTool.updateUI({value:Math.round(s.props.getOpacity()/255*100)});else{var l=e.every(function(t){return t.props.getOpacity()===e[0].props.getOpacity()})?Math.round(e[0].props.getOpacity()/255*100):Na.a.UNKNOWN_MULTI_VALUE;this.opacityTool.updateUI({value:l})}return this.updateCommonTools(e,t),a&&this.updateHyperlinkRow(s||Qe.b.getRootGroup(e[0].groupId)),e.length>1?(this.groupRow.rowVisible=!je.a.isMobilePortraitSize(),this.groupRow.updateUI(!(n.length>1&&!Qe.b.isSameGroup(n)))):this.groupRow.rowVisible=!1,!0}},{key:"getItemIncludedPage",value:function(e){var t=null;return X.a.instance.dispatch(new K.c(function(n){t=Qo.a.getItemIncludedPage(n.pages,e)})),t}},{key:"makeGroupRow",value:function(){var e=new Hd(function(e){e?X.a.instance.dispatch(new On.a):X.a.instance.dispatch(new On.d)});e.addCustomClass(r.a.ROW_GROUP),this.groupRow=e}}]),e}();!function(e){e[e.ALIGN_LEFT=2]="ALIGN_LEFT",e[e.ALIGN_CENTER=4]="ALIGN_CENTER",e[e.ALIGN_RIGHT=8]="ALIGN_RIGHT",e[e.ALIGN_DHC=16]="ALIGN_DHC",e[e.ALIGN_TOP=32]="ALIGN_TOP",e[e.ALIGN_MIDDLE=64]="ALIGN_MIDDLE",e[e.ALIGN_BOTTOM=128]="ALIGN_BOTTOM",e[e.ALIGN_DVC=256]="ALIGN_DVC",e[e.ORDER_FIRST=512]="ORDER_FIRST",e[e.ORDER_FORWARD=1024]="ORDER_FORWARD",e[e.ORDER_BACKWARD=2048]="ORDER_BACKWARD",e[e.ORDER_LAST=4096]="ORDER_LAST",e[e.FLIP_HORIZON=8192]="FLIP_HORIZON",e[e.FLIP_VERTICAL=16384]="FLIP_VERTICAL"}(Gd||(Gd={}));var Xd,jd,Zd=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,"div",[r.a.TOGGLE_ITEM]))).listener=s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.contain()?Ye.a.openLoginPopup(Ie.a.FAVORITES,function(){return qt.a.unregisterFavorite(e.pk)}):Ye.a.openLoginPopup(Ie.a.FAVORITES,s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,qt.a.registerFavorite(e.pk);case 2:case"end":return t.stop()}},t)})));case 1:case"end":return t.stop()}},t)})),e}var n;return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.element=document.createElement("label"),this.inputElement=document.createElement("input"),this.inputElement.type="checkbox",this.element.appendChild(this.inputElement),this.container.appendChild(this.element),this.initEventListener()}},{key:"updateUI",value:(n=s()(a.a.mark(function e(n){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=n.selectedItem,this.clear();try{i instanceof ad.a||i instanceof ud.a?this.pk={referenceKey:i.svgData.key,repositoryType:Do.a.UNICORN,resourceType:i.svgData.type.getResourceType()}:i instanceof ee.b?this.pk={referenceKey:i.svgData.key,repositoryType:Do.a.UNICORN,resourceType:Q.a.FRAME}:i instanceof Je.d&&(o=t.getResourceType(i.orgType))&&(this.pk={referenceKey:i.props.getPhotoKey(),repositoryType:Do.a.BIZHOWS,resourceType:o})}catch(e){console.error(e)}if(!this.pk){e.next=10;break}return e.next=6,qt.a.setMyCollectionPk(this.pk);case 6:this.updateInputUI(),this.show(),e.next=11;break;case 10:this.hide();case 11:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"show",value:function(){this.container.style.display="inline-block"}},{key:"clear",value:function(){this.pk=null}},{key:"initEventListener",value:function(){var e=this;this.inputElement.addEventListener("change",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.listener();case 2:case"end":return t.stop()}},t)}))),Q.b.values().forEach(function(t){qt.a.addRegisterListener(t,function(t){e.pk&&qt.a.isSamePk(e.pk,t)&&e.updateInputUI()}).addUnregisterListener(t,function(t){e.pk&&qt.a.isSamePk(e.pk,t)&&e.updateInputUI()})})}},{key:"contain",value:function(){return qt.a.isFavorite(this.pk)}},{key:"updateInputUI",value:function(){var e=this.contain();this.setIcon(),this.inputElement.checked=e,this.inputElement.checked?this.container.classList.add(r.a.ACTIVE):this.container.classList.remove(r.a.ACTIVE)}},{key:"setIcon",value:function(){var e=this.element.firstChild;"I"===e.nodeName&&this.element.removeChild(e),this.contain()?Object(ne.setToolsIcon)(this.element,ne.ToolsIcon.HEART_FILL):Object(ne.setToolsIcon)(this.element,ne.ToolsIcon.HEART)}}],[{key:"getResourceType",value:function(e){switch(e){case Je.b.Sticker:return Q.a.BITMAP;case Je.b.Image:return Q.a.IMAGE;case Je.b.BackgroundImage:return Q.a.BACKGROUND_IMAGE;default:return null}}}]),t}(Da.a),qd=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add("clipboard_input_view"),this.input=us.a.createElement('<input spellcheck="false" />',this.container,{type:"focusout",listener:function(){return e.setActive(!1)}}),us.a.createElement("<button></button>",this.container,{type:"click",listener:this.onClickCopy.bind(this)})}},{key:"onClickCopy",value:function(){wa.a.copyValue(this.input,!1),this.setActive(!0)}},{key:"renderView",value:function(e){he()(F()(t.prototype),"renderView",this).call(this),this.input.value=e||"",this.setActive(!1)}}]),t}(He.a),$d=n(378),Qd=function(){function e(){L()(this,e),this.youtubeUrlRow=new ia.g("URL 링크").addCustomClass(r.a.YOUTUbE_URL).setBorderBottom(),this.youtubeUrlRow.add(this.youtubeUrlInputView=new qd)}return w()(e,[{key:"makeToolboxRowContents",value:function(){return[{row:this.youtubeUrlRow,priority:510,viewType:0}]}},{key:"makeMobileToolbox",value:function(){return this.mobileToolboxContainer=aa.a.makeToolboxTopContentsWrapper(),this.mobileToolboxContainer.appendChild(aa.a.makeIconButtonShowToolsRow(ne.ToolsIcon.HYPERLINK,this.youtubeUrlRow)),this.mobileToolboxContainer}},{key:"updateToolboxRowContents",value:function(e,t){var n=e&&1===e.length&&e[0]instanceof $d.a?e[0]:null,i=!!n;return this.youtubeUrlRow.rowVisible=i,aa.a.setContentsVisible(this.mobileToolboxContainer,i),i&&this.youtubeUrlInputView.renderView(n.props.videoUrl),i}}]),e}(),Jd=function(e){function t(e,n,i,a,o,s,r,l,c,u,d,h){var p;return L()(this,t),(p=V()(this,F()(t).call(this))).items=e,p.renderedItem=n,p.headerTitle=i,p.headerToolVisible=a,p.navRootGroup=o,p.isLock=s,p.isValidResource=r,p.isUnsupportedItem=l,p.isAdminEditView=c,p.theme=u,p.mockUpEditIdx=d,p.devMode=h,p}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){if(null==e.items||null==this.items||e.items.length!==this.items.length||e.headerToolVisible!==this.headerToolVisible||e.isAdminEditView!==this.isAdminEditView||e.theme!==this.theme||e.devMode!==this.devMode)return!0;if(e.headerTitle!==this.headerTitle)return!0;if(e.renderedItem!==this.renderedItem)return!0;for(var t=0,n=e.items.length;t<n;t++)if(e.items[t].revision!==this.items[t].revision||e.items[t].tbpeId!==this.items[t].tbpeId||this.items[t].forced)return!0;return!1}},{key:"isHeaderChangeFrom",value:function(e){return this.headerTitle!==e.headerTitle||this.isLock!==e.isLock||this.isValidResource!==e.isValidResource||this.isUnsupportedItem!==e.isUnsupportedItem||this.isAdminEditView!==e.isAdminEditView||this.navRootGroup!==e.navRootGroup}}]),t}(He.b),eh=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this))).editorViewMode=e,o.visible=n,o.top=i,o.left=a,o}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return e.visible!==this.visible||e.left!==this.left||e.top!==this.top||e.editorViewMode!==this.editorViewMode}}]),t}(He.c),th=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,!0,"itemToolbox"))).margin=5,e.marginBottom=36,e.mouseAction={mode:Fn.a.MODE_NONE,offsetX:0,offsetY:0,baseX:0,baseY:0},e.isAdminEditMode=!1,e.rowContents=[],e.rowContentsRenderer=[],e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this);var n=document.getElementById(sc.a.librarySection);this.contentsStates=new Jd(null,null,null,0,!1,!1,!0,!1,!1,null),this.positionStates=new eh(null,!1,0,0),this.rowContentsRenderer=[new Yd,new Zu,new Ha(this.onChangeScrollY.bind(this)),new ju,new nd.b,new pd,new id,new od,new Nu,new _o(this.onChangeScrollY.bind(this)),new Qd,new td],this.rowContentsRenderer.forEach(function(t){e.addRowContents(t.makeToolboxRowContents())}),this.makeHeader(),this.makeHeaderSlide(),this.makeBody(),this.makeFooter(),n.appendChild(this.container),Ke.a.addListener(this)}},{key:"onChangeUserSetting",value:function(e,t){t===Yo.b.FIELD_IS_DEV&&this.renderView(Y.a.instance.activeItems)}},{key:"onStartView",value:function(){he()(F()(t.prototype),"onStartView",this).call(this),this.addEventListeners()}},{key:"setToolsExpend",value:function(e){this.enableStyle(e,this.container,"expend")}},{key:"toggleToolsExpend",value:function(){this.container.classList.toggle("expend")}},{key:"makeHeaderMobileLeftTools",value:function(){var e=document.createElement("div");e.className="header_tools mobile_left";var n=document.createElement("div");n.className="btn_wrapper",e.appendChild(n);var i=(this.btnCopyOfMobileLeft=new xa(t.onCopy,{icon:ne.ToolsIcon.COPY})).getContainer();i.classList.add("copy"),n.appendChild(i);var a=(this.btnDeleteOfMobileLeft=new xa(t.onDelete,{icon:ne.ToolsIcon.DELETE})).getContainer();a.classList.add("delete"),n.appendChild(a),this.header.appendChild(e)}},{key:"makeHeaderRightTools",value:function(){var e=this,n=this.headerRightTools=document.createElement("div");n.className="header_tools right",this.btnAdminEdit=new xa(function(t){e.isAdminEditMode=t,X.a.instance.dispatch(new K.c(function(e,t,n){n.renderItemTools(e,t)},!1))},{icon:ne.ToolsIcon.SETTINGS}),this.btnImageframePhotoLock=new xa(function(){return X.a.instance.dispatch(new Rn.c)},{icon:ne.ToolsIcon.FRAME_LOCK}),this.btnImageframePhotoLock.getContainer().classList.add("frame_lock"),this.btnCopy=new xa(t.onCopy,{icon:ne.ToolsIcon.COPY}),this.btnCopy.getContainer().classList.add("copy"),new Le.a(this.btnCopy.container,Ge.a.B,{title:{name:"복제하기",shortcut:"Ctrl + D"}}).onStartView(),this.btnLock=new xa(t.onLock,{icon:ne.ToolsIcon.LOCK}),this.btnLock.getContainer().classList.add("lock"),new Le.a(this.btnLock.container,Ge.a.B,{title:{name:"잠금",shortcut:"Ctrl + L"}},{title:{name:"잠금해제",shortcut:"Ctrl + L"}}).onStartView(),this.btnDelete=new xa(t.onDelete,{icon:ne.ToolsIcon.DELETE}),this.btnDelete.getContainer().classList.add("delete"),new Le.a(this.btnDelete.container,Ge.a.B,{title:{name:"삭제하기",shortcut:"Delete"}}).onStartView(),this.btnFavorite=new Zd,this.btnGroup=new xa(function(e){e?X.a.instance.dispatch(new On.a):X.a.instance.dispatch(new On.d)},{icon:ne.ToolsIcon.ITEM_GROUP}),new Le.a(this.btnGroup.container,Ge.a.B,{title:{name:"그룹",shortcut:"Ctrl + G"}},{title:{name:"그룹해제",shortcut:"Ctrl + Shift + G"}}).onStartView();var i=document.createElement("div");i.className="btn_wrapper",i.appendChild(this.btnAdminEdit.getContainer()),i.appendChild(this.btnImageframePhotoLock.getContainer()),i.appendChild(this.btnGroup.getContainer()),i.appendChild(this.btnCopy.getContainer()),i.appendChild(this.btnLock.getContainer()),i.appendChild(this.btnDelete.getContainer()),i.appendChild(this.btnFavorite.getContainer()),n.appendChild(i),this.header.appendChild(n)}},{key:"makeHeaderMobileRightTools",value:function(){var e=this.headerMobileRightTools=document.createElement("div");e.className="header_tools mobile_right";var n=document.createElement("div");n.className="btn_wrapper",e.appendChild(n);var i=(this.btnLockOfMobileRight=new xa(t.onLock,{icon:ne.ToolsIcon.LOCK})).getContainer();i.classList.add("lock"),n.appendChild(i),this.header.appendChild(e)}},{key:"makeHeaderMobileTools",value:function(){var e=this.headerMobileTools=document.createElement("div");e.className="toolbox_header_mobile",this.rowContentsRenderer.forEach(function(t){e.insertBefore(t.makeMobileToolbox(),e.lastChild)}),this.header.appendChild(e)}},{key:"makeHeader",value:function(){this.header=document.createElement("div"),this.header.className=r.a.TOOLBOX_HEADER,this.headerTitle=document.createElement("span"),this.header.appendChild(this.headerTitle),this.makeHeaderMobileLeftTools(),this.makeHeaderMobileTools(),this.makeHeaderRightTools(),this.makeHeaderMobileRightTools(),this.container.appendChild(this.header)}},{key:"makeHeaderSlide",value:function(){var e=this,t=this.headerSlide=document.createElement("div");t.className="header_slide",Object(ne.setToolsIcon)(t,ne.ToolsIcon.GREATER_THAN),this.container.appendChild(t);var n=0;this.header.onscroll=function(){n&&window.clearTimeout(n),n=window.setTimeout(function(){return e.changeSlideVisibleDependsOnHeaderScrollState()},50)}}},{key:"makeBody",value:function(){this.body=document.createElement("div"),this.body.className=r.a.TOOLBOX_BODY;var e=document.createDocumentFragment();this.rowContents.forEach(function(t){var n=t.row.getContainer();t.element=n,e.appendChild(n)}),this.scrollElement=new Ce.a,this.scrollElement.element.style.width="100%",this.scrollContents=document.createElement("div"),this.scrollContents.appendChild(e),this.body.appendChild(this.scrollElement.render(this.scrollContents)),this.container.appendChild(this.body)}},{key:"makeFooter",value:function(){this.footer=document.createElement("div"),this.footer.className=r.a.TOOLBOX_FOOTER,this.container.appendChild(this.footer)}},{key:"addRowContents",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.forEach(function(e){return t.rowContents.push(e)}),n&&this.rowContents.sort(function(e,t){return e.priority-t.priority})}},{key:"onDataChanged",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;this.designDoc=e,this.renderView(t,n,i)}},{key:"renderView",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;he()(F()(t.prototype),"renderView",this).call(this);var o=this.contentsStates;if(this.checkUpStatesChange(this.getRenderStates(n,i,a)),this.positionStates.visible){var s=!1,r=!1;if(1===n.length&&n[0]instanceof Z.a){var l=n[0];s=!l.isSameLastEditedCellAndEditingCell(),r=!l.isSameTextStyle(),l.updateLastEditedCell(),l.updateLastTextStyle()}(this.contentsStatesChanged||s||r||i===Xd.FORCE_UPDATE||i===Xd.MOCKUP_EDIT)&&(this.renderContents(this.positionStates.editorViewMode,n,this.contentsStates.isHeaderChangeFrom(o)),this.changeSlideVisibleDependsOnBodyEffectToolActiveState())}else this.setToolsExpend(!1);X.a.instance.dispatch(new K.c(function(t,n,i){var a=e.positionStates.visible?nl.top:nl.default;i.setPositionFloatingButtons(a)})),this.positionStatesChanged&&(this.setActive(this.positionStates.visible),this.positionStates.visible&&document.body.setAttribute("data-view",this.positionStates.editorViewMode),X.a.instance.dispatch(new K.c(function(t,n,i){i.leftPanelMainVC.setActiveItemMenu(e.positionStates.visible)})))}},{key:"renderContents",value:function(e,n,i){var a=this,o=this.contentsStates.renderedItem,s=this.contentsStates.isLock,l=this.contentsStates.isValidResource,c=this.contentsStates.isUnsupportedItem;if(i){this.headerTitle.innerHTML="";var u=this.contentsStates.headerTitle;if(s?u+=" (잠겨있음)":l?c&&(u="미지원 요소"):u+=o&&o.getResourceLoadStatus()===qe.b.TEMPORARY_ERROR?" (일시적인 오류)":" (삭제됨)",this.contentsStates.navRootGroup){var d=document.createElement("span");d.className=t.NAV_ROOT_GROUP,d.innerText="그룹",this.headerTitle.appendChild(d),o&&Object(ne.setToolsIcon)(this.headerTitle,ne.ToolsIcon.GREATER_THAN,!0)}this.contentsStates.navRootGroup&&!o||this.headerTitle.appendChild(document.createTextNode(u)),this.contentsStates.renderedItem&&this.container.setAttribute("data-type",o.getItemType().toLowerCase()),this.setToolsExpend(!1),this.headerMobileTools.childNodes.forEach(function(e){e.classList.contains(r.a.HIDE)||e.childNodes.forEach(function(e){return e.classList.remove("is_selected")})}),this.rowContents.forEach(function(e){e.element.classList.remove("mobile_active"),e.element.classList.contains("row_item_common")&&e.element.childNodes.forEach(function(e){e.classList.contains("tools_popup")&&e.classList.add(r.a.HIDE)})})}var h=id.isVisiblePhotoLockBtn(o);this.btnImageframePhotoLock.setDisplay(h),h&&this.btnImageframePhotoLock.updateUI({isSelected:!o.props.canInsertPhotoItem});var p=o&&o.isOnlyOneItem(),m=(this.contentsStates.headerToolVisible&jd.LOCK)>0&&!p;if(m){var f={isSelected:s};this.btnLock.updateUI(f),this.btnLockOfMobileRight.updateUI(f)}this.btnLock.setDisplay(m),this.headerMobileRightTools.style.display=m?"":"none",(this.contentsStates.headerToolVisible&jd.FAVORITE)>0?(this.btnFavorite.setDisplay(!0),this.btnFavorite.updateUI({active:!0,selectedItem:o})):(this.btnFavorite.setDisplay(!1),this.btnFavorite.updateUI({active:!1})),(this.contentsStates.headerToolVisible&jd.GROUP)>0?(this.btnGroup.setDisplay(!0),1===n.length?this.btnGroup.updateUI({isSelected:!0}):this.btnGroup.updateUI({isSelected:Qe.b.isSameGroup(n)})):this.btnGroup.setDisplay(!1),this.btnAdminEdit.setDisplay(Ke.a.getUserSetting().adminMode),this.btnAdminEdit.updateUI({active:Ke.a.getUserSetting().adminMode,isSelected:this.contentsStates.isAdminEditView}),this.rowContentsRenderer.forEach(function(e){e.updateToolboxRowContents(n,a.contentsStates)});var v=!(!s&&l&&!c);this.enableStyle(v,this.container,r.a.ITEM_LOCKED),this.enableStyle(v,this.headerRightTools,r.a.ITEM_LOCKED),this.enableStyle(v,this.headerMobileTools,r.a.ITEM_LOCKED),this.enableStyle(v,this.headerMobileRightTools,r.a.ITEM_LOCKED),this.btnDelete.setDisplay(!0);var g={active:!s&&l,isSelected:!1};this.btnDelete.updateUI(g),this.btnDeleteOfMobileLeft.updateUI(g);var E=l&&!p&&!s&&!c;this.btnCopy.setDisplay(E),this.btnCopyOfMobileLeft.setDisplay(!p),this.btnCopyOfMobileLeft.updateUI({active:E,isSelected:!1}),this.changeSlideVisibleDependsOnHeaderScrollState();for(var y=0,T=0,I=this.rowContents.length;T<I;T++){var C=this.rowContents[T];if(C.row.rowVisible){if(y+=1,null==C.element){var k=C.row.getContainer();C.element=k}if(this.scrollContents===C.element.parentElement)continue;this.scrollContents.insertBefore(C.element,this.scrollContents.children.item(y-1))}else C.element.parentElement&&C.element.parentElement.removeChild(C.element)}}},{key:"getRenderStates",value:function(e,t,n){if(this.mouseAction.mode===Fn.a.MODE_ITEM_DRAG)return{position:new eh(this.positionStates.editorViewMode,!0,this.mouseAction.offsetY,this.mouseAction.offsetX),contents:void 0};var i=e;if(t===Xd.HIDE||0===i.length||i.some(function(e){return e.status===qe.g.LOADING}))return{position:new eh(this.positionStates.editorViewMode,!1,this.positionStates.top,this.positionStates.left),contents:new Jd(null,null,null,0,!1,!1,!0,!1,!1,null)};var a=null,o=null,s=jd.LOCK,r=!1,l=!0,c=!1,u=!1;i.length>1?(s|=jd.GROUP,Qe.b.isSameGroup(i)?(u=!0,(o=Qe.b.getRootGroup(i[0].groupId).getSelectedItem())?(a=o.getHeaderTitle(),r=o.isLock()):(a="그룹",r=i[0].isLock())):(a="다중요소",r=i[0].isLock())):(a=(o=i[0]).getHeaderTitle(),o instanceof q.a||(s|=jd.FAVORITE),o.groupId&&(u=!0,s|=jd.GROUP),r=o.isLock(),l=!o.isResourceLoadFail(),c=o.isUnsupported(),l&&!c||(s-=jd.LOCK,s-=jd.FAVORITE)),t===Xd.ADMIN&&(this.isAdminEditMode=!0);var d=-1;t===Xd.MOCKUP_EDIT&&(a="조합",this.isAdminEditMode=!0,d=n);var h=Ke.a.getUserSetting(),p=h.adminMode,m=h.devMode,f=h.unicornTheme;return{position:new eh(this.positionStates.editorViewMode,!0,this.positionStates.top,this.positionStates.left),contents:new Jd(i.map(function(e){return{tbpeId:e.tbpeId,revision:e.props.getRevision(),forced:e.props.isForcedUpdate()}}),o,a,s,u,r,l,c,this.isAdminEditMode&&p,f,d,m)}}},{key:"addEventListeners",value:function(){var e=this,n=this,i=function(t){if(e.mouseAction.mode===Fn.a.MODE_ITEM_DRAG){var n=Y.a.instance.size;e.mouseAction.offsetX+=t.clientX-e.mouseAction.baseX,e.mouseAction.offsetY+=t.clientY-e.mouseAction.baseY,e.mouseAction.baseX=t.clientX,e.mouseAction.baseY=t.clientY,e.mouseAction.offsetX=Math.max(264-n.canvasWidth+e.margin,Math.min(e.mouseAction.offsetX,-e.margin)),e.mouseAction.offsetY=Math.min(n.canvasHeight-e.marginBottom,Math.max(e.mouseAction.offsetY,e.margin)),e.onDataChanged(void 0)}},a=function t(n){e.mouseAction.mode=Fn.a.MODE_NONE,document.removeEventListener("mouseup",t),document.removeEventListener("mousemove",i)};$(this.container).on("click",".".concat(t.NAV_ROOT_GROUP),function(){X.a.instance.dispatch(new Du)}).on("mousedown",".".concat(r.a.TOOLBOX_HEADER),function(e){2!==e.button&&Y.a.instance.editorViewMode!==xr.b.HARD_FIXED&&(document.addEventListener("mouseup",a),document.addEventListener("mousemove",i),n.mouseAction.mode=Fn.a.MODE_ITEM_DRAG,n.mouseAction.baseX=e.clientX,n.mouseAction.baseY=e.clientY)}).on("keydown",":text",function(e){return e.stopPropagation()}).on("mousedown",[".".concat(r.a.TOOLS_ACCORDION_ROW),".".concat(r.a.ACCORDION_EFFECT_ROW)],function(){e.changeSlideVisibleDependsOnBodyEffectToolActiveState()})}},{key:"addContentsRenderers",value:function(e){var t=this;this.onCreateViewIfNotCreated(),e.forEach(function(e){if(!t.rowContentsRenderer.some(function(t){return t===e})){t.rowContentsRenderer.push(e);var n=e.makeToolboxRowContents();t.addRowContents(n),n.forEach(function(e){var n=e.row.getContainer();e.element=n,t.scrollContents.appendChild(n)})}})}},{key:"getContentsRendererList",value:function(){return this.rowContentsRenderer}},{key:"changeSlideVisibleDependsOnHeaderScrollState",value:function(){if(this.header&&this.headerSlide){var e=this.header,t=Math.round(e.scrollWidth-e.clientWidth)===Math.round(e.scrollLeft),n=!this.header.offsetParent||e.clientWidth===e.scrollWidth||t;this.headerSlide.style.display=n?"none":""}}},{key:"changeSlideVisibleDependsOnBodyEffectToolActiveState",value:function(){var e=this;this.headerSlide&&setTimeout(function(){var t=Array.from(e.scrollContents.querySelectorAll(".".concat(r.a.EFFECT_TOOLS))).some(function(e){return e.classList.contains("mobile_active")});e.headerSlide.style.display=t?"none":"",t||e.changeSlideVisibleDependsOnHeaderScrollState()},0)}},{key:"onChangeActiveState",value:function(){he()(F()(t.prototype),"onChangeActiveState",this).call(this),this.changeSlideVisibleDependsOnHeaderScrollState()}},{key:"onChangeScrollY",value:function(e){this.scrollElement.setScrollY(e,100)}}],[{key:"onCopy",value:function(){X.a.instance.dispatch(new xn(Y.a.instance.renderPageIdx)),X.a.instance.dispatch(new Vn(Y.a.instance.renderPageIdx))}},{key:"onDelete",value:function(){X.a.instance.dispatch(new An.a)}},{key:"onLock",value:function(e){e?X.a.instance.dispatch(new On.l):X.a.instance.dispatch(new On.p)}}]),t}(He.a);th.NAV_ROOT_GROUP="nav_root_group",function(e){e[e.HIDE=0]="HIDE",e[e.ADMIN=1]="ADMIN",e[e.FORCE_UPDATE=2]="FORCE_UPDATE",e[e.MOCKUP_EDIT=3]="MOCKUP_EDIT"}(Xd||(Xd={})),function(e){e[e.LOCK=2]="LOCK",e[e.FAVORITE=4]="FAVORITE",e[e.GROUP=8]="GROUP"}(jd||(jd={}));var nh,ih=function(){function e(){L()(this,e),this.toolbox=new th}var t;return w()(e,[{key:"setReady",value:(t=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.toolbox.onStartView();case 1:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"render",value:function(e,t,n){var i=t.activeItems;n===nh.HIDE?this.toolbox.onDataChanged(e,i,Xd.HIDE):n===nh.FORCE_UPDATE?this.toolbox.onDataChanged(e,i,Xd.FORCE_UPDATE):n===nh.ADMIN?this.toolbox.onDataChanged(e,i,Xd.ADMIN):this.toolbox.onDataChanged(e,i)}},{key:"renderItem",value:function(e,t,n,i){n===nh.ADMIN?this.toolbox.onDataChanged(void 0,e,Xd.ADMIN):n===nh.MOCKUP_EDIT?this.toolbox.onDataChanged(void 0,e,Xd.MOCKUP_EDIT,i):n===nh.HIDE?this.toolbox.onDataChanged(void 0,e,Xd.HIDE):this.toolbox.onDataChanged(void 0,e)}},{key:"addToolboxContentsRenderers",value:function(e){this.toolbox.addContentsRenderers(e)}},{key:"setToolsExpend",value:function(e){this.toolbox.setToolsExpend(e)}},{key:"toggleToolsExpend",value:function(){this.toolbox.toggleToolsExpend()}},{key:"getToolRenderers",value:function(){return this.toolbox.getContentsRendererList()}}]),e}();!function(e){e[e.HIDE=0]="HIDE",e[e.ADMIN=1]="ADMIN",e[e.FORCE_UPDATE=2]="FORCE_UPDATE",e[e.MOCKUP_EDIT=3]="MOCKUP_EDIT"}(nh||(nh={}));var ah,oh=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,!0))).isLoginRequire=!1,e.isVisibleOnlyAdmin=!1,e.isVisibleOnlyDev=!1,e.isLoaded=!1,e.itemAccessType=So.a.PUBLIC,e}var n;return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.loginView=t.makeLoginView("로그인 후 이용 가능해요.")}},{key:"getNameResourceKey",value:function(){return this.nameResourcekey}},{key:"isSameType",value:function(e){return this.leftPanelType===e}},{key:"getLeftPanelType",value:function(){return this.leftPanelType}},{key:"loadList",value:function(){this.resetMenuListLoadFlag(),this.fetchList()}},{key:"resetMenuListLoadFlag",value:function(){}},{key:"fetchList",value:function(){}},{key:"onChangeFetchCondition",value:function(){this.fetchList()}},{key:"checkLoginRequire",value:function(){var e=this.isLoginRequire&&!f.a.getUser().isLogin();return e?this.container.appendChild(this.loginView):$(this.loginView).remove(),e}},{key:"setActive",value:function(e){return he()(F()(t.prototype),"setActive",this).call(this,e),e&&(X.a.instance.dispatch(new K.c(function(e,t,n){n&&n.renderItemTools(e,t,!0)})),this.isLoaded||(this.fetchList(),this.isLoaded=!0)),!e&&this.searchTool&&this.searchTool.initUI(),this}},{key:"onDataChanged",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"setItemAccessType",value:(n=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.itemAccessType!==t){e.next=2;break}return e.abrupt("return");case 2:this.itemAccessType=t,this.loadList();case 4:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"makeAdminUI",value:function(){var e=this;this.adminUIElement=document.createElement("div"),this.adminUIElement.className=r.a.ADMIN_UI;var t=document.createElement("ul"),n=document.createElement("li");n.className=r.a.ACTIVE,n.setAttribute("data-type",So.a.PUBLIC),n.addEventListener("click",function(){return l(n)}),n.innerText="공개",t.appendChild(n);var i=document.createElement("li");i.setAttribute("data-type",So.a.PRIVATE),i.addEventListener("click",function(){return l(i)}),i.innerText="비공개",t.appendChild(i);var o=document.createElement("li");o.setAttribute("data-type",So.a.DISABLED),o.addEventListener("click",function(){return l(o)}),o.innerText="비활성",t.appendChild(o),this.adminUIElement.appendChild(t);var l=function(){var n=s()(a.a.mark(function n(i){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return $(t).children().removeClass(r.a.ACTIVE),i.classList.add(r.a.ACTIVE),n.next=4,e.setItemAccessType(i.getAttribute("data-type"));case 4:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}();return this.adminUIElement}},{key:"getGTMItemData",value:function(e){return null}},{key:"getItemUseEventData",value:function(){return null}},{key:"leftPanelType",set:function(e){this._leftPanelType=e,this.nameResourcekey=So.b.getNameResourceKey(e)},get:function(){return this._leftPanelType}}],[{key:"makeLoginView",value:function(e){var t=document.createElement("div");t.className=r.a.LOGIN_NOTI_LAYER;var n=document.createElement("div");Object(ne.setToolsIcon)(n,ne.ToolsIcon.USER_PROFILE);var i=document.createElement("p");i.innerText=e,n.appendChild(i);var a=document.createElement("button");return a.innerText="로그인 하기",a.addEventListener("click",function(){return Ye.a.openLoginPopup(Ie.a.LEFT_MENU)}),n.appendChild(a),t.appendChild(n),t}}]),t}(He.a),sh=function(){function e(){L()(this,e)}var t,n;return w()(e,[{key:"loadSheetFile",value:(n=s()(a.a.mark(function e(t){var n,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readXmlFile(t);case 2:return n=e.sent,i=zt.a.makeDesignDC(null),e.next=6,i.load();case 6:return o=e.sent,e.next=9,o.loadPageFromXml([n]);case 9:return e.next=11,this.renderEditor();case 11:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"readXmlFile",value:function(e){return new Promise(function(t,n){var i=new FileReader;i.onloadend=function(){var e=(new DOMParser).parseFromString(i.result,"text/xml");t(e)},i.onerror=function(){return n("fail readXmlFile : [".concat(e.name,"]"))},i.readAsText(e)})}},{key:"loadDesign",value:(t=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=zt.a.makeDesignDC({repositoryType:Do.a.UNICORN,idx:t}),e.t0=Y.a,e.next=4,n.load();case 4:return e.t1=e.sent,e.t0.setMetaData.call(e.t0,e.t1),e.next=8,this.renderEditor();case 8:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"renderEditor",value:function(){return new Promise(function(e,t){X.a.instance.dispatch(new K.c(function(){var n=s()(a.a.mark(function n(i,o,s){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,s.canvasAreaVC.updatePagingManager(),s.canvasAreaVC.updateZoomFitAfterRender(),n.next=5,s.renderAll(i,o);case 5:X.a.instance.dispatch(new Jn.g),e(),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),t(n.t0);case 12:case"end":return n.stop()}},n,null,[[0,9]])}));return function(e,t,i){return n.apply(this,arguments)}}()))})}}]),e}(),rh=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).leftPanelType=So.b.DEV_TOOL,e.developerToolCtrl=new sh,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className="lib_dev_tool",this.container.appendChild(this.makeSheetFileLoader()),this.container.appendChild(this.makeDesignLoader())}},{key:"makeSheetFileLoader",value:function(){var e=this,t=document.createElement("button");t.innerText="시트 파일 로드",t.addEventListener("click",function(){return $(n).trigger("click")});var n=document.createElement("input");n.type="file",n.accept=".xml",n.style.display="none",$(n).on("change",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.files){t.next=13;break}return t.prev=1,t.next=4,e.developerToolCtrl.loadSheetFile(n.files[0]);case 4:t.next=10;break;case 6:t.prev=6,t.t0=t.catch(1),console.error(t.t0),alert("오류");case 10:return t.prev=10,n.value="",t.finish(10);case 13:case"end":return t.stop()}},t,null,[[1,6,10,13]])})));var i=document.createElement("div");return i.appendChild(t),i.appendChild(n),i}},{key:"makeDesignLoader",value:function(){var e=this,t=document.createElement("input");t.placeholder="디자인 인덱스",t.addEventListener("keydown",function(e){return e.stopPropagation()});var n=document.createElement("button");n.innerText="디자인 로드",n.addEventListener("click",s()(a.a.mark(function n(){var i;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=isNaN(Number(t.value))?Number(atob(t.value)):Number(t.value),!(isNaN(i)||i<=0)){n.next=3;break}return n.abrupt("return");case 3:return n.prev=3,n.next=6,e.developerToolCtrl.loadDesign(i);case 6:n.next=12;break;case 8:n.prev=8,n.t0=n.catch(3),console.error(n.t0),alert("오류");case 12:case"end":return n.stop()}},n,null,[[3,8]])})));var i=document.createElement("div");return i.appendChild(t),i.appendChild(n),i}}]),t}(oh),lh=n(380),ch=function(){function e(){L()(this,e)}return w()(e,[{key:"requestExternalStickerDownload",value:function(e,t){lh.a.requestExternalStickerDownload(t).then(function(){return e.onRequestExternalStickerDownload(!0)},function(){return e.onRequestExternalStickerDownload(!1)})}}]),e}(),uh=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).leftPanelType=So.b.IMAGE_DOWNLOAD,e.imageDownloadDC=new ch,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.LIBRARY_IMAGE_DOWNLOAD,this.gettyInput=this.makeIdInput("Getty",this.container),this.utoInput=this.makeIdInput("Uto",this.container),this.container.appendChild(this.makeDownloadReqButton())}},{key:"makeIdInput",value:function(e,t){var n=this.createDivElement(r.a.ROW_WRAP);t.appendChild(n);var i=this.createDivElement(r.a.TITLE);i.innerText="".concat(e," ID"),n.appendChild(i);var a=this.createDivElement(r.a.DESC);a.innerText="* 여러 개 입력 시 콤마 사용",n.appendChild(a);var o=document.createElement("textarea");return o.addEventListener("keydown",function(e){return e.stopPropagation()}),n.appendChild(o),o}},{key:"makeDownloadReqButton",value:function(){var e=this,t=document.createElement("button");return t.innerText="다운로드 요청하기",t.addEventListener("click",function(){return e.imageDownloadDC.requestExternalStickerDownload(e,e.getReqParam())}),t}},{key:"onRequestExternalStickerDownload",value:function(e){e?(this.utoInput.value="",this.gettyInput.value="",zc.a.open({title:"다운로드 요청 완료",subTitle:"메일을 확인해주세요.",hideCancelBtn:!0})):alert("다운로드 요청에 실패하였습니다.")}},{key:"getReqParam",value:function(){var e={designerId:f.a.getUser().email.split("@")[0]},t=this.gettyInput.value;t.length&&(e.gettyIdList=t.split(","));var n=this.utoInput.value;return n.length&&(e.utoIdList=n.split(",")),e}}]),t}(oh),dh=n(171),hh=n(102),ph=n(402),mh=n(395),fh=function(e){function t(e,n,i,a,o){var s;return L()(this,t),(s=V()(this,F()(t).call(this,!0))).hasNextPage=!0,s.justifyRequire=!1,s.justifyForce=!1,s.enableScrollPaging=!1,s.listToolType=e,s.listToolInitParam=n,s.paginationMode=a,s.listEmptyView=o,s.paginationParam={page:1,pageSize:i},s}var n;return z()(t,e),w()(t,[{key:"setListener",value:function(e){this.listener=e}},{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.PAGINATION_TOOL,this.scrollElement=new Ce.a(!1,!0,"100%"),this.scrollElement.onAfterScroll=this.onScroll.bind(this),this.listTool=new this.listToolType(this.listToolInitParam.listItemRenderAction,this.listToolInitParam.justifyOption),this.container.appendChild(this.scrollElement.render(this.listTool.getContainer())),this.pagination=new ph.a(function(){var t=s()(a.a.mark(function t(n){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.paginationParam=n,e.doRequestAction();case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),this.paginationParam.pageSize),this.container.appendChild(this.pagination.render()),this.loadingUI=new mh.a(this.container),this.makeElement()}},{key:"makeElement",value:function(){this.renderPaginationMode()}},{key:"initList",value:function(){this.paginationParam.page=1,this.hasNextPage=!0,this.enableScrollPaging=!0,this.doRequestAction()}},{key:"justifyList",value:(n=s()(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.justifyRequire=!1,t=this.justifyForce,this.justifyForce=!1,e.next=5,this.listTool.justify(t);case 5:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"setJustifyRequire",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.justifyRequire=!0,this.justifyForce=e}},{key:"isJustifyRequire",value:function(){return this.justifyRequire}},{key:"renderPaginationMode",value:function(){switch(this.onCreateViewIfNotCreated(),this.paginationMode){case au.a.SCROLL:this.container.classList.remove(r.a.BUTTON_MODE);break;case au.a.BUTTON:this.container.classList.add(r.a.BUTTON_MODE)}}},{key:"onScroll",value:function(){this.scrollElement.hasScroll()&&this.scrollElement.isScrollBottomEnd()&&(this.enableScrollPaging&&this.paginationMode===au.a.SCROLL&&this.hasNextPage&&(this.paginationParam.page++,this.doRequestAction()),this.listener&&this.listener.onScrollBottomEnd())}},{key:"doRequestAction",value:function(){this.listTool.refreshWidthOption();try{this.loadList()}catch(e){throw this.renderEmptyListView(!0),e}}},{key:"loadList",value:function(){this.listEmptyView&&$(this.listEmptyView).remove();var e,t=1===this.paginationParam.page||this.paginationMode===au.a.BUTTON;t&&(this.listTool.clear(),this.scrollElement.setScrollY(0)),e="MyImageListVC"!==this.listToolType.name||t?this.showLoadingBoxes():[],this.listener.onNeedMoreElementSync(this.paginationParam,t,e)}},{key:"setPaginationListResponse",value:function(e,t,n){this.renderPagination(e.totalRow)}},{key:"onApiError",value:function(e){this.setPaginationListResponse({items:[],totalRow:0},this.paginationParam,e)}},{key:"onJustifiedListViewRendered",value:function(e){this.scrollElement.updateScrollbar(),this.checkScroll(),this.listener&&this.listener.onPaginationFinishRender(this.getTotalRow()),this.loading(!1)}},{key:"checkScroll",value:function(){this.paginationMode===au.a.SCROLL&&this.isElementVisible()&&!this.hasVerticalScroll()&&this.hasNextPage&&(this.paginationParam.page++,this.loadList())}},{key:"isElementVisible",value:function(){return $(this.scrollElement.contents).is(":visible")}},{key:"hasVerticalScroll",value:function(){return this.scrollElement.contents.clientHeight<this.scrollElement.contents.scrollHeight}},{key:"showLoadingBoxes",value:function(){return this.listTool.showLoadingBoxes(this.paginationParam.pageSize,this.listToolInitParam.justifyOption)}},{key:"renderEmptyListView",value:function(e){this.listEmptyView&&(1===this.paginationParam.page&&e?this.container.appendChild(this.listEmptyView):$(this.listEmptyView).remove())}},{key:"renderPagination",value:function(e){this.pagination.render({page:this.paginationParam.page,pageSize:this.paginationParam.pageSize,totalRow:e})}},{key:"setPaginationMode",value:function(e){this.paginationMode=e,this.renderPaginationMode()}},{key:"setListEmptyView",value:function(e){this.listEmptyView=e}},{key:"prependItem",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];$(this.listEmptyView).remove(),this.listTool.prependItem(e,t)}},{key:"loading",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.onCreateViewIfNotCreated(),this.enableStyle(e,this.container,r.a.LOADING)}},{key:"getTotalRow",value:function(){return this.pagination.getTotalRow()}},{key:"prependElementToScrollContents",value:function(e){this.onCreateViewIfNotCreated(),this.scrollElement.contents.insertBefore(e,this.scrollElement.contents.firstChild)}}]),t}(He.a),vh=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add(r.a.TITLE)}},{key:"renderView",value:function(e){he()(F()(t.prototype),"renderView",this).call(this),this.container.innerText=e||"",this.setVisibility(Boolean(e))}}]),t}(He.a),gh=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:au.a.SCROLL,a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;return L()(this,t),(n=V()(this,F()(t).call(this,hh.c,{listItemRenderAction:function(e){return e.render()},justifyOption:a},e,i,o))).colSize=1,n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.titleView=new vh,this.scrollElement.contents.insertBefore(this.titleView.getContainer(),this.scrollElement.contents.firstChild)}},{key:"loadList",value:function(){1!==this.paginationParam.page&&this.paginationMode!==au.a.BUTTON||(this.loadedListItems=[]),he()(F()(t.prototype),"loadList",this).call(this)}},{key:"setPaginationListResponse",value:function(e,n,i){var a=this;he()(F()(t.prototype),"setPaginationListResponse",this).call(this,e,n,i);var o=1===n.page||this.paginationMode===au.a.BUTTON;try{var s;if(!o&&this.loadedListItems)(s=this.loadedListItems).push.apply(s,Yn()(e.items));else this.loadedListItems=e.items;this.hasNextPage=!it.a.isEmpty(e.items)&&this.paginationParam.page*this.paginationParam.pageSize<e.totalRow,this.listTool.setUpdateUIParam({list:e.items,isAppend:!o,loadingBoxes:i,colCount:this.colSize},function(){return a.onJustifiedListViewRendered(e)})}catch(e){throw this.loading(!1),this.listTool.clearUnloaded(i),e}}},{key:"onJustifiedListViewRendered",value:function(e){he()(F()(t.prototype),"onJustifiedListViewRendered",this).call(this,e),this.renderEmptyListView(it.a.isEmpty(e.items))}},{key:"setListEmptyView",value:function(e){this.listEmptyView&&this.listEmptyView.parentElement&&this.listEmptyView.parentElement.removeChild(this.listEmptyView),he()(F()(t.prototype),"setListEmptyView",this).call(this,e)}},{key:"addItem",value:function(e){if(this.loadedListItems){var t=this.loadedListItems.find(function(t){return t.listItemData.myCollectionPk.referenceKey===e.listItemData.myCollectionPk.referenceKey});t?(t.listItemData.resourceData.pageList=e.listItemData.resourceData.pageList,t.updateThumbImg()):(this.pagination.increaseTotalCount(),this.prependItem(e))}}},{key:"prependItem",value:function(e){this.loadedListItems&&(this.loadedListItems.push(e),he()(F()(t.prototype),"prependItem",this).call(this,e,!1))}},{key:"updateItemThumbnail",value:function(e,t){if(this.loadedListItems){var n=this.loadedListItems.find(function(t){if(!Number.isNaN(Number(t.listItemData.myCollectionPk.referenceKey)))return Number(t.listItemData.myCollectionPk.referenceKey)===e});n&&n.updateThumbImg(t)}}},{key:"removeItem",value:function(e){var t=this.loadedListItems.find(function(t){return Number(t.listItemData.myCollectionPk.referenceKey)===e});t&&(this.loadedListItems.splice(this.loadedListItems.indexOf(t),1),this.listTool.removeItem(t.listItemData.resourceKey),this.listTool.justify(!0))}},{key:"setRecommendList",value:function(e){if(!this.recommendListTool){this.recommendListTool=new hh.c(function(e){return e.render()});var t=this.recommendListTool.getContainer();t.classList.add(r.a.RECOMMEND_LIST),$(this.scrollElement.contents).prepend(t)}this.recommendListTool.setUpdateUIParam({list:e},void 0)}},{key:"setListToolVisibility",value:function(e){this.scrollElement.setScrollY(0),this.listTool.setVisibility(e),this.pagination.setVisibility(e),$(this.listEmptyView).remove(),this.titleView.setVisibility(e),this.enableScrollPaging=e}},{key:"setColSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;this.colSize=e,this.listTool.setColSize(e,t)}}]),t}(fh),Eh=n(465),yh=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getTemplateLoadButtonName",value:function(){return"모든 페이지 적용하기"}}]),t}(Tn),Th=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this))).paginationMode=e,o.accountId=n,o.isAdminMode=i,o.isDevMode=a,o}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return this.isChangeRequireReload(e)||e.isAdminMode!==this.isAdminMode||e.isDevMode!==this.isDevMode}},{key:"isChangePaginationMode",value:function(e){return void 0===e||e.paginationMode!==this.paginationMode}},{key:"isChangeUser",value:function(e){return void 0===e||e.accountId!==this.accountId}},{key:"isChangeRequireReload",value:function(e){return void 0===e||this.isChangePaginationMode(e)||this.isChangeUser(e)}}]),t}(He.b),Ih=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).paginationListTool=new gh(e.getPageSize(),Ke.a.getUserSetting().leftPanelPaginationMode,e.getJustifiedListToolOption(),t.makeSearchNoResultView()),e.paginationListTool.setListener(H()(e)),e.paginationListTool.loading(),e.isLoginRequire&&qt.a.addDataInitListener(function(){return e.lib.clearCache()}),e}return z()(t,e),w()(t,[{key:"makeSubPagesTool",value:function(){return this.subPagesTool=S.a.getExecutionMode().isBizhowsChannelAndOrderPurpose()?new yh:new Tn,this.subPagesTool.getContainer()}},{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.removePaginationLoading(),this.setResizeEventListener()}},{key:"fetchList",value:function(){he()(F()(t.prototype),"fetchList",this).call(this),this.checkLoginRequire()||this.isLoaded||(this.loadListSync(),this.isLoaded=!0)}},{key:"loadListSync",value:function(){}},{key:"onNeedMoreElementSync",value:function(e,t,n){var i=this;this.lib.fetchElementList(e,t).then(function(t){i.paginationListTool.setPaginationListResponse(t,e,n)}).catch(function(e){console.error(e);var t=f.a.getUser();t.isLogin()&&e instanceof p.a&&e.isTeamPermissionDenied()?new Eh.a(t.getEmail(),t.getName(),i.loadListSync.bind(i)).open():i.paginationListTool.onApiError(n)})}},{key:"onPaginationFinishRender",value:function(e){}},{key:"onScrollBottomEnd",value:function(){}},{key:"removePaginationLoading",value:function(){this.paginationListTool.loading(!1)}},{key:"setResizeEventListener",value:function(){var e=this;window.addEventListener("resize",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isActive()){t.next=5;break}return t.next=3,e.paginationListTool.justifyList();case 3:t.next=6;break;case 5:e.paginationListTool.setJustifyRequire();case 6:case"end":return t.stop()}},t)})))}},{key:"getPageSize",value:function(){return 20}},{key:"getJustifiedListToolOption",value:function(){return hh.a}},{key:"setActive",value:function(e){return he()(F()(t.prototype),"setActive",this).call(this,e),this.onChangeActive(e),this}},{key:"onChangeActive",value:function(e){e&&(this.paginationListTool.isJustifyRequire()&&this.paginationListTool.justifyList().catch(function(e){return console.error(e)}),this.listener&&this.listener.onLeftPanelListViewActive(this))}},{key:"onDataChanged",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.contentsStates;return this.checkUpContentsChange(this.getRenderStates()),this.contentsStatesChanged&&(this.updateUI(t),this.contentsStates.isChangeRequireReload(n)&&(this.renderPaginationListTool(n),(this.isLoginRequire&&this.contentsStates.isChangeUser(n)||this.contentsStates.isChangePaginationMode(n)&&this.isLoaded)&&(this.isLoaded=!1))),this.container}},{key:"updateUI",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.enableStyle(Ke.a.getUserSetting().adminMode,this.paginationListTool.getContainer(),r.a.ADMIN_MODE)}},{key:"renderPaginationListTool",value:function(e){this.paginationListTool&&this.contentsStates.isChangePaginationMode(e)&&this.paginationListTool.setPaginationMode(Ke.a.getUserSetting().leftPanelPaginationMode)}},{key:"getRenderStates",value:function(){return new Th(Ke.a.getUserSetting().leftPanelPaginationMode,f.a.getUser().accountId,Ke.a.getUserSetting().adminMode,Ke.a.getUserSetting().devMode)}},{key:"getGTMItemData",value:function(e){return this.lib.getGTMItemData(e)}},{key:"getItemUseEventData",value:function(){var e=this.lib.getGTMLibData();return{type:Te.b.ITEM,category:e.category,keyword:e.keyword}}},{key:"setListener",value:function(e){this.listener=e}}],[{key:"makeSearchNoResultView",value:function(){var e=document.createElement("div");e.className=r.a.EMPTY_LIST_NOTI_LAYER;var t=document.createElement("div"),n=document.createElement("div");n.className="empty_list_notify_img",t.appendChild(n);var i=document.createElement("p");i.classList.add(r.a.TITLE),i.innerHTML="검색 결과가 없어요...",t.appendChild(i);var a=document.createElement("p");return a.innerHTML="다른 검색어를 입력해주세요.",t.appendChild(a),e.appendChild(t),e}}]),t}(oh),Ch=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getContents",value:function(){var e=document.createElement("div");e.className=r.a.CONTENTS,e.classList.add(r.a.DISABLE);var t=document.createElement("p");t.innerText=this.getTitle(),e.appendChild(t);var n=this.getInsideContents();return n.classList.add(r.a.INSIDE_CONTENTS),e.appendChild(n),e}},{key:"makeLine",value:function(){var e=document.createElement("div");return e.className=r.a.LINE,e}},{key:"makeRow",value:function(e,t){var n=document.createElement("div");n.className=r.a.ROW_WRAP;var i=document.createElement("span");i.className=r.a.TITLE,i.innerText=e;var a=document.createElement("span");return a.className=r.a.VALUE_ELEMENT,a.innerText=t,n.appendChild(i),n.appendChild(a),n}},{key:"getId",value:function(){return"miniPopup"}},{key:"updateUI",value:function(){}}]),t}(u.a),kh=function(e){function t(e,n,i,a,o,s,r){var l;return L()(this,t),(l=V()(this,F()(t).call(this))).imageId=e,l.designerId=n,l.imgWidth=i,l.imgHeight=a,l.extension=o,l.uploadImageCount=s,l.uploadDate=r,l.dddotElem=l.makeDddot(),l}return z()(t,e),w()(t,[{key:"getInsideContents",value:function(){var e=document.createElement("div");return e.appendChild(this.makeRow("디자이너 ID",this.designerId)),e.appendChild(this.makeRow("이미지 사이즈","".concat(this.imgWidth," × ").concat(this.imgHeight))),e.appendChild(this.makeRow("확장자",this.extension)),e.appendChild(this.makeRow("등록 스티커 수",this.uploadImageCount.toString())),e.appendChild(this.makeLine()),e.appendChild(this.makeRow("등록일",re.a.toString(new Date(this.uploadDate),"yyyy/MM/dd HH:mm"))),e}},{key:"getTitle",value:function(){return this.imageId}},{key:"getDddot",value:function(){return this.dddotElem}},{key:"makeDddot",value:function(){var e=this,t=document.createElement("div");t.className=r.a.DDDOT_WRAP;var n=Object(ne.setToolsIcon)(t,ne.ToolsIcon.DDDOT);return t.appendChild(n),n.addEventListener("click",function(){var t=s()(a.a.mark(function t(i){var o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.dddotElem.classList.add(r.a.ACTIVE),i.stopPropagation(),(o=$(n).offset()).left+=$(n).width()+6,e.open(o);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),t}},{key:"close",value:function(){return he()(F()(t.prototype),"close",this).call(this),this.dddotElem.classList.remove(r.a.ACTIVE),this}}]),t}(Ch),Lh=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0,void 0,"li"))).resourceData=e,n.container.draggable=!0,n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.makeElement()}},{key:"render",value:function(){return this.container}},{key:"getThumbUrlList",value:function(){return[this.resourceData.thumbnailUrl]}},{key:"makeElement",value:function(){var e=this.makeThumbImg();this.container.appendChild(e);var t=this.makeImageHoverLayer();t.style.backgroundImage="url(".concat(e.src,")"),this.container.appendChild(t)}},{key:"makeThumbImg",value:function(){var e=jt.a.getImageElementWithReplaceableThumbnail(),t=this.getThumbUrlList();return e.src=it.a.isEmpty(t)?null:t[0],e}},{key:"updateThumbImg",value:function(){if(this.thumb){var e=this.getThumbUrlList();this.thumb.src=it.a.isEmpty(e)?null:e[0]}}},{key:"makeImageHoverLayer",value:function(){var e=this,t=document.createElement("div");t.className=r.a.BTN_LAYER,Object(ne.setToolsIcon)(t,ne.ToolsIcon.DOWNLOAD,!0).addEventListener("click",function(){var t=s()(a.a.mark(function t(n){var i,o,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.stopPropagation(),n.preventDefault(),i=f.a.getUser().email.split("@")[0],o=e.resourceData.requestId.startsWith("uto_")?{designerId:i,utoIdList:[e.resourceData.requestId.replace("uto_","")]}:{designerId:i,gettyIdList:[e.resourceData.requestId.replace("get_","")]},s=!0,t.next=7,lh.a.requestExternalStickerDownload(o).catch(function(){s=!1,alert("다운로드 요청에 실패하였습니다.")});case 7:s&&zc.a.open({title:"다운로드 요청 완료",subTitle:"메일을 확인해주세요.",hideCancelBtn:!0});case 8:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());var n=new kh(this.resourceData.requestId,this.resourceData.designerId,this.resourceData.stickerWidth,this.resourceData.stickerHeight,this.resourceData.extension,Math.max(this.resourceData.stickerIdList.length,1),this.resourceData.createDate).getDddot();return t.appendChild(n),t}},{key:"getEECItemData",value:function(e,t,n){}}]),t}($t);!function(e){e[e.NONE=0]="NONE",e[e.STICKER=1]="STICKER",e[e.DESIGNER=2]="DESIGNER"}(ah||(ah={}));var _h,wh,Sh,bh=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).searchType=ah.NONE,e}var n;return z()(t,e),w()(t,[{key:"setKeyword",value:function(e){e.startsWith("@")?(this.searchType=ah.DESIGNER,this.keyword=e.replace("@","")):e.startsWith("get_")||e.startsWith("uto_")?(this.searchType=ah.STICKER,this.keyword=e):this.searchType=ah.NONE}},{key:"fetchListInternal",value:(n=s()(a.a.mark(function e(t){var n,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lh.a.getExternalStickerList(t);case 2:return n=e.sent,i=n.data?n.data:[],e.abrupt("return",{items:i.map(function(e){return new Lh(e)}),totalRow:n.totalCount});case 5:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)})},{key:"getRequestParam",value:function(e){return{pageNo:e.page,pageSize:e.pageSize,requestId:this.searchType===ah.STICKER?this.keyword:null,designerId:this.searchType===ah.DESIGNER?this.keyword:null}}},{key:"getLibType",value:function(){return sn.b.IMAGE_DOWNLOAD}}]),t}(sn.a),Rh=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getInsideContents",value:function(){var e=document.createElement("div");return e.id="KeywordSearchInfoPopup",e.appendChild(t.makeRow("이미지 ID",null,"get_a0123456789")),e.appendChild(t.makeRow("디자이너 ID","@","yjson")),e}},{key:"getTitle",value:function(){return"키워드 검색 예시"}}],[{key:"makeRow",value:function(e,t,n){var i=document.createElement("div");i.className=r.a.ROW_WRAP;var a=document.createElement("div");a.className=r.a.TITLE,a.innerText=e;var o=document.createElement("div");if(o.className=r.a.VALUE_ELEMENT,t){var s=document.createElement("span");s.className=r.a.SPECIAL,s.innerText=t,o.appendChild(s)}var l=document.createElement("span");return l.innerText=n,o.appendChild(l),i.appendChild(a),i.appendChild(o),i}}]),t}(Ch),Ah=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).keywordSearchInfoPopup=new Rh,e.lib=new bh,e.leftPanelType=So.b.IMAGE_SEARCH,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add(r.a.LIBRARY_IMAGE_SEARCH),this.container.appendChild(this.makeSearchTool()),this.container.appendChild(this.makeInfoBtn()),this.container.appendChild(this.paginationListTool.getContainer())}},{key:"makeSearchTool",value:function(){var e=this;return this.searchTool=new dh.a(function(t){return e.setKeyword(t)},"검색어를 입력하세요."),this.searchTool.getContainer()}},{key:"setKeyword",value:function(e){this.lib.setKeyword(e),this.loadListSync()}},{key:"makeInfoBtn",value:function(){var e=this,t=document.createElement("button");return t.className=r.a.BTN_IMAGE_SEARCH_INFO,Object(ne.setToolsIcon)(t,ne.ToolsIcon.OUTLINE),t.addEventListener("click",function(){var n=$(t).offset();n.left+=$(t).width()+6,e.keywordSearchInfoPopup.open(n)}),t}},{key:"loadListSync",value:function(){this.paginationListTool.initList()}},{key:"getJustifiedListToolOption",value:function(){return null}}]),t}(Ih),Oh=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).menuMap=new Map,e.isVisibleOnlyAdmin=!0,e.isVisibleOnlyDev=!0,e.leftPanelType=So.b.ADMIN_TOOL,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.LIBRARY_BACKGROUND,this.container.appendChild(this.makeRadioTool()),this.container.appendChild(this.makeContentsWrap());var e=[So.b.IMAGE_DOWNLOAD,So.b.IMAGE_SEARCH,So.b.DEV_TOOL];this.makeRadioItems(e),this.selectMenu(e[0])}},{key:"makeRadioItems",value:function(e){var t=this;e.forEach(function(e){var n=new Dh(e);t.radioTool.addBtn(new be.a("# ".concat(n.resourceKey),n.leftPanelType,!1))})}},{key:"makeRadioTool",value:function(){var e=this;return this.radioTool=new be.b(function(t){return e.selectMenu(t)}),this.radioTool.getContainer()}},{key:"makeContentsWrap",value:function(){return this.contentsWrap=this.createDivElement(r.a.CONTENTS_WRAP),this.contentsWrap}},{key:"makeMenuPanel",value:function(e){var t=Ph.create(e);return t&&(this.menuMap.set(t.getLeftPanelType(),t),this.contentsWrap.appendChild(t.getContainer())),t}},{key:"selectMenu",value:function(e){if(!this.checkLoginRequire()){var t=this.menuMap.get(e);t||(t=this.makeMenuPanel(e)),this.radioTool.select(e,!1),this.selectedMenu&&this.selectedMenu.setActive(!1),this.selectedMenu=t.setActive(!0)}}}]),t}(oh),Ph=function(){function e(){L()(this,e)}return w()(e,null,[{key:"create",value:function(e){switch(e){case So.b.IMAGE_DOWNLOAD:return new uh;case So.b.IMAGE_SEARCH:return new Ah;case So.b.DEV_TOOL:return new rh;default:throw new Error("메뉴가 존재하지 않습니다.")}}}]),e}(),Dh=function e(t){L()(this,e),this.leftPanelType=t,this.resourceKey=So.b.getNameResourceKey(t)};!function(e){e.LINE="LINE",e.FIGURE="FIGURE",e.ILLUST_GROUP="ILLUST_GROUP",e.ILLUST="ILLUST",e.FRAME="FRAME",e.PICTURE="PICTURE",e.BITMAP="BITMAP",e.COMBINATION="COMBINATION",e.STYLE="STYLE",e.MOCKUP_TEXT="MOCKUP_TEXT",e.MOCKUP_GRID="MOCKUP_GRID",e.BACKGROUND_PATTERN="BACKGROUND_PATTERN",e.BACKGROUND_PICTURE="BACKGROUND_PICTURE",e.BIZHOWS="BIZHOWS",e.VIDEO="VIDEO"}(Sh||(Sh={}));var Mh,Nh=(_h={},Wc()(_h,Sh.LINE,gn.a.LINE),Wc()(_h,Sh.FIGURE,gn.a.FIGURE),Wc()(_h,Sh.ILLUST_GROUP,gn.a.ILLUST_GROUP),Wc()(_h,Sh.ILLUST,gn.a.ILLUST),Wc()(_h,Sh.FRAME,gn.a.FRAME),Wc()(_h,Sh.PICTURE,gn.a.PICTURE),Wc()(_h,Sh.BITMAP,gn.a.ILLUST_GROUP),Wc()(_h,Sh.COMBINATION,gn.a.COMBINATION),Wc()(_h,Sh.STYLE,gn.a.STYLE),Wc()(_h,Sh.MOCKUP_TEXT,gn.a.MOCKUP_TEXT),Wc()(_h,Sh.MOCKUP_GRID,gn.a.MOCKUP_GRID),Wc()(_h,Sh.BACKGROUND_PATTERN,gn.a.BACKGROUND_PATTERN),Wc()(_h,Sh.BACKGROUND_PICTURE,gn.a.BACKGROUND_PICTURE),Wc()(_h,Sh.BIZHOWS,gn.a.PICTURE),Wc()(_h,Sh.VIDEO,gn.a.VIDEO),_h),xh=(wh={},Wc()(wh,Sh.LINE,gn.a.ELEMENT),Wc()(wh,Sh.FIGURE,gn.a.ELEMENT),Wc()(wh,Sh.ILLUST_GROUP,gn.a.ELEMENT),Wc()(wh,Sh.ILLUST,gn.a.ELEMENT),Wc()(wh,Sh.FRAME,gn.a.ELEMENT),Wc()(wh,Sh.PICTURE,gn.a.PICTURE),Wc()(wh,Sh.BITMAP,gn.a.ELEMENT),Wc()(wh,Sh.COMBINATION,gn.a.COMBINATION),Wc()(wh,Sh.STYLE,gn.a.STYLE),Wc()(wh,Sh.MOCKUP_TEXT,gn.a.ELEMENT),Wc()(wh,Sh.MOCKUP_GRID,gn.a.ELEMENT),Wc()(wh,Sh.BACKGROUND_PATTERN,gn.a.BACKGROUND_PATTERN),Wc()(wh,Sh.BACKGROUND_PICTURE,gn.a.BACKGROUND_PICTURE),Wc()(wh,Sh.BIZHOWS,gn.a.PICTURE),Wc()(wh,Sh.VIDEO,gn.a.VIDEO),wh);(Mh=Sh||(Sh={})).getKeywordCategoryType=function(e){return Nh[e]},Mh.getDesignResourceTypeForRecent=function(e){return xh[e]};var Bh,Vh=Sh,Uh=function(){function e(t,n){L()(this,e),this.prepared=!1,this.elementType=t,this.resourceData=n}var t;return w()(e,[{key:"getIdx",value:function(){switch(this.elementType){case Vh.PICTURE:case Vh.BITMAP:case Vh.BACKGROUND_PICTURE:case Vh.BIZHOWS:return this.resourceData.tsIdx;case Vh.MOCKUP_TEXT:case Vh.MOCKUP_GRID:case Vh.COMBINATION:case Vh.STYLE:return this.resourceData.idx;case Vh.LINE:case Vh.FIGURE:case Vh.ILLUST:case Vh.BACKGROUND_PATTERN:case Vh.FRAME:return this.resourceData.idx;default:throw new Error("잘못된 타입. ".concat(this.elementType))}}},{key:"prepare",value:(t=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.prepared){e.next=2;break}return e.abrupt("return",this);case 2:e.prev=2,e.t0=this.elementType,e.next=e.t0===Vh.LINE?6:e.t0===Vh.FIGURE?6:e.t0===Vh.ILLUST?6:e.t0===Vh.BACKGROUND_PATTERN?6:e.t0===Vh.FRAME?9:12;break;case 6:return e.next=8,Xt.c.parseSvg(this.resourceData);case 8:return e.abrupt("break",12);case 9:return e.next=11,Yt.c.getDataFromMeta(this.resourceData);case 11:return e.abrupt("break",12);case 12:this.prepared=!0,e.next=18;break;case 15:e.prev=15,e.t1=e.catch(2),console.error(e.t1);case 18:return e.abrupt("return",this);case 19:case"end":return e.stop()}},e,this,[[2,15]])})),function(){return t.apply(this,arguments)})}]),e}();!function(e){e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE",e.DISABLED="DISABLED"}(Bh||(Bh={}));var Fh,Gh,Hh=Bh,Wh=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}var n,i;return z()(t,e),w()(t,null,[{key:"getList",value:(i=s()(a.a.mark(function e(n,i,o,s,r){var l,c,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he()(F()(t),"requestV3",this).call(this,void 0,pe.b.GET,"/api/element?".concat($.param({page:n,pageSize:i,type:o,keyword:s,status:r})));case 2:return l=e.sent,c=l.list,u=l.pagination,e.abrupt("return",{list:this.parseList(c),pagination:u});case 6:case"end":return e.stop()}},e,this)})),function(e,t,n,a,o){return i.apply(this,arguments)})},{key:"fetchRecentList",value:(n=s()(a.a.mark(function e(n){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,he()(F()(t),"requestV3",this).call(this,void 0,pe.b.GET,"/api/element/recent?resourceGroup=".concat(n));case 3:return i=e.sent.list,e.abrupt("return",this.parseList(i));case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}},e,this,[[0,7]])})),function(e){return n.apply(this,arguments)})},{key:"parseList",value:function(e){var t=[];return e.forEach(function(e){try{t.push(zh.parse(e))}catch(e){console.error(e)}}),t}}]),t}(pe.a),zh=function(){function e(){L()(this,e)}return w()(e,null,[{key:"parse",value:function(e){return new Uh(e.type,this.parseResponse(e))}},{key:"parseResponse",value:function(e){switch(e.type){case Vh.PICTURE:case Vh.BITMAP:case Vh.BACKGROUND_PICTURE:case Vh.BIZHOWS:return this.parseBizhowsSticker(e);case Vh.MOCKUP_TEXT:case Vh.MOCKUP_GRID:case Vh.COMBINATION:case Vh.STYLE:return this.parseTemplateDesign(e);case Vh.LINE:case Vh.FIGURE:case Vh.ILLUST:case Vh.BACKGROUND_PATTERN:return this.parseSvg(e);case Vh.FRAME:return this.parseImageFrame(e);default:throw new Error("잘못된 타입. ".concat(e.type))}}},{key:"parseBizhowsSticker",value:function(e){return{id:e.name,thumbImgUrl:e.thumbnailUrl,tsIdx:e.idx}}},{key:"parseTemplateDesign",value:function(e){return{accountId:e.accountId,designerId:e.accountId,idx:e.idx,keywordList:e.keywordList,memo:e.elementMemo,name:e.name,sheetUrl:e.elementUrl,status:e.status===Hh.ACTIVE?tt.b.ACTIVE:tt.b.DISABLED,thumb300Url:e.thumbnailUrl,type:e.type===Vh.MOCKUP_TEXT?tt.c.MOCKUP_TEXT:tt.c.MOCKUP_GRID}}},{key:"parseSvg",value:function(e){return{accountId:e.accountId,accountInfo:e.accountInfo,categoryIdxList:e.categoryIdxList,colorDtoList:e.colorDtoList,createDate:e.createDate,height:e.height,idx:e.idx,key:e.key,keywordList:e.keywordList,layerDtoList:e.layerDtoList,license:e.license,minHeight:e.minHeight,minWidth:e.minWidth,name:e.name,replacementUrl:e.replacementUrl,status:e.status,stickerLinkList:e.stickerLinkList,svgMemoDto:e.elementMemo,svgUrl:e.elementUrl,thumbnailKey:e.thumbnailkey,thumbnailUrl:e.thumbnailUrl,type:e.type,updateAccountInfo:e.updateAccountInfo,updateDate:e.updateDate,updateId:e.updateId,width:e.width}}},{key:"parseImageFrame",value:function(e){return{accountId:String(e.accountId),accountInfo:e.accountInfo,colorDtoList:e.colorDtoList,height:e.height,idx:e.idx,imageFrameMaskMetaDto:e.imageFrameMaskMetaDto,imageFrameUrl:e.elementUrl,key:e.key,keywordList:e.keywordList,license:e.license,name:e.name,status:e.status,width:e.width,minHeight:e.minHeight,minWidth:e.minWidth,categoryIdxList:e.categoryIdxList}}}]),e}(),Kh=Wh,Yh=new(function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}var n,i;return z()(t,e),w()(t,[{key:"fetchListInternal",value:(i=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Kh.fetchRecentList(t);case 2:return n=e.sent,e.next=5,Promise.all(n.map(function(e){return e.prepare()}));case 5:return e.abrupt("return",n.filter(function(e){return e.prepared}));case 6:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)})},{key:"makeRecentDesignResourceParam",value:function(e){return new vn(String(e.getIdx()),e.elementType)}},{key:"addRecentResource",value:(n=s()(a.a.mark(function e(n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:he()(F()(t.prototype),"addRecentResource",this).call(this,n,Vh.getDesignResourceTypeForRecent(n.elementType),i);case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})}]),t}(fn)),Xh=function e(){L()(this,e)},jh=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"setFilterState",value:function(e){this.setFilterDataInternal(e),this.listener&&this.listener.onChangeFilter(e)}},{key:"setListener",value:function(e){this.listener=e}}]),t}(dn.a);!function(e){e.VECTOR="VECTOR",e.BITMAP="BITMAP"}(Gh||(Gh={}));var Zh=(Fh={},Wc()(Fh,Gh.VECTOR,"벡터 (색상 편집 가능)"),Wc()(Fh,Gh.BITMAP,"비트맵"),Fh);(Gh||(Gh={})).getName=function(e){return Zh[e]};var qh=function e(t){L()(this,e),this.value=t},$h=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).imageType=e,n}return z()(t,e),t}(Xh),Qh=new(function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"setFilterDataInternal",value:function(e){this.getImageTypeMenuItems().forEach(function(t){return t.selected=t.value===e.imageType})}},{key:"getImageTypeMenuItems",value:function(){return this.imageTypeItems||(this.imageTypeItems=[new qh(Gh.VECTOR),new qh(Gh.BITMAP)]),this.imageTypeItems}},{key:"getSelectedImageType",value:function(){var e=this.getImageTypeMenuItems().find(function(e){return e.selected});return e?e.value:null}}]),t}(jh)),Jh=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this))).type=e,o.makeListItem=n,o.getItemAccessType=i,o.getKeyword=a,o}var n,i;return z()(t,e),w()(t,[{key:"fetchListInternal",value:(i=s()(a.a.mark(function e(t){var n,i,o,s,r,l,c,u=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.keyword=d.b.nvl(t.keyword).trim(),this.setGTMLibDataAuto(t.keyword),this.type!==Vh.VIDEO){e.next=4;break}return e.abrupt("return",{items:[],totalRow:0});case 4:return e.next=6,Kh.getList(t.page,t.pageSize,t.type,t.keyword,t.status);case 6:return n=e.sent,i=n.list,o=n.pagination,e.next=11,Promise.all(i.map(function(e){return e.prepare()}));case 11:if((s=i.filter(function(e){return e.prepared}).map(function(e){var t=u.makeListItem(e);return t.getContainer().addEventListener("click",u.onItemClicked.bind(u,e)),t})).length>0)try{r=this.getGTMLibData(),l=r.listTitle,c=r.category,Ft.a.sendImpressions({items:s,category:c,listTitle:l,pageNo:t.page,pageSize:t.pageSize})}catch(e){}return e.abrupt("return",{items:s,totalRow:o.totalRow});case 14:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"onItemClicked",value:function(e){Yh.addRecentResource(e,this.getKeyword())}},{key:"getRequestParam",value:function(e){return{type:this.getParameterType(),keyword:this.getKeyword(),status:this.getElementStatus(),page:e.page,pageSize:e.pageSize}}},{key:"fetchRecentList",value:(n=s()(a.a.mark(function e(){var n,i,o=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isCanSearchRecent()){e.next=2;break}return e.abrupt("return",he()(F()(t.prototype),"fetchRecentList",this).call(this));case 2:return e.next=4,Yh.fetchList(Vh.getDesignResourceTypeForRecent(this.type)||gn.a.ELEMENT);case 4:return n=e.sent,e.next=7,Promise.all(n.map(function(e){return e.prepare()}));case 7:return i=n.filter(function(e){return e.prepared}).map(function(e){return o.makeListItem(e)}),e.abrupt("return",{items:i,totalRow:i.length});case 9:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"getElementStatus",value:function(){switch(this.getItemAccessType()){case So.a.PUBLIC:return Hh.ACTIVE;case So.a.PRIVATE:return Hh.INACTIVE;default:return Hh.DISABLED}}},{key:"getLibType",value:function(){return sn.b.ITEM}},{key:"isCanSearchRecent",value:function(){switch(this.type){case Vh.ILLUST_GROUP:case Vh.MOCKUP_TEXT:case Vh.FIGURE:case Vh.LINE:case Vh.FRAME:case Vh.MOCKUP_GRID:return!1;default:return!0}}},{key:"getParameterType",value:function(){if(this.type!==Vh.ILLUST_GROUP)return this.type;switch(Qh.getSelectedImageType()){case Gh.VECTOR:return Vh.ILLUST;case Gh.BITMAP:return Vh.BITMAP;default:return this.type}}}]),t}(sn.a),ep=function(){function e(){L()(this,e),this.attachedElement=null,this.layerRoot=document.createElement("div"),this.layerRoot.className=r.a.SCREEN_LAYER,this.addAllEventListeners()}return w()(e,[{key:"addAllEventListeners",value:function(){$(this.layerRoot).on("click",function(t){if(t.preventDefault(),e.instance.isDddotInfoLayer){var n=$(".".concat(r.a.DDDOT_INFO_LAYER));if(n.length&&n[0].contains(t.target))return}e.close()})}},{key:"attach",value:function(t,n,i){if(null===this.attachedElement){this.attachedElement=t,this.attachedElement.classList.add(r.a.HIDDEN),this.layerRoot.appendChild(this.attachedElement),document.body.appendChild(this.layerRoot);var a=e.calculatePos(t,n,i);t.style.top="".concat(a.y,"px"),t.style.left="".concat(a.x,"px"),this.attachedElement.classList.remove(r.a.HIDDEN)}}},{key:"detach",value:function(){null!==this.attachedElement&&(this.layerRoot.removeChild(this.attachedElement),this.attachedElement=null),this.layerRoot.parentNode&&this.layerRoot.parentNode.removeChild(this.layerRoot)}}],[{key:"open",value:function(t,n,i,a,o){e.instance.attach(t,n,i),e.instance.isDddotInfoLayer=a,this.instance.closeCallback=o}},{key:"close",value:function(){e.instance.detach(),this.instance.closeCallback&&(this.instance.closeCallback(),this.instance.closeCallback=null)}},{key:"calculatePos",value:function(e,t,n){var i=$(window).height()<e.offsetHeight+n.y+$(t).height()?n.y-e.offsetHeight:n.y,a=n.x+$(t).width()+10;return new ns.a(a,i)}}]),e}();ep.instance=new ep;var tp,np,ip=n(313);!function(e){e.LEFT_MENU_DDDOT_POPUP_WRAPPER="left_menu_dddot_popup_wrapper",e.DDDOT_HEADER_WRAP="dddot_header_wrap",e.KEYWORD_LIST_WRAP="keyword_list_wrap",e.CHANGE_TEMPLATE="change_template",e.FAVORITES_WRAP="favorites_wrap",e.MOVE_BIZ="move_biz"}(tp||(tp={})),function(e){e[e.STICKER=0]="STICKER",e[e.SVG=1]="SVG",e[e.FRAME=2]="FRAME",e[e.MOCKUP=3]="MOCKUP"}(np||(np={}));var ap=function(){function e(){L()(this,e)}return w()(e,null,[{key:"makeDddotBtn",value:function(e){var t=document.createElement("div");return t.className=r.a.DDDOT_WRAP,Object(ne.setToolsIcon)(t,ne.ToolsIcon.DDDOT).addEventListener("click",function(){var t=s()(a.a.mark(function t(n){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.stopPropagation(),e();case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),t}},{key:"makeHeaderWrap",value:function(){var e=document.createElement("p");return e.className=tp.DDDOT_HEADER_WRAP,e}},{key:"makeBtnFavorites",value:function(e,t){var n=document.createElement("div");n.className="btn_favorites",n.classList.add(e);var i=document.createElement("div");return i.className="label",i.innerText="찜하기",n.appendChild(i),Object(ne.setToolsIcon)(n,t,!0),n}},{key:"makeKeywordWrap",value:function(){var e=document.createElement("div");return e.className=tp.KEYWORD_LIST_WRAP,e}},{key:"resourceTypeToItemType",value:function(e){switch(e){case Q.a.BACKGROUND_IMAGE:case Q.a.IMAGE:case Q.a.BITMAP:return np.STICKER;case Q.a.ILLUST:case Q.a.FIGURE:case Q.a.LINE:case Q.a.BACKGROUND_PATTERN:return np.SVG;case Q.a.TEXT:case Q.a.GRID:case Q.a.COMBINATION:case Q.a.STYLE:return np.MOCKUP;case Q.a.FRAME:return np.FRAME;default:return null}}}]),e}(),op=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).isAutoDirection=!0,e}return z()(t,e),w()(t,[{key:"makeFavoritesBtn",value:function(){var e=this,t=this.favoritesBtn=document.createElement("div");t.className=tp.FAVORITES_WRAP,this.contents.appendChild(t);var n=ap.makeBtnFavorites("add_favorites",ne.ToolsIcon.HEART);n.addEventListener("click",function(n){n.stopPropagation(),n.preventDefault();var i=e.favoritesParam;i.useFavorite&&i.myCollectionPk&&Ye.a.openLoginPopup(Ie.a.FAVORITES,function(){qt.a.registerFavorite(i.myCollectionPk),t.classList.add(r.a.MY_COLLECTION)})}),t.appendChild(n);var i=ap.makeBtnFavorites("cancel_favorites",ne.ToolsIcon.HEART_FILL);return i.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation();var i=e.favoritesParam;i.useFavorite&&i.myCollectionPk&&Ye.a.openLoginPopup(Ie.a.FAVORITES,function(){qt.a.unregisterFavorite(i.myCollectionPk),t.classList.remove(r.a.MY_COLLECTION)})}),t.appendChild(i),t}},{key:"renderFavorite",value:function(e){if(e&&f.a.getUser().isLogin()&&this.favoritesBtn){var t=qt.a.get(e);t&&t.isFavorite()?this.favoritesBtn.classList.add(r.a.MY_COLLECTION):this.favoritesBtn.classList.remove(r.a.MY_COLLECTION)}else this.favoritesBtn.classList.remove(r.a.MY_COLLECTION)}},{key:"makeElement",value:function(){(this.contents=document.createElement("div")).className=tp.LEFT_MENU_DDDOT_POPUP_WRAPPER,this.makeBtnClose=!1}},{key:"openPopup",value:function(e,n){this.favoritesParam=e,this.favoritesParam.useFavorite&&this.renderFavorite(e.myCollectionPk),he()(F()(t.prototype),"open",this).call(this,n)}},{key:"getContents",value:function(){return this.contents}},{key:"updateUI",value:function(){}}]),t}(u.a),sp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.btnKeywordMore=n.makeBtnKeywordMore(),n.btnKeywordShort=n.makeBtnKeywordShort(),n.makeElement(),n}var n,i;return z()(t,e),w()(t,[{key:"makeTitle",value:function(){var e=document.createElement("div");e.className="dddot_header_wrap";var t=document.createElement("span");t.innerText=this.param.title,e.appendChild(t),this.contents.appendChild(e)}},{key:"openItemInfo",value:(i=s()(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.makeKeywordLayer();case 2:this.keywordLayer=e.sent,$(this.keywordWrapper).empty(),this.keywordWrapper.appendChild(this.keywordLayer),this.openPopup(t,n),this.setMoreBtn(this.keywordLayer);case 7:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"makeElement",value:function(){he()(F()(t.prototype),"makeElement",this).call(this),this.param.title&&this.makeTitle(),this.makeKeywordWrapper(),this.makeFavoritesBtn()}},{key:"makeKeywordWrapper",value:function(){this.keywordWrapper=ap.makeKeywordWrap(),this.contents.appendChild(this.keywordWrapper)}},{key:"makeBtnKeywordMore",value:function(){var e=this,t=document.createElement("button");return t.innerText="... 더보기",t.className=r.a.BTN_KEYWORD_MORE,t.addEventListener("click",function(){$(e.wordWrap.children).removeClass(r.a.CLEAR_BOTH),e.wordWrap.classList.remove(r.a.LIMIT_HEIGHT),e.wordWrap.lastChild.after(e.btnKeywordShort)}),t}},{key:"makeBtnKeywordShort",value:function(){var e=this,t=document.createElement("button");return t.innerText="간단히",t.className=r.a.BTN_KEYWORD_SHORT,t.addEventListener("click",function(){e.wordWrap.classList.add(r.a.LIMIT_HEIGHT),e.btnKeywordMore.nextElementSibling.classList.add(r.a.CLEAR_BOTH)}),t}},{key:"setMoreBtn",value:function(e){var t=$(e).children(".".concat(r.a.KEYWORD_WRAP)),n=t.children(),i=n.eq(0).position().top,a=2*n.height()+i,o=!1,s=0;if(t.height()>=2*n.height())for(var l=0;l<n.length;l++){var c=n.eq(l),u=c.position();if(o){$(this.btnKeywordMore).position().top>=a&&(n.eq(s-1).before(this.btnKeywordMore),n.eq(s-1).addClass(r.a.CLEAR_BOTH));break}u.top>=a?(n.eq(l-1).before(this.btnKeywordMore),n.eq(l-1).addClass(r.a.CLEAR_BOTH),s=l-1,o=!0):u.top>i&&c.height()>=2*n.height()&&(c.before(this.btnKeywordMore),c.addClass(r.a.CLEAR_BOTH),s=l,o=!0)}}},{key:"makeKeywordLayer",value:(n=s()(a.a.mark(function e(){var t,n,i,o,s,l,c,u,d,h,p,m,f=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],this.param.itemType!==np.STICKER){e.next=8;break}return e.next=4,ip.a.selectOne(this.param.itemReferenceKey);case 4:n=e.sent,t=n.keywordList,e.next=26;break;case 8:if(this.param.itemType!==np.SVG){e.next=15;break}return e.next=11,Xt.c.getSvgDataByKey(this.param.itemReferenceKey);case 11:i=e.sent,t=i.keywordList,e.next=26;break;case 15:if(this.param.itemType!==np.MOCKUP){e.next=22;break}return e.next=18,tt.a.findOne(this.param.itemIdx);case 18:o=e.sent,t=o.keywordList,e.next=26;break;case 22:return e.next=24,Yt.c.getImageframeDataByKey(this.param.itemReferenceKey);case 24:s=e.sent,t=s.keywordList;case 26:return(l=document.createElement("div")).className=r.a.KEYWORD_LAYER,l.classList.add(r.a.DDDOT_INFO_LAYER,r.a.KEYWORD_LAYER),(c=document.createElement("div")).classList.add(r.a.KEYWORD_WRAP,r.a.LIMIT_HEIGHT),u=document.createDocumentFragment(),(d=document.createElement("label")).innerText="키워드",u.appendChild(d),h=t.length-1,p=void 0!==this.param.searchTool||this.param.search,t.forEach(function(e,t){var n,i=document.createElement("span");if(i.className=r.a.WORD_WRAP,(n=p?document.createElement("a"):document.createElement("span")).innerText=e,i.appendChild(n),t<h){var a=document.createElement("span");a.innerText=",",a.className="separator",i.appendChild(a)}u.appendChild(i)}),t.length||((m=document.createElement("span")).className=r.a.KEYWORD_NONE,m.innerText="없음",u.appendChild(m)),$(u.childNodes).on("click","a",function(e){if(p){ep.close();var t=e.currentTarget;f.search(t.innerText)}}),c.appendChild(u),l.appendChild(c),this.wordWrap=c,e.abrupt("return",l);case 44:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"search",value:function(e){this.param.searchTool?this.param.searchTool.search(e):this.param.search&&this.param.search(e)}},{key:"getId",value:function(){return"itemDddotPopup"}}]),t}(op),rp=n(319),lp=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"doAction",value:function(){he()(F()(t.prototype),"doAction",this).call(this)}}]),t}(Qt),cp=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this,new Jt(e.resourceData,n,Do.a.BIZHOWS)))).param=e,o.originPhotoType=i,o.elementType=a,o}return z()(t,e),w()(t,[{key:"getThumbUrlList",value:function(){return[ip.a.getThumbnail(this.listItemData.resourceData.id,ip.b.SIZE_400)]}},{key:"doAction",value:function(){if(he()(F()(t.prototype),"doAction",this).call(this),this.param.getKeyword){var e=this.param.getKeyword();d.b.isEmpty(e)||e.startsWith("#")||e.startsWith("@")||rp.a.from(Do.a.SMILECAT,Boolean(!1)).increaseStickerSearchKeywordCount(this.listItemData.resourceData.tsIdx,e.split(" "))}}},{key:"makeHoverLayer",value:function(){var e=this,n=he()(F()(t.prototype),"makeHoverLayer",this).call(this),i=Object(ne.setToolsIcon)(n,ne.ToolsIcon.SETTINGS,!0);i.addEventListener("click",function(){var t=s()(a.a.mark(function t(n){var i,o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.stopPropagation(),i=e.listItemData.myCollectionPk,(o=new Je.d("",new O.a(0,0,0,0))).props.setPhotoKey(i.referenceKey),o.orgType=e.originPhotoType,X.a.instance.dispatch(new K.c(function(e,t,n){J.a.unselectAllItems(),n.renderHandler(e,t),n.renderItemToolsByItem([o],t,pl.a.ADMIN)}));case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),n.appendChild(i);var o=new sp({itemType:np.STICKER,itemReferenceKey:this.listItemData.myCollectionPk.referenceKey,search:this.param.setKeyword?function(t){return e.param.setKeyword(t)}:void 0});o.setOnCloseListener(this);var r=this.dddotBtn=ap.makeDddotBtn(s()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onOpenDddot();case 2:n={useFavorite:e.useFavorite,myCollectionPk:e.listItemData.myCollectionPk},o.openItemInfo(n,$(r).offset());case 4:case"end":return t.stop()}},t)})));return n.appendChild(r),n}}]),t}(lp),up=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,new Jt(e.resourceData,n,Do.a.UNICORN)))).param=e,i}return z()(t,e),w()(t,[{key:"getThumbUrlList",value:function(){return[this.listItemData.resourceData.thumb300Url]}},{key:"makeHoverLayer",value:function(){var e=this,n=he()(F()(t.prototype),"makeHoverLayer",this).call(this),i=Object(ne.setToolsIcon)(n,ne.ToolsIcon.SETTINGS,!0);i.addEventListener("click",function(){var t=s()(a.a.mark(function t(n){var i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.stopPropagation(),i=e.getDefaultTbpeItem(),X.a.instance.dispatch(new K.c(function(t,n,a){a.renderItemToolsByItem([i],n,pl.a.MOCKUP_EDIT,e.listItemData.resourceData.idx)}));case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),n.appendChild(i);var o={itemType:np.MOCKUP,itemIdx:this.listItemData.resourceData.idx,search:this.param.setKeyword,title:this.param.resourceData.name},r=new sp(o);r.setOnCloseListener(this);var l=this.dddotBtn=ap.makeDddotBtn(s()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onOpenDddot();case 2:n={useFavorite:e.useFavorite,myCollectionPk:e.listItemData.myCollectionPk},r.openItemInfo(n,$(l).offset());case 4:case"end":return t.stop()}},t)})));return n.appendChild(l),n}}]),t}(lp),dp=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,e,n))).elementType=i,a}return z()(t,e),w()(t,[{key:"getDefaultTbpeItem",value:function(){return new q.a("",new O.a(0,0,0,0))}},{key:"getEECItemData",value:function(e,t,n){var i=this.listItemData.myCollectionPk,a=Object(Q.c)(i.resourceType),o="".concat(a,":").concat(i.referenceKey);return{name:"".concat(o,":").concat(this.listItemData.resourceData.name),id:o,price:0,brand:"요소",category:e,variant:a,list:t,position:n}}}]),t}(up),hp=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,e,Q.a.GRID))).elementType=n,i}return z()(t,e),w()(t,[{key:"getDefaultTbpeItem",value:function(){var e=new Z.a("",new O.a(0,0,0,0));return e.init(1,1),e}},{key:"getEECItemData",value:function(e,t,n){var i=this.listItemData.myCollectionPk,a=Object(Q.c)(i.resourceType),o="".concat(a,":").concat(i.referenceKey);return{name:"".concat(o,":").concat(this.listItemData.resourceData.name),id:o,price:0,brand:"요소",category:e,variant:a,list:t,position:n}}}]),t}(up),pp=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,new Jt(e.resourceData,n,Do.a.UNICORN)))).param=e,a.elementType=i,a.svgData=Xt.c.getSvgDataByKeySync(e.resourceData.key),a.useFavorite=!0,a}return z()(t,e),w()(t,[{key:"getThumbUrlList",value:function(){return[this.svgData.thumb]}},{key:"makeElement",value:function(){he()(F()(t.prototype),"makeElement",this).call(this),this.container.setAttribute("data-ratio",String(this.svgData.width/this.svgData.height))}},{key:"makeHoverLayer",value:function(){var e=this,n=he()(F()(t.prototype),"makeHoverLayer",this).call(this),i=Object(ne.setToolsIcon)(n,ne.ToolsIcon.SETTINGS,!0);i.addEventListener("click",function(){var t=s()(a.a.mark(function t(n){var i,o,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.stopPropagation(),i=e.listItemData.myCollectionPk,t.next=4,Xt.c.getSvgDataByKey(i.referenceKey);case 4:o=t.sent,s=new ad.a("",o,new O.a(0,0,0,0)),X.a.instance.dispatch(new K.c(function(e,t,n){J.a.unselectAllItems(),n.renderHandler(e,t),n.renderItemToolsByItem([s],t,pl.a.ADMIN)}));case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),n.appendChild(i);var o=new sp({itemType:np.SVG,itemReferenceKey:this.listItemData.myCollectionPk.referenceKey,search:function(t){return e.param.setKeyword(t)}});o.setOnCloseListener(this);var r=this.dddotBtn=ap.makeDddotBtn(s()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onOpenDddot();case 2:n={useFavorite:e.useFavorite,myCollectionPk:e.listItemData.myCollectionPk},o.openItemInfo(n,$(r).offset());case 4:case"end":return t.stop()}},t)})));return n.appendChild(r),n}},{key:"getEECItemData",value:function(e,t,n){var i=this.listItemData.myCollectionPk,a=this.listItemData.resourceData.idx,o=Object(Q.c)(i.resourceType),s="".concat(o,":").concat(a);return{name:s,id:s,price:0,brand:"요소",category:e,variant:o,list:t,position:n}}}]),t}(lp),mp=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,new Jt(e.resourceData,Q.a.FRAME,Do.a.UNICORN)))).param=e,i.elementType=n,i.imageframeData=Yt.c.getImageframeDataByKeySync(e.resourceData.key),i.useFavorite=!0,i}return z()(t,e),w()(t,[{key:"getThumbUrlList",value:function(){return[this.imageframeData.thumb]}},{key:"makeElement",value:function(){he()(F()(t.prototype),"makeElement",this).call(this),this.container.setAttribute("data-ratio",String(this.imageframeData.width/this.imageframeData.height))}},{key:"makeHoverLayer",value:function(){var e=this,n=he()(F()(t.prototype),"makeHoverLayer",this).call(this),i=Object(ne.setToolsIcon)(n,ne.ToolsIcon.SETTINGS,!0);i.addEventListener("click",function(){var t=s()(a.a.mark(function t(n){var i,o,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.stopPropagation(),i=e.listItemData.myCollectionPk,t.next=4,Yt.c.getImageframeDataByKey(i.referenceKey);case 4:o=t.sent,s=new ee.b("",o,new O.a(0,0,0,0),0,!0,!0,!0,!0,!0,!0),X.a.instance.dispatch(new K.c(function(e,t,n){J.a.unselectAllItems(),n.renderHandler(e,t),n.renderItemToolsByItem([s],t,pl.a.ADMIN)}));case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),n.appendChild(i);var o=new sp({itemType:np.FRAME,itemReferenceKey:this.listItemData.myCollectionPk.referenceKey});o.setOnCloseListener(this);var r=this.dddotBtn=ap.makeDddotBtn(s()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onOpenDddot();case 2:n={useFavorite:e.useFavorite,myCollectionPk:e.listItemData.myCollectionPk},o.openItemInfo(n,$(r).offset());case 4:case"end":return t.stop()}},t)})));return n.appendChild(r),n}}]),t}(lp),fp=function(){function e(){L()(this,e)}return w()(e,null,[{key:"make",value:function(e,t){switch(e){case Vh.PICTURE:return new cp(t,Q.a.IMAGE,Je.b.Image,e);case Vh.BITMAP:return new cp(t,Q.a.BITMAP,Je.b.Sticker,e);case Vh.BACKGROUND_PICTURE:return new cp(t,Q.a.BACKGROUND_IMAGE,Je.b.BackgroundImage,e);case Vh.MOCKUP_TEXT:return new dp(t,Q.a.TEXT,e);case Vh.COMBINATION:return new dp(t,Q.a.COMBINATION,e);case Vh.STYLE:return new dp(t,Q.a.STYLE,e);case Vh.MOCKUP_GRID:return new hp(t,e);case Vh.LINE:return new pp(t,Q.a.LINE,e);case Vh.FIGURE:return new pp(t,Q.a.FIGURE,e);case Vh.ILLUST:return new pp(t,Q.a.ILLUST,e);case Vh.BACKGROUND_PATTERN:return new pp(t,Q.a.BACKGROUND_PATTERN,e);case Vh.FRAME:return new mp(t,e)}}}]),e}(),vp=n(175),gp=function(e){function t(e,n,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ke.a.getUserSetting().adminMode,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ke.a.getUserSetting().leftPanelPaginationMode;return L()(this,t),(a=V()(this,F()(t).call(this))).hasKeyword=e,a.itemAccessType=n,a.isVisibleFromParent=i,a.adminMode=o,a.paginationMode=s,a}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return this.hasKeyword!==e.hasKeyword||this.itemAccessType!==e.itemAccessType||this.isVisibleFromParent!==e.isVisibleFromParent||this.adminMode!==e.adminMode||this.paginationMode!==e.paginationMode}},{key:"isActive",value:function(){return this.isVisibleFromParent&&!this.hasKeyword}}]),t}(He.b),Ep=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0))).elementListViewMap=new Map,n.elementDCMap=new Map,n.props=e,n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this)}},{key:"renderView",value:function(){he()(F()(t.prototype),"renderView",this).call(this);var e=this.props,n=e.hasKeyword,i=e.getItemAccessType,a=e.isVisibleFromParent,o=e.elementType;if(this.checkUpContentsChange(new gp(n(),i(),a())),this.contentsStatesChanged){var s=this.contentsStates.isActive();this.setVisibility(s),s&&(this.container.innerHTML="",vp.a.fetchList(Vh.getKeywordCategoryType(o)||gn.a.ELEMENT,this))}}},{key:"onKeywordCategoryFetched",value:function(e,t){var n=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var r=o.value,l=r;if(!this.elementListViewMap.has(l)){var c=new ln;c.setListener(this),this.elementListViewMap.set(l,c)}var u=this.elementListViewMap.get(l);this.fetchListView(u,r),this.container.appendChild(u.getContainer())}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}this.setVisibility(!it.a.isEmpty(t))}},{key:"onShowMore",value:function(e){this.props.setKeyword(e)}},{key:"fetchListView",value:function(e,t){var n=this;e.renderView([],t,t),e.loading(),s()(a.a.mark(function i(){var o;return a.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,n.getElementDC(t).fetchElementList({page:1,pageSize:5},!0);case 3:o=i.sent,e.renderView(o.items,t,t),i.next=11;break;case 7:i.prev=7,i.t0=i.catch(0),console.error(i.t0),e.renderView([],t,t);case 11:return i.prev=11,i.finish(11);case 13:case"end":return i.stop()}},i,null,[[0,7,11,13]])}))()}},{key:"getElementDC",value:function(e){var t=this;return this.elementDCMap.has(e)||this.elementDCMap.set(e,new Jh(this.props.elementType,function(n){return fp.make(n.elementType,{resourceData:n.resourceData,setKeyword:t.props.setKeyword,getKeyword:function(){return e}})},this.props.getItemAccessType,function(){return e})),this.elementDCMap.get(e)}}]),t}(He.a),yp=n(173),Tp=n(172),Ip=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0))}return z()(t,e),w()(t,[{key:"setListener",value:function(e){this.listener=e}},{key:"onResultRecentDesignResource",value:function(e,n){var i=this;if(n===this.designResourceType){var a=!it.a.isEmpty(e)&&this.isVisibleState();this.setVisibility(a),a&&(this.onCreateViewIfNotCreated(),this.listView.renderView(e.slice(0,t.MAX_RENDER_CNT).map(function(e){return i.makeListItemView(e)}),sn.a.RECENT_KEYWORD,sn.a.RECENT_KEYWORD))}}},{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.listView=new ln({initialTitle:sn.a.RECENT_KEYWORD}),this.listView.setListener(this),this.container.appendChild(this.listView.getContainer())}},{key:"onShowMore",value:function(e){this.listener&&this.listener.onRecentMore(e)}}]),t}(He.a);Ip.MAX_RENDER_CNT=5;var Cp=Ip,kp=function(e){function t(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.a.getUser().isLogin();return L()(this,t),(i=V()(this,F()(t).call(this))).keyword=e,i.isVisibleFromParent=n,i.isLogin=a,i}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return this.keyword!==e.keyword||this.isVisibleFromParent!==e.isVisibleFromParent||this.isLogin!==e.isLogin}},{key:"isVisible",value:function(){return this.isLogin&&this.isVisibleFromParent&&!this.keyword}}]),t}(He.b),Lp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).props=e,n.designResourceType=e.designResourceType,Yh.addListener(H()(n)),n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this)}},{key:"makeListItemView",value:function(e){var t=e.elementType,n=e.resourceData,i=this.props,a=i.getKeyword,o=i.setKeyword;return fp.make(t,{resourceData:n,getKeyword:a,setKeyword:o})}},{key:"renderView",value:function(){if(he()(F()(t.prototype),"renderView",this).call(this),this.checkUpContentsChange(new kp(this.props.getKeyword(),this.props.isVisibleFromParent())),this.contentsStatesChanged){var e=this.isVisibleState();this.setVisibility(e),e&&Yh.fetchList(this.designResourceType)}}},{key:"isVisibleState",value:function(){return this.contentsStates.isVisible()}}]),t}(Cp),_p=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).hasElementRecentList=!1,e.listColSize=3,e.listColSizeMobile=2,e.paginationListTool.setListEmptyView(new yp.a("검색 결과가 없어요...","원하는 요소에 관한 의견을 보내주세요.",Tp.a.ELEMENT_REQUEST).getContainer()),e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.createElement(),this.onDataChanged()}},{key:"createElement",value:function(){this.container.className=this.elementClass,this.paginationListTool.setColSize(this.listColSize,this.listColSizeMobile),this.container.appendChild(this.paginationListTool.getContainer());var e=this.param,t=e.getKeyword,n=e.setKeyword,i=e.getItemAccessType,a=(e.hasFilter,this.lib.type),o=Vh.getKeywordCategoryType(a),s=document.createElement("div");s.classList.add(r.a.MULTIPLE_LIST),this.paginationListTool.prependElementToScrollContents(s),this.hasElementRecentList&&(this.elementRecentListVC=new Lp({designResourceType:o,getKeyword:t,setKeyword:n,isVisibleFromParent:this.needSlideViews.bind(this)}),this.elementRecentListVC.setListener(this),s.appendChild(this.elementRecentListVC.getContainer())),this.categoryElementListVC=new Ep({elementType:a,hasKeyword:function(){return!d.b.isEmpty(t())},setKeyword:n,getItemAccessType:i,isVisibleFromParent:this.needSlideViews.bind(this)}),s.appendChild(this.categoryElementListVC.getContainer())}},{key:"needSlideViews",value:function(){return d.b.isEmpty(this.param.getKeyword())&&!this.param.hasFilter()&&(Ke.a.getUserSetting().leftPanelPaginationMode!==au.a.BUTTON||1===this.paginationListTool.paginationParam.page)}},{key:"loadListSync",value:function(){this.paginationListTool.initList()}},{key:"onDataChanged",value:function(){return he()(F()(t.prototype),"onDataChanged",this).call(this),this.renderSlideListViews(),this.container}},{key:"fetchList",value:function(){he()(F()(t.prototype),"fetchList",this).call(this),this.renderSlideListViews()}},{key:"onNeedMoreElementSync",value:function(e,n,i){he()(F()(t.prototype),"onNeedMoreElementSync",this).call(this,e,n,i),this.renderSlideListViews()}},{key:"renderSlideListViews",value:function(){this.hasElementRecentList&&this.elementRecentListVC&&this.elementRecentListVC.renderView(),this.categoryElementListVC&&this.categoryElementListVC.renderView();var e=this.needSlideViews()?this.getNameResourceKey():"";this.paginationListTool.titleView.renderView(e?"모든 ".concat(e):"")}},{key:"onRecentMore",value:function(e){this.param.setKeyword(e)}},{key:"makeListItemView",value:function(e){return fp.make(e.elementType,{resourceData:e.resourceData,setKeyword:this.param.setKeyword,getKeyword:this.param.getKeyword})}},{key:"getJustifiedListToolOption",value:function(){return null}},{key:"getPageSize",value:function(){return 30}}]),t}(Ih),wp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Jh(Vh.PICTURE,n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.STICKER_PHOTO_LIB,n.elementClass=r.a.LIBRARY_STICKER_PHOTO,n.hasElementRecentList=!0,n.paginationListTool.setListEmptyView(new yp.a("검색 결과가 없어요...","원하는 사진에 관한 의견을 보내주세요.",Tp.a.PHOTO_REQUEST).getContainer()),n}return z()(t,e),w()(t,[{key:"getJustifiedListToolOption",value:function(){return hh.a}}]),t}(_p),Sp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n}var n;return z()(t,e),w()(t,[{key:"fetchListInternal",value:(n=s()(a.a.mark(function e(n){var i,o,s,r,l,c,u=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setGTMLibDataAuto(n.keyword),e.next=3,ti.d.fetchImages(t._getRequestParam(n));case 3:if(i=e.sent,o=i.imageInfoList().map(function(e){return u.param.makeListItem(e)}),s={items:o,totalRow:i.total},o.length>0)try{r=this.getGTMLibData(),l=r.listTitle,c=r.category,Ft.a.sendImpressions({items:o,category:c,listTitle:l,pageNo:n.page,pageSize:n.perPage})}catch(e){}return e.abrupt("return",s);case 8:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"getRequestParam",value:function(e){return{keyword:this.param.getKeyword()||" ",page:e.page,perPage:e.pageSize}}},{key:"getLibType",value:function(){return sn.b.PIXABAY}},{key:"setGTMLibDataAuto",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.setGTMLibData({listTitle:"픽사베이 > ".concat(e),category:"픽사베이>".concat(e),keyword:e})}}],[{key:"_getRequestParam",value:function(e){return(new ti.c).setKeyword(e.keyword).setPage(e.page).setPerPage(e.perPage).setTemp(re.a.toString(new Date,"yyyyMMddHH")+Math.floor((new Date).getMinutes()/10))}}]),t}(sn.a),bp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,new Jt(e,Q.a.PIXABAY,Do.a.UNICORN)))).useFavorite=!1,n}return z()(t,e),w()(t,[{key:"getThumbUrlList",value:function(){return[this.listItemData.resourceData.previewURL]}},{key:"makeElement",value:function(){he()(F()(t.prototype),"makeElement",this).call(this);var e=Number(this.listItemData.resourceData.imageWidth),n=Number(this.listItemData.resourceData.imageHeight);this.container.setAttribute("data-ratio",String(e/n))}},{key:"makeHoverLayer",value:function(){var e=he()(F()(t.prototype),"makeHoverLayer",this).call(this);return e.appendChild(this.makeDddot()),e}},{key:"makeDddot",value:function(){var e=this,t=document.createElement("div");t.className=r.a.DDDOT_WRAP;var n=Object(ne.setToolsIcon)(t,ne.ToolsIcon.DDDOT);return t.appendChild(n),n.addEventListener("click",function(){var n=s()(a.a.mark(function n(i){var o;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.classList.add(r.a.SHOWN),i.stopPropagation(),o=$(t).offset(),ep.open(e.makeInfoLayer(),t,new ns.a(o.left,o.top),!0,function(){t.classList.remove(r.a.SHOWN)});case 4:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()),t}},{key:"makeInfoLayer",value:function(){var e=document.createElement("div");e.classList.add(r.a.DDDOT_INFO_LAYER,r.a.PIXABAY_INFO_LAYER);var t=this.listItemData.resourceData,n=document.createElement("div"),i=document.createElement("span");i.className=r.a.TITLE,i.innerText="Pixabay";var a=document.createElement("span");a.innerText=" by ";var o=document.createElement("span");o.className=r.a.PIXABAY_UPLOAD_USER_ID,o.innerText=t.uploadUser,n.appendChild(i),n.appendChild(a),n.appendChild(o);var s=document.createElement("span");return s.className=r.a.PIXABAY_IMG_SIZE_INFO,s.innerText="".concat(t.imageWidth," px X ").concat(t.imageHeight," px"),e.appendChild(n),e.appendChild(s),e}},{key:"getEECItemData",value:function(e,t,n){var i="픽사베이:".concat(this.listItemData.resourceData.id);return{name:i,id:i,price:0,brand:"요소",category:e,variant:"픽사베이-".concat(this.listItemData.resourceData.type),list:t,position:n}}}]),t}(Qt),Rp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Sp({makeListItem:function(e){return new bp(e)},getKeyword:n.param.getKeyword}),n.leftPanelType=So.b.PIXABAY_LIB,n.paginationListTool.setListEmptyView(new yp.a("검색 결과가 없어요...","원하는 사진에 관한 의견을 보내주세요.",Tp.a.PHOTO_REQUEST).getContainer()),n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.PIXABAY_PHOTO,this.container.appendChild(this.paginationListTool.getContainer())}},{key:"loadListSync",value:function(){this.paginationListTool.initList()}},{key:"getPageSize",value:function(){return 30}}]),t}(Ih),Ap=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Jh(Vh.ILLUST_GROUP,n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.ILLUST_LIB,n.elementClass=r.a.LIBRARY_ILLUST,n}return z()(t,e),t}(_p),Op=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Jh(Vh.FIGURE,n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.FIGURE_LIB,n.elementClass=r.a.LIBRARY_FIGURE,n}return z()(t,e),t}(_p),Pp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Jh(Vh.LINE,n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.LINE_LIB,n.elementClass=r.a.LIBRARY_LINE,n}return z()(t,e),t}(_p),Dp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Jh(Vh.FRAME,n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.FRAME_LIB,n.elementClass=r.a.LIBRARY_FRAME,n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),M.b.setUrlImage("imageframe_basic_png","".concat(fs.a.RESOURCE_DOMAIN,"image/imageframe_basic.png"))}}]),t}(_p),Mp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Jh(Vh.MOCKUP_GRID,n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.GRID_LIB,n.elementClass=r.a.LIBRARY_GRID,n.listColSize=n.listColSizeMobile=1,n}return z()(t,e),t}(_p),Np=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Jh(Vh.COMBINATION,n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.TEXT_COMBINATION_LIB,n.elementClass=r.a.LIBRARY_TEXT_COMBINATION,n.hasElementRecentList=!0,n.listColSize=2,n}return z()(t,e),t}(_p),xp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Jh(Vh.STYLE,n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.TEXT_STYLE_LIB,n.elementClass=r.a.LIBRARY_TEXT_STYLE,n.hasElementRecentList=!0,n.listColSize=2,n}return z()(t,e),t}(_p),Bp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Jh(Vh.MOCKUP_TEXT,n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.ITEM_COMBINATION_LIB,n.elementClass=r.a.LIBRARY_ITEM_COMBINATION,n}return z()(t,e),t}(_p),Vp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e,Q.a.BACKGROUND_PATTERN,Vh.BACKGROUND_PATTERN))).svgData=new Xt.b,n}return z()(t,e),w()(t,[{key:"makeElement",value:function(){var e=this;he()(F()(t.prototype),"makeElement",this).call(this),this.container.classList.add("function_item"),X.a.instance.dispatch(new K.c(function(t,n){e.container.style.backgroundColor=t.pages[n.renderPageIdx].background.color}))}},{key:"updateElementBackgroundColor",value:function(e){this.container&&(this.container.style.backgroundColor=e)}},{key:"makeThumbImg",value:function(){var e=jt.a.getImageElementWithReplaceableThumbnail();return e.style.display="none",e}},{key:"makeHoverLayer",value:function(){return document.createElement("div")}},{key:"doAction",value:function(){X.a.instance.dispatch(new K.c(function(e,t,n){n.leftBarVC.setActive(!1);var i=e.pages[t.renderPageIdx].background;J.a.selectItem(i.backgroundItem),X.a.instance.dispatch(new oi.d)}))}}]),t}(pp),Up=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,Vh.BACKGROUND_PATTERN,e,n,i))).functionItem=new Vp({resourceData:{},setKeyword:null}),a}var n;return z()(t,e),w()(t,[{key:"fetchListInternal",value:(n=s()(a.a.mark(function e(n){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he()(F()(t.prototype),"fetchListInternal",this).call(this,n);case 2:return i=e.sent,1===n.page&&this.functionItem&&d.b.isEmpty(n.keyword)&&i.items.unshift(this.functionItem),e.abrupt("return",i);case 5:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})}]),t}(Jh),Fp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Up(n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.BACKGROUND_PATTERN_LIB,n.elementClass=r.a.LIBRARY_BACKGROUND_PATTERN,n.hasElementRecentList=!0,n}return z()(t,e),w()(t,[{key:"getItemUseEventData",value:function(){return{type:Te.b.BG_ITEM,category:null,keyword:null,customAction:"패턴"}}},{key:"getFunctionItem",value:function(){return this.lib.functionItem}}]),t}(_p),Gp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Jh(Vh.BACKGROUND_PICTURE,n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.BACKGROUND_IMAGE_LIB,n.elementClass=r.a.LIBRARY_BACKGROUND_PHOTO,n.hasElementRecentList=!0,n}return z()(t,e),w()(t,[{key:"getItemUseEventData",value:function(){return{type:Te.b.BG_ITEM,category:null,keyword:null,customAction:"사진"}}}]),t}(_p),Hp=n(412),Wp=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y.a.instance.renderPageIdx;return L()(this,t),(n=V()(this,F()(t).call(this))).changeDesign=function(){return!0},n.renderAuto=!1,n.commitAction=function(){var e=s()(a.a.mark(function e(t,i,o){var s,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Hp.a.checkVideoUrlValidation(n.videoUrl)){e.next=2;break}throw new p.b("유튜브 아이템 생성 오류 - ".concat(n.videoUrl));case 2:if(s=t.pages[n.pageIdx],n.newItem){e.next=8;break}return r=Qo.a.getOffsetBaseRect(!1,s.sheetSize,s.editScale,0,0,1280,720),e.next=7,n.createItem(r.toRect());case 7:n.newItem=e.sent;case 8:s.addItem(n.newItem),o.renderAuto(t,i);case 10:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),n.rollbackAction=function(e,t,i){e.pages[n.pageIdx].removeItem(n.newItem),i.renderAuto(e,t)},n.recycle=function(){},n.videoUrl=e,n.pageIdx=i,n}var n;return z()(t,e),w()(t,[{key:"createItem",value:(n=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Hp.a.getYoutubeId(this.videoUrl),e.abrupt("return",$d.a.create(t,n,this.videoUrl));case 2:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})}]),t}(K.b),zp=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).leftPanelType=So.b.YOUTUBE,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add("lib_youtube");var e=us.a.createElement('<div class="input_container"><div class="title">URL</div></div>',this.container);this.urlInput=us.a.createElement('<input placeholder="YouTube 동영상 URL 입력" spellcheck="false" />',e,{type:"keydown",listener:this.onInputKeydown.bind(this)}),us.a.createElement('<button class="btn_move_youtube">YouTube 이동</button>',e,{type:"click",listener:function(){return window.open("https://www.youtube.com/","_blank")}}),this.alertElement=us.a.createElement('<div class="alert hidden">* Youtube 동영상 URL을 다시 확인해주세요.</div>',this.container,{type:"click",listener:this.onClickCreateBtn.bind(this)}),us.a.createElement('<button class="btn_create">만들기</button>',this.container,{type:"click",listener:this.onClickCreateBtn.bind(this)})}},{key:"onClickCreateBtn",value:function(){this.onCreateViewIfNotCreated(),Hp.a.checkVideoUrlValidation(this.urlInput.value)?X.a.instance.dispatch(new Wp(this.urlInput.value)):this.alertElement.classList.remove("hidden")}},{key:"onInputKeydown",value:function(e){e.stopPropagation(),this.alertElement.classList.add("hidden")}}]),t}(oh),Kp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).param=e,n.lib=new Jh(Vh.VIDEO,n.makeListItemView.bind(H()(n)),n.param.getItemAccessType,n.param.getKeyword),n.leftPanelType=So.b.VIDEO,n.elementClass=r.a.LIBRARY_TEXT_COMBINATION,n.hasElementRecentList=!1,n}return z()(t,e),w()(t,[{key:"createElement",value:function(){this.container.classList.add("lib_video"),us.a.createElement('\n            <div>\n                <img src="https://resource.miricanvas.com/image/argo/argo_coming_soon.png?200921" />\n                <div>준비중입니다.</div>\n            </div>\n        ',this.container)}},{key:"onChangeActive",value:function(e){}}]),t}(_p),Yp=function(){function e(){L()(this,e)}return w()(e,null,[{key:"make",value:function(e,t){switch(e){case So.b.STICKER_PHOTO_LIB:return new wp(t);case So.b.PIXABAY_LIB:return new Rp(t);case So.b.ILLUST_LIB:return new Ap(t);case So.b.ITEM_COMBINATION_LIB:return new Bp(t);case So.b.FIGURE_LIB:return new Op(t);case So.b.LINE_LIB:return new Pp(t);case So.b.FRAME_LIB:return new Dp(t);case So.b.GRID_LIB:return new Mp(t);case So.b.TEXT_COMBINATION_LIB:return new Np(t);case So.b.TEXT_STYLE_LIB:return new xp(t);case So.b.BACKGROUND_PATTERN_LIB:return new Fp(t);case So.b.BACKGROUND_IMAGE_LIB:return new Gp(t);case So.b.VIDEO:return new Kp(t);case So.b.YOUTUBE:return new zp;default:throw Error("정의되지 않은 LeftPanelType.")}}}]),e}(),Xp=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this))).isBackground=e,o.renderPageIdx=n,o.backgroundColor=i,o.isAdminMode=a,o}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return e.isBackground!==this.isBackground||e.renderPageIdx!==this.renderPageIdx||e.backgroundColor!==this.backgroundColor||e.isAdminMode!==this.isAdminMode}}]),t}(He.b),jp=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).menuMap=new Map,e.leftPanelType=So.b.BACKGROUND_LIB,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.LIBRARY_BACKGROUND,this.container.appendChild(this.makeAdminUI()),this.container.appendChild(this.makeSearchTool()),this.container.appendChild(this.makeSolidColor()),this.container.appendChild(this.makeTabUI()),this.container.appendChild(this.makeContentsWrap());var e=[So.b.BACKGROUND_PATTERN_LIB,So.b.BACKGROUND_IMAGE_LIB];this.addTabBtn(e),this.selectMenu(e[0])}},{key:"makeSearchTool",value:function(){var e=this;return this.searchTool=new dh.a(function(t){return e.setKeyword(t)},"".concat(So.b.getNameResourceKey(this.leftPanelType)," 검색"),void 0,void 0,void 0,gn.a.BACKGROUND_PATTERN),this.searchTool.getContainer()}},{key:"makeButtonBackgroundTools",value:function(){var e=this.btnBackgroundTools=this.createDivElement("background_tools_button");Object(ne.setToolsIcon)(e,ne.ToolsIcon.PENCIL);var t=document.createElement("div");return t.innerText="배경 편집",e.appendChild(t),e.addEventListener("click",function(){J.a.selectBackgroundItem()}),e}},{key:"setKeyword",value:function(e){e=e?e.trim():"",this.keyword!==e&&(this.keyword=e,this.searchTool.updateUI(e),this.loadList())}},{key:"makeSolidColor",value:function(){var e=this,t=(new ia.g).setMarginTop().addCustomClass(r.a.ROW_BACKGROUND_SOLID_COLOR);this.solidColor=new Pa.a(function(t){e.solidColor.updateUI({value:t}),X.a.instance.dispatch(new oi.c(Y.a.instance.renderPageIdx,t,!0))},null,"단색",!1,!0),Te.a.setGTMValue(this.solidColor.container,"lib_background_solid"),this.solidColor.updateUI({value:"#ffffff"}),t.add(this.solidColor);var n=new ia.a(Ei.b.NONE);return n.itemRows.push(t),n.render()}},{key:"makeTabUI",value:function(){var e=this.createDivElement(r.a.BACKGROUND_TAB);return e.classList.add(r.a.ACTIVE),this.btnElement=document.createElement("ul"),e.appendChild(this.btnElement),e.appendChild(this.makeButtonBackgroundTools()),e}},{key:"addTabBtn",value:function(e){var t=this;e.forEach(function(e){var n=document.createElement("li");n.setAttribute("data-type",e),n.addEventListener("click",function(){return t.selectMenu(e)}),n.innerText=So.b.getNameResourceKey(e),t.btnElement.appendChild(n)})}},{key:"makeContentsWrap",value:function(){return this.contentsWrap=this.createDivElement(r.a.CONTENTS_WRAP),this.contentsWrap}},{key:"selectRadio",value:function(e){var t=$(this.btnElement);t.children().removeClass(r.a.ACTIVE),t.find('[data-type="'.concat(e,'"]')).addClass(r.a.ACTIVE)}},{key:"setFunctionItem",value:function(e,t){e===So.b.BACKGROUND_PATTERN_LIB&&(this.functionItem=t.getFunctionItem())}},{key:"createLeftPanelListView",value:function(e){var t=Yp.make(e,this.getItemLibMenuParam());return this.setFunctionItem(e,t),this.setLeftPanelListView(t)}},{key:"setLeftPanelListView",value:function(e){return this.menuMap.set(e.getLeftPanelType(),e),this.contentsWrap.appendChild(e.getContainer()),e}},{key:"getItemLibMenuParam",value:function(){var e=this;return{getKeyword:function(){return e.keyword},setKeyword:function(t){return e.setKeyword(t)},getItemAccessType:function(){return e.itemAccessType},hasFilter:function(){return!1}}}},{key:"selectMenu",value:function(e){this.selectRadio(e);var t=this.menuMap.get(e)||this.createLeftPanelListView(e);if(!t)throw new Error("메뉴가 존재하지 않습니다");this.selectedMenu&&this.selectedMenu.setActive(!1),this.selectedMenu=t.setActive(!0),this.sendGASearchReport()}},{key:"fetchList",value:function(){this.selectedMenu.onChangeFetchCondition(),this.sendGASearchReport()}},{key:"sendGASearchReport",value:function(){var e=this.keyword||"";if(e){var t=0;try{t=this.selectedMenu.lib.lastListResult.totalRow}catch(e){n()}try{Te.a.sendSearchReport({type:Te.b.BG_ITEM,keyword:e,category:this.selectedMenu.getNameResourceKey(),totalRow:t})}catch(e){n()}}function n(e){0}}},{key:"resetMenuListLoadFlag",value:function(){this.menuMap.forEach(function(e){return e.isLoaded=!1})}},{key:"onDataChanged",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.onCreateViewIfNotCreated(),this.checkUpContentsChange(this.getRenderStates(e)),this.contentsStatesChanged&&(this.enableStyle(Ke.a.getUserSetting().adminMode,this.adminUIElement,r.a.ACTIVE),as.a.instance.hide(),this.solidColor.updateUI({value:this.contentsStates.backgroundColor}),this.functionItem&&this.functionItem.updateElementBackgroundColor(this.contentsStates.backgroundColor),this.enableStyle(!this.contentsStates.isBackground,this.btnBackgroundTools,r.a.DISABLE)),this.menuMap.forEach(function(i){i.onDataChanged(e,n),!i.isLoaded&&t.isActive()&&i.isActive()&&i.setActive(!0)})}},{key:"getRenderStates",value:function(e){function t(){return e.pages[Y.a.instance.renderPageIdx].background}return new Xp(null!==t().backgroundItem,Y.a.instance.renderPageIdx,t().color,Ke.a.getUserSetting().adminMode)}},{key:"getGTMItemData",value:function(e){return this.selectedMenu.getGTMItemData(e)}},{key:"getItemUseEventData",value:function(){return this.selectedMenu.getItemUseEventData()}}]),t}(oh),Zp=function(e){function t(e,n,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ke.a.getUserSetting().adminMode;return L()(this,t),(a=V()(this,F()(t).call(this))).menuInfos=e,a.hasKeyword=n,a.itemAccessType=i,a.adminMode=o,a}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return this.menuInfos!==e.menuInfos||this.hasKeyword!==e.hasKeyword||this.itemAccessType!==e.itemAccessType||this.adminMode!==e.adminMode}},{key:"isActive",value:function(){return!it.a.isEmpty(this.menuInfos)&&!this.hasKeyword}}]),t}(He.b),qp=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0))).elementListViewMap=new Map,n.elementDCMap=new Map,n.props=e,n}return z()(t,e),w()(t,[{key:"setListener",value:function(e){this.listener=e}},{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this)}},{key:"renderView",value:function(e){var n=this;if(he()(F()(t.prototype),"renderView",this).call(this),!e&&this.contentsStates&&(e=this.contentsStates.menuInfos),this.checkUpContentsChange(new Zp(e,this.props.hasKeyword(),this.props.getItemAccessType())),this.contentsStatesChanged){var i=this.contentsStates.isActive();this.setVisibility(i),i&&(this.container.innerHTML="",this.contentsStates.menuInfos.forEach(function(e){if(!n.elementListViewMap.has(e.elementType)){var t=new ln;t.setListener(n),n.elementListViewMap.set(e.elementType,t)}var i=n.elementListViewMap.get(e.elementType);n.fetchListView(i,e),n.container.appendChild(i.getContainer())}))}}},{key:"onShowMore",value:function(e){this.listener.onMoveDetail(e)}},{key:"fetchListView",value:function(e,t){var n=this,i=t.elementType,o=t.leftPanelType,r=So.b.getNameResourceKey(o);e.renderView([],o,r),e.loading(),s()(a.a.mark(function t(){var s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.getElementDC(i).fetchElementList({page:1,pageSize:5},!0);case 3:s=t.sent,e.renderView(s.items,o,r),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0),e.renderView([],o,r);case 11:return t.prev=11,t.finish(11);case 13:case"end":return t.stop()}},t,null,[[0,7,11,13]])}))()}},{key:"getElementDC",value:function(e){var t=this;return this.elementDCMap.has(e)||this.elementDCMap.set(e,new Jh(e,function(e){return fp.make(e.elementType,{resourceData:e.resourceData,setKeyword:t.props.setKeyword,getKeyword:function(){return""}})},this.props.getItemAccessType,function(){return""})),this.elementDCMap.get(e)}}]),t}(He.a),$p=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this))).items=[],o.getKeyword=e,o.getItemAccessType=n,o.setKeyword=i,o.selectMenu=a,o.leftPanelType=So.b.ALL_TYPE_ITEM,o.lib=new Jh(null,function(t){return fp.make(t.elementType,{resourceData:t.resourceData,setKeyword:i,getKeyword:e})},o.getItemAccessType,e),o}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add(r.a.LIBRARY_ITEM_ALL_TYPE),this.elementRecentListVC=new Lp({designResourceType:gn.a.ELEMENT,getKeyword:this.getKeyword,setKeyword:this.setKeyword,isVisibleFromParent:function(){return!0}}),this.elementRecentListVC.setListener(this),this.categoryElementListVC=new Ep({elementType:null,setKeyword:this.setKeyword,hasKeyword:function(){return!d.b.isEmpty(e.getKeyword())},getItemAccessType:this.getItemAccessType,isVisibleFromParent:function(){return!0}}),this.allTypeElementListVC=new qp({setKeyword:this.setKeyword,hasKeyword:function(){return!d.b.isEmpty(e.getKeyword())},getItemAccessType:this.getItemAccessType}),this.allTypeElementListVC.setListener(this),this.allTypeElementListVC.renderView([{leftPanelType:So.b.ILLUST_LIB,elementType:Vh.ILLUST_GROUP},{leftPanelType:So.b.ITEM_COMBINATION_LIB,elementType:Vh.MOCKUP_TEXT},{leftPanelType:So.b.FIGURE_LIB,elementType:Vh.FIGURE},{leftPanelType:So.b.LINE_LIB,elementType:Vh.LINE},{leftPanelType:So.b.FRAME_LIB,elementType:Vh.FRAME},{leftPanelType:So.b.GRID_LIB,elementType:Vh.MOCKUP_GRID}]);var n=this.multipleListScrollElement=new Ce.a(!1,!0,"100%"),i=document.createElement("div");i.classList.add(r.a.MULTIPLE_LIST),i.appendChild(this.elementRecentListVC.getContainer()),i.appendChild(this.categoryElementListVC.getContainer()),i.appendChild(this.allTypeElementListVC.getContainer()),this.container.appendChild(n.render(i)),this.paginationListTool.setColSize(3),this.container.appendChild(this.paginationListTool.getContainer())}},{key:"loadListSync",value:function(){var e=!d.b.isEmpty(this.getKeyword());this.paginationListTool.setVisibility(e),e&&this.paginationListTool.initList(),this.renderMultipleList()}},{key:"renderMultipleList",value:function(){this.enableStyle(!d.b.isEmpty(this.getKeyword()),this.multipleListScrollElement.element,r.a.HIDDEN),this.elementRecentListVC.renderView(),this.categoryElementListVC.renderView(),this.allTypeElementListVC.renderView()}},{key:"setActive",value:function(e){return he()(F()(t.prototype),"setActive",this).call(this,e),e&&this.renderMultipleList(),this}},{key:"getGTMItemData",value:function(e){var n={resourceType:e.resourceType,referenceKey:e.key,repositoryType:e.repositoryType},i=this.items.find(function(e){return qt.a.isSamePk(n,e.listItemData.myCollectionPk)});return i?i.getEECItemData(t.ALL_TYPE_CATEGORY,t.ALL_TYPE_TITLE,1):null}},{key:"getItemUseEventData",value:function(){return{type:Te.b.ITEM,category:"전체",keyword:this.getKeyword()}}},{key:"getItemsCount",value:function(){return this.items.length}},{key:"onMoveDetail",value:function(e){this.selectMenu(e)}},{key:"onRecentMore",value:function(e){this.setKeyword(e)}},{key:"onDataChanged",value:function(){return he()(F()(t.prototype),"onDataChanged",this).call(this),this.renderMultipleList(),this.container}},{key:"getJustifiedListToolOption",value:function(){return null}},{key:"getPageSize",value:function(){return 30}}]),t}(Ih);$p.ALL_TYPE_CATEGORY="요소>전체",$p.ALL_TYPE_TITLE="요소 > 전체";var Qp=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this))).isAdminMode=e,a.isDevMode=n,a.paginationMode=i,a}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return e.isAdminMode!==this.isAdminMode||e.isDevMode!==this.isDevMode||e.paginationMode!==this.paginationMode}}]),t}(He.b),Jp=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).menuMap=new Map,n.searchDesignResourceType=gn.a.ELEMENT,n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=this.elementClass,this.container.appendChild(this.makeAdminUI()),this.container.appendChild(this.makeSearchTool()),this.container.appendChild(this.makeRadioTool()),this.container.appendChild(this.makeContentsWrap())}},{key:"setActive",value:function(e){return he()(F()(t.prototype),"setActive",this).call(this,e),this.selectedMenu&&this.selectedMenu.setActive(e),this}},{key:"addRadioButtons",value:function(e){var t=this;e.forEach(function(e){t.radioTool.addBtn(new be.a("".concat(So.b.getNameResourceKey(e)),e,!1)),t.radioTool.setGtmData("lib_item")}),this.radioTool.select(e[0],!1)}},{key:"setFirstMenu",value:function(){this.selectMenu(this.radioTool.getValue())}},{key:"makeSearchTool",value:function(){var e=this;return this.searchTool=new dh.a(function(t){return e.setKeyword(t)},"".concat(So.b.getNameResourceKey(this.leftPanelType)," 검색"),void 0,void 0,void 0,this.searchDesignResourceType),this.searchTool.getContainer()}},{key:"makeRadioTool",value:function(){var e=this;return this.radioTool=new be.b(function(t){return e.selectMenu(t)},null,r.a.ITEM_MENU_RADIO_TOOL),this.radioTool.getContainer()}},{key:"makeContentsWrap",value:function(){return this.contentsWrap=document.createElement("div"),this.contentsWrap.className=r.a.CONTENTS_WRAP,this.contentsWrap}},{key:"selectMenu",value:function(e){this.radioTool.select(e,!1);var t=this.menuMap.get(e)||this.createLeftPanelListView(e);this.selectedMenu&&this.selectedMenu.setVisibility(!1).setActive(!1),this.selectedMenu=t.setVisibility(!0).setActive(!0),this.sendGASearchReport()}},{key:"createLeftPanelListView",value:function(e){var t=Yp.make(e,this.getItemLibMenuParam());return t instanceof Ih&&t.setListener(this),this.setLeftPanelListView(t)}},{key:"setLeftPanelListView",value:function(e){return this.menuMap.set(e.getLeftPanelType(),e),e.setVisibility(!1),this.contentsWrap.appendChild(e.getContainer()),e}},{key:"getItemLibMenuParam",value:function(){var e=this;return{getKeyword:function(){return e.searchTool.getKeyword()},setKeyword:function(t){return e.setKeyword(t)},getItemAccessType:function(){return e.itemAccessType},hasFilter:this.hasFilter.bind(this)}}},{key:"hasFilter",value:function(){return!1}},{key:"setKeyword",value:function(e){e=e?e.trim():"",this.searchTool.updateUI(e),this.loadList()}},{key:"fetchList",value:function(){this.selectedMenu.isLoaded||this.selectedMenu.onChangeFetchCondition(),this.isLoaded=!0,this.sendGASearchReport()}},{key:"sendGASearchReport",value:function(){var e=this.searchTool.getKeyword()||"";if(e){var t=0;if(this.selectedMenu instanceof $p)t=this.selectedMenu.getItemsCount();else try{t=this.selectedMenu.lib.lastListResult.totalRow}catch(e){n()}try{Te.a.sendSearchReport({type:Te.b.ITEM,keyword:e,category:this.selectedMenu.getNameResourceKey(),totalRow:t})}catch(e){n()}}function n(e){0}}},{key:"resetMenuListLoadFlag",value:function(){this.menuMap.forEach(function(e){return e.isLoaded=!1})}},{key:"onDataChanged",value:function(e){var t=this;this.onCreateViewIfNotCreated(),this.checkUpContentsChange(this.getRenderStates()),this.contentsStatesChanged&&this.enableStyle(Ke.a.getUserSetting().adminMode,this.adminUIElement,r.a.ACTIVE),this.menuMap.forEach(function(n){n.onDataChanged(e),!n.isLoaded&&t.isActive()&&n.isActive()&&n.setActive(!0)})}},{key:"getRenderStates",value:function(){return new Qp(Ke.a.getUserSetting().adminMode,Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().leftPanelPaginationMode)}},{key:"getGTMItemData",value:function(e){return this.selectedMenu.getGTMItemData(e)}},{key:"getItemUseEventData",value:function(){return this.selectedMenu.getItemUseEventData()}},{key:"onLeftPanelListViewActive",value:function(e){}}]),t}(oh),em=n(177),tm=n(174),nm=n.n(tm),im=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add(r.a.SLIDE_VIEW),this.scrollElement=new Ce.a(!0,!1,"100%"),this.scrollElement.onAfterScroll=this.updateButtonVisibility.bind(this),this.container.appendChild(this.scrollElement.render()),this.container.appendChild(this.makePrevBtn()),this.container.appendChild(this.makeNextBtn()),this.attachScrollElementObserver()}},{key:"attachScrollElementObserver",value:function(){var e=this;this.observer=new MutationObserver(function(t){t.forEach(function(t){"childList"===t.type&&nm()(e.scrollElement.render(),function(){e.updateButtonVisibility(),e.observer.disconnect()})})}),this.observer.observe(this.scrollElement.render(),{attributes:!0,childList:!0,characterData:!1,subtree:!0})}},{key:"renderView",value:function(e){he()(F()(t.prototype),"renderView",this).call(this),this.updateButtonVisibility(),this.scrollElement.render(e.getContainer())}},{key:"hideElementWhen",value:function(e,t){e?t.classList.add(r.a.HIDDEN):t.classList.remove(r.a.HIDDEN)}},{key:"updateButtonVisibility",value:function(){this.hideElementWhen(this.scrollElement.isScrollLeftEnd(),this.prevBtn.getContainer()),this.hideElementWhen(this.scrollElement.isScrollRightEnd(),this.nextBtn.getContainer())}},{key:"makePrevBtn",value:function(){return this.prevBtn=new em.a(!1),this.prevBtn.setOnClickListener(this),this.prevBtn.getContainer()}},{key:"makeNextBtn",value:function(){return this.nextBtn=new em.a(!0),this.nextBtn.setOnClickListener(this),this.nextBtn.getContainer()}},{key:"onClick",value:function(e){this.scrollElement.setScrollX(this.scrollElement.getScrollX()+(e.isNextButton?1:-1)*this.scrollElement.element.clientWidth,200)}}]),t}(He.a),am=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,!0))).clickOnContainer=!0,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add(r.a.SEARCH_FILTER);var n=document.createElement("div");n.className=r.a.BACKGROUND,n.addEventListener("click",function(){return e.setActive(!1)}),this.container.appendChild(n),this.container.appendChild(this.button=Object(ne.setToolsIcon)(document.createElement("button"),ne.ToolsIcon.TUNE2)),this.button.addEventListener("click",this.toggleActive.bind(this)),this.container.appendChild(this.filterCountLabel=document.createElement("div")),this.filterCountLabel.classList.add(r.a.NUMBER_LABEL)}},{key:"setActive",value:function(e){return he()(F()(t.prototype),"setActive",this).call(this,e),this.onCreateViewIfNotCreated(),e&&this.getFilterMenu().refresh(),this.updateButtonStatus(),this}},{key:"updateButtonStatus",value:function(){var e=this.getSelectedFilterItemCount();this.filterCountLabel.innerText=String(e),this.enableStyle(e>0,this.button,r.a.ACTIVE)}}]),t}(He.a),om=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).btnApplyRef=Object(sa.createRef)(),n.btnClearRef=ra.a.createRef(),n}return z()(t,e),w()(t,[{key:"render",value:function(){return ra.a.createElement("div",{className:r.a.MENU_ITEM},ra.a.createElement("button",{ref:this.btnClearRef},"초기화"),ra.a.createElement("div",{className:r.a.BODY},this.renderBody()),ra.a.createElement("div",{className:r.a.FOOTER},ra.a.createElement("button",{ref:this.btnApplyRef},"필터 적용")))}},{key:"componentDidMount",value:function(){this.btnApplyRef.current.addEventListener("click",this.onApplyFilter.bind(this)),this.btnClearRef.current.addEventListener("click",this.onClearFilter.bind(this))}}]),t}(sa.Component),sm=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).containerRef=Object(sa.createRef)(),n}return z()(t,e),w()(t,[{key:"render",value:function(){var e=this.props,t=e.imageType,n=e.selected;return ra.a.createElement("div",{ref:this.containerRef,key:t,className:n?r.a.SELECTED:"","data-image-type":t},ra.a.createElement("div",{className:r.a.RADIO_BUTTON},ra.a.createElement("div",null)),ra.a.createElement("div",{className:r.a.NAME},Gh.getName(t)))}},{key:"componentDidMount",value:function(){var e=this;this.containerRef.current.addEventListener("click",function(t){return e.props.onSelectImageType(e.props.selected?null:t.currentTarget.getAttribute("data-image-type"))})}}]),t}(sa.Component),rm=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).state={imageTypeMenuItems:[],selectedImageType:null},n}return z()(t,e),w()(t,[{key:"renderBody",value:function(){var e=this,t=this.state,n=t.imageTypeMenuItems,i=t.selectedImageType;return ra.a.createElement(ra.a.Fragment,null,ra.a.createElement("div",{className:r.a.TITLE},"유형"),ra.a.createElement("div",{className:r.a.CONTENTS},n.map(function(t){return ra.a.createElement(sm,{key:t.value,selected:t.value===i,imageType:t.value,onSelectImageType:e.onSelectImageType.bind(e)})})))}},{key:"refresh",value:function(){var e=Qh.getImageTypeMenuItems(),t=e.find(function(e){return e.selected});this.setState({imageTypeMenuItems:e,selectedImageType:t?t.value:null})}},{key:"onSelectImageType",value:function(e){this.setState({selectedImageType:e})}},{key:"onApplyFilter",value:function(){Qh.setFilterState(new $h(this.state.selectedImageType))}},{key:"onClearFilter",value:function(){this.setState({selectedImageType:null})}}]),t}(om),lm=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add(r.a.ELEMENT_PANEL)}},{key:"getFilterMenu",value:function(){if(this.filterMenu)return this.filterMenu;var e=document.createElement("div");return e.className=r.a.SEARCH_FILTER_MENU,this.filterMenu=_a.a.render(ra.a.createElement(rm),e),this.container.appendChild(e),this.filterMenu}},{key:"getSelectedFilterItemCount",value:function(){return Qh.getSelectedImageType()?1:0}}]),t}(am),cm=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.filterView=new lm,this.filterView.setOnClickListener(this),this.filterView.setVisibility(!1),this.container.insertBefore(this.filterView.getContainer(),this.container.firstChild)}},{key:"renderView",value:function(e){he()(F()(t.prototype),"renderView",this).call(this),this.filterView.setVisibility(e===So.b.ILLUST_LIB),this.setPlaceholder("".concat(So.b.getNameResourceKey(e)," 검색"))}}]),t}(dh.a),um=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).leftPanelType=So.b.ITEM_LIB,e.elementClass=r.a.LIBRARY_ITEM,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this);var n=new $p(function(){return e.searchTool.getKeyword()},function(){return e.itemAccessType},this.setKeyword.bind(this),function(t){return e.selectMenu(t)});n.setListener(this),this.setLeftPanelListView(n),this.addRadioButtons([So.b.ALL_TYPE_ITEM,So.b.ILLUST_LIB,So.b.ITEM_COMBINATION_LIB,So.b.FIGURE_LIB,So.b.LINE_LIB,So.b.FRAME_LIB,So.b.GRID_LIB]),this.setFirstMenu()}},{key:"makeRadioTool",value:function(){return he()(F()(t.prototype),"makeRadioTool",this).call(this),this.slideView=new im,this.slideView.renderView(this.radioTool),this.slideView.getContainer()}},{key:"selectMenu",value:function(e){he()(F()(t.prototype),"selectMenu",this).call(this,e);var n=this.radioTool.getSelectedButtonElement();if(n){var i=this.slideView.scrollElement.contents,a=n.offsetLeft+n.offsetWidth;i.scrollLeft+i.clientWidth<a?this.slideView.scrollElement.setScrollX(a-i.clientWidth+1,300):i.scrollLeft>n.offsetLeft&&this.slideView.scrollElement.setScrollX(n.offsetLeft,300)}}},{key:"onLeftPanelListViewActive",value:function(e){this.searchTool.renderView(e.getLeftPanelType())}},{key:"onChangeFilter",value:function(e){this.searchTool.initUI(),this.selectedMenu.isLoaded=!1,this.selectedMenu.onChangeFetchCondition()}},{key:"makeSearchTool",value:function(){var e=this;return this.searchTool=new cm(function(t){return e.setKeyword(t)},"".concat(So.b.getNameResourceKey(this.leftPanelType)," 검색"),void 0,void 0,void 0,this.searchDesignResourceType),Qh.setListener(this),this.searchTool.getContainer()}},{key:"hasFilter",value:function(){return this.selectedMenu.getLeftPanelType()===So.b.ILLUST_LIB&&Boolean(Qh.getSelectedImageType())}}]),t}(Jp),dm=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,new Jt(e,n,i)))).resourceType=n,a.resourceDataGetter=Zt.a.createInstance(n,i),a}return z()(t,e),w()(t,[{key:"getThumbUrlList",value:function(){return[this.resourceDataGetter.getThumb(this.listItemData.resourceData)]}},{key:"makeHoverLayer",value:function(){var e=this,n=he()(F()(t.prototype),"makeHoverLayer",this).call(this),i=ap.resourceTypeToItemType(this.resourceType);if(null===i)return n;var o={itemType:i,itemReferenceKey:this.listItemData.myCollectionPk.referenceKey};i===np.MOCKUP&&(o.itemIdx=this.listItemData.resourceData.idx);var r=new sp(o);r.setOnCloseListener(this);var l=this.dddotBtn=ap.makeDddotBtn(s()(a.a.mark(function t(){var n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.setDddotBtnVisibility(!0),Ft.a.sendDetailClick(e.listItemData.myCollectionPk),n={useFavorite:e.useFavorite,myCollectionPk:e.listItemData.myCollectionPk},r.openItemInfo(n,$(l).offset());case 4:case"end":return t.stop()}},t)})));return n.appendChild(l),n}}]),t}(Qt),hm=n(435),pm=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).makeListItem=e,n}var n,i;return z()(t,e),w()(t,[{key:"setResourceType",value:function(e){this.resourceType=e}},{key:"getResourceType",value:function(){return this.resourceType}},{key:"addItem",value:function(e){this.items.push(e),this.clearCache()}},{key:"removeItem",value:function(e){var t=this,n=this.findItems(e);n.reverse(),n.forEach(function(e){e.item.removeElement(),t.items.splice(t.items.indexOf(e.item),1)}),this.clearCache()}},{key:"fetchListInternal",value:(i=s()(a.a.mark(function e(t){var n,i,o,s,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setGTMLibDataAuto(),e.next=3,hm.a.getList(t);case 3:return n=e.sent,e.next=6,this.makeItems(n.list);case 6:if((i=e.sent).length>0)try{o=this.getGTMLibData(),s=o.listTitle,r=o.category,Ft.a.sendImpressions({items:i,category:r,listTitle:s,pageNo:t.page,pageSize:t.pageSize})}catch(e){}return e.abrupt("return",{items:i,totalRow:n.pagination.totalRow});case 9:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"getRequestParam",value:function(e){return{resourceType:this.resourceType,page:e.page,pageSize:e.pageSize,category:null}}},{key:"makeItems",value:(n=s()(a.a.mark(function e(t){var n,i=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!it.a.isEmpty(t)){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,qt.a.setMyCollectionList(t);case 4:return n=[],t.forEach(function(e){var t=qt.a.makeMyCollectionPk(e);if(qt.a.has(t)){var a=qt.a.get(t);n.push(i.makeListItem(a.getResourceData(),t.resourceType,t.repositoryType))}else console.error("유효하지 않은 찜 데이터입니다.",e)}),e.abrupt("return",n);case 7:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)})},{key:"getLibType",value:function(){return sn.b.FAVORITES}},{key:"setGTMLibDataAuto",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.setGTMLibData({listTitle:"찜하기",category:"찜하기",keyword:e})}}]),t}(sn.a),mm=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"dispatchTemplateLoadAction",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];X.a.instance.dispatch(new lc.c(e,t,n,i))}},{key:"loadTemplateDesign",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e?n=new Mo.a(e.width,e.height,De.a.PX):t&&(n=new Mo.a(t.width,t.height,t.unit,Mo.a.DEFAULT_DPI)),this.dispatchTemplateLoadAction(this.getDesignParam(),n,t,i)}},{key:"loadTemplatePage",value:function(e){X.a.instance.dispatch(new ei.a(this.getDesignParam(),e))}},{key:"getDesignParam",value:function(){var e=this.listItemData,t=e.dropEventKey,n=e.myCollectionPk,i=n.repositoryType,a=n.resourceType;return Gt.a.getDesignBasis(t,i,a===Q.a.TEMPLATE)}},{key:"makeThumbImg",value:function(){var e=this,n=he()(F()(t.prototype),"makeThumbImg",this).call(this);return n.onload=function(){var t=n.width/hh.c.MAX_WIDTH;n.height/t<hh.c.SHORT_HEIGHT&&e.container.classList.add(r.a.SHORT)},n}}]),t}(Qt),fm=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).isMultiPage=!1,n}return z()(t,e),w()(t,[{key:"checkMultiPage",value:function(){var e=this.getThumbUrlList();this.isMultiPage=it.a.isEmpty(e)||e.length<2}},{key:"doAction",value:function(){this.isMultiPage?he()(F()(t.prototype),"doAction",this).call(this):this.openSubPage(this)}},{key:"makeHoverLayer",value:function(){var e=he()(F()(t.prototype),"makeHoverLayer",this).call(this),n=this.getThumbUrlList();if(!it.a.isEmpty(n)&&n.length>1){var i=document.createElement("label");i.innerText=String(n.length),i.className=r.a.PAGE_CNT,e.appendChild(i)}return e}}]),t}(mm),vm=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).HEIGHT_MARGIN=85,n.param=e,n.templateInfoElementMap={},n.makeElement(),n}return z()(t,e),w()(t,[{key:"openTemplateInfo",value:function(e){var t=this;this.openParam=e,this.emptyElement(),this.openPopup(e.favoritesParam,e.offset),this.loadTemplateInfo().then(function(){return t.updateUIAfterRender()})}},{key:"emptyElement",value:function(){this.templateInfoElementMap.title.innerText="",this.templateInfoElementMap.updateDate&&(this.templateInfoElementMap.updateDate.innerText=""),this.templateInfoElementMap.designerId&&(this.templateInfoElementMap.designerId.innerText=""),this.templateInfoElementMap.keywords&&$(this.templateInfoElementMap.keywords).empty()}},{key:"updateUIAfterRender",value:function(){var e=$(this.templateInfoElementMap.keywords);if(this.templateInfoElementMap.keywords&&e.height()<this.templateInfoElementMap.keywords.scrollHeight)for(var t=e.children(),n=2*t.height(),i=!1,a=0,o=t.length;a<o;a++){var s=t.eq(a),l=s.position();if(!i&&l.top>0&&(s.before(this.btnKeywordMore),i=!0),l.top>=n){s.before(this.btnKeywordMore).addClass(r.a.CLEAR_BOTH);break}}}},{key:"updateKeywordsUI",value:function(e){var t=this.templateInfoElementMap.keywords;t.classList.add(r.a.LIMIT_HEIGHT),$(t).empty();var n=document.createDocumentFragment(),i=document.createElement("label");i.innerText="키워드",n.appendChild(i);var a=e.length-1;if(e.forEach(function(e,t){var i=document.createElement("span");i.className=r.a.WORD_WRAP;var o=document.createElement("a");if(o.innerText=e,i.appendChild(o),t<a){var s=document.createElement("span");s.innerText=",",i.appendChild(s)}n.appendChild(i)}),!e.length){var o=document.createElement("span");o.className=r.a.KEYWORD_NONE,o.innerText="없음",n.appendChild(o)}t.appendChild(n)}},{key:"makeHeader",value:function(){var e=ap.makeHeaderWrap();this.templateInfoElementMap.title=this.makeTemplateTitleElem(),e.appendChild(this.templateInfoElementMap.title),this.hasUpdateDate()&&(this.templateInfoElementMap.updateDate=document.createElement("p"),this.templateInfoElementMap.updateDate.className=r.a.UPDATE_DATE,e.appendChild(this.templateInfoElementMap.updateDate)),this.hasDesignerId()&&(this.templateInfoElementMap.designerId=document.createElement("p"),this.templateInfoElementMap.designerId.className=r.a.DESIGNER_ID,e.appendChild(this.templateInfoElementMap.designerId)),this.contents.appendChild(e)}},{key:"makeKeyword",value:function(){var e=this,t=ap.makeKeywordWrap();this.templateInfoElementMap.keywords=document.createElement("div"),this.templateInfoElementMap.keywords.className=r.a.KEYWORDS,t.appendChild(this.templateInfoElementMap.keywords),this.btnKeywordMore=document.createElement("button"),this.btnKeywordMore.className=r.a.BTN_KEYWORD_MORE,this.btnKeywordMore.innerText="... 더보기",$(this.templateInfoElementMap.keywords).on("click","a",function(t){e.close();var n=t.currentTarget;e.param.searchKeywordCallback&&e.param.searchKeywordCallback(n.innerText)}),this.btnKeywordMore.addEventListener("click",function(){e.templateInfoElementMap.keywords.classList.remove(r.a.LIMIT_HEIGHT),e.templateInfoElementMap.keywords.lastChild.after(e.btnKeywordShort)}),this.btnKeywordShort=document.createElement("button"),this.btnKeywordShort.className=r.a.BTN_KEYWORD_SHORT,this.btnKeywordShort.innerText="간단히",this.btnKeywordShort.addEventListener("click",function(){e.templateInfoElementMap.keywords.classList.add(r.a.LIMIT_HEIGHT)}),this.contents.appendChild(t)}},{key:"makeTemplateChangeBtn",value:function(){var e=document.createElement("div");e.className=r.a.BUTTON_WRAP,e.classList.add(tp.CHANGE_TEMPLATE),e.appendChild(this.makeBtnTemplateChange()),this.contents.appendChild(e)}},{key:"makeBtnTemplateChange",value:function(){var e=this,t=document.createElement("button");return t.innerText="이 템플릿으로 덮어쓰기",Object(ne.setToolsIcon)(t,ne.ToolsIcon.REPLACE),new Le.a(t,Ge.a.B,{title:{name:"해당 기능은 작업사이즈 변경 우려로<br/>인쇄용 작업시 제공되지 않습니다."}},{title:{name:"해당 기능은 작업사이즈 변경 우려로<br/>인쇄용 작업시 제공되지 않습니다."}},{atDisable:!0}).onStartView(),t.addEventListener("click",function(){return e.loadTemplate()}),this.btnLoadTemplate=t,t}},{key:"loadTemplate",value:function(){var e;this.close(),Y.a.instance.editorMainVC.leftBarVC.setActive(!1),this.openParam.sheetSize?e=new Mo.a(this.openParam.sheetSize.width,this.openParam.sheetSize.height,De.a.PX):this.openParam.templateType&&(e=new Mo.a(this.openParam.templateType.width,this.openParam.templateType.height,this.openParam.templateType.unit,Mo.a.DEFAULT_DPI)),X.a.instance.dispatch(new lc.c(Gt.a.getDesignBasis(this.getDesignKey(),this.openParam.repositoryType,this.isTemplate()),e,this.openParam.templateType)),this.param.onAfterTemplateLoaded&&this.param.onAfterTemplateLoaded()}},{key:"getDesignKey",value:function(){return this.openParam.templateLoadKey?this.openParam.templateLoadKey:String(this.openParam.designIdx)}},{key:"updateUI",value:function(){}},{key:"hasUpdateDate",value:function(){return!1}},{key:"hasDesignerId",value:function(){return!1}},{key:"makeTemplateTitleElem",value:function(){return document.createElement("span")}}]),t}(op),gm=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}var n;return z()(t,e),w()(t,[{key:"makeElement",value:function(){he()(F()(t.prototype),"makeElement",this).call(this),this.makeHeader(),this.makeKeyword(),S.a.getLeftPanelOption().changeTemplate&&this.makeTemplateChangeBtn(),this.makeFavoritesBtn()}},{key:"loadTemplateInfo",value:(n=s()(a.a.mark(function e(){var t,n,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,on.a.findOneTemplate(this.openParam.designIdx);case 2:t=e.sent,n=t.highestPriorityTemplateType,i=t.templateTypeList,this.templateInfoElementMap.title.innerText="".concat(t.title," ").concat(n.getTitleWithGroupPrefix()||i[0].getTitleWithGroupPrefix()),this.templateInfoElementMap.updateDate&&(this.templateInfoElementMap.updateDate.innerText="".concat(re.a.toString(new Date(t.updateDate),"yyyy-MM-dd HH:mm"))),this.templateInfoElementMap.designerId&&(o=t.creatorAccountEmail.slice(0,t.creatorAccountEmail.indexOf("@")),this.templateInfoElementMap.designerId.innerText="By ".concat(o)),this.templateInfoElementMap.keywords&&this.updateKeywordsUI(t.keywords);case 8:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"makeTemplateTitleElem",value:function(){var e=this,t=document.createElement("span");return t.addEventListener("click",function(){var t=e.openParam.templateType,n=(new No.a).set(No.b.TEMPLATE_IDX,String(e.openParam.designIdx));t&&(n.set(No.b.SHEET_W,String(De.a.getPixel(t.width,Mo.a.DEFAULT_DPI,t.unit||De.a.PX))).set(No.b.SHEET_H,String(De.a.getPixel(t.height,Mo.a.DEFAULT_DPI,t.unit||De.a.PX))).set(No.b.TEMPLATE_TYPE_ID,String(t.id)),t.unit&&t.unit!==De.a.PX&&n.set(No.b.SIZE_UNIT,t.unit).set(No.b.DPI,String(Mo.a.DEFAULT_DPI))),window.open("".concat(S.a.getUrlBasePath(),"design?").concat(n.serialize()),"_blank")}),S.a.getDddotPopupOption().openNewTab||t.classList.add(r.a.DISABLE),t}},{key:"isTemplate",value:function(){return!0}},{key:"hasDesignerId",value:function(){return!0}},{key:"getId",value:function(){return"unicornTemplateDddotPopup"}}]),t}(vm),Em=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,new Jt(e,Q.a.TEMPLATE,Do.a.UNICORN)))).openSubPage=n,i.checkMultiPage(),i}return z()(t,e),w()(t,[{key:"getThumbUrlList",value:function(){return this.listItemData.resourceData.pageList.map(function(e){return e.thumb300Url})}},{key:"makeHoverLayer",value:function(){var e=this,n=he()(F()(t.prototype),"makeHoverLayer",this).call(this),i=new gm({});i.setOnCloseListener(this);var a=this.dddotBtn=ap.makeDddotBtn(function(){e.setDddotBtnVisibility(!0);var t=e.listItemData.myCollectionPk;i.openTemplateInfo({designIdx:Number(t.referenceKey),repositoryType:t.repositoryType,favoritesParam:{useFavorite:!0,myCollectionPk:t},offset:$(a).offset(),templateLoadKey:e.listItemData.dropEventKey}),Ft.a.sendDetailClick(e.listItemData.myCollectionPk)});return n.appendChild(a),n}},{key:"getTitle",value:function(){return this.listItemData.resourceData.title}}]),t}(fm),ym=n(437),Tm=n(19),Im=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}var n;return z()(t,e),w()(t,[{key:"loadTemplateInfo",value:(n=s()(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ym.a.getBizhowsTemplate(this.openParam.designIdx);case 2:t=e.sent,this.templateInfoElementMap.title.innerText=t.designTitle,this.templateInfoElementMap.designerId&&(this.templateInfoElementMap.designerId.innerText="By ".concat(t.designerId)),this.templateInfoElementMap.keywords&&this.updateKeywordsUI(t.manualKeywords.concat(t.autoKeywords));case 6:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"makeElement",value:function(){he()(F()(t.prototype),"makeElement",this).call(this),this.makeHeader(),this.makeKeyword(),S.a.getLeftPanelOption().changeTemplate&&this.makeTemplateChangeBtn(),this.makeFavoritesBtn(),S.a.getDddotPopupOption().moveBiz&&this.makebtnMoveBiz()}},{key:"openTemplateInfo",value:function(e){he()(F()(t.prototype),"openTemplateInfo",this).call(this,e),!e.bizDetailSiteMapIdx&&this.contents.contains(this.bizBtnWrap)&&this.contents.removeChild(this.bizBtnWrap)}},{key:"makebtnMoveBiz",value:function(){var e=this,t=this.bizBtnWrap=document.createElement("div");t.className=r.a.BUTTON_WRAP,t.classList.add(tp.MOVE_BIZ);var n=document.createElement("button");n.className=r.a.BUTTON_BIZ,n.innerText="비즈하우스에서 보기",Object(ne.setToolsIcon)(n,ne.ToolsIcon.LIBRARY_DESIGN),n.addEventListener("click",function(){return e.moveBizDetailPage()}),t.appendChild(n),this.contents.appendChild(t)}},{key:"moveBizDetailPage",value:function(){var e="/mall/design/design_detail.jsp?site_map_idx=${siteMapIdx}&design_idx=${designIdx}".replace("${siteMapIdx}",String(this.openParam.bizDetailSiteMapIdx)).replace("${designIdx}",String(this.openParam.designIdx));window.open(Tm.a.getURL(e),"_blank")}},{key:"isTemplate",value:function(){return!0}},{key:"hasDesignerId",value:function(){return!0}},{key:"getId",value:function(){return"bizTemplateDddotPopup"}}]),t}(vm),Cm=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,new Jt(e,Q.a.TEMPLATE,Do.a.BIZHOWS)))).openSubPage=n,i.checkMultiPage(),i}return z()(t,e),w()(t,[{key:"getThumbUrlList",value:function(){if(!this.thumbUrlList){this.thumbUrlList=[];var e,t=0;do{(e=this.listItemData.resourceData["imgURL".concat(t++)])&&this.thumbUrlList.push(e)}while(null!=e)}return this.thumbUrlList}},{key:"makeHoverLayer",value:function(){var e=this,n=he()(F()(t.prototype),"makeHoverLayer",this).call(this),i=new Im({});i.setOnCloseListener(this);var a=this.dddotBtn=ap.makeDddotBtn(function(){e.setDddotBtnVisibility(!0);var t=e.listItemData.myCollectionPk;i.openTemplateInfo({designIdx:Number(t.referenceKey),repositoryType:t.repositoryType,favoritesParam:{useFavorite:!0,myCollectionPk:t},offset:$(a).offset(),templateLoadKey:e.listItemData.dropEventKey,bizDetailSiteMapIdx:null,sheetSize:null})});return n.appendChild(a),n}},{key:"getTitle",value:function(){return this.listItemData.resourceData.designTitle}}]),t}(fm),km=n(390),Lm=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}var n;return z()(t,e),w()(t,[{key:"loadTemplateInfo",value:(n=s()(a.a.mark(function e(){var t,n,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={title:"",updateDate:0,creatorAccountEmail:"",keywords:[]},e.next=3,km.a.findOne(this.openParam.designIdx);case 3:n=e.sent,this.openParam.templateType=n.templateType,Object.assign(t,n),this.templateInfoElementMap.title.innerText=t.title,this.templateInfoElementMap.updateDate&&(this.templateInfoElementMap.updateDate.innerText="".concat(re.a.toString(new Date(t.updateDate),"yyyy-MM-dd HH:mm"))),this.templateInfoElementMap.designerId&&(i=t.creatorAccountEmail.slice(0,t.creatorAccountEmail.indexOf("@")),this.templateInfoElementMap.designerId.innerText="By ".concat(i)),this.templateInfoElementMap.keywords&&this.updateKeywordsUI(t.keywords);case 10:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"makeElement",value:function(){he()(F()(t.prototype),"makeElement",this).call(this),this.makeHeader(),S.a.getLeftPanelOption().changeTemplate&&this.makeTemplateChangeBtn()}},{key:"isTemplate",value:function(){return!1}},{key:"hasUpdateDate",value:function(){return!0}},{key:"getId",value:function(){return"designDddotPopup"}}]),t}(vm),_m=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,new Jt(e,Q.a.DESIGN,Do.a.UNICORN)))).openSubPage=n,i.checkMultiPage(),i}return z()(t,e),w()(t,[{key:"getThumbUrlList",value:function(){return this.listItemData.resourceData.pageList.map(function(e){return e.thumb300Url})}},{key:"makeHoverLayer",value:function(){var e=this,n=he()(F()(t.prototype),"makeHoverLayer",this).call(this),i=new Lm({});i.setOnCloseListener(this);var a=this.dddotBtn=ap.makeDddotBtn(function(){e.setDddotBtnVisibility(!0);var t=e.listItemData.myCollectionPk;i.openTemplateInfo({designIdx:Number(t.referenceKey),favoritesParam:{useFavorite:!0,myCollectionPk:t},repositoryType:t.repositoryType,offset:$(a).offset()})});return n.appendChild(a),n}},{key:"getTitle",value:function(){return this.listItemData.resourceData.title}}]),t}(fm),wm=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"dispatchTemplateLoadAction",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];X.a.instance.dispatch(new lc.a(e,t,n,i))}},{key:"loadTemplateDesign",value:function(){he()(F()(t.prototype),"loadTemplateDesign",this).call(this,void 0,void 0,!0)}}]),t}(Em),Sm=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"dispatchTemplateLoadAction",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];X.a.instance.dispatch(new lc.a(e,t,n,i))}},{key:"loadTemplateDesign",value:function(){he()(F()(t.prototype),"loadTemplateDesign",this).call(this,void 0,void 0,!0)}}]),t}(Cm),bm=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).isLoginRequire=!0,e.lib=new pm(function(t,n,i){return e.makeListItem(t,n,i)}),e.leftPanelType=So.b.FAVORITE_LIB,e}var n,i,o;return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.LIBRARY_FAVORITES,this.radioTool=new be.b(function(t){return e.setResourceType(t)}),this.container.appendChild(this.radioTool.getContainer()),this.container.appendChild(this.makeListSection());var n=!0,i=!1,a=void 0;try{for(var o,s=Q.b.values()[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;qt.a.addRegisterListener(l,function(t){return e.addItemByFavoritePk(t)}).addUnregisterListener(l,function(t){return e.removeItemByFavoritePk(t)})}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"makeListSection",value:function(){var e=document.createElement("div");return e.className=r.a.LIST_SECTION,this.paginationListTool.setListEmptyView(t.makeEmptyListView()),e.appendChild(this.paginationListTool.getContainer()),e.appendChild(this.makeSubPagesTool()),e}},{key:"addItemByFavoritePk",value:(o=s()(a.a.mark(function e(t){var n,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=qt.a.get(t),this.isLoaded&&n){e.next=3;break}return e.abrupt("return");case 3:if(this.subPagesTool.setVisibility(!1),this.updateUIRadioTool(),i=this.lib.getResourceType(),!d.b.isEmpty(i)&&i!==t.resourceType){e.next=16;break}if(o=this.makeListItem(n.getResourceData(),t.resourceType,t.repositoryType),this.lib.addItem(o),this.paginationListTool.prependItem(o),!this.isActive()){e.next=15;break}return e.next=13,this.paginationListTool.justifyList();case 13:e.next=16;break;case 15:this.paginationListTool.setJustifyRequire(!0);case 16:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"removeItemByFavoritePk",value:(i=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.lib.removeItem(t),this.subPagesTool.setVisibility(!1),this.updateUIRadioTool(),n=this.lib.getResourceType(),!d.b.isEmpty(n)&&n!==t.resourceType){e.next=12;break}if(!qt.a.hasFavorite(n)){e.next=10;break}return e.next=8,this.justifyList();case 8:e.next=12;break;case 10:this.setResourceType(null,!0),this.isActive()||this.paginationListTool.setJustifyRequire(!0);case 12:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"justifyList",value:(n=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isActive()){e.next=5;break}return e.next=3,this.paginationListTool.justifyList();case 3:e.next=6;break;case 5:this.paginationListTool.setJustifyRequire(!0);case 6:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"makeListItem",value:function(e,t,n){switch(t){case Q.a.TEMPLATE:switch(n){case Do.a.UNICORN:return new(S.a.getExecutionMode().isBizhowsChannelAndOrderPurpose()?wm:Em)(e,this.openSubPage.bind(this));case Do.a.BIZHOWS:return new(S.a.getExecutionMode().isBizhowsChannelAndOrderPurpose()?Sm:Cm)(e,this.openSubPage.bind(this));default:throw new Error("잘못된 타입입니다. - ".concat(t,", ").concat(n))}case Q.a.DESIGN:return new _m(e,this.openSubPage.bind(this));default:return new dm(e,t,n)}}},{key:"openSubPage",value:function(e){this.subPagesTool.updateUI({listItem:e}),this.subPagesTool.setVisibility(!0)}},{key:"setResourceType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(t||this.lib.getResourceType()!==e)&&(this.lib.setResourceType(e),this.loadListSync())}},{key:"loadListSync",value:function(){this.subPagesTool.setVisibility(!1),this.isLoaded?this.paginationListTool.initList():qt.a.initSizeMap(this.onInitSizeMapResult.bind(this))}},{key:"onInitSizeMapResult",value:function(){this.isLoaded=!0,this.updateUIRadioTool(),this.paginationListTool.initList()}},{key:"updateUIRadioTool",value:function(){var e=this.lib.getResourceType(),t=[],n=!0,i=!1,a=void 0;try{for(var o,s=Q.b.values()[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var r=o.value;if(qt.a.hasFavorite(r))if("continue"===function(){var n="# ".concat(Q.b.getText(r));if(t.find(function(e){return e.label===n}))return"continue";t.push(new be.a(n,r,r===e))}())continue}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}t.length>0&&t.unshift(new be.a("# 전체","",!t.some(function(e){return e.selected}))),this.radioTool.updateUI(t)}},{key:"onDataChanged",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return he()(F()(t.prototype),"onDataChanged",this).call(this,e,n),this.isActive()&&this.fetchList(),this.container}}],[{key:"makeEmptyListView",value:function(){var e=document.createElement("div");e.className=r.a.EMPTY_LIST_NOTI_LAYER;var t=document.createElement("div");Object(ne.setToolsIcon)(t,ne.ToolsIcon.HEART).classList.add("empty_list_notify_favorite_img");var n=document.createElement("p");n.classList.add(r.a.TITLE),n.innerHTML="아직 찜한 디자인이 없어요.",t.appendChild(n);var i=document.createElement("p");return i.innerHTML="마음에 드는 템플릿이나<br>디자인 요소를 담아주세요.",t.appendChild(i),e.appendChild(t),e}}]),t}(Ih),Rm=function(){function e(){L()(this,e),this.itemMap=new Map,this.buttonContainer=this.makeButtonContainer(),this.contentsContainer=this.makeContentsContainer(),this.element=this.makeElement()}return w()(e,[{key:"addItem",value:function(e){var t=this,n=new Am(e).addClickListener(function(e){return t.select(e)});return this.itemMap.set(n.id,n),this.buttonContainer.appendChild(n.button),this.contentsContainer.appendChild(n.contents),(e.active||1===this.itemMap.size)&&this.select(n.id),this}},{key:"select",value:function(e){var t=this.itemMap.get(e);if(!t)throw new Error("메뉴가 존재하지 않습니다");return this.itemMap.forEach(function(e){return e.inactive()}),t.active(),this}},{key:"getSelectedButtonId",value:function(){var e="";return this.itemMap.forEach(function(t){t.isActive()&&(e=t.id)}),e}},{key:"makeElement",value:function(){var e=document.createElement("div");e.className="tab_menu_component";var t=document.createElement("div");t.className="button_container_wrap",t.appendChild(this.buttonContainer),e.appendChild(t);var n=document.createElement("div");return n.className="contents_container_wrap",n.appendChild(this.contentsContainer),e.appendChild(n),e}},{key:"makeButtonContainer",value:function(){var e=document.createElement("div");return e.className="button_container",e}},{key:"makeContentsContainer",value:function(){var e=document.createElement("div");return e.className="contents_container",e}}]),e}(),Am=function(){function e(t){L()(this,e),this.id=t.menuId||d.b.random(),this.button=this.makeButton(t.button,t.buttonClickEvent),this.contents=this.makeContents(t.contents)}return w()(e,[{key:"active",value:function(){this.button.classList.add("active"),this.contents.classList.add("active")}},{key:"inactive",value:function(){this.button.classList.remove("active"),this.contents.classList.remove("active")}},{key:"isActive",value:function(){return this.button.classList.contains("active")}},{key:"addClickListener",value:function(e){var t=this;return this.button.addEventListener("click",function(){return e(t.id)}),this}},{key:"makeButton",value:function(t,n){var i,a=document.createElement("div");return a.className="button_wrap",a.setAttribute(e.ATTRIBUTE_NAME_MENU_ID,this.id),t instanceof HTMLElement?i=t:(i=document.createElement("span")).innerText=t,a.appendChild(i),n&&a.addEventListener("click",n),a}},{key:"makeContents",value:function(t){var n=document.createElement("div");return n.className="contents_wrap",n.setAttribute(e.ATTRIBUTE_NAME_MENU_ID,this.id),n.appendChild(t),n}}]),e}();Am.ATTRIBUTE_NAME_MENU_ID="data-menu-id";var Om=n(343),Pm=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,!0))).title=e,a.contents=n,a.btn=i,a}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.EMPTY_LIST_NOTI_LAYER;var e=document.createElement("div"),n=document.createElement("div");n.className="empty_list_notify_img",e.appendChild(n);var i=document.createElement("p");i.classList.add(r.a.TITLE),i.innerHTML=this.title,e.appendChild(i);var a=document.createElement("p");a.innerHTML=this.contents,e.appendChild(a),this.btn&&e.appendChild(this.btn),this.container.appendChild(e)}}]),t}(He.a),Dm=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).orderType=Om.b.DESC,n.orderField=Om.c.UPDATE_DATE,n.categoryIdx=0,n.repositoryType=Om.d.MIRICANVAS,n.param=e,n}var n;return z()(t,e),w()(t,[{key:"setListener",value:function(e){this.listener=e}},{key:"setKeyword",value:function(e){this.keyword=e}},{key:"getKeyword",value:function(){return this.keyword}},{key:"setOrderType",value:function(e){this.orderType=e}},{key:"setOrderField",value:function(e){this.orderField=e}},{key:"setDesignCategory",value:function(e){this.categoryIdx=e}},{key:"setDesignRepositoryType",value:function(e){this.repositoryType=e}},{key:"fetchListInternal",value:(n=s()(a.a.mark(function e(t){var n,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,km.a.fetchMyDesignList(t,f.a.getUser().accountId);case 2:return n=e.sent,i=this.makeListItems(n.listItemParams),e.abrupt("return",{items:i,totalRow:n.totalRow});case 5:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"getRequestParam",value:function(e){var t=d.b.nvl(this.keyword);return{page:e.page,pageSize:e.pageSize,title:t,orderField:this.orderField,orderBy:this.orderType,categorySearch:this.categoryIdx>0,categoryIdx:this.categoryIdx,repo:t?Om.d.ALL:this.repositoryType}}},{key:"makeListItems",value:function(e){var t=this;return e.map(function(e){return t.param.makeListItem(e)})}},{key:"getLibType",value:function(){return sn.b.DESIGN}},{key:"getGTMItemData",value:function(e){return null}},{key:"removeDesign",value:function(e){var t=this;km.a.updateEnabled(e,!1).then(function(n){t.listener&&n===e&&t.listener.onRemoveDesign(e)}).catch(function(e){return console.error("Failed to change design's enabled",e)})}}]),t}(sn.a),Mm=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).makeBtnClose=!1,e.id=d.b.random(),e.selectedOrderFieldInfo=t.ORDER_FIELD_INFO_LIST[0],e.selectedOrderTypeInfo=t.ORDER_TYPE_INFO_LIST[1],e.contents=e.makeContents(),e}return z()(t,e),w()(t,[{key:"render",value:function(){he()(F()(t.prototype),"render",this).call(this),this.element.classList.add("order_field_select_popup")}},{key:"addOrderFieldSelectListener",value:function(e){return this.orderFieldSelectListener=e,this}},{key:"addOrderTypeSelectListener",value:function(e){return this.orderTypeSelectListener=e,this}},{key:"getSelectedOrderFieldInfo",value:function(){return this.selectedOrderFieldInfo}},{key:"makeContents",value:function(){var e=document.createElement("div");return e.appendChild(this.makeTitle()),e.appendChild(this.makeOrderField()),e.appendChild(this.makeOrderType()),e}},{key:"getContents",value:function(){return this.contents}},{key:"makeTitle",value:function(){var e=document.createElement("p");return e.className=r.a.TITLE,e.innerText="정렬",e}},{key:"makeOrderField",value:function(){var e=this,n=document.createDocumentFragment();return t.ORDER_FIELD_INFO_LIST.forEach(function(t){n.appendChild(e.makeOrderFieldItem(t))}),this.orderFieldUl=document.createElement("ul"),this.orderFieldUl.className="order_field",this.orderFieldUl.appendChild(n),this.orderFieldUl}},{key:"makeOrderFieldItem",value:function(e){var t=this,n=document.createElement("li"),i=document.createElement("span");return i.innerText=e.label,n.appendChild(i),Object(ne.setToolsIcon)(n,ne.ToolsIcon.CHECK,!0),n.addEventListener("click",function(){if(t.selectedOrderFieldInfo.field!==e.field){t.close(),t.selectedOrderFieldInfo=e;var i=!0,a=!1,o=void 0;try{for(var s,l=t.orderFieldUl.children[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){s.value.classList.remove(r.a.ACTIVE)}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}n.classList.add(r.a.ACTIVE),t.orderFieldSelectListener&&t.orderFieldSelectListener(e)}}),e.field===this.selectedOrderFieldInfo.field&&n.classList.add(r.a.ACTIVE),n}},{key:"makeOrderType",value:function(){var e=this,n=document.createDocumentFragment();return t.ORDER_TYPE_INFO_LIST.forEach(function(t){n.appendChild(e.makeOrderTypeItem(t))}),this.orderTypeUl=document.createElement("ul"),this.orderTypeUl.className="order_type",this.orderTypeUl.appendChild(n),this.orderTypeUl}},{key:"makeOrderTypeItem",value:function(e){var t=this,n=document.createElement("li");n.setAttribute("data-order-type",e.type);var i=document.createElement("span");return i.innerText=e.label,n.appendChild(i),Object(ne.setToolsIcon)(n,ne.ToolsIcon.CHECK,!0),n.addEventListener("click",function(){t.setOrderType(e.type),t.orderTypeSelectListener&&t.orderTypeSelectListener(e)}),e.type===this.selectedOrderTypeInfo.type&&n.classList.add(r.a.ACTIVE),n}},{key:"setOrderType",value:function(e){var n=t.ORDER_TYPE_INFO_LIST.find(function(t){return t.type===e});if(n&&n.type!==this.selectedOrderTypeInfo.type){this.close(),this.selectedOrderTypeInfo=n;var i=!0,a=!1,o=void 0;try{for(var s,l=this.orderTypeUl.children[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;c.getAttribute("data-order-type")===n.type?c.classList.add(r.a.ACTIVE):c.classList.remove(r.a.ACTIVE)}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}}}}]),t}(u.a);Mm.ORDER_FIELD_INFO_LIST=[{field:Om.c.UPDATE_DATE,label:"마지막 수정일"},{field:Om.c.CREATE_DATE,label:"최근 생성일"},{field:Om.c.TITLE,label:"이름순"}],Mm.ORDER_TYPE_INFO_LIST=[{type:Om.b.ASC,label:"오름차순"},{type:Om.b.DESC,label:"내림차순"}];var Nm,xm=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,!0))).orderType=Om.b.DESC,i.orderFieldSelectCallback=e,i.orderTypeToggleCallback=n,i}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className="list_header",this.container.appendChild(this.makeTotalRowLabel()),this.orderFieldSelectPopup=(new Mm).addOrderFieldSelectListener(function(t){e.orderFieldLabel.innerText=t.label,e.orderFieldSelectCallback(t.field)}).addOrderTypeSelectListener(function(t){e.selectOrderType(t.type)}),this.container.appendChild(this.makeOrderController())}},{key:"setTotalRow",value:function(e,t){this.totalRowLabel.innerText=String(e),this.enableStyle(t,this.totalRowLabel,r.a.KEYWORDS),this.totalRowLabel.classList.remove(r.a.LOADING)}},{key:"loading",value:function(){this.totalRowLabel.innerText="",this.totalRowLabel.classList.add(r.a.LOADING)}},{key:"makeTotalRowLabel",value:function(){var e=document.createElement("div");return e.className="total_row_wrap",this.totalRowLabel=document.createElement("span"),this.totalRowLabel.classList.add(r.a.LOADING),this.totalRowLabel.className="total_row",this.totalRowLabel.innerText="",e.appendChild(this.totalRowLabel),e}},{key:"makeOrderController",value:function(){var e=document.createElement("div");return e.className="order_controller",e.appendChild(this.makeOrderFieldSelectButton()),e.appendChild(this.makeOrderTypeToggleButton()),e}},{key:"makeOrderFieldSelectButton",value:function(){var e=this,t=document.createElement("div");return t.className="order_field_select_btn",this.orderFieldLabel=document.createElement("span"),t.appendChild(this.orderFieldLabel),this.orderFieldLabel.innerText=this.orderFieldSelectPopup.getSelectedOrderFieldInfo().label,t.addEventListener("click",function(){e.orderFieldSelectPopup.open($(t).offset())}),t}},{key:"makeOrderTypeToggleButton",value:function(){var e=this,t=this.orderTypeToggleBtn=document.createElement("div");return t.className="order_type_toggle_btn",Object(ne.setToolsIcon)(t,ne.ToolsIcon.MOVE_DOWN),t.setAttribute("data-order-type",this.orderType),t.addEventListener("click",function(){je.a.isMobileSize()?e.orderFieldSelectPopup.open($(t).offset()):(e.selectOrderType(e.orderType===Om.b.DESC?Om.b.ASC:Om.b.DESC),e.orderFieldSelectPopup.setOrderType(e.orderType))}),t}},{key:"selectOrderType",value:function(e){this.orderType=e,this.orderTypeToggleBtn.setAttribute("data-order-type",this.orderType),this.orderTypeToggleCallback(this.orderType)}}]),t}(He.a),Bm=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,new Jt(e,Q.a.DESIGN,Do.a.UNICORN)))).openSubPage=n,i.useFavorite=!1,i}return z()(t,e),w()(t,[{key:"getThumbUrlList",value:function(){return this.listItemData.resourceData.pageList.map(function(e){return e.thumb300Url})}},{key:"doAction",value:function(){if(!this.isEditing){var e=this.getThumbUrlList();it.a.isEmpty(e)||e.length<2?he()(F()(t.prototype),"doAction",this).call(this):this.openSubPage(this)}}},{key:"createDddotPopup",value:function(){return new Lm({})}},{key:"makeHoverLayer",value:function(){var e=he()(F()(t.prototype),"makeHoverLayer",this).call(this);e.appendChild(this.makeDddot());var n=this.getThumbUrlList();if(!it.a.isEmpty(n)&&n.length>1){var i=document.createElement("label");i.innerText=String(n.length),i.className=r.a.PAGE_CNT,e.appendChild(i)}return e}},{key:"makeDddot",value:function(){var e=this,t=this.createDddotPopup();t.setOnCloseListener(this);var n=this.dddotBtn=ap.makeDddotBtn(s()(a.a.mark(function i(){var o;return a.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.onOpenDddot(!1);case 2:o=e.listItemData.myCollectionPk,t.openTemplateInfo({designIdx:Number(o.referenceKey),favoritesParam:{useFavorite:!1,myCollectionPk:o},repositoryType:o.repositoryType,offset:$(n).offset()});case 4:case"end":return i.stop()}},i)})));return n}},{key:"render",value:function(){return he()(F()(t.prototype),"render",this).call(this),this.setIsEditing(),this.container}},{key:"setIsEditing",value:function(){var e=le.a.get().getIdx();return e>0&&(this.isEditing=this.listItemData.resourceData.idx===e,this.isEditing&&this.container.classList.add(r.a.EDITING)),this}},{key:"getTitle",value:function(){return this.listItemData.resourceData.title}}]),t}(mm),Vm=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"dispatchTemplateLoadAction",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];X.a.instance.dispatch(new lc.a(e,t,n,i))}},{key:"loadTemplateDesign",value:function(){he()(F()(t.prototype),"loadTemplateDesign",this).call(this,void 0,void 0,!0)}}]),t}(Bm),Um=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).isLoginRequire=!0,e.lib=new Dm({makeListItem:function(t){return e.makeListItem(t)}}),e.lib.setListener(H()(e)),e}return z()(t,e),w()(t,[{key:"setActive",value:function(e){return this.onCreateViewIfNotCreated(),he()(F()(t.prototype),"setActive",this).call(this,e)}},{key:"beforeLoadListAsync",value:function(){this.onCreateViewIfNotCreated(),this.subPagesTool.setVisibility(!1)}},{key:"makeListHeader",value:function(){return this.listHeader=new xm(this.setOrderField.bind(this),this.setOrderType.bind(this)),this.listHeader.onStartView(),this.listHeader.getContainer()}},{key:"setOrderField",value:function(e){this.lib.setOrderField(e),this.loadListSync()}},{key:"setOrderType",value:function(e){this.lib.setOrderType(e),this.loadListSync()}},{key:"makeListSection",value:function(){var e=document.createElement("div");return e.className=r.a.LIST_SECTION,this.paginationListTool.prependElementToScrollContents(this.makeListHeader()),e.appendChild(this.paginationListTool.getContainer()),e.appendChild(this.makeSubPagesTool()),e}},{key:"makeListItem",value:function(e){var t=this;return new(S.a.getExecutionMode().isBizhowsChannelAndOrderPurpose()?Vm:Bm)(e,function(e){return t.openSubPage(e)})}},{key:"addDesignListItem",value:function(e){this.paginationListTool.addItem(this.makeListItem(e)),this.updateListCount()}},{key:"openSubPage",value:function(e){this.subPagesTool.updateUI({listItem:e}),this.subPagesTool.setVisibility(!0)}},{key:"updateListCount",value:function(){this.listHeader.setTotalRow(this.paginationListTool.getTotalRow(),!d.b.isEmpty(this.lib.getKeyword()))}},{key:"onRemoveDesign",value:function(e){this.paginationListTool.removeItem(e)}}]),t}(Ih),Fm=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,{}))).onRemoveDesign=e,n}return z()(t,e),w()(t,[{key:"makeRemoveDesignButton",value:function(){var e=this,t=document.createElement("div");t.className=r.a.BUTTON_WRAP;var n=document.createElement("button");n.innerText="나의 템플릿에서 제거하기",Object(ne.setToolsIcon)(n,ne.ToolsIcon.CLOSE);var i=function(){e.onRemoveDesign&&e.onRemoveDesign(),e.close()};n.addEventListener("click",function(){(new mc.a).setSubtitle("나의 템플릿에서 제거하시겠습니까?").addButton("취소",void 0,!0,Lc.b.DEFAULT,1).addButton("제거하기",i,!0,Lc.b.GRAY,2).activateXCloseButton().activateShowingUpFromBottomOnMobile().show()}),t.appendChild(n),this.contents.appendChild(t)}},{key:"makeElement",value:function(){he()(F()(t.prototype),"makeElement",this).call(this),this.makeRemoveDesignButton()}}]),t}(Lm),Gm=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,e,n))).onRemoveDesign=i,a}return z()(t,e),w()(t,[{key:"createDddotPopup",value:function(){return new Fm(this.onRemoveDesign)}}]),t}(Bm),Hm=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"dispatchTemplateLoadAction",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];X.a.instance.dispatch(new lc.a(e,t,n,i))}},{key:"loadTemplateDesign",value:function(){he()(F()(t.prototype),"loadTemplateDesign",this).call(this,void 0,void 0,!0)}}]),t}(Gm),Wm=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).lib.setDesignRepositoryType(Om.d.BIZHOWS),e.paginationListTool.setListEmptyView(t.makeListEmptyView().getContainer()),e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container=this.makeListSection()}},{key:"loadListSync",value:function(){this.beforeLoadListAsync(),this.listHeader.loading(),this.paginationListTool.initList()}},{key:"onPaginationFinishRender",value:function(e){this.updateListCount()}},{key:"updateListItemThumbnail",value:function(e,t){this.paginationListTool.updateItemThumbnail(e,t)}},{key:"makeListItem",value:function(e){var t=this;return new(S.a.getExecutionMode().isBizhowsChannelAndOrderPurpose()?Hm:Gm)(e,function(e){return t.openSubPage(e)},function(){return t.lib.removeDesign(e.idx)})}}],[{key:"makeListEmptyView",value:function(){return new Pm("앗, 저장한 디자인이 없어요...","<a>비즈하우스</a>에서<br/>미리캔버스로 편집한 디자인은<br/>여기에서 볼 수 있어요!")}}]),t}(Um),zm=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.lib.setDesignRepositoryType(Om.d.MIRICANVAS),this.myDesignEmptyView=this.makeListEmptyView(),this.myDesignEmptyViewForKeyword=this.makeListEmptyViewForKeyword(),this.paginationListTool.setListEmptyView(this.myDesignEmptyView.getContainer()),this.container=this.makeListSection()}},{key:"loadListSync",value:function(){he()(F()(t.prototype),"loadListSync",this).call(this),this.beforeLoadListAsync(),this.reloadDocumentContents()}},{key:"reloadDocumentContents",value:function(){this.listHeader.loading(),this.paginationListTool.initList()}},{key:"makeListEmptyView",value:function(){var e=document.createElement("button");return e.innerText="템플릿으로 이동하기",e.addEventListener("click",function(){return Y.a.instance.editorMainVC.leftPanelMainVC.activePanel(So.b.TEMPLATE_LIB)}),new Pm("앗, 아직 내 디자인이 없어요...","템플릿을 활용하여<br>나만의 디자인을 만들어보세요.",e)}},{key:"makeListEmptyViewForKeyword",value:function(){return new Pm("검색 결과가 없어요...","다른 검색어를 입력해주세요.")}},{key:"onPaginationFinishRender",value:function(e){this.updateListCount()}},{key:"updateListItemThumbnail",value:function(e,t){this.paginationListTool.updateItemThumbnail(e,t)}},{key:"setKeyword",value:function(e){d.b.isEmpty(e)?this.paginationListTool.setListEmptyView(this.myDesignEmptyView.getContainer()):this.paginationListTool.setListEmptyView(this.myDesignEmptyViewForKeyword.getContainer()),this.lib.setKeyword(e),this.reloadDocumentContents()}}]),t}(Um),Km=new(function(){function e(){L()(this,e)}var t;return w()(e,[{key:"fetchMyDesignFolderList",value:(t=s()(a.a.mark(function e(t){var n,i,o,r=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.folderDataCache){e.next=9;break}return n="/api/design/category",e.next=4,m.a.getDefaultSelectedTeamData(f.a.getUser().accountId);case 4:return i=e.sent,e.next=7,ce.b.get("".concat(n,"?").concat($.param(i)));case 7:o=e.sent,this.folderDataCache=o.data;case 9:s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t(r.folderDataCache.slice());case 1:case"end":return e.stop()}},e)}))();case 10:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"sortFolders",value:function(e){return e.sort(function(e,t){return e.name.localeCompare(t.name)})}}]),e}()),Ym=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).paginationListTool.setListEmptyView(new Pm("앗, 폴더가 비어있어요...","내 디자인 분류 및 관리는<br>마이스페이스에서 이용할 수 있어요.").getContainer()),e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.LIBRARY_DESIGN_FOLDER,this.container.appendChild(this.makeHeader()),this.container.appendChild(this.makeBody())}},{key:"loadFolderDesigns",value:function(e){this.folder&&this.folder.idx===e.idx||(this.setFolder(e),this.setActive(!0),this.loadListSync())}},{key:"updateListItemThumbnail",value:function(e,t){}},{key:"setFolder",value:function(e){this.folder=e,this.lib.setDesignCategory(e.idx),this.folderNameLabel.innerText=e.name,this.listHeader.setTotalRow(e.designCount,!1)}},{key:"loadListSync",value:function(){this.beforeLoadListAsync(),this.checkLoginRequire()||this.paginationListTool.initList()}},{key:"makeHeader",value:function(){var e=this,t=document.createElement("div");return t.className="design_folder_header",Object(ne.setToolsIcon)(t,ne.ToolsIcon.MOVE_LEFT).addEventListener("click",function(){return e.closeSelf()}),this.folderNameLabel=document.createElement("span"),t.appendChild(this.folderNameLabel),t}},{key:"makeBody",value:function(){var e=document.createElement("div");return e.className="design_folder_body",e.appendChild(this.makeListSection()),e}},{key:"closeSelf",value:function(){this.container.parentElement&&this.container.parentElement.removeChild(this.container)}}]),t}(Um),Xm=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.myDesignFolderListView=new Ym,this.foldersUl=document.createElement("ul"),this.container.appendChild(new Ce.a(!1,!0,"100%").render(this.foldersUl)),this.enableStyle(!0,this.container,"loading"),Km.fetchMyDesignFolderList(this.onFolderListResult.bind(this))}},{key:"onFolderListResult",value:function(e){var t=this;this.enableStyle(it.a.isEmpty(e),this.container.parentElement,"empty"),it.a.isEmpty(e)?this.container.appendChild(new Pm("앗, 내 폴더가 없어요...","폴더 생성 및 관리는 <br>마이스페이스에서 이용할 수 있어요.").getContainer()):Km.sortFolders(e).forEach(function(e){t.foldersUl.appendChild(t.makeFolderRow(e))}),this.enableStyle(!1,this.container,"loading")}},{key:"makeFolderRow",value:function(e){var t=this,n=document.createElement("li"),i=this.createDivElement("thumb_wrap");if(d.b.isEmpty(e.thumb300Url))Object(ne.setToolsIcon)(i,ne.ToolsIcon.FOLDER_OUTLINE),i.classList.add("empty");else{var a=document.createElement("img");a.src=e.thumb300Url,i.appendChild(a)}n.appendChild(i);var o=this.createDivElement("folder_info_wrap"),s=document.createElement("span");s.className="title",s.innerText=e.name,o.appendChild(s);var r=document.createElement("span");return r.className="design_cnt",r.innerText=String(e.designCount),o.appendChild(r),n.addEventListener("click",function(){return t.onClickFolderList(e)}),n.appendChild(o),n}},{key:"onClickFolderList",value:function(e){this.container.parentElement.parentElement.appendChild(this.myDesignFolderListView.getContainer()),this.myDesignFolderListView.loadFolderDesigns(e)}}]),t}(He.a);!function(e){e.DOCUMENTS="DOCUMENTS",e.FOLDERS="FOLDERS",e.BIZHOWS="BIZHOWS"}(Nm||(Nm={}));var jm=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).tabContents=new Map,e.tabContentsDOM=new Map,e.leftPanelType=So.b.DESIGN_LIB,e.isLoginRequire=!0,e.firstTabMaking=!0,e}var n;return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.LIBRARY_DESIGN,this.container.appendChild(this.makeSearchTool()),this.container.appendChild(this.makeTabMenu())}},{key:"setActive",value:function(e){if(he()(F()(t.prototype),"setActive",this).call(this,e),e){if(this.checkLoginRequire())return;if(this.updateBizhowsTab(),this.firstTabMaking){this.firstTabMaking=!1;var n=f.a.getUser().hasBizAuth&&S.a.getMyDesignPanelOption().defaultBizhowsTab?Nm.BIZHOWS:Nm.DOCUMENTS;this.selectMenu(n)}}return this}},{key:"selectMenu",value:function(e){this.reloadTabMenuId=e,this.tabMenu.select(e);var t=this.makeTabContentsIfNotExist(e);this.tabContents.forEach(function(e){return e.setActive(!1)}),this.tabContentsDOM.get(e).appendChild(t.setActive(!0).getContainer())}},{key:"makeTabContentsIfNotExist",value:function(e){if(!this.tabContents.has(e)){var t;switch(e){case Nm.DOCUMENTS:t=new zm;break;case Nm.FOLDERS:t=new Xm;break;case Nm.BIZHOWS:t=new Wm;break;default:console.error("존재하지 않는 TabMenuId입니다.",e)}this.tabContents.set(e,t)}return this.tabContents.get(e)}},{key:"makeSearchTool",value:function(){var e=this;return this.searchTool=new dh.a(function(t){return e.setKeyword(d.b.nvl(t))},"내 디자인 문서 찾기"),this.searchTool.getContainer()}},{key:"makeTabMenu",value:function(){var e=this;return this.tabContentsDOM.set(Nm.DOCUMENTS,this.createDivElement("document_tab_contents")),this.tabContentsDOM.set(Nm.FOLDERS,this.createDivElement("folder_tab_contents")),this.tabMenu=(new Rm).addItem({button:"문서",contents:this.tabContentsDOM.get(Nm.DOCUMENTS),menuId:Nm.DOCUMENTS,buttonClickEvent:function(){e.selectMenu(Nm.DOCUMENTS)}}).addItem({button:"폴더",contents:this.tabContentsDOM.get(Nm.FOLDERS),menuId:Nm.FOLDERS,buttonClickEvent:function(){e.selectMenu(Nm.FOLDERS)}}),this.makeBizhowsTabMenu(),this.tabMenu.element}},{key:"makeBizhowsTabMenu",value:function(){var e=this;f.a.getUser().hasBizAuth&&(this.tabContentsDOM.set(Nm.BIZHOWS,this.createDivElement("bizhows_tab_contents")),this.tabMenu.addItem({button:"비즈하우스",contents:this.tabContentsDOM.get(Nm.BIZHOWS),menuId:Nm.BIZHOWS,buttonClickEvent:function(){e.selectMenu(Nm.BIZHOWS)}}))}},{key:"setKeyword",value:(n=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=t?t.trim():"",this.searchTool.updateUI(t),d.b.isEmpty(t)?(this.tabMenu.element.classList.remove(r.a.KEYWORDS),this.changeSelectedTab()):(this.lastTabMenuId||(this.lastTabMenuId=this.getActiveTabMenuId()),this.selectMenu(Nm.DOCUMENTS),this.tabMenu.element.classList.add(r.a.KEYWORDS)),this.tabContents.get(Nm.DOCUMENTS).setKeyword(t);case 4:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"getActiveTabMenuId",value:function(){return this.tabMenu.getSelectedButtonId()||Nm.DOCUMENTS}},{key:"changeSelectedTab",value:function(){this.lastTabMenuId&&(this.tabMenu.select(this.lastTabMenuId),this.lastTabMenuId=null)}},{key:"addDesignListItem",value:function(e){this.reloadTabMenuId!==Nm.FOLDERS&&this.tabContents.get(this.reloadTabMenuId).addDesignListItem(e)}},{key:"updateListItemThumbnail",value:function(e,t){this.reloadTabMenuId!==Nm.FOLDERS&&this.tabContents.get(this.reloadTabMenuId).updateListItemThumbnail(e,t)}},{key:"updateBizhowsTab",value:function(){if(this.tabContentsDOM.get(Nm.BIZHOWS)){if(!f.a.getUser().hasBizAuth){var e=Array.from(this.tabMenu.element.querySelectorAll(".button_wrap")).find(function(e){return e.getAttribute("data-menu-id")===Nm.BIZHOWS});e&&e.parentElement&&e.parentElement.removeChild(e);var t=Array.from(this.tabMenu.element.querySelectorAll(".contents_wrap")).find(function(e){return e.getAttribute("data-menu-id")===Nm.BIZHOWS});t&&t.parentElement&&(t.parentElement.removeChild(t),this.tabContentsDOM.delete(Nm.BIZHOWS)),this.selectMenu(Nm.DOCUMENTS)}}else f.a.getUser().hasBizAuth&&!this.tabContentsDOM.get(Nm.BIZHOWS)&&this.makeBizhowsTabMenu()}},{key:"onDataChanged",value:function(e){var t=this;return this.tabContents.forEach(function(n){n.onDataChanged(e),n instanceof Ih&&!n.isLoaded&&t.isActive()&&n.isActive()&&n.setActive(!0)}),this.container}}]),t}(oh),Zm=n(254),qm=n(255),$m=n(353),Qm=n(347),Jm=n(346),ef=n(299),tf=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).success=e,n.input=document.createElement("input"),n.input.type="text",n.input.maxLength=25,n.input.placeholder=t.EMPTY_DIRECTORY_NAME,n.input.value="",n.content=document.createElement("div"),n.cancelBtn=document.createElement("div"),n.confirmBtn=document.createElement("div"),n.descArea=document.createElement("div"),n.initEvent(),n}var n;return z()(t,e),w()(t,[{key:"getContents",value:function(){var e=document.createElement("div");e.className="title",e.innerText="새 폴더 만들기",this.content.appendChild(e);var t=document.createElement("div");t.className="input_wrap",t.appendChild(this.input),this.content.appendChild(t),this.descArea.className="desc_area",this.content.appendChild(this.descArea),this.hideDesc();var n=document.createElement("div");return n.className="button_wrap",this.cancelBtn.innerText="취소",this.confirmBtn.innerText="확인",n.appendChild(this.cancelBtn),n.appendChild(this.confirmBtn),this.content.appendChild(n),this.content}},{key:"showDesc",value:function(e){this.descArea.innerText=e,this.descArea.style.display="block"}},{key:"hideDesc",value:function(){this.descArea.style.display="none"}},{key:"updateUI",value:function(){}},{key:"getId",value:function(){return"createFolderPopup"}},{key:"initEvent",value:function(){var e=this;this.cancelBtn.addEventListener("click",function(){return e.close()}),this.confirmBtn.addEventListener("click",function(){e.input.value?e.createDirectory():e.showDesc("* ".concat(t.EMPTY_DIRECTORY_NAME))}),this.input.addEventListener("keyup",function(t){"Enter"===t.key&&e.confirmBtn.click()})}},{key:"createDirectory",value:(n=s()(a.a.mark(function e(){var t,n,i=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.input.value,n=Zm.c.selectedTeamData,e.next=4,Jm.a.createFolder({name:t,teamIdx:n.teamIdx,teamScope:n.teamScope},function(e){i.success(e),i.close()},function(e){i.errorHandleByStatusCode(e)});case 4:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"errorHandleByStatusCode",value:function(e){switch(e){case 409:this.showDesc("* 동일한 이름의 폴더가 있습니다. 다른 이름을 입력해주세요.");break;case 403:case 401:this.showDesc("* 로그인 세션이 만료되었습니다. 새로고침을 하고 다시 시도해주시기 바랍니다.");break;default:alert("잠시 후에 다시 시도해주시기 바랍니다.")}}},{key:"open",value:function(e){return he()(F()(t.prototype),"open",this).call(this,e),je.a.isIOS()||this.input.focus(),this}}]),t}(u.a);tf.EMPTY_DIRECTORY_NAME="폴더명을 입력해주세요.";var nf,af=n(365),of=function(e){function t(){var e;L()(this,t),e=V()(this,F()(t).call(this,!0));for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e.menus=i||[],e.container.className="menu_list",e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.addEventListener("click",function(e){return e.stopPropagation()}),this.show()}},{key:"clearAll",value:function(){this.menus=[]}},{key:"updateUI",value:function(){var e=this;this.onCreateViewIfNotCreated(),this.container.innerHTML="",this.menus.forEach(function(t){e.container.appendChild(t.getContainer())})}},{key:"addMenu",value:function(e){return this.menus.push(e),this}},{key:"show",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isHide=!1,this.container.style.display="",t&&$(document.body).on("click.menuListPopup",function(){return e.hide()})}},{key:"hide",value:function(){this.isHide=!0,this.container.style.display="none",$(document.body).off("click.menuListPopup")}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isHide?this.show(e):this.hide()}}]),t}(He.a),sf=function(e){function t(){var e;L()(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return V()(this,(e=F()(t)).call.apply(e,[this].concat(i)))}return z()(t,e),w()(t,[{key:"updateUI",value:function(e){he()(F()(t.prototype),"updateUI",this).call(this),this.menus.forEach(function(t){e&&(t===e?t.selectUI():t.unSelectUI())})}}]),t}(of),rf=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,!0))).listener=[],i.folder=e,i.container=document.createElement("div"),i.container.className="folder_menu",void 0!==n&&n===e.idx&&i.container.classList.add("selected"),i}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this);var n=document.createElement("div");n.className="folder_thumb_warp";var i=jt.a.getImageElementWithReplaceableThumbnail();i.className="folder_thumb",void 0!==this.folder.folderThumbnailInfo&&null!==this.folder.folderThumbnailInfo?af.b.instance.thumbnailMaker(this.folder.folderThumbnailInfo.type).setThumbnail(this.folder.folderThumbnailInfo.key,this.folder.folderThumbnailInfo.thumb300Url,i,!0):i.src=Qm.a.defaultFolderImg,n.appendChild(i);var a=document.createElement("span");a.className="folder_name",a.innerHTML=ef.a.beautifyFolderName(this.folder.name,8);var o=document.createElement("div");if(o.className="folder_info",o.appendChild(a),void 0!==this.folder.folderStoreInfo){var s=document.createElement("span");s.className="file_count",s.innerHTML="파일 ".concat(this.folder.folderStoreInfo.fileCount),o.appendChild(s)}else a.classList.add("default_folder");this.container.appendChild(n),this.container.appendChild(o),this.checkIcon=Object(ne.setToolsIcon)(this.container,ne.ToolsIcon.CHECK,!0),this.container.addEventListener("click",function(){e.listener.forEach(function(t){t(e)})})}},{key:"addListener",value:function(e){this.listener.push(e)}},{key:"getData",value:function(){return this.folder}},{key:"selectUI",value:function(){this.container.classList.add("selected"),$(this.checkIcon).show()}},{key:"unSelectUI",value:function(){this.container.classList.remove("selected"),$(this.checkIcon).hide()}}]),t}(He.a),lf=function(e){function t(e,n,i,a,o){var s;return L()(this,t),(s=V()(this,F()(t).call(this))).selectedFolderNameSpan=document.createElement("span"),s.currentFolderNameSpan=document.createElement("span"),s.currentFolderIdx=e,s.photos=n,s.isInFolder=i,s.onSuccess=a,s.scrollElement=new Ce.a(!1,!0,"calc(100% - 152px)"),s.contents=document.createElement("div"),s.contents.className="folder_contents",s.titleElem=document.createElement("div"),s.titleElem.className="folder_title_wrap",s.currentFolderName=o,s.currentFolderNameSpan.className="current_folder",s.selectedFolderNameSpan.className="select_folder",s.currentFolderNameSpan.innerHTML=s.currentFolderName?ef.a.beautifyFolderName(s.currentFolderName):"폴더를 선택해주세요.",s.titleElem.appendChild(s.currentFolderNameSpan),s.makeBtnClose=!1,s.currentFolderName?Object(ne.setToolsIcon)(s.titleElem,ne.ToolsIcon.GREATER_THAN,!0):($(s.currentFolderNameSpan).hide(),s.selectedFolderNameSpan.innerHTML="폴더를 선택해주세요."),s.titleElem.appendChild(s.selectedFolderNameSpan),s.listMenuTool=new sf,s.initElements(),s.updateUI(),s}var n;return z()(t,e),w()(t,[{key:"initElements",value:function(){this.contents.appendChild(this.makeHeaderWrap()),this.contents.appendChild(this.titleElem),this.contents.appendChild(this.scrollElement.render(this.makeList())),this.contents.appendChild(this.createFooterBtnWrap())}},{key:"makeList",value:function(){var e=document.createElement("div");return e.className="upload_directory_list",e.appendChild(this.createMakeDirectoryBtn()),e.appendChild(this.listMenuTool.getContainer()),e}},{key:"makeHeaderWrap",value:function(){var e=this,t=document.createElement("div");t.className="header_wrap",Object(ne.setToolsIcon)(t,ne.ToolsIcon.GREATER_THAN,!0,"left",180).addEventListener("click",function(){return e.close()});var n=document.createElement("div");return n.innerText="폴더 설정",t.appendChild(n),t}},{key:"createFooterBtnWrap",value:function(){var e=document.createElement("div");return e.className="footer_btn_wrap",e.appendChild(this.createCancelBtn()),e.appendChild(this.createConfirmBtn()),e}},{key:"makeWithdrawMenu",value:function(){var e=this,t={idx:0,name:"기본 보관함",accountId:f.a.getUser().accountId,parentIdx:-1},n=new rf(t);return this.listMenuTool.addMenu(n),n.addListener(function(n){e.selectedFolderNameSpan.innerHTML=t.name,e.listMenuTool.updateUI(n),e.selectedFolder=t}),n}},{key:"updateDirectories",value:(n=s()(a.a.mark(function e(t){var n,i=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Zm.c.selectedTeamData,Jm.a.userFolders(n).then(function(e){i.listMenuTool.clearAll(),i.isInFolder&&i.listMenuTool.addMenu(i.makeWithdrawMenu());var n=!0,a=!1,o=void 0;try{for(var s,r=e.data[Symbol.iterator]();!(n=(s=r.next()).done);n=!0){var l=s.value,c=new rf(l,i.currentFolderIdx);i.listMenuTool.addMenu(c),c.addListener(function(e){i.select(e)}),void 0!==t&&t.idx===l.idx&&(i.select(c,l),i.scrollElement.setScrollY(99999999))}}catch(e){a=!0,o=e}finally{try{n||null==r.return||r.return()}finally{if(a)throw o}}i.listMenuTool.updateUI(),i.listMenuTool.show()});case 2:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)})},{key:"select",value:function(e,t){this.selectedFolder=void 0!==t?t:e.getData(),this.selectedFolderNameSpan.innerHTML=ef.a.beautifyFolderName(this.selectedFolder.name),this.confirmBtn.classList.add(r.a.ACTIVE),this.listMenuTool.updateUI(e)}},{key:"getContents",value:function(){return this.contents}},{key:"getId",value:function(){return"folderListPopup"}},{key:"updateUI",value:function(){this.updateDirectories()}},{key:"createMakeDirectoryBtn",value:function(){var e=this,t=document.createElement("div");t.className="create_directory";var n=document.createElement("div");n.className="create_directory_icon",Object(ne.setToolsIcon)(n,ne.ToolsIcon.ADD),t.appendChild(n);var i=document.createElement("div");return i.className="create_directory_label",i.innerText="새 폴더 만들기",t.appendChild(i),t.addEventListener("click",function(){var t=new tf(function(n){e.updateDirectories(n),t.close()});t.open()}),t}},{key:"createCancelBtn",value:function(){var e=this,t=document.createElement("div");return t.className="cancel_btn",t.innerText="취소",t.addEventListener("click",function(){return e.close()}),t}},{key:"createConfirmBtn",value:function(){var e=this,t=this.confirmBtn=document.createElement("div");return t.className="confirm_btn",t.innerText="확인",t.addEventListener("click",s()(a.a.mark(function t(){var n,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.selectedFolder&&e.selectedFolder.idx!==e.currentFolderIdx){t.next=3;break}return e.close(),t.abrupt("return");case 3:if(n=Array.from(e.photos.values()).map(function(e){return e.referenceKey}),i=Zm.c.selectedTeamData,0!==e.selectedFolder.idx){t.next=8;break}return Jm.a.withdrawPhotos(n,e.currentFolderIdx,i,e.onSuccess),t.abrupt("return");case 8:Zm.c.moveImagesToFolder(n,e.selectedFolder.idx,e.onSuccess);case 9:case"end":return t.stop()}},t)}))),t}}]),t}(u.a),cf=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0))).listener=[],n.param=e,n.container.className="menu_checkbox",n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.checkbox=document.createElement("input"),this.checkbox.type="checkbox",this.checkbox.name=this.param.name||"",this.checkbox.value=this.param.value||"",this.checkbox.checked=this.param.checked,this.checkbox.addEventListener("change",function(){e.listener.forEach(function(t){return t(e)})});var n=document.createElement("label");n.appendChild(this.checkbox),Object(ne.setToolsIcon)(n,ne.ToolsIcon.CHECK,!0),this.param.text&&n.appendChild(document.createTextNode(this.param.text)),this.container.appendChild(n)}},{key:"addChangeListener",value:function(e){this.listener.push(e)}},{key:"select",value:function(){this.checkbox.checked=!0}},{key:"deselect",value:function(){this.checkbox.checked=!1}},{key:"isSelected",value:function(){return this.checkbox.checked}},{key:"getValue",value:function(){return this.checkbox.value}}]),t}(He.a),uf=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).content=document.createElement("div"),e.title=document.createElement("div"),e.subTitle=document.createElement("div"),e.cancelBtn=document.createElement("div"),e.confirmBtn=document.createElement("div"),e.directoriesElem=document.createElement("div"),e.selectedDirectoryNameElem=document.createElement("div"),e.scrollElement=new Ce.a(!1,!0,"280px"),e.checkbox=new cf({text:"폴더 설정하기"}),e.listMenuTool=new sf,e.initDom(),e.initEvent(),e}var n,i,o;return z()(t,e),w()(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),w()(t,[{key:"initDom",value:function(){this.title.className="title",this.content.appendChild(this.title),this.subTitle.className="sub_title",this.content.appendChild(this.subTitle),this.content.appendChild(this.checkbox.getContainer()),this.selectedDirectoryNameElem.innerText="폴더를 선택해주세요.",this.selectedDirectoryNameElem.className="name",this.directoriesElem.className="directories",this.directoriesElem.appendChild(this.selectedDirectoryNameElem),this.directoriesElem.appendChild(this.scrollElement.render()),this.content.appendChild(this.directoriesElem);var e=document.createElement("div");e.className="button_wrap",this.cancelBtn.innerText="취소",this.confirmBtn.innerText="복제하기",e.appendChild(this.cancelBtn),e.appendChild(this.confirmBtn),this.content.appendChild(e)}},{key:"initEvent",value:function(){var e=this;this.cancelBtn.addEventListener("click",function(){return t.close()}),this.confirmBtn.addEventListener("click",s()(a.a.mark(function n(){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e.param.folderIdx=e.getSelectedIdx(),Jm.a.copy(e.param).then(function(){t.close(),alert("".concat(e.getScopeString(),"로 복제되었습니다."))}).catch(function(){t.close(),alert("복제에 실패했습니다. 잠시후 다시 시도해주세요.")}),e.complete();case 3:case"end":return n.stop()}},n)}))),this.checkbox.addChangeListener(function(){e.showDirectories(e.checkbox.isSelected())})}},{key:"getContents",value:function(){return this.content}},{key:"getId",value:function(){return"copyUserResourcePopup"}},{key:"updateUI",value:function(){this.title.innerText="".concat(this.getScopeString(),"로 복제"),this.subTitle.innerText="".concat(this.param.fileKeys.length,"개의 파일을 ").concat(this.getScopeString(),"로 복제하시겠습니까?"),this.scrollElement.contents.innerHTML="",this.listMenuTool.updateUI(),this.scrollElement.contents.appendChild(this.listMenuTool.getContainer())}},{key:"initData",value:(o=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.selectedDirectoryNameElem.innerText="폴더를 선택해주세요.",this.selectedCategoryIdx=0,this.checkbox.deselect(),this.showDirectories(!1),e.next=6,this.updateDirectories();case 6:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"updateDirectories",value:(i=s()(a.a.mark(function e(){var t,n,i,o,s,r,l,c,u,d=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Zm.c.selectedTeamData.teamIdx,e.next=3,Jm.a.userFolders({teamIdx:t,teamScope:this.param.scopeToCopy});case 3:for(n=e.sent,this.listMenuTool.clearAll(),i=!0,o=!1,s=void 0,e.prev=8,r=n.data[Symbol.iterator]();!(i=(l=r.next()).done);i=!0)c=l.value,u=new rf(c),this.listMenuTool.addMenu(u),u.addListener(function(e){d.select(e)});e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),o=!0,s=e.t0;case 16:e.prev=16,e.prev=17,i||null==r.return||r.return();case 19:if(e.prev=19,!o){e.next=22;break}throw s;case 22:return e.finish(19);case 23:return e.finish(16);case 24:this.listMenuTool.updateUI(),this.listMenuTool.show();case 26:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23]])})),function(){return i.apply(this,arguments)})},{key:"select",value:function(e){this.selectedCategoryIdx=e.getData().idx,this.selectedDirectoryNameElem.innerText=e.getData().name,this.listMenuTool.updateUI(e),this.updateUI()}},{key:"getScopeString",value:function(){return this.param.scopeToCopy===mu.b.TEAM?"팀 파일":"개인 파일"}},{key:"showDirectories",value:function(e){this.directoriesElem.style.display=e?"":"none"}},{key:"getSelectedIdx",value:function(){return this.checkbox.isSelected()?this.selectedCategoryIdx:0}}],[{key:"open",value:(n=s()(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.instance.param=t,this.instance.complete=n,e.next=4,this.instance.initData();case 4:this.instance.open();case 5:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"close",value:function(){this.instance.close(),this._instance=null}}]),t}(u.a),df=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0))).listener=[],n.param=e,n.value=n.param.value||"",n.text=n.param.text,n.container.className="menu_checkbox",n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.radio=document.createElement("input"),this.radio.type="radio",this.radio.name=this.param.name||"",this.radio.value=this.param.value||"",this.radio.checked=this.param.checked,this.radio.addEventListener("change",function(){e.listener.forEach(function(t){return t(e)})});var n=document.createElement("label");n.appendChild(this.radio),Object(ne.setToolsIcon)(n,ne.ToolsIcon.CHECK,!0),n.appendChild(document.createTextNode(this.param.text)),this.container.appendChild(n)}},{key:"select",value:function(){this.radio.checked=!0}},{key:"deselect",value:function(){this.radio.checked=!1}},{key:"setSelect",value:function(e){e?this.select():this.deselect()}},{key:"isSelected",value:function(){return he()(F()(t.prototype),"onCreateViewIfNotCreated",this).call(this),this.radio.checked}},{key:"getValue",value:function(){return this.value}},{key:"getText",value:function(){return this.text}},{key:"addChangeListener",value:function(e){this.listener.push(e)}}]),t}(He.a),hf=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getSelectedMenu",value:function(){return this.menus.filter(function(e){return e.isSelected()})[0]}},{key:"setSelectMenu",value:function(e){return this.menus.forEach(function(t){return t.setSelect(e===t.getValue())}),this.menus.some(function(t){return t.getValue()===e})}}]),t}(of),pf=function(e){function t(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return L()(this,t),(i=V()(this,F()(t).call(this,!0))).listener=[],i.name=e,i.params=n,i.isAutoClose=a,i.container.className="radio_select_tool",i}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.selectedText=document.createElement("div"),this.selectedText.className="selected_text",this.container.appendChild(this.selectedText),this.radioListTool=new hf,this.updateUI(this.name,this.params),this.radioListTool.hide(),this.container.appendChild(this.radioListTool.getContainer()),this.container.addEventListener("click",function(t){t.stopPropagation(),e.radioListTool.toggle(e.isAutoClose)})}},{key:"addChangeEventListener",value:function(e){this.listener.push(e)}},{key:"getSelectedMenu",value:function(){return this.radioListTool.getSelectedMenu()}},{key:"setSelectMenu",value:function(e){this.radioListTool.setSelectMenu(e.value)&&this.updateSelectedText(e.text)}},{key:"updateSelectedText",value:function(e){this.selectedText.innerText=e}},{key:"updateUI",value:function(e,t){var n=this;this.radioListTool.clearAll();for(var i=t.filter(function(e){return e.isSelected}),a=i.length>0?i[i.length-1]:null,o=0;o<t.length;o++){var s=t[o],r=a?a===s:0===o,l=new df({name:e,value:s.value,text:s.text,checked:r});r&&this.updateSelectedText(l.getText()),l.addChangeListener(function(e){n.setSelectMenu({value:e.getValue(),text:e.getText(),isSelected:e.isSelected()}),n.listener.forEach(function(t){return t(e)}),n.radioListTool.hide()}),this.radioListTool.addMenu(l)}this.radioListTool.updateUI()}}]),t}(He.a),mf=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,!0))).toolTips=[],i.myImagePanelVC=e,i.folderName=n,i}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){this.container=this.createDivElement("upload_header"),void 0!==this.folderName&&(this.titleBar=this.makeTitleBar(),this.container.append(this.titleBar)),this.buttonsRightWrap=this.createDivElement("upload_header_right_button_wrap"),this.appendButtonsRight(),this.container.append(this.buttonsRightWrap),this.buttonsLeftWrap=this.createDivElement("upload_header_left_button_wrap"),this.appendButtonsLeft(),this.container.append(this.buttonsLeftWrap),this.makeTooltips(),this.disableAllButtons()}},{key:"makeTitleBar",value:function(){var e=this,t=this.createDivElement("header_title_wrap"),n=this.makeButton(ne.ToolsIcon.MOVE_LEFT,null,"back_button",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.myImagePanelVC.renderDefaultMain();case 1:case"end":return t.stop()}},t)})));return t.appendChild(n),this.titleSpan=document.createElement("span"),this.titleSpan.className="folder_title",this.titleSpan.innerHTML=ef.a.beautifyFolderName(this.folderName,14),t.appendChild(this.titleSpan),t}},{key:"makeButton",value:function(e,t,n,i){var a=document.createElement("div");if(a.classList.add(n),t){var o=document.createElement("span");o.innerText=t,a.appendChild(o)}return null!=e&&Object(ne.setToolsIcon)(a,e),a.addEventListener("click",function(){i&&i()}),a}},{key:"disableButtonByCount",value:function(e,t){e.classList.toggle("disabled",0===t)}},{key:"destroy",value:function(){he()(F()(t.prototype),"destroy",this).call(this),this.toolTips.forEach(function(e){e.dispose()})}}]),t}(He.a),ff=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,e,n))).orderFieldOptions=[{value:Zm.b.CREATE_DATE,text:"등록일"},{value:Zm.b.NAME,text:"이름"},{value:Zm.b.SIZE,text:"크기"}],i}return z()(t,e),w()(t,[{key:"disableAllButtons",value:function(){this.disableButtonByCount(this.selectBtn,0),this.disableButtonByCount(this.orderBtnWrap,0)}},{key:"updateUIAfterListLoad",value:function(e){this.disableButtonByCount(this.selectBtn,e),this.disableButtonByCount(this.orderBtnWrap,e),this.updateOrderButtons()}},{key:"makeTooltips",value:function(){this.toolTips.push(new Le.a(this.selectBtn,Ge.a.T,{title:{name:"선택모드"}}))}},{key:"appendButtonsRight",value:function(){var e=this;this.selectBtn=this.makeButton(ne.ToolsIcon.CHECK_BOX,null,"upload_header_button",function(){e.myImagePanelVC.changeModeAndRender(bf.SELECT_MODE)}),this.buttonsRightWrap.appendChild(this.selectBtn)}},{key:"appendButtonsLeft",value:function(){var e=this;this.orderBtnWrap=document.createElement("div"),this.orderBtnWrap.className="order_btn_wrap",this.orderFieldOptions[0].isSelected=!0,this.orderFieldSelect=new pf("orderField",this.orderFieldOptions,!0),this.orderBtnWrap.appendChild(this.orderFieldSelect.getContainer()),this.orderArrowBtn=Object(ne.setToolsIcon)(this.orderBtnWrap,ne.ToolsIcon.ARROW_DOWN,!0),this.orderArrowBtn.addEventListener("click",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.orderArrowBtn.classList.contains("asc")?e.orderArrowBtn.classList.remove("asc"):e.orderArrowBtn.classList.add("asc"),Zm.c.clickOrderByButton(e.orderArrowBtn.classList.contains("asc")),e.myImagePanelVC.toDefaultModeAndLoadList();case 3:case"end":return t.stop()}},t)}))),this.orderFieldSelect.addChangeEventListener(function(){var t=s()(a.a.mark(function t(n){var i,o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.getValue()){t.next=3;break}return t.abrupt("return");case 3:t.t0=i,t.next=t.t0===Zm.b.NAME?6:t.t0===Zm.b.CREATE_DATE?9:t.t0===Zm.b.SIZE?9:12;break;case 6:return e.orderArrowBtn.classList.add("asc"),o=Zm.a.ASC,t.abrupt("break",12);case 9:return e.orderArrowBtn.classList.remove("asc"),o=Zm.a.DESC,t.abrupt("break",12);case 12:Zm.c.changeOrderBy(o,i),e.myImagePanelVC.toDefaultModeAndLoadList();case 14:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),this.buttonsLeftWrap.appendChild(this.orderBtnWrap)}},{key:"updateOrderButtons",value:function(){this.orderFieldOptions.forEach(function(e){e.isSelected=e.value===Zm.c.orderField});var e=this.orderFieldOptions.find(function(e){return e.isSelected});this.orderFieldSelect.setSelectMenu(e),Zm.c.orderBy===Zm.a.ASC?this.orderArrowBtn.classList.add("asc"):this.orderArrowBtn.classList.remove("asc")}}]),t}(mf),vf=n(326),gf=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this,e,i))).teamScope=n,o.isIndividual=a,o}return z()(t,e),w()(t,[{key:"disableAllButtons",value:function(){this.disableButtonByCount(this.moveBtn,0),this.disableButtonByCount(this.deleteBtn,0),this.disableButtonByCount(this.copyToIndividualScope,0),this.disableButtonByCount(this.copyToTeamScope,0),this.teamScope&&!this.isIndividual&&this.toggleCopyToScopeButtonsVisibility(this.teamScope),this.allSelectBtn.classList.toggle("checked_icon",!1)}},{key:"makeTooltips",value:function(){this.toolTips.push(new Le.a(this.moveBtn,Ge.a.T,{title:{name:"폴더이동"}})),this.toolTips.push(new Le.a(this.deleteBtn,Ge.a.T,{title:{name:"휴지통에 넣기"}})),this.toolTips.push(new Le.a(this.copyToTeamScope,Ge.a.T,{title:{name:"팀 파일로 복제"}})),this.toolTips.push(new Le.a(this.copyToIndividualScope,Ge.a.T,{title:{name:"내 파일로 복제"}}))}},{key:"appendButtonsLeft",value:function(){var e=this;this.selectCounterWrap=document.createElement("div"),this.allSelectBtn=Object(ne.setToolsIcon)(this.selectCounterWrap,ne.ToolsIcon.CHECK,!0),this.allSelectBtn.classList.add("all_select"),this.allSelectBtn.addEventListener("click",function(){e.allSelectBtn.classList.contains("checked_icon")?(e.allSelectBtn.classList.remove("checked_icon"),e.myImagePanelVC.onClickUnselectAll()):(e.allSelectBtn.classList.add("checked_icon"),e.myImagePanelVC.onClickSelectAll())}),this.countSpan=document.createElement("span"),this.countSpan.className="count_info",this.countSpan.innerHTML="0개",this.selectCounterWrap.appendChild(this.countSpan),this.buttonsLeftWrap.appendChild(this.selectCounterWrap)}},{key:"appendButtonsRight",value:function(){var e=this;this.moveBtn=this.makeButton(ne.ToolsIcon.MOVE_FOLDER_OUTLINE,null,"upload_header_button",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.myImagePanelVC.onClickHeaderMoveButton(Zm.c.checkedData);case 1:case"end":return t.stop()}},t)}))),this.moveBtn.classList.add("disabled"),this.buttonsRightWrap.appendChild(this.moveBtn),this.deleteBtn=this.makeButton(ne.ToolsIcon.DELETE_OUTLINE,null,"upload_header_button",function(){e.myImagePanelVC.toDefaultModeAndLoadList(!1),Zm.c.updateStatusCheckedData(vf.a.INACTIVE)}),this.deleteBtn.classList.add("disabled"),this.buttonsRightWrap.appendChild(this.deleteBtn),this.cancelBtn=this.makeButton(ne.ToolsIcon.CLOSE,null,"upload_header_button",function(){e.myImagePanelVC.changeModeAndRender(bf.DEFAULT_MODE)}),this.cancelBtn.classList.add("cancel"),this.buttonsRightWrap.appendChild(this.cancelBtn),this.copyToTeamScope=this.makeButton(ne.ToolsIcon.GROUP_OUTLINE,null,"upload_header_button",function(){Zm.c.clickCopyToScope()}),this.copyToTeamScope.style.display="none",this.buttonsRightWrap.prepend(this.copyToTeamScope),this.copyToIndividualScope=this.makeButton(ne.ToolsIcon.RECEIVE,null,"upload_header_button",function(){Zm.c.clickCopyToScope()}),this.copyToIndividualScope.style.display="none",this.buttonsRightWrap.prepend(this.copyToIndividualScope)}},{key:"onSelectCheckBox",value:function(e,t){this.disableButtonByCount(this.deleteBtn,e),this.disableButtonByCount(this.moveBtn,e),this.disableButtonByCount(this.copyToTeamScope,e),this.disableButtonByCount(this.copyToIndividualScope,e),this.allSelectBtn.classList.toggle("checked_icon",0!==t&&e===t),this.countSpan.innerHTML="".concat(e,"개")}},{key:"onSelectTeamScope",value:function(e){this.toggleCopyToScopeButtonsVisibility(e)}},{key:"toggleCopyToScopeButtonsVisibility",value:function(e){this.copyToTeamScope.style.display=e===mu.b.INDIVIDUAL?"block":"none",this.copyToIndividualScope.style.display=e===mu.b.INDIVIDUAL?"none":"block"}}]),t}(mf),Ef=function(e){function t(e,n){return L()(this,t),V()(this,F()(t).call(this,e,void 0,n))}return z()(t,e),w()(t,[{key:"disableAllButtons",value:function(){this.disableButtonByCount(this.restoreBtn,0),this.disableButtonByCount(this.permanentDelBtn,0),this.allSelectBtn.classList.toggle("checked_icon",!1)}},{key:"makeTooltips",value:function(){this.toolTips.push(new Le.a(this.restoreBtn,Ge.a.T,{title:{name:"복원하기"}})),this.toolTips.push(new Le.a(this.permanentDelBtn,Ge.a.T,{title:{name:"영구삭제"}}))}},{key:"appendButtonsRight",value:function(){var e=this;this.restoreBtn=this.makeButton(ne.ToolsIcon.RESTORE,null,"upload_header_button",function(){Zm.c.updateStatusCheckedData(vf.a.ACTIVE)}),this.restoreBtn.classList.add("disabled"),this.buttonsRightWrap.appendChild(this.restoreBtn),this.permanentDelBtn=this.makeButton(ne.ToolsIcon.DELETE_OUTLINE,null,"upload_header_button",function(){e.myImagePanelVC.promptPermanentDeletion()}),this.permanentDelBtn.classList.add("disabled"),this.buttonsRightWrap.appendChild(this.permanentDelBtn)}},{key:"onSelectCheckBox",value:function(e,t){this.disableButtonByCount(this.restoreBtn,e),this.disableButtonByCount(this.permanentDelBtn,e),this.allSelectBtn.classList.toggle("checked_icon",e===t),this.countSpan.innerHTML="".concat(e,"개")}}]),t}(gf),yf=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0))).myImagePanelVC=e,n.currentToolBar=new ff(n.myImagePanelVC),n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.appendChild(this.currentToolBar.getContainer())}},{key:"updateToolBarView",value:function(){this.container.replaceChild(this.currentToolBar.getContainer(),this.container.childNodes[0])}},{key:"changeToolbarView",value:function(e,t){var n;if(Zm.c.folderMap.has(t)&&(n=Zm.c.folderMap.get(t).name),this.currentToolBar.destroy(),e===bf.DEFAULT_MODE)this.currentToolBar=new ff(this.myImagePanelVC,n);else if(e===bf.SELECT_MODE){var i=Zm.c.selectedTeamData.teamScope,a=1===m.a.getSelectedTeam().memberList.length;this.myImagePanelVC.isInRecycleBin()?this.currentToolBar=new Ef(this.myImagePanelVC,n):this.currentToolBar=new gf(this.myImagePanelVC,i,n,a)}this.container.append(this.currentToolBar.getContainer())}},{key:"updateUIAfterLoadList",value:function(e){this.currentToolBar instanceof ff&&this.currentToolBar.updateUIAfterListLoad(e),this.updateToolBarView()}},{key:"onSelectCheckBox",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zm.c.totalItemCount;this.currentToolBar instanceof gf&&this.currentToolBar.onSelectCheckBox(e,t),this.updateToolBarView()}},{key:"toggleCopyBtn",value:function(e){this.currentToolBar instanceof gf&&this.currentToolBar.onSelectTeamScope(e)}}]),t}(He.a),Tf=n(320),If=n(328),Cf=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,i))).folderIdx=e,a.folderName=n,a.originalName=n,a.input.value=n,a}var n;return z()(t,e),w()(t,[{key:"createDirectory",value:(n=s()(a.a.mark(function e(){var t,n,i,o=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.input.value,this.originalName!==t){e.next=4;break}return this.close(),e.abrupt("return");case 4:return n=Zm.c.selectedTeamData,i={idx:this.folderIdx,name:t,teamIdx:n.teamIdx,teamScope:n.teamScope},e.next=8,Jm.a.changeName(i,function(e){o.success(e),o.close()},function(e){o.errorHandleByStatusCode(e)});case 8:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"getContents",value:function(){var e=document.createElement("div");e.className="title",e.innerText="폴더 이름 바꾸기",this.content.appendChild(e);var t=document.createElement("div");t.className="input_wrap",t.appendChild(this.input),this.content.appendChild(t),this.descArea.className="desc_area",this.content.appendChild(this.descArea),this.hideDesc();var n=document.createElement("div");return n.className="button_wrap",this.cancelBtn.innerText="취소",this.confirmBtn.innerText="확인",n.appendChild(this.cancelBtn),n.appendChild(this.confirmBtn),this.content.appendChild(n),this.content}}]),t}(tf);!function(e){e.SHARED_INFO="shared_info",e.ACCOUNT_NAME="account_name",e.FILE_THUMB_WRAP="file_thumb_wrap",e.FILE_THUMB="file_thumb",e.FOLDER_THUMB_WRAP="folder_thumb_wrap",e.FOLDER_THUMB="folder_thumb"}(nf||(nf={}));var kf=function(){function e(){L()(this,e)}return w()(e,[{key:"createElementWithName",value:function(e,t){return this.createElement(e,t,void 0)}},{key:"createElementWithText",value:function(e,t){return this.createElement(e,void 0,t)}},{key:"createElement",value:function(e,t,n){var i=document.createElement(e);return t&&(i.className=t),n&&(i.innerText=n),i}},{key:"makeProfileElem",value:function(e){var t=this.createElementWithName("div",nf.SHARED_INFO),n=this.createElement("span",nf.ACCOUNT_NAME,e);return Object(ne.setToolsIcon)(n,ne.ToolsIcon.USER_PROFILE),t.appendChild(n),t}},{key:"appendFolderInfo",value:function(e,t){var n=ef.a.beautifyFolderName(t.name,14);if(e.appendChild(this.createElementWithText("header",n)),t.folderStoreInfo){var i=ef.a.getSizeDescription(t.folderStoreInfo.fileSize),a="".concat(t.folderStoreInfo.fileCount,"개의 파일 / ").concat(i);e.appendChild(this.createElementWithText("span",a))}}}]),e}(),Lf=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).toDefaultModeOnClick=e,n}return z()(t,e),w()(t,[{key:"makeThumbnailWrap",value:function(e){var t=this.createElementWithName("div",nf.FILE_THUMB_WRAP),n=jt.a.getImageElementWithReplaceableThumbnail();return n.className=nf.FILE_THUMB,e.uuidKey?af.b.instance.thumbnailMaker(e.type).setThumbnail(e.uuidKey,e.thumb300Url,n,!1):n.src=Qm.a.defaultFolderImg,t.appendChild(n),t}},{key:"makeInfoLayer",value:function(e,t){var n=this,i=this.createElementWithName("div",r.a.FILE_INFO_LAYER),o=this.createElementWithName("div",r.a.FILE_INFO),l=ef.a.beautifyFileName(e.filename);o.appendChild(this.createElementWithText("header",l));var c=Nn.a.createFromObject(JSON.parse(e.fileMeta));if(c&&c.hasArea()){var u=ef.a.getSizeDescription(e.fileSize),d="".concat(c.width," px × ").concat(c.height," px / ").concat(u);o.appendChild(this.createElementWithText("span",d))}t&&o.appendChild(this.makeProfileElem(e.accountName));var h=this.createElementWithName("div",r.a.FILE_MENU);Object(ne.setToolsIcon)(h,ne.ToolsIcon.DOWNLOAD),h.appendChild(this.createElementWithText("span","원본 다운로드")),h.addEventListener("click",function(){try{Tf.a.downloadByFileUrl(e.originUrl)}catch(e){console.warn(e)}});var p=this.createElementWithName("div",r.a.FILE_MENU);return Object(ne.setToolsIcon)(p,ne.ToolsIcon.DELETE),p.appendChild(this.createElementWithText("span","휴지통에 넣기")),p.addEventListener("click",s()(a.a.mark(function t(){var i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=e.type===If.a.USER_IMAGE?Q.a.PHOTO:Q.a.SVG,n.toDefaultModeOnClick(!1),Zm.c.updateStatus([{key:e.uuidKey,type:i}],vf.a.INACTIVE),Zm.c.removeUserFile(e);case 4:case"end":return t.stop()}},t)}))),i.appendChild(o),i.appendChild(h),i.appendChild(p),i}}]),t}(kf),_f=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).toDefaultModeOnClick=e,n}return z()(t,e),w()(t,[{key:"makeThumbnailWrap",value:function(e){var t=this.createElementWithName("div",nf.FOLDER_THUMB_WRAP),n=jt.a.getImageElementWithReplaceableThumbnail();return n.className=nf.FOLDER_THUMB,void 0!==e.folderThumbnailInfo&&null!==e.folderThumbnailInfo?af.b.instance.thumbnailMaker(e.folderThumbnailInfo.type).setThumbnail(e.folderThumbnailInfo.key,e.folderThumbnailInfo.thumb300Url,n,!0):n.src=Qm.a.defaultFolderImg,t.appendChild(n),t}},{key:"makeInfoLayer",value:function(e,t){var n=this,i=this.createElementWithName("div",r.a.FILE_INFO_LAYER),o=this.createElementWithName("div",r.a.FILE_INFO);o.appendChild(this.makeThumbnailWrap(e)),this.appendFolderInfo(o,e),t&&e.accountName&&o.appendChild(this.makeProfileElem(e.accountName));var l=this.createElementWithName("div",r.a.FILE_MENU);Object(ne.setToolsIcon)(l,ne.ToolsIcon.PENCIL),l.appendChild(this.createElementWithText("span","이름 변경")),l.addEventListener("click",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:new Cf(e.idx,e.name,s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.toDefaultModeOnClick();case 1:case"end":return e.stop()}},e)}))).open();case 2:case"end":return t.stop()}},t)})));var c=this.createElementWithName("div",r.a.FILE_MENU);return Object(ne.setToolsIcon)(c,ne.ToolsIcon.DELETE),c.appendChild(this.createElementWithText("span","휴지통에 넣기")),c.addEventListener("click",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.toDefaultModeOnClick(!1),Zm.c.updateStatus([{key:String(e.idx),type:Q.a.USER_FOLDER}],vf.a.INACTIVE);case 2:case"end":return t.stop()}},t)}))),i.appendChild(o),i.appendChild(l),i.appendChild(c),i}}]),t}(kf),wf=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this))).onClickPermanentDeleteButton=e,i.toDefaultModeOnClick=n,i}return z()(t,e),w()(t,[{key:"makeInfoLayer",value:function(e,t){var n=this,i=this.createElementWithName("div",r.a.FILE_INFO_LAYER),o=this.createElementWithName("div",r.a.FILE_INFO);this.appendFolderInfo(o,e);var l=this.createElementWithName("div",r.a.FILE_MENU);Object(ne.setToolsIcon)(l,ne.ToolsIcon.RESTORE),l.appendChild(this.createElementWithText("span","전체 복원하기")),l.addEventListener("click",s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.toDefaultModeOnClick(!1),Zm.c.updateStatusAll(vf.a.ACTIVE);case 2:case"end":return e.stop()}},e)})));var c=this.createElementWithName("div",r.a.FILE_MENU);return Object(ne.setToolsIcon)(c,ne.ToolsIcon.DELETE_OUTLINE),c.appendChild(this.createElementWithText("span","전체 영구삭제")),c.addEventListener("click",s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.onClickPermanentDeleteButton(!0);case 1:case"end":return e.stop()}},e)}))),i.appendChild(o),i.appendChild(l),i.appendChild(c),i}}]),t}(kf),Sf=function(){function e(){L()(this,e)}return w()(e,[{key:"maker",value:function(e,t,n){return e.extraData.isRecycleBin?new wf(t,n):e.key.resourceType===Q.a.USER_FOLDER?new _f(n):new Lf(n)}}]),e}();Sf.instance=new Sf;var bf,Rf=function(){function e(){L()(this,e)}return w()(e,[{key:"getTitle",value:function(){return this.title}},{key:"setTitle",value:function(e){return this.title=e,this}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(e){return this.content=e,this}},{key:"getImgUrl",value:function(){return this.imgUrl}},{key:"setImgUrl",value:function(e){return this.imgUrl=e,this}},{key:"getClassName",value:function(){return this.className}},{key:"setClassName",value:function(e){return this.className=e,this}},{key:"getOnClickListener",value:function(){return this.onClickListener}},{key:"setOnClickListener",value:function(e){return this.onClickListener=e,this}}]),e}(),Af=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this.container;e.className="lib_banner";var t=this.titleElement=document.createElement("div");t.className="banner_title",e.appendChild(t);var n=this.contentElement=document.createElement("div");n.className="banner_content",e.appendChild(n);var i=this.imgElement=document.createElement("img");i.className="banner_img",e.appendChild(i),Object(ne.setToolsIcon)(e,ne.ToolsIcon.GREATER_THAN,!0)}},{key:"setContent",value:function(e){this.onCreateViewIfNotCreated(),this.titleElement.innerText=e.getTitle(),this.contentElement.innerText=e.getContent(),this.imgElement.src=e.getImgUrl(),this.container.className="lib_banner ".concat(e.getClassName()?e.getClassName():""),$(this.container).off("click").on("click",e.getOnClickListener())}}]),t}(He.a),Of=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}var n;return z()(t,e),w()(t,[{key:"justifyRow",value:(n=s()(a.a.mark(function e(t){var n,i,o,s,l,c,u,d,h,p,m=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(e,t){if(void 0===t)return e.li.classList.contains("folder");var n=e.li.classList.contains("folder"),i=t.li.classList.contains("folder");return n&&!i},i=[],0!==t.length){e.next=4;break}return e.abrupt("return",i);case 4:o=0,s=0,!1,c=hh.c.MIN_WIDTH/this.option.defaultRowHeight;case 8:if(it.a.isEmpty(t)){e.next=41;break}return u=t.shift(),d=void 0,e.prev=11,e.next=14,this.makeListItem(u,c);case 14:d=e.sent,e.next=21;break;case 17:return e.prev=17,e.t0=e.catch(11),console.error(e.t0),e.abrupt("continue",8);case 21:if(l){e.next=27;break}return o=(l=d).ratio*this.option.defaultRowHeight,this.option.rowWidth<o,i.push(l),e.abrupt("continue",8);case 27:if(!n(i[i.length-1],d)){e.next=30;break}return t.unshift(u),e.abrupt("break",41);case 30:if(i.push(d),h=d.ratio*this.option.defaultRowHeight,o+=h,s+=this.option.horizonMargin,!(this.option.rowWidth<o+s)){e.next=39;break}return!0,o+s-this.option.rowWidth>(h+this.option.horizonMargin)/2&&(t.unshift(d.li),i.pop(),o-=h,s-=this.option.horizonMargin),e.abrupt("break",41);case 39:e.next=8;break;case 41:return p=(this.option.rowWidth-s)/o*this.option.defaultRowHeight,i.forEach(function(e){var t=m.option.horizonMargin;e===l?(t=0,e.li.classList.add(r.a.CLEAR_BOTH)):e.li.classList.remove(r.a.CLEAR_BOTH),e.li.classList.contains("folder")&&(p=m.option.defaultRowHeight);var n=p*e.ratio,i=p.toFixed(3),a="width:".concat(n.toFixed(3),"px; height:").concat(i,"px; margin-right:0; margin-left:").concat(t,"px");e.li.setAttribute("style",a),Number(i)<hh.c.SHORT_HEIGHT&&e.li.classList.add(r.a.SHORT)}),e.abrupt("return",i);case 44:case"end":return e.stop()}},e,this,[[11,17]])})),function(e){return n.apply(this,arguments)})},{key:"appendAndReOrder",value:function(e){var t=this.liRenderFunc(e),n=[t],i=[],a=[],o=null;if(this.option){for(var s=0;s<this.ul.children.length;s++){var r=this.ul.children.item(s);r.classList.contains("folder")?i.push(r):(null===o&&(o=r),a.push(r))}var l=i.concat(n).concat(a);this._justify(l,!1)}null!==o?o.before(t):$(this.ul).append(t)}}]),t}(hh.c),Pf=n(125),Df=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this,Of,e,n,i,null))).listToolInitParam=e,o.paginationMode=i,o.getEmptyListView=a,o}var n;return z()(t,e),w()(t,[{key:"makeElement",value:function(){}},{key:"setLibBanner",value:function(e){if(e||!this.libBannerView){if(!this.libBannerView){var t=(new Rf).setTitle("이미지 수정이 필요하나요?").setContent("보정, 누끼, 합성 등 요청하기").setImgUrl("".concat(fs.a.RESOURCE_DOMAIN,"image/library/my_image_banner.png")).setOnClickListener(function(){return Pf.a.submitToUrlAfterCheckingUserAuth("http://www.bizhows.com/mall/option/design_request_option.jsp?site_map_idx=26930&pog_seq=995")});this.libBannerView=new Af,this.libBannerView.setContent(t)}this.libBannerView.getContainer().parentElement||this.prependElementToScrollContents(this.libBannerView.getContainer())}else this.libBannerView.detachContainer()}},{key:"justifyList",value:(n=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.scrollElement.setScrollY(0),e.next=3,he()(F()(t.prototype),"justifyList",this).call(this);case 3:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"doRequestAction",value:function(){$(this.container).children("."+r.a.EMPTY_LIST_NOTI_LAYER).remove(),this.setLibBanner(!1),he()(F()(t.prototype),"doRequestAction",this).call(this)}},{key:"setPaginationListResponse",value:function(e,n,i){var a=this;he()(F()(t.prototype),"setPaginationListResponse",this).call(this,e,n,i),this.setLibBanner(e.activeLibBanner),this.hasNextPage=!it.a.isEmpty(e.listItemParams)&&n.page*n.pageSize<e.totalRow,this.listTool.setUpdateUIParam({list:e.listItemParams,isAppend:!0,loadingBoxes:i},function(){return a.onJustifiedListViewRendered(e)})}},{key:"onJustifiedListViewRendered",value:function(e){he()(F()(t.prototype),"onJustifiedListViewRendered",this).call(this,e),this.renderEmptyListView(0===e.listItemParams.filter(function(e){return!e.extraData.isRecycleBin&&!e.extraData.isAddFolderBin}).length)}},{key:"renderEmptyListView",value:function(e){1===this.paginationParam.page&&e&&this.container.appendChild(this.getEmptyListView())}},{key:"prependItem",value:function(e){$(this.container).children("."+r.a.EMPTY_LIST_NOTI_LAYER).remove(),this.listTool.prependItem(e)}},{key:"appendPhoto",value:function(e){$(this.container).children("."+r.a.EMPTY_LIST_NOTI_LAYER).remove(),this.listTool.appendAndReOrder(e)}},{key:"getCurrentPaginationParam",value:function(){return this.pagination.getPaginationParam()}}]),t}(fh),Mf=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0))}return z()(t,e),w()(t,[{key:"makeListItemThumb",value:function(e){var t=it.a.isEmpty(e.thumbList)?null:e.thumbList[0];return this.makeListItemThumbProcess(e.key.referenceKey,t,e.key.resourceType)}},{key:"makeListItemThumbProcess",value:function(e,t,n){var i=af.b.instance.thumbnailMaker(n).makeThumbnail(e,t);return i.onload=function(){Zm.c.onloadThumbnail(e,i.width,i.height)},i}},{key:"attachImageObserver",value:function(e){var t=new IntersectionObserver(function(n){n.forEach(function(n){n.isIntersecting&&(e.src=e.dataset.src,e.classList.add(r.a.ACTIVE),t.unobserve(e))})});t.observe(e)}}]),t}(He.a),Nf=function(){function e(){L()(this,e)}return w()(e,null,[{key:"makeUserFolderDiv",value:function(e,t,n){var i=this.createElement("div","background_wrap"),a=this.createElement("div","background","one");i.appendChild(a);var o=this.createElement("div","background","two");i.appendChild(o);var s=this.createElement("div","background","three");e.className="thumb_nail",t&&e.classList.add("default"),s.appendChild(e);var r=this.createElement("div","thumb_nail_cover","background");if(s.appendChild(r),void 0!==n){var l=this.createElement("span","file_count");l.innerHTML="".concat(n),s.appendChild(l)}return i.appendChild(s),i}},{key:"createElement",value:function(e,t,n){var i=document.createElement(e);return i.className=t,n&&i.classList.add(n),i}}]),e}(),xf=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this))).listItemParam=e,a.makeHoverLayer=n,a.onFolderClick=i,a.folder=Zm.c.folderMap.get(+e.key.referenceKey),a.fileCount=a.folder.folderStoreInfo.fileCount,a.folderClick=a.folderClick.bind(H()(a)),a}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){this.container=document.createElement("li"),this.container.draggable=!1,this.container.className="user_rsc",this.container.classList.add("folder"),$(this.container).data("key",this.listItemParam.key);var e=this.makeFolderDivWithThumbnail();this.container.appendChild(e),this.container.appendChild(this.makeHoverLayer(this.listItemParam,this.container)),this.container.setAttribute("data-ratio","0.83"),this.createExtra(),this.container.addEventListener("click",this.folderClick);var t=document.createElement("span");t.classList.add("title"),t.innerHTML=ef.a.beautifyFolderName(this.folder.name,6),this.container.appendChild(t)}},{key:"folderClick",value:function(){this.onFolderClick(this.folder,this.container)}},{key:"getContainer",value:function(){return he()(F()(t.prototype),"getContainer",this).call(this)}},{key:"createExtra",value:function(){}},{key:"makeFolderDivWithThumbnail",value:function(){var e=this.listItemParam.extraData;if(e){var t=this.listItemParam.thumbList[0],n=e.thumbnailKey,i=e.thumbnailType,a=this.makeListItemThumbProcess(n,t,i);return this.attachImageObserver(a),Nf.makeUserFolderDiv(a,!1,this.fileCount)}var o=document.createElement("img"),s=Zm.c.isIndividualScope();return Qm.a.setDefaultFolderImg(s),o.src=Qm.a.defaultFolderImg,Nf.makeUserFolderDiv(o,s,this.fileCount)}}]),t}(Mf),Bf=function(e){function t(e,n,i){return L()(this,t),V()(this,F()(t).call(this,e,n,i))}return z()(t,e),w()(t,[{key:"createExtra",value:function(){this.container.classList.add("add_folder_bin")}},{key:"makeFolderDivWithThumbnail",value:function(){var e=document.createElement("div");return e.className="icon_wrapper",Object(ne.setToolsIcon)(e,ne.ToolsIcon.ADD),e}}]),t}(xf),Vf=function(e){function t(e,n,i){return L()(this,t),V()(this,F()(t).call(this,e,n,i))}return z()(t,e),w()(t,[{key:"createExtra",value:function(){this.container.classList.add("recyclebin")}},{key:"makeFolderDivWithThumbnail",value:function(){var e=document.createElement("img");return e.src=Qm.a.reCycleImg,Nf.makeUserFolderDiv(e,!0,this.fileCount)}}]),t}(xf),Uf=n(518),Ff=function(e){function t(e,n,i,a,o,s){var r;return L()(this,t),(r=V()(this,F()(t).call(this))).listItemParam=e,r.mode=n,r.doJustify=i,r.makeHoverLayer=a,r.clickListItem=o,r.getResourceKey=s,r.referenceKey=r.listItemParam.key.referenceKey,r.userFile=Zm.c.imageMap.get(r.referenceKey),r.clickImage=r.clickImage.bind(H()(r)),r}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this,t=this.getResourceKey(this.listItemParam),n=Ut.a.getResourceKey(this.listItemParam.key.resourceType,this.referenceKey,this.listItemParam.key.repositoryType);this.container=document.createElement("li"),this.container.classList.add("user_rsc"),this.container.draggable=!0,this.container.id=d.b.random(),this.container.setAttribute(Yf.ATTRIBUTE_RESOURCE_KEY,t),this.container.setAttribute(Yf.ATTRIBUTE_MY_COLLECTION_KEY,n),this.listItemParam.myCollectionIdx&&$(this.container).addClass(r.a.MY_COLLECTION).data(Yf.DATA_MY_COLLECTION_IDX,String(this.listItemParam.myCollectionIdx)),$(this.container).data("key",this.listItemParam.key);var i=this.makeListItemThumb(this.listItemParam);this.attachImageObserver(i),this.container.appendChild(i),this.doJustify||(i.onload=function(){i.height<hh.c.SHORT_HEIGHT&&e.container.classList.add(r.a.SHORT)});var a=it.a.isEmpty(this.listItemParam.thumbList)?null:this.listItemParam.thumbList[0],o=this.makeHoverLayer(this.listItemParam,this.container);if(a&&(o.style.backgroundImage="url(".concat(i.src,")")),this.container.appendChild(o),this.container.addEventListener("click",this.clickImage),this.userFile){var s=Nn.a.createFromObject(JSON.parse(this.userFile.fileMeta));s&&s.hasArea()&&this.container.setAttribute("data-ratio",String(Number(s.width)/Number(s.height)))}var l=Uf.a.map.get(Uf.a.generateUploadKey(this.referenceKey));void 0!==l&&l.addRoot(this.container)}},{key:"clickImage",value:function(){this.mode===bf.SELECT_MODE&&ci.a.isUploading&&this.container.getElementsByClassName(r.a.PROGRESS_BAR_HOR).length>0||this.clickListItem(this.listItemParam,this.container)}},{key:"getContainer",value:function(){return he()(F()(t.prototype),"getContainer",this).call(this)}}]),t}(Mf),Gf=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this,!0))).selectedTeam=e,i.onClickUploadButton=n,i.clickUploadButton=i.clickUploadButton.bind(H()(i)),i.clickCapacityInfo=i.clickCapacityInfo.bind(H()(i)),i}var n;return z()(t,e),w()(t,[{key:"onCreateView",value:function(){this.container=document.createElement("div"),this.container.className=r.a.BUTTON_WRAP;var e=document.createElement("button");e.className=r.a.BTN_IMAGE_UPLOAD,e.innerText="내 이미지 사용",this.container.appendChild(e),e.addEventListener("click",this.clickUploadButton);var t=this.btnCapInfo=this.makeCapacityInfoButton();t.addEventListener("click",this.clickCapacityInfo),this.container.appendChild(t)}},{key:"onChangeCapacity",value:function(e){var t=e>f.a.getUser().getTotalUploadSizeLimit(),n=Go.b.getCookie(Go.a.EXCESS_CAPACITY)===Go.a.EXCESS_CAPACITY;!t&&n&&Go.b.removeCookie(Go.a.EXCESS_CAPACITY),this.activeCapInfoMark(t&&!n)}},{key:"clickUploadButton",value:function(){this.onClickUploadButton()}},{key:"clickCapacityInfo",value:(n=s()(a.a.mark(function e(t){var n,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),e.next=3,ci.a.fetchCapacity(this.selectedTeam);case 3:(n=e.sent)>f.a.getUser().getTotalUploadSizeLimit()&&Go.b.setCookie(Go.a.EXCESS_CAPACITY,Go.a.EXCESS_CAPACITY,36500),this.activeCapInfoMark(!1),i=$(this.btnCapInfo).offset(),ep.open(this.makeCapacityInfoLayer(n),this.btnCapInfo,new ns.a(i.left,i.top));case 8:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"makeCapacityInfoButton",value:function(){var e=document.createElement("button");return e.className=r.a.BTN_CAPACITY_INFO,e.type="button",Object(ne.setToolsIcon)(e,ne.ToolsIcon.OUTLINE),e}},{key:"makeCapacityInfoLayer",value:function(e){var t=document.createElement("div");Object(ne.setToolsIcon)(t,ne.ToolsIcon.CLOSE),t.className=r.a.UPLOAD_INFO_LAYER;var n=document.createElement("header");n.innerText="업로드 정보",t.appendChild(n);var i=document.createElement("div");i.className="upload_info_body",t.appendChild(i);var a=f.a.getUser().getTotalUploadSizeLimit();if(e>a){var o=document.createElement("div");o.className=r.a.STORAGE_GUIDANCE;var s=document.createElement("span");s.innerText="저장 공간이 ",o.appendChild(s);var l=document.createElement("span");l.className="full",l.innerText=ef.a.getSizeDescription(a),o.appendChild(l);var c=document.createElement("span");c.innerText="를 초과했어요. 정책에 따라 업로드 제한이 있을 수 있으니 참고해주세요.",o.appendChild(c),i.appendChild(o)}var u=document.createElement("div");u.className=r.a.STORAGE_INFO;var d=document.createElement("label");d.innerText="저장 공간";var h=document.createElement("span"),p=document.createElement("span");p.className=e<a?"enough":"full",p.innerText="".concat(ef.a.getSizeDescription(e));var m=document.createElement("span");m.innerText=" / ".concat(ef.a.getSizeDescription(a)),u.appendChild(d),u.appendChild(h),h.appendChild(p),h.appendChild(m),i.appendChild(u);var v=document.createElement("div");v.className=r.a.FILE_GUIDE;var g=document.createElement("label");g.innerText="지원 파일";var E=document.createElement("span");return E.innerText="JPG, PNG, SVG",v.appendChild(g),v.appendChild(E),i.appendChild(v),t}},{key:"activeCapInfoMark",value:function(e){var t=this.btnCapInfo.querySelector(".mark");if(e&&!t){var n=document.createElement("div");n.className="mark",n.innerText="1",this.btnCapInfo.appendChild(n)}else!e&&t&&this.btnCapInfo.removeChild(t)}}]),t}(He.a),Hf=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0))).titleText="업로드한 이미지가 없어요.",n.additionalMessage="사진 추가하기 버튼을 클릭하여<br>사진, SVG 파일을 올려보세요!",n.icon=ne.ToolsIcon.ITEM_PHOTO,n.addLayerEventListener=e,n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this.container=document.createElement("div");e.className=r.a.EMPTY_LIST_NOTI_LAYER;var t=document.createElement("div");Object(ne.setToolsIcon)(t,this.icon,!0);var n=document.createElement("p");n.classList.add(r.a.TITLE),n.innerHTML=this.titleText,t.appendChild(n);var i=document.createElement("p");i.innerHTML=this.additionalMessage,t.appendChild(i),e.appendChild(t),void 0!==this.addLayerEventListener&&this.addLayerEventListener(e)}}]),t}(He.a),Wf=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).titleText="휴지통이 비어있어요.",e.additionalMessage="휴지통에 버려지면 30일간 보관 후</br>자동으로 삭제돼요!",e.icon=ne.ToolsIcon.DELETE_OUTLINE,e}return z()(t,e),t}(Hf),zf=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).titleText="폴더가 비어있어요.",e.additionalMessage="내 이미지 사용 버튼을 클릭하여</br>사진, SVG 파일을 올려보세요!",e.icon=ne.ToolsIcon.FOLDER_OUTLINE,e}return z()(t,e),t}(Hf);!function(e){e.DEFAULT_MODE="DEFAULT_MODE",e.SELECT_MODE="SELECT_MODE"}(bf||(bf={}));var Kf=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this))).isAdminMode=e,o.isDevMode=n,o.paginationMode=i,o.accountId=a,o}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return e.isAdminMode!==this.isAdminMode||e.isDevMode!==this.isDevMode||e.paginationMode!==this.paginationMode||e.accountId!==this.accountId}}]),t}(He.b),Yf=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).pageSize=30,e.doJustify=!0,e.selectedFolderIdx=0,e.isSelectAll=!1,e.leftPanelType=So.b.MY_IMAGE_LIB,e.myImagePanelVCMode=bf.DEFAULT_MODE,ci.a.setListener(H()(e)),Zm.c.setListener(H()(e)),e}var n;return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),$(this.container).empty(),this.container.classList.add(r.a.LIBRARY_UPLOAD),this.makeBtnUpload(),this.makeSearchTool(),this.makeHeader(),this.makePaginationListTool(),this.makeSearchResultSpan(),this.makeListTool(),this.makeDragToUploadLayer(),f.a.getUser().isLogin()||this.makeLoginNotiLayer(),Zm.c.loadUserDataAndRender(this.onMakeTeamScopeTab.bind(this)).catch(function(e){return console.error(e)}),this.setResizeEventListener()}},{key:"getRenderStates",value:function(){return new Kf(Ke.a.getUserSetting().adminMode,Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().leftPanelPaginationMode,f.a.getUser().accountId)}},{key:"isInFolder",value:function(){return 0!==this.selectedFolderIdx}},{key:"isInRecycleBin",value:function(){return this.myImagePanelVCMode===bf.SELECT_MODE&&this.isInRecycleBinView}},{key:"isSelected",value:function(){return this.container.classList.contains(r.a.ACTIVE)}},{key:"setEmptyListView",value:function(){this.isInFolder()&&!this.isInRecycleBin()?this.emptyListView=(new zf).getContainer():this.isInRecycleBin()?this.emptyListView=(new Wf).getContainer():this.isInSearchView?this.emptyListView=Ih.makeSearchNoResultView():this.myImagePanelVCMode!==bf.SELECT_MODE&&this.myImagePanelVCMode!==bf.DEFAULT_MODE||(this.emptyListView=new Hf(this.addLayerEventListener.bind(this)).getContainer())}},{key:"onLoginRemoveLoginLayer",value:function(){$(this.loginNotiLayer).remove()}},{key:"changeModeAndRender",value:function(e){this.myImagePanelVCMode=e,this.renderBeforeLoadList(),this.renderAfterLoadList()}},{key:"toDefaultModeAndLoadList",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.myImagePanelVCMode=bf.DEFAULT_MODE,e&&Zm.c.loadListSync()}},{key:"toRecycleBinMode",value:function(){this.isInRecycleBinView=!0,this.myImagePanelVCMode=bf.SELECT_MODE}},{key:"onClickSelectAll",value:function(){Zm.c.selectAll(this.renderSelectAfterLoadList.bind(this))}},{key:"onClickUnselectAll",value:function(){this.isInRecycleBin()?this.changeModeAndRender(bf.SELECT_MODE):this.changeModeAndRender(bf.DEFAULT_MODE)}},{key:"selectCheckBox",value:function(e,t,n){this.myImagePanelVCMode===bf.DEFAULT_MODE&&this.changeModeAndRender(bf.SELECT_MODE),Zm.c.toggleCheckBoxData(n),Zm.c.checkedData.has(n.referenceKey)?this.checkACheckBox(e,t,!0):this.checkACheckBox(e,t,!1),0!==Zm.c.getCheckedDataSize()||this.isInRecycleBin()||this.changeModeAndRender(bf.DEFAULT_MODE)}},{key:"forEachListItem",value:function(e){this.container.querySelectorAll(".user_rsc").forEach(function(t){t.classList.contains("recyclebin")||t.classList.contains("add_folder_bin")||e(t)})}},{key:"setDddotWrapVisibility",value:function(e,t){var n=e.querySelector(".".concat(r.a.DDDOT_WRAP));n&&(n.classList.contains(r.a.ACTIVE)?n.style.visibility=t:n.style.visibility="hidden")}},{key:"enableAllDottedMenu",value:function(e){var t=this;this.forEachListItem(function(n){return t.enableDddotMenu(n,e)})}},{key:"enableDddotMenu",value:function(e,t){var n=e.querySelector(".".concat(r.a.DDDOT_WRAP));n&&(n.classList.toggle(r.a.ACTIVE,t),t||this.setDddotWrapVisibility(e,"hidden"),je.a.isMobileDevice()&&this.setDddotWrapVisibility(e,"visible"))}},{key:"checkCheckedBoxes",value:function(){var e=this;this.forEachListItem(function(t){var n=t.querySelector(".user_lib_checkbox"),i=t.querySelector(".checked_layer"),a=$(t).data("key").referenceKey;Zm.c.checkedData.has(a)?e.checkACheckBox(n,i):e.checkACheckBox(n,i,!1)})}},{key:"showAllCheckBoxes",value:function(e){this.forEachListItem(function(t){var n=t.querySelector(".user_lib_checkbox");ci.a.isUploading&&t.getElementsByClassName(r.a.PROGRESS_BAR_HOR).length>0?n.style.visibility="hidden":n.style.visibility=e?"visible":"hidden"})}},{key:"checkACheckBox",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.querySelector(".icon_check");if(i){t.classList.toggle("checked",n),i.classList.toggle("checked_icon",n),n&&(e.style.visibility="visible");var a=Zm.c.totalItemCount;if(Ke.a.getUserSetting().leftPanelPaginationMode===au.a.BUTTON){var o=this.paginationListTool.getCurrentPaginationParam().pageSize;a>this.paginationListTool.getCurrentPaginationParam().page*o?a=o:a%=o}this.header.onSelectCheckBox(Zm.c.getCheckedDataSize(),a)}}},{key:"enableUploadBtnAndSearchTool",value:function(e){var t=this.container.querySelector(".team_scope_tab"),n=this.container.querySelector(".button_wrap");t&&t.classList.toggle("disabled",!e),n&&n.classList.toggle("disabled",!e),this.searchTool.container.classList.toggle("disabled",!e)}},{key:"disableAddFolderButtonAndRecycleBin",value:function(e){var t=this.container.querySelector(".user_rsc.recyclebin"),n=this.container.querySelector(".user_rsc.add_folder_bin");t&&t.classList.toggle("disabled",e),n&&n.classList.toggle("disabled",e)}},{key:"makeLoginNotiLayer",value:function(){var e=this.loginNotiLayer=document.createElement("div");e.className=r.a.LOGIN_NOTI_LAYER;var t=document.createElement("div");Object(ne.setToolsIcon)(t,ne.ToolsIcon.USER_PROFILE);var n=document.createElement("p");n.innerText="로그인 후 이용 가능해요.",t.appendChild(n);var i=document.createElement("button");i.innerText="로그인 하기",i.addEventListener("click",function(){Ye.a.openLoginPopup(Ie.a.TEMP)}),t.appendChild(i),e.appendChild(t),this.container.appendChild(this.loginNotiLayer)}},{key:"setResizeEventListener",value:function(){var e=this;window.addEventListener("resize",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isActive()){t.next=5;break}return t.next=3,e.paginationListTool.justifyList();case 3:t.next=6;break;case 5:e.paginationListTool.setJustifyRequire();case 6:case"end":return t.stop()}},t)})))}},{key:"fetchList",value:function(){he()(F()(t.prototype),"fetchList",this).call(this);var e=!1;try{if(this.checkLoginRequire())return;this.toDefaultModeAndLoadList(),this.isLoaded=!0}catch(t){console.error(t),e=!0}e&&alert("리스트를 가져오는 도중 오류가 발생하였습니다.")}},{key:"setActive",value:function(e){return he()(F()(t.prototype),"setActive",this).call(this,e),e&&(this.isInRecycleBin()||this.changeModeAndRender(bf.DEFAULT_MODE),this.isLoaded&&X.a.instance.dispatch(new K.c(function(e,t,n){return n.renderItemTools(e,t,!0)})),this.isJustifyRequire()&&this.justifyList().catch(function(e){return console.error(e)})),this}},{key:"onMakeTeamScopeTab",value:function(e){var t=this,n=this.createDivElement("team_scope_tab",r.a.ACTIVE),i=document.createElement("ul"),a=function(n){var a=n===mu.b.INDIVIDUAL?ne.ToolsIcon.USER_OUTLINE:ne.ToolsIcon.GROUP_OUTLINE,o=n===mu.b.INDIVIDUAL?"개인 업로드":"팀 업로드",s=document.createElement("li");s.setAttribute("data-type",n),s.addEventListener("click",function(){return function(e){$(i).children().removeClass(r.a.ACTIVE),e.classList.add(r.a.ACTIVE);var n=e.getAttribute("data-type");t.header.toggleCopyBtn(n),Zm.c.setTeamScope(n),t.renderDefaultMain()}(s)}),Object(ne.setToolsIcon)(s,a,!0);var l=document.createElement("span");return l.innerText=o,s.appendChild(l),e.teamScope===n&&s.classList.add(r.a.ACTIVE),s};i.appendChild(a(mu.b.INDIVIDUAL)),i.appendChild(a(mu.b.TEAM)),n.appendChild(i),this.container.prepend(n)}},{key:"makeSearchResultSpan",value:function(){this.searchResultSpan=document.createElement("span"),this.searchResultSpan.className="search_result",$(this.searchResultSpan).hide(),this.container.appendChild(this.searchResultSpan)}},{key:"makeSearchTool",value:function(){this.searchTool=new dh.a(this.renderWhenSearchTyped.bind(this),"검색어를 입력하세요.",!0,this.renderWhenSearchCancel.bind(this)),this.container.appendChild(this.searchTool.getContainer())}},{key:"makeHeader",value:function(){this.header=new yf(this),this.container.appendChild(this.header.getContainer())}},{key:"makeHoverLayerOldPanelVC",value:function(e,t){var n=this,i=document.createElement("div");return i.className=r.a.BTN_LAYER,i.draggable=!0,i.addEventListener("dragstart",function(e){$(t).addClass("dragging"),e.dataTransfer.setData("text",t.id)}),i.addEventListener("dragend",function(){$(t).removeClass("dragging")}),i.addEventListener("mouseenter",function(){je.a.isMobileDevice()||(ci.a.isUploading&&i.parentElement.getElementsByClassName(r.a.PROGRESS_BAR_HOR).length>0?n.onHoverLayerButtonsVisibility(i,"hidden"):n.myImagePanelVCMode!==bf.SELECT_MODE&&n.onHoverLayerButtonsVisibility(i,"visible"))}),i.addEventListener("mouseleave",function(){n.myImagePanelVCMode===bf.SELECT_MODE||je.a.isMobileDevice()||n.onHoverLayerButtonsVisibility(i,"hidden")}),i}},{key:"makeHoverLayer",value:function(e,t){var n=this.makeHoverLayerOldPanelVC(e,t);if(e.key.resourceType===Q.a.PHOTO||e.key.resourceType===Q.a.SVG){var i=Object(ne.setToolsIcon)(n,ne.ToolsIcon.SETTINGS,!0);i.addEventListener("click",function(){var t=s()(a.a.mark(function t(n){var i,o,s,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.stopPropagation(),i=e.key.referenceKey,e.key.resourceType!==Q.a.PHOTO){t.next=11;break}return(s=new Je.d("",new O.a(0,0,0,0))).props.setPhotoKey(i),s.orgType=Je.b.Photo,o=s,t.next=9,qm.b.fetchKeyList([s.props.getPhotoKey()],"forEditing");case 9:t.next=15;break;case 11:return t.next=13,In.a.makeSvgDataFromFileKey(i);case 13:r=t.sent,o=new $m.a("",r,new O.a(0,0,0,0));case 15:X.a.instance.dispatch(new K.c(function(e,t,n){J.a.unselectAllItems(),n.renderHandler(e,t),n.renderItemToolsByItem([o],t,pl.a.ADMIN)}));case 16:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),n.appendChild(i)}var o=e.key.referenceKey,r=e.key.resourceType===Q.a.USER_FOLDER?Zm.c.folderMap.get(Number(o)):Zm.c.imageMap.get(o),l=document.createElement("div");l.className="checked_layer";var c=this.makeCheckBox(e,l);if(Zm.c.checkedData.has(o)&&this.checkACheckBox(c,l),c&&(n.appendChild(l),n.appendChild(c)),!this.isInRecycleBin()&&r&&!e.extraData.isAddFolderBin){var u=Zm.c.isTeamScope(),d=this.makeUserImageHandleButton(Sf.instance.maker(e,this.promptPermanentDeletion.bind(this),this.toDefaultModeAndLoadList.bind(this)).makeInfoLayer(r,u));n.appendChild(d)}return n}},{key:"onHoverLayerButtonsVisibility",value:function(e,t){this.setDddotWrapVisibility(e,t);var n=e.querySelector(".user_lib_checkbox");n&&(n.style.visibility=t)}},{key:"onDataChanged",value:function(e){this.checkUpContentsChange(this.getRenderStates()),this.contentsStatesChanged&&(this.isLoaded=!1,this.paginationListTool&&(this.enableStyle(Ke.a.getUserSetting().adminMode,this.paginationListTool.getContainer(),r.a.ADMIN_MODE),this.paginationListTool.setPaginationMode(Ke.a.getUserSetting().leftPanelPaginationMode)),this.isSelected()&&this.toDefaultModeAndLoadList())}},{key:"makeListItem",value:function(e){return e.key.resourceType===Q.a.USER_FOLDER?e.extraData.isRecycleBin?new Vf(e,this.makeHoverLayer.bind(this),this.onFolderClick.bind(this)).getContainer():e.extraData.isAddFolderBin?new Bf(e,this.makeHoverLayer.bind(this),this.onAddFolderClick.bind(this)).getContainer():new xf(e,this.makeHoverLayer.bind(this),this.onFolderClick.bind(this)).getContainer():new Ff(e,this.myImagePanelVCMode,this.doJustify,this.makeHoverLayer.bind(this),this.clickListItem.bind(this),this.getResourceKey.bind(this)).getContainer()}},{key:"onAddFolderClick",value:function(){var e=this;new tf(function(t){e.showLoadingUi(!1),e.toDefaultModeAndLoadList()}).open()}},{key:"onFolderClick",value:function(e,t){if(this.myImagePanelVCMode===bf.SELECT_MODE){if(e===Qm.a.recycleBin)return;this.triggerClickCheckBoxInItem(t)}else this.myImagePanelVCMode===bf.DEFAULT_MODE&&(this.toDefaultModeAndLoadList(!1),e===Qm.a.recycleBin&&this.toRecycleBinMode(),this.selectedFolderIdx=e.idx,Zm.c.loadListSync())}},{key:"onClickUploadButton",value:function(){this.myImagePanelVCMode=bf.DEFAULT_MODE,$(this.fileInput).trigger("click")}},{key:"makeBtnUpload",value:function(){var e=this;this.uploadButtonWrap=new Gf(Zm.c.selectedTeamData,this.onClickUploadButton.bind(this)),this.container.appendChild(this.uploadButtonWrap.getContainer());var t=this.fileInput=document.createElement("input");t.type="file",t.multiple=!0,t.accept="image/png, image/jpeg, image/jpg, image/svg+xml",$(t).on("change",s()(a.a.mark(function n(){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.files)try{ci.a.dispatchUploadUserFile(t.files,!1)}catch(e){console.error(e)}finally{e.paginationListTool.loadingUI.hide(),t.value=""}case 1:case"end":return n.stop()}},n)}))),this.container.appendChild(t)}},{key:"onAddUserFilesDto",value:function(e){this.header.updateUIAfterLoadList(Zm.c.totalItemCount),this.isInFolder()?this.paginationListTool.prependItem(e):(this.paginationListTool.appendPhoto(e),this.paginationListTool.loadingUI.hide())}},{key:"makePaginationListTool",value:function(){var e=this;return this.paginationListTool=new Df({listItemRenderAction:function(t){return e.makeListItem(t)},justifyOption:{defaultRowHeight:118,horizonMargin:8,rowWidth:318}},this.pageSize,Ke.a.getUserSetting().leftPanelPaginationMode,function(){return e.setEmptyListView(),e.emptyListView}),this.paginationListTool.setListener(this),this.paginationListTool.onStartView(),this.paginationListTool.setPaginationMode(Ke.a.getUserSetting().leftPanelPaginationMode),this.paginationListTool}},{key:"onNeedMoreElementSync",value:function(e,t,n){Ke.a.getUserSetting().leftPanelPaginationMode===au.a.BUTTON&&(this.isInRecycleBin()?this.changeModeAndRender(bf.SELECT_MODE):this.changeModeAndRender(bf.DEFAULT_MODE)),this.loadingBoxes=n,t&&this.myImagePanelVCMode===bf.DEFAULT_MODE&&this.enableUploadBtnAndSearchTool(!1),Zm.c.requestPaginationListAction(e,this.selectedFolderIdx,this.searchTool.getKeyword(),t)}},{key:"onRequestPaginationListAction",value:function(e,t,n){n&&this.myImagePanelVCMode===bf.DEFAULT_MODE&&this.enableUploadBtnAndSearchTool(!0),this.header.updateUIAfterLoadList(Zm.c.totalItemCount),this.renderSearchResultCount();var i={activeLibBanner:!this.isInFolder()&&!this.isInRecycleBin()&&!this.isInSearchView,listItemParams:e,totalRow:Zm.c.totalItemCount};this.paginationListTool.setPaginationListResponse(i,t,this.loadingBoxes)}},{key:"onPaginationFinishRender",value:function(e){Zm.c.onPaginationFinishRender(this.isInRecycleBin(),this.renderAfterLoadList.bind(this))}},{key:"onScrollBottomEnd",value:function(){}},{key:"makeListTool",value:function(){this.container.appendChild(this.paginationListTool.getContainer())}},{key:"addLayerEventListener",value:function(e){e.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()}),e.addEventListener("dragleave",function(e){e.preventDefault(),e.stopPropagation()})}},{key:"makeDragToUploadLayer",value:function(){var e=this.dragToUploadLayer=document.createElement("div");e.className=r.a.DRAG_TO_UPLOAD_LAYER,e.style.zIndex="10",e.style.opacity="0.8";var t=document.createElement("div");Object(ne.setToolsIcon)(t,ne.ToolsIcon.UPLOAD_CLOUD);var n=document.createElement("p");n.classList.add(r.a.TITLE),n.innerHTML="이미지 업로드",t.appendChild(n);var i=document.createElement("p");i.innerHTML="여러개의 이미지를 업로드 할 수 있습니다.",t.appendChild(i);var a=document.createElement("p");a.innerHTML="JPG, PNG, SVG",t.appendChild(a),e.appendChild(t),this.addLayerEventListener(e)}},{key:"showDragToUploadLayer",value:function(){this.isInRecycleBin()||this.showUploadLayer()}},{key:"showUploadLayer",value:function(){this.paginationListTool.getContainer().appendChild(this.dragToUploadLayer)}},{key:"removeDragToUploadLayer",value:function(){this.removeUploadLayer()}},{key:"removeUploadLayer",value:function(){$(this.dragToUploadLayer).remove()}},{key:"onRemoveUploadLayer",value:function(){this.removeUploadLayer()}},{key:"openLoginPopupUpload",value:function(e,t){var n=this;Ye.a.openLoginPopup(Ie.a.UPLOAD,s()(a.a.mark(function i(){return a.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n.showLoadingUi(!0),i.next=3,ci.a.tryUploadUserFile(e,t,n.selectedFolderIdx,n.isInRecycleBin());case 3:n.showLoadingUi(!1);case 4:case"end":return i.stop()}},i)})))}},{key:"onLoadListSync",value:function(){this.setEmptyListView(),this.paginationListTool.setListEmptyView(this.emptyListView),this.renderBeforeLoadList(),this.paginationListTool&&this.paginationListTool.initList()}},{key:"makeUserImageHandleButton",value:function(e){var t=document.createElement("div");return t.className=r.a.DDDOT_WRAP,Object(ne.setToolsIcon)(t,ne.ToolsIcon.DDDOT),this.myImagePanelVCMode!==bf.SELECT_MODE&&t.classList.add(r.a.ACTIVE),document.createElement("div").className=r.a.TOOLS_TAB,t.addEventListener("click",function(n){if(n.stopPropagation(),!(je.a.isMobileDevice()&&ci.a.isUploading&&t.parentElement.parentElement.getElementsByClassName(r.a.PROGRESS_BAR_HOR).length>0)){t.classList.add(r.a.SHOWN);var i=$(t).offset();ep.open(e,t,new ns.a(i.left,i.top),void 0,function(){t.classList.remove(r.a.SHOWN)})}}),t}},{key:"makeCheckBox",value:function(e,t){var n=this;if(!e.extraData.isRecycleBin&&!e.extraData.isAddFolderBin){var i=document.createElement("div");return i.className="user_lib_checkbox",Object(ne.setToolsIcon)(i,ne.ToolsIcon.CHECK),i.addEventListener("click",function(a){a.stopPropagation(),n.selectCheckBox(i,t,e.key)}),i}}},{key:"clickListItem",value:function(e,t){this.myImagePanelVCMode!==bf.SELECT_MODE?this.onCanvasDrop(this.getResourceKey(e)):this.triggerClickCheckBoxInItem(t)}},{key:"getResourceKey",value:function(e){var t=e.key.resourceType,n=e.key.repositoryType,i=e.key.referenceKey,a=e.dropEventKey?e.dropEventKey:i;return Ut.a.getResourceKey(t,a,n)}},{key:"onCanvasDrop",value:function(e){var t=Y.a.instance,n=t.size,i=n.pageOffsetX*t.zoomScale+n.pageWidth*t.zoomScale/2,a=n.pageOffsetY*t.zoomScale+n.pageHeight*t.zoomScale/2;X.a.instance.dispatch(new ui(Y.a.instance.renderPageIdx,i,a,e))}},{key:"triggerClickCheckBoxInItem",value:function(e){var t=e.querySelector(".user_lib_checkbox");t&&$(t).trigger("click")}},{key:"onClickHeaderMoveButton",value:function(e){var t=this;if(Zm.c.isFolderChecked())zc.a.open({title:"폴더 이동 불가",subTitle:"폴더는 이동할 수 없습니다. 폴더 선택을 해제하고 다시 시도해주세요.",confirmAction:function(){return Zm.c.unselectFolders(t.renderSelectAfterLoadList.bind(t))},txtConfirmBtn:"폴더 선택 해제"});else{var n=Zm.c.folderMap.has(this.selectedFolderIdx)?Zm.c.folderMap.get(this.selectedFolderIdx).name:null,i=new lf(this.selectedFolderIdx,e,this.isInFolder(),function(){t.onAfterImageMove(e),i.close()},n);i.open({top:160,left:370})}}},{key:"onAfterImageMove",value:function(e){this.toDefaultModeAndLoadList()}},{key:"onClickCopyUserResourcePopup",value:function(e){var t=this;Zm.c.isFolderChecked()?zc.a.open({title:"폴더 복제 불가",subTitle:"폴더는 복제할 수 없습니다. 폴더 선택을 해제하고 다시 시도해주세요.",confirmAction:function(){return Zm.c.unselectFolders(t.renderSelectAfterLoadList.bind(t))},txtConfirmBtn:"폴더 선택 해제"}):uf.open(e,function(){return t.changeModeAndRender(bf.DEFAULT_MODE)})}},{key:"showLoadingUi",value:function(e){e?this.paginationListTool.loadingUI.show():this.paginationListTool.loadingUI.hide()}},{key:"promptPermanentDeletion",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t?Qm.a.recycleBin.folderStoreInfo.fileCount:Zm.c.getCheckedDataSize();zc.a.open({title:"영구 삭제",subTitle:"삭제된 파일 및 폴더는 다시 복원할 수 없습니다. ".concat(n,"개의 항목을 정말 삭제하시겠습니까?"),confirmAction:function(){t?(e.toDefaultModeAndLoadList(!1),Zm.c.updateStatusAll(vf.a.PERMANENTLY_INACTIVE)):(e.toRecycleBinMode(),Zm.c.updateStatusCheckedData(vf.a.PERMANENTLY_INACTIVE))}})}},{key:"onChangeCapacity",value:function(e){this.uploadButtonWrap.onChangeCapacity(e)}},{key:"justifyList",value:(n=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.paginationListTool.justifyList();case 2:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"isJustifyRequire",value:function(){return this.paginationListTool.isJustifyRequire()}}]),t}(oh);Yf.ATTRIBUTE_MY_COLLECTION_KEY="data-my-collection-key",Yf.ATTRIBUTE_RESOURCE_KEY="data-resource-key",Yf.DATA_MY_COLLECTION_IDX="myCollectionIdx";var Xf=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"renderBeforeLoadList",value:function(){Zm.c.clearCheckedData(),this.myImagePanelVCMode===bf.DEFAULT_MODE?this.renderNormalModeBeforeLoad():this.myImagePanelVCMode===bf.SELECT_MODE&&this.renderSelectMode()}},{key:"renderAfterLoadList",value:function(){this.myImagePanelVCMode===bf.DEFAULT_MODE?(this.renderNormalModeAfterLoad(),this.isInSearchView&&(this.searchResultSpan.style.display="block")):this.myImagePanelVCMode===bf.SELECT_MODE&&this.renderSelectAfterLoadList()}},{key:"renderSelectMode",value:function(){this.enableUploadBtnAndSearchTool(!1),this.header.changeToolbarView(bf.SELECT_MODE,this.selectedFolderIdx)}},{key:"renderSelectAfterLoadList",value:function(){this.disableAddFolderButtonAndRecycleBin(!0),this.enableAllDottedMenu(!1),this.showAllCheckBoxes(!0),this.checkCheckedBoxes()}},{key:"renderDefaultMain",value:function(){this.selectedFolderIdx=0,this.isInSearchView=!1,this.isInRecycleBinView=!1,this.hideSearchResult(),this.header.changeToolbarView(bf.DEFAULT_MODE),Zm.c.clearCheckedData(),this.toDefaultModeAndLoadList()}},{key:"renderNormalModeBeforeLoad",value:function(){this.enableUploadBtnAndSearchTool(!1),this.header.changeToolbarView(bf.DEFAULT_MODE,this.selectedFolderIdx),this.enableAllDottedMenu(!0)}},{key:"renderNormalModeAfterLoad",value:function(){this.enableUploadBtnAndSearchTool(!0),this.header.updateUIAfterLoadList(Zm.c.totalItemCount),this.disableAddFolderButtonAndRecycleBin(!1),this.showAllCheckBoxes(!1),this.checkCheckedBoxes()}},{key:"renderSearchResultCount",value:function(){var e=Zm.c.folderMap.get(this.selectedFolderIdx),t=e?e.name:null,n=(this.isInFolder()?"'".concat(t,"' 폴더의"):"전체")+" 검색 결과 ".concat(Zm.c.totalItemCount,"개");this.searchResultSpan.innerHTML=n}},{key:"renderWhenSearchTyped",value:function(e){d.b.isEmpty(e)?this.isInSearchView&&this.renderWhenSearchCancel():(this.toDefaultModeAndLoadList(),this.isInSearchView=!0)}},{key:"renderWhenSearchCancel",value:function(){this.searchTool.offCloseEvent(),this.hideSearchResult(),this.isInSearchView&&(this.isInSearchView=!1,this.changeModeAndRender(bf.DEFAULT_MODE),Zm.c.loadListSync())}},{key:"hideSearchResult",value:function(){this.searchTool.updateUI(""),$(this.searchResultSpan).hide()}}]),t}(Yf),jf=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).leftPanelType=So.b.PHOTO_LIB,e.elementClass=r.a.LIBRARY_PHOTO,e.searchDesignResourceType=gn.a.PICTURE,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.addRadioButtons([So.b.STICKER_PHOTO_LIB,So.b.PIXABAY_LIB]),this.setFirstMenu()}}]),t}(Jp),Zf=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this,!0))).btn=document.createElement("div"),a.label=document.createElement("div"),a.listWrap=document.createElement("div"),a.leftUl=document.createElement("ul"),a.rightUl=document.createElement("ul"),a.list=e,a.dataKeyMap=n,a.listener=i,a}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.TWO_LAYER_SELECT_TOOL,this.btn.appendChild(this.label),Object(ne.setToolsIcon)(this.btn,ne.ToolsIcon.GREATER_THAN,!0,void 0,90),this.btn.className=r.a.BTN_SELECT,this.container.appendChild(this.btn),this.listWrap.className=r.a.SELECT_LIST_WRAP,this.listWrap.appendChild(this.leftUl),this.listWrap.appendChild(this.rightUl),this.container.appendChild(this.listWrap),this.renderComboList(),this.addEventListener()}},{key:"renderComboList",value:function(){var e=this,t=document.createDocumentFragment(),n=document.createDocumentFragment();this.list.forEach(function(i,a){var o=e.makeLi(i,a);0===a&&o.classList.add(r.a.ACTIVE),Object(ne.setToolsIcon)(o,ne.ToolsIcon.GREATER_THAN,!0),t.appendChild(o);var s=i[e.dataKeyMap.list];s&&s.forEach(function(t,i){var o=e.makeLi(t,a,i);0===a&&(o.classList.add(r.a.SHOW),0===i&&(o.classList.add(r.a.ACTIVE),e.title=t[e.dataKeyMap.label],e.label.innerText=e.title)),n.appendChild(o)})}),this.leftUl.appendChild(t),this.rightUl.appendChild(n)}},{key:"makeLi",value:function(e,n,i){var a=$("<li>".concat(e[this.dataKeyMap.label],"</li>"));return a.data(e),a.data(t.TAB_IDX_KEY,n),i&&a.data(t.DATA_IDX_KEY,i),a[0]}},{key:"expand",value:function(){var e=this;this.listWrap.classList.add(r.a.ACTIVE),$(document.body).off(t.CUSTOM_CLICK_EVENT_NAME).on(t.CUSTOM_CLICK_EVENT_NAME,function(n){var i=n.target;e.checkFold(i)&&(e.listWrap.classList.remove(r.a.ACTIVE),$(document.body).off(t.CUSTOM_CLICK_EVENT_NAME))})}},{key:"fold",value:function(){this.listWrap.classList.remove(r.a.ACTIVE),$(document.body).off(t.CUSTOM_CLICK_EVENT_NAME)}},{key:"checkFold",value:function(e){return e!==this.btn&&!$.contains(this.btn,e)&&e!==this.listWrap&&!$.contains(this.listWrap,e)}},{key:"addEventListener",value:function(){var e=this;$(this.btn).on("click",function(t){e.listWrap.classList.contains(r.a.ACTIVE)?e.fold():e.expand()}),$(this.leftUl).on("mouseover","li",function(n){var i=!0,a=!1,o=void 0;try{for(var s,l=e.leftUl.childNodes[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){s.value.classList.remove(r.a.HOVER)}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}var c=n.currentTarget;c.classList.add(r.a.HOVER);var u=$(c).data(t.TAB_IDX_KEY),d=!0,h=!1,p=void 0;try{for(var m,f=e.rightUl.childNodes[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var v=m.value;t.showRightLi(v,u)}}catch(e){h=!0,p=e}finally{try{d||null==f.return||f.return()}finally{if(h)throw p}}}).on("click","li",function(n){var i=n.currentTarget,a=$(i).data(t.TAB_IDX_KEY),o=!0,s=!1,r=void 0;try{for(var l,c=e.rightUl.childNodes[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;if($(u).data(t.TAB_IDX_KEY)===a){e.select(u);break}}}catch(e){s=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw r}}}),$(this.rightUl).on("click","li",function(t){e.select(t.currentTarget)})}},{key:"select",value:function(e){var n=$(e).data(t.TAB_IDX_KEY),i=!0,a=!1,o=void 0;try{for(var s,l=this.rightUl.childNodes[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;t.showRightLi(c,n),c.classList.remove(r.a.ACTIVE)}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}e.classList.add(r.a.ACTIVE);var u=$(e).data(),d=!0,h=!1,p=void 0;try{for(var m,f=this.leftUl.childNodes[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var v=m.value,g=$(v).data();g[t.TAB_IDX_KEY]===u[t.TAB_IDX_KEY]?(v.classList.add(r.a.ACTIVE),v.classList.remove(r.a.HOVER),g[this.dataKeyMap.label]):v.classList.remove(r.a.ACTIVE)}}catch(e){h=!0,p=e}finally{try{d||null==f.return||f.return()}finally{if(h)throw p}}this.title=u[this.dataKeyMap.label],this.label.innerText=this.title,this.listener(u),this.fold()}},{key:"selectFirst",value:function(){this.selectIdx(0)}},{key:"selectIdx",value:function(e){var t=this.rightUl.childNodes.item(e);this.select(t)}},{key:"getList",value:function(){return this.list}},{key:"setGtmData",value:function(e){Te.a.setGTMValue(this.listWrap,e)}},{key:"getTitle",value:function(){return this.title}}],[{key:"showRightLi",value:function(e,n){$(e).data(t.TAB_IDX_KEY)===n?e.classList.add(r.a.SHOW):e.classList.remove(r.a.SHOW)}}]),t}(He.a);Zf.TAB_IDX_KEY="_tabIdx",Zf.DATA_IDX_KEY="_dataIdx",Zf.CUSTOM_CLICK_EVENT_NAME="click.DESIGN_TYPE_SELECT";var qf=function(e){function t(e,n,i,a,o){var s;return L()(this,t),(s=V()(this,F()(t).call(this,new Jt(e,Q.a.TEMPLATE,Do.a.BIZHOWS)))).sheetSize=n,s.openSubPage=i,s.searchKeywordCallback=a,s.getTemplateParam=o,s}return z()(t,e),w()(t,[{key:"loadTemplateDesign",value:function(){he()(F()(t.prototype),"loadTemplateDesign",this).call(this,this.getTemplateSheetSize(),void 0,this.isKeepSheetSizeWhenLoadTemplate())}},{key:"getThumbUrlList",value:function(){if(this.thumbUrlList)return this.thumbUrlList;if(it.a.isEmpty(this.listItemData.resourceData.imgUrlList)){this.thumbUrlList=[];var e,t=0;do{(e=this.listItemData.resourceData["imgURL".concat(t++)])&&this.thumbUrlList.push(e)}while(null!=e)}else this.thumbUrlList=this.listItemData.resourceData.imgUrlList;return this.thumbUrlList}},{key:"doAction",value:function(){var e=this.getThumbUrlList();it.a.isEmpty(e)||e.length<2?he()(F()(t.prototype),"doAction",this).call(this):this.openSubPage(this)}},{key:"makeHoverLayer",value:function(){var e=he()(F()(t.prototype),"makeHoverLayer",this).call(this);e.appendChild(this.makeDddot());var n=this.getThumbUrlList();if(!it.a.isEmpty(n)&&n.length>1){var i=document.createElement("label");i.innerText=String(n.length),i.className=r.a.PAGE_CNT,e.appendChild(i)}return e}},{key:"makeDddot",value:function(){var e=this,t=new Im({searchKeywordCallback:this.searchKeywordCallback});t.setOnCloseListener(this);var n=this.dddotBtn=ap.makeDddotBtn(s()(a.a.mark(function i(){var o;return a.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.onOpenDddot();case 2:o=e.listItemData.myCollectionPk,t.openTemplateInfo({designIdx:Number(o.referenceKey),repositoryType:o.repositoryType,favoritesParam:{useFavorite:!0,myCollectionPk:o},offset:$(n).offset(),templateLoadKey:e.listItemData.dropEventKey,bizDetailSiteMapIdx:e.getTemplateParam().siteMapIdx,sheetSize:e.getTemplateParam().sheetSize});case 4:case"end":return i.stop()}},i)})));return n}},{key:"getEECItemData",value:function(e,t,n){var i=this.listItemData.resourceData.pkName||this.listItemData.resourceData.designIdx,a="비즈템플릿:".concat(i),o=e.split(">");return{name:a,id:a,price:0,brand:"템플릿",category:e,variant:3===o.length?o[1].length>10?o[2]:o[2].indexOf(o[1])>-1?o[2]:"".concat(o[1]," ").concat(o[2]):o.join(" "),list:t,position:n}}},{key:"getTemplateSize",value:function(){return this.sheetSize.clone()}},{key:"getTitle",value:function(){return this.listItemData.resourceData.designTitle}},{key:"getTemplateSheetSize",value:function(){return this.getTemplateParam().sheetSize}},{key:"isKeepSheetSizeWhenLoadTemplate",value:function(){return!1}}]),t}(mm);function $f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}var Qf,Jf,ev,tv=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).state={isCheckboxChecked:n.props.isCookieChecked},n.isMouseDownOnProp=!1,n}return z()(t,e),w()(t,[{key:"onClickClose",value:function(){this.state.isCheckboxChecked&&Go.b.setCookie(Go.a.BIZ_TEMPLATE_NOTICE,Go.a.BIZ_TEMPLATE_NOTICE,7,0,0),this.props.onClose()}},{key:"onChangeCheckbox",value:function(){this.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$f(n,!0).forEach(function(t){Wc()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$f(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},this.state,{isCheckboxChecked:!this.state.isCheckboxChecked}))}},{key:"renderBody",value:function(){var e={textIndent:"-18px",paddingLeft:"18px"};return ra.a.createElement("div",{className:r.a.BODY},ra.a.createElement("p",{className:r.a.TITLE},"비즈하우스 템플릿 안내"),ra.a.createElement("p",null,ra.a.createElement("b",null,"비즈템플릿"),"을 사용하기 전 아래의 유의사항을 확인해주세요."),ra.a.createElement("div",{className:r.a.CONTENTS},ra.a.createElement("p",{style:e},"① 일부 템플릿은 정상적으로 보이지 않을 수 있습니다."),ra.a.createElement("p",{style:e},"② 현재 인쇄출력 용도로는 제공하고 있지 않습니다. 인쇄출력용 디자인이 필요한 경우"," ",ra.a.createElement("a",{href:"http://www.bizhows.com",target:"_blank"},"비즈하우스")," ","서비스를 이용해주시기 바랍니다.")),ra.a.createElement("p",null,"현재 비즈템플릿은 미리캔버스에서 사용하기 위해",ra.a.createElement("br",null),"최적화 변환 작업 중입니다."))}},{key:"renderFooter",value:function(){var e=this;return ra.a.createElement("div",{className:r.a.FOOTER},ra.a.createElement("label",{className:this.props.isCookieChecked?r.a.ACTIVE:""},ra.a.createElement("input",{type:"checkbox",defaultChecked:this.props.isCookieChecked,onChange:function(){return e.onChangeCheckbox()}}),ra.a.createElement("i",{className:Yr()(ne.TOOLS_ICON_CLASS,Object(ne.getToolsIconName)(ne.ToolsIcon.CHECK))}),ra.a.createElement("span",null,"7일간 보지 않기")),ra.a.createElement("button",{onClick:function(){return e.onClickClose()}},"닫기"))}},{key:"render",value:function(){var e=this;return ra.a.createElement("div",{id:"bizTemplateNoticePopup",className:Yr()(r.a.POPUP,"responsive",r.a.ACTIVE),tabIndex:0,onClick:function(t){t.preventDefault(),e.isMouseDownOnProp||e.props.onClose()},onKeyDown:function(e){return e.stopPropagation()},onMouseDown:function(){return e.isMouseDownOnProp=!1}},ra.a.createElement("div",{className:r.a.POPUP_CONTENTS_WRAP,onClick:function(e){return e.stopPropagation()},onMouseDown:function(t){t.stopPropagation(),e.isMouseDownOnProp=!0}},ra.a.createElement("i",{className:Yr()(ne.TOOLS_ICON_CLASS,Object(ne.getToolsIconName)(ne.ToolsIcon.CLOSE)),onClick:function(){return e.props.onClose()}}),ra.a.createElement("div",null,this.renderBody(),this.renderFooter())))}}]),t}(sa.Component),nv=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"dispatchTemplateLoadAction",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];X.a.instance.dispatch(new lc.a(e,t,n,i))}},{key:"getTemplateSheetSize",value:function(){}},{key:"isKeepSheetSizeWhenLoadTemplate",value:function(){return!0}}]),t}(qf),iv=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).initBizTemplateNoticeCookiePopup=!1,e.lib=new ym.a({makeListItem:function(t){return e.makeListItem(t)}}),e.leftPanelType=So.b.BIZ_TEMPLATE_LIB,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.LIBRARY_BIZ_TEMPLATE,S.a.getTemplatePanelOption().header&&this.container.appendChild(this.makeHeader()),this.container.appendChild(this.makeAdminUI()),this.container.appendChild(this.makeSearchTool()),this.container.appendChild(this.makeTemplateTypeTool()),this.container.appendChild(this.makeListSection());var e=this.toolWindowTwoLayerSelectView.getList()[0];this.setTemplateParam(e.templateParamList[0],!1),this.setLinked("false",!1)}},{key:"setKeyword",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=e?e.trim():"",this.searchTool.updateUI(e),this.lib.setKeyword(e),t&&this.loadListSync()}},{key:"setTemplateParam",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.lib.setTemplateParam(e),t&&this.loadListSync()}},{key:"setLinked",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.linkedRadioTool.select(e,!1),this.lib.setLinked("true"===e),t&&this.loadListSync()}},{key:"loadListSync",value:function(){this.openBizTemplateNoticePopup(),this.subPagesTool.setVisibility(!1),this.paginationListTool.setColSize(this.getListColSize()),this.paginationListTool.initList()}},{key:"onPaginationFinishRender",value:function(e){he()(F()(t.prototype),"onPaginationFinishRender",this).call(this,e);var n=this.lib.getKeyword()||"",i=this.toolWindowTwoLayerSelectView.getTitle();n&&Te.a.sendSearchReport({type:Te.b.BIZ_TEMPLATE,keyword:n,category:i,totalRow:e})}},{key:"getListColSize",value:function(){var e=this.lib.getTemplateParam().sheetSize;return yn.getColsByRatio(e.width/e.height)}},{key:"makeHeader",value:function(){var e=this,t=document.createElement("div");t.className=r.a.HEADER;var n=document.createElement("a");n.href="http://www.bizhows.com",n.target="_blank",t.appendChild(n);var i=document.createElement("button");Object(ne.setToolsIcon)(i,ne.ToolsIcon.OUTLINE);var a=document.createElement("span");return a.innerText="템플릿 안내",i.appendChild(a),i.addEventListener("click",function(){return e.openBizTemplateNoticePopup(!1)}),t.appendChild(i),t}},{key:"makeAdminUI",value:function(){var e=this;return this.adminUIElement=document.createElement("div"),this.adminUIElement.className=r.a.ADMIN_UI,this.linkedRadioTool=new be.b(function(t){return e.setLinked(t)},[new be.a("호환","true",!1),new be.a("비호환","false",!0)]),this.adminUIElement.appendChild(this.linkedRadioTool.getContainer()),this.adminUIElement}},{key:"makeSearchTool",value:function(){var e=this;return this.searchTool=new dh.a(function(t){return e.setKeyword(t)},"검색어를 입력하세요."),this.searchTool.getContainer()}},{key:"makeTemplateTypeTool",value:function(){var e=this,t=Object(ym.b)();return this.toolWindowTwoLayerSelectView=new Zf(t,{label:"name",list:"templateParamList"},function(t){return e.setTemplateParam(t)}),this.toolWindowTwoLayerSelectView.setGtmData("lib_biz_template"),this.toolWindowTwoLayerSelectView.getContainer()}},{key:"makeListSection",value:function(){var e=document.createElement("div");return e.className=r.a.LIST_SECTION,e.appendChild(this.paginationListTool.getContainer()),e.appendChild(this.makeSubPagesTool()),e}},{key:"getJustifiedListToolOption",value:function(){return null}},{key:"openBizTemplateNoticePopup",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&this.initBizTemplateNoticeCookiePopup||(this.initBizTemplateNoticeCookiePopup=!0,t&&Go.a.BIZ_TEMPLATE_NOTICE===Go.b.getCookie(Go.a.BIZ_TEMPLATE_NOTICE)||(this.bizTemplateNoticePopupDomView=new Fo.a(document.body,tv,{onClose:function(){return e.bizTemplateNoticePopupDomView.destroy()},isCookieChecked:t},!0)))}},{key:"updateUI",value:function(){he()(F()(t.prototype),"updateUI",this).call(this),this.onCreateViewIfNotCreated(),this.enableStyle(Ke.a.getUserSetting().adminMode,this.adminUIElement,r.a.ACTIVE)}},{key:"makeListItem",value:function(e){var t=this;return new(S.a.getExecutionMode().isBizhowsChannelAndOrderPurpose()?nv:qf)(e,this.lib.getTemplateParam().sheetSize,function(e){return t.openSubPage(e)},function(e){return t.setKeyword(e)},function(){return t.lib.getTemplateParam()})}},{key:"openSubPage",value:function(e){this.subPagesTool.updateUI({listItem:e,cols:this.getListColSize()}),this.subPagesTool.setVisibility(!0)}},{key:"getItemUseEventData",value:function(){var e=this.lib.getGTMLibData();return{type:Te.b.BIZ_TEMPLATE,category:e.category,keyword:e.keyword}}},{key:"onDataChanged",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return he()(F()(t.prototype),"onDataChanged",this).call(this,e,n),this.isActive()&&this.fetchList(),this.container}}]),t}(Ih);!function(e){e.SIMILAR="SIMILAR",e.SQUARE="SQUARE",e.HORIZONTAL="HORIZONTAL",e.VERTICAL="VERTICAL",e.LONG_HORIZONTAL="LONG_HORIZONTAL",e.LONG_VERTICAL="LONG_VERTICAL"}(ev||(ev={}));var av,ov=(Qf={},Wc()(Qf,ev.SIMILAR,"비율이 유사한"),Wc()(Qf,ev.SQUARE,"정사각형"),Wc()(Qf,ev.HORIZONTAL,"가로형"),Wc()(Qf,ev.VERTICAL,"세로형"),Wc()(Qf,ev.LONG_HORIZONTAL,"긴 가로형"),Wc()(Qf,ev.LONG_VERTICAL,"긴 세로형"),Qf),sv=function(){function e(t,n,i){L()(this,e),this.min=t,this.max=n,this.radTerm=i}return w()(e,[{key:"isInRange",value:function(e,t){return this.radTerm?this.isInRangeBySheetSize(e,t):this.isInRangeByMinMax(e)}},{key:"isInRangeBySheetSize",value:function(e,t){var n=Math.atan2(e.width,e.height),i=Math.atan2(t.width,t.height);return i-this.radTerm<=n&&n<i+this.radTerm}},{key:"isInRangeByMinMax",value:function(e){var t=e.width/e.height;return this.min===this.max?t===this.min:(!this.min||this.min<=t)&&(!this.max||t<this.max)}}]),e}(),rv=(Jf={},Wc()(Jf,ev.SIMILAR,new sv(0,0,.14)),Wc()(Jf,ev.SQUARE,new sv(1,1)),Wc()(Jf,ev.HORIZONTAL,new sv(1,2.5)),Wc()(Jf,ev.VERTICAL,new sv(.45,1)),Wc()(Jf,ev.LONG_HORIZONTAL,new sv(2.5,0)),Wc()(Jf,ev.LONG_VERTICAL,new sv(0,.45)),Jf);(av=ev||(ev={})).getName=function(e){return ov[e]},av.getRatioRange=function(e){return rv[e]};var lv=function e(t){L()(this,e),this.selected=!1,this.value=t},cv=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).shapes=e,n}return z()(t,e),t}(Xh),uv=new(function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"setFilterDataInternal",value:function(e){this.getShapeMenuItems().forEach(function(t){return t.selected=e.shapes.has(t.value)})}},{key:"getShapeMenuItems",value:function(){return this.shapeMenuItems||(this.shapeMenuItems=[new lv(ev.SIMILAR),new lv(ev.SQUARE),new lv(ev.HORIZONTAL),new lv(ev.VERTICAL),new lv(ev.LONG_HORIZONTAL),new lv(ev.LONG_VERTICAL)]),this.shapeMenuItems}},{key:"getSelectedShape",value:function(){var e=this.getShapeMenuItems().find(function(e){return e.selected});return e?e.value:null}},{key:"getSelectedShapes",value:function(){return this.getShapeMenuItems().filter(function(e){return e.selected}).map(function(e){return e.value})}},{key:"hasSelectedShapes",value:function(){return this.getSelectedShapes().length>0}}]),t}(jh)),dv=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,!0))).onClick=e,n}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className="btn_back",Object(ne.setToolsIcon)(this.container,ne.ToolsIcon.GREATER_THAN,!0),this.container.addEventListener("click",function(t){e.onClick()})}}]),t}(He.a),hv=n(262),pv=n(414),mv=function(e){function t(e,n,i,a){var o;return L()(this,t),(o=V()(this,F()(t).call(this,new Jt(e,Q.a.TEMPLATE,Do.a.UNICORN)))).showThumbnailHorizontal=!1,o.resourceData=e,o.openSubPage=n,o.searchKeywordCallback=i,o.onAfterTemplateLoaded=a,0!==Object.keys(e.highestPriorityTemplateType).length&&(o.showThumbnailHorizontal=!0,o.templateType=e.highestPriorityTemplateType),o}return z()(t,e),w()(t,[{key:"loadTemplateDesign",value:function(){he()(F()(t.prototype),"loadTemplateDesign",this).call(this,void 0,this.getTemplateType(),this.isKeepSheetSizeWhenLoadTemplate())}},{key:"setTemplateType",value:function(e){return this.templateType=e,this.thumb&&this.isShowMultipleThumb()&&(this.container.removeChild(this.container.firstChild),this.appendMultipleThumbs(3)),this}},{key:"isShowMultipleThumb",value:function(){return this.templateType&&"detail_page"===this.templateType.id}},{key:"getTemplateType",value:function(){return this.templateType}},{key:"getThumbUrlList",value:function(){return this.listItemData.resourceData.pageList.map(function(e){return e.thumb300Url})}},{key:"makeElement",value:function(){this.isShowMultipleThumb()?this.appendMultipleThumbs(3):this.container.appendChild(this.makeThumbImg()),this.container.appendChild(this.makeHoverLayer())}},{key:"appendMultipleThumbs",value:function(e){this.container.classList.toggle("thumbnail_wrap"),this.container.classList.toggle("horizontal",this.showThumbnailHorizontal);for(var t=this.getThumbUrlList(),n=0;n<e&&n<t.length;n++){var i=jt.a.getImageElementWithReplaceableThumbnail();i.src=t[n],this.container.appendChild(i)}}},{key:"doAction",value:function(){var e=this.getThumbUrlList();it.a.isEmpty(e)||e.length<2?he()(F()(t.prototype),"doAction",this).call(this):this.openSubPage(this)}},{key:"makeHoverLayer",value:function(){var e=this,n=he()(F()(t.prototype),"makeHoverLayer",this).call(this),i=Object(ne.setToolsIcon)(n,ne.ToolsIcon.SETTINGS,!0);i.addEventListener("click",function(t){t.stopPropagation(),X.a.instance.dispatch(new K.c(function(){var t=s()(a.a.mark(function t(n,i,o){var s,r,l,c;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=Number(e.listItemData.myCollectionPk.referenceKey),t.next=3,hv.a.instance.getTemplateProjectList("templateIdx=".concat(s));case 3:if(r=t.sent,!it.a.isEmpty(r.list)){t.next=7;break}return alert("프로젝트가 없는 템플릿입니다. (구 템플릿 데이터) idx = ".concat(s)),t.abrupt("return");case 7:return o.showTemplateProjectPanel(!0),l=pv.a.getTemplateProjectVC().templateProjectManagementMenu,t.next=11,l.loadProject(r.list[0].idx);case 11:if(c=l.moveTemplateListTab().getTemplateListView(),c.selectTemplate(s)){t.next=16;break}return t.next=16,c.searchTemplate(s);case 16:case"end":return t.stop()}},t)}));return function(e,n,i){return t.apply(this,arguments)}}()))}),n.appendChild(i),n.appendChild(this.makeDddot());var o=this.getThumbUrlList();if(!it.a.isEmpty(o)&&o.length>1){var l=document.createElement("label");l.innerText=String(o.length),l.className=r.a.PAGE_CNT,n.appendChild(l)}return n}},{key:"makeDddot",value:function(){var e=this,t=new gm({searchKeywordCallback:this.searchKeywordCallback,onAfterTemplateLoaded:this.onAfterTemplateLoaded.bind(this)});t.setOnCloseListener(this);var n=this.dddotBtn=document.createElement("div");n.className="".concat(r.a.DDDOT_WRAP);var i=Object(ne.setToolsIcon)(n,ne.ToolsIcon.DDDOT);return n.appendChild(i),i.addEventListener("click",function(){var n=s()(a.a.mark(function n(o){var s;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o.stopPropagation(),n.next=3,e.onOpenDddot();case 3:s=e.listItemData.myCollectionPk,t.openTemplateInfo({designIdx:Number(s.referenceKey),repositoryType:s.repositoryType,favoritesParam:{useFavorite:!0,myCollectionPk:s},offset:$(i).offset(),templateLoadKey:e.listItemData.dropEventKey,templateType:e.getTemplateType()});case 5:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()),n}},{key:"getEECItemData",value:function(e,t,n){var i=this.listItemData.myCollectionPk,a=Object(Q.c)(i.resourceType),o=this.getVariant(),s="".concat(a,":").concat(i.referenceKey);return{name:s,id:s,price:0,brand:"템플릿",category:e,variant:o,list:t,position:n}}},{key:"getVariant",value:function(){var e=this.getTemplateType();return e.groupTitle?"".concat(e.groupTitle," ").concat(e.title):e.title}},{key:"getTitle",value:function(){return this.listItemData.resourceData.title}},{key:"isKeepSheetSizeWhenLoadTemplate",value:function(){return!1}}]),t}(mm),fv=function(e){function t(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ke.a.getUserSetting().adminMode;return L()(this,t),(i=V()(this,F()(t).call(this))).templateTypeListAll=e,i.isActiveFromParam=n,i.adminMode=a,i}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return Boolean(this.templateTypeListAll)!==Boolean(e.templateTypeListAll)||this.templateTypeListAll&&e.templateTypeListAll&&(this.templateTypeListAll.length!==e.templateTypeListAll.length||this.templateTypeListAll.some(function(t,n){return t.id!==e.templateTypeListAll[n].id}))||this.isActiveFromParam!==e.isActiveFromParam||this.adminMode!==e.adminMode}}]),t}(He.b),vv=function(e){function t(e){return L()(this,t),V()(this,F()(t).call(this,e))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add(r.a.ALL_TYPE_TEMPLATE_LIST)}},{key:"renderView",value:function(e){var n=this;if(he()(F()(t.prototype),"renderView",this).call(this),void 0===e&&this.contentsStates&&(e=this.contentsStates.templateTypeListAll),this.checkUpContentsChange(new fv(e,this.props.isActive())),this.contentsStatesChanged)if(this.contentsStates.isActiveFromParam){this.container.innerHTML="";var i=!it.a.isEmpty(this.contentsStates.templateTypeListAll);this.setVisibility(i),i&&(this.contentsStates.templateTypeListAll.forEach(function(e){var t=e.id;n.templateListViewMap.has(t)||n.makeTemplateListView(t),n.container.appendChild(n.templateListViewMap.get(t).init().getContainer())}),this.fetchListMore())}else this.setVisibility(!1)}},{key:"fetchListMore",value:function(){var e=it.a.nvl(this.contentsStates.templateTypeListAll,[]),n=0,i=!0,a=!1,o=void 0;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value,c=this.templateListViewMap.get(l.id);if(!c.fetched&&(n++,c.fetched=!0,c.setVisibility(!0),this.getTemplateDC().loadMultiTypeList(l,this),n===t.MAX_RENDER_CNT_AT_ONCE))break}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}n>0&&this.listener.onRenderedMultipleList(this)}},{key:"onFetchMultiTypeTemplateList",value:function(e,t){t.forEach(function(t){return t.setTemplateType(e)}),this.templateListViewMap.get(e.id).renderView(t,e,e?e.getTitleWithGroupPrefix():""),this.onFetchList()}},{key:"onShowMore",value:function(e){this.listener&&this.listener.onMoveDetail({templateType:e})}}]),t}(un);vv.MAX_RENDER_CNT_AT_ONCE=5;var gv=vv,Ev=function(e){function t(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ke.a.getUserSetting().adminMode,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ke.a.getUserSetting().leftPanelPaginationMode;return L()(this,t),(i=V()(this,F()(t).call(this))).selectedTemplateType=e,i.isActiveFromParam=n,i.adminMode=a,i.paginationMode=o,i}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return Boolean(this.selectedTemplateType)!==Boolean(e.selectedTemplateType)||this.selectedTemplateType&&e.selectedTemplateType&&this.selectedTemplateType.id!==e.selectedTemplateType.id||this.isActiveFromParam!==e.isActiveFromParam||this.adminMode!==e.adminMode||this.paginationMode!==e.paginationMode}},{key:"isActive",value:function(){return this.isActiveFromParam&&Boolean(this.selectedTemplateType)}}]),t}(He.b),yv=function(e){function t(e){return L()(this,t),V()(this,F()(t).call(this,e))}return z()(t,e),w()(t,[{key:"renderView",value:function(e){he()(F()(t.prototype),"renderView",this).call(this),void 0===e&&this.contentsStates&&(e=this.contentsStates.selectedTemplateType),this.checkUpContentsChange(new Ev(e?e.shallowClone():void 0,this.props.isActive())),this.contentsStatesChanged&&(this.contentsStates.isActive()?(this.container.innerHTML="",vp.a.fetchList(this.contentsStates.selectedTemplateType.getKeywordCategoryType(),this)):this.setVisibility(!1))}},{key:"onKeywordCategoryFetched",value:function(e,t){if(this.contentsStates.selectedTemplateType.getKeywordCategoryType()===e){var n=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var r=o.value,l=this.getListViewKey(r);this.templateListViewMap.has(l)||this.makeTemplateListView(l);var c=this.templateListViewMap.get(l);this.fetchListView(c,r,this.contentsStates.selectedTemplateType),this.container.appendChild(c.getContainer())}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}this.setVisibility(!it.a.isEmpty(t))}}},{key:"fetchListView",value:function(e,t,n){var i=this;s()(a.a.mark(function o(){var s;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,i.getTemplateDC().setTemplateType(n),i.getTemplateDC().setKeyword(t),a.next=5,i.getTemplateDC().fetchElementList({page:1,pageSize:un.LIST_SIZE},!0);case 5:s=a.sent,e.renderView(s.items,t,t),a.next=13;break;case 9:a.prev=9,a.t0=a.catch(0),console.error(a.t0),e.renderView([],t,t);case 13:return a.prev=13,i.onFetchList(),a.finish(13);case 16:case"end":return a.stop()}},o,null,[[0,9,13,16]])}))()}},{key:"getListViewKey",value:function(e){return"".concat((this.contentsStates.selectedTemplateType?this.contentsStates.selectedTemplateType:an.d.ALL_TYPE).id,"_").concat(e)}},{key:"onShowMore",value:function(e){this.listener&&this.listener.onMoveDetail({keyword:e})}}]),t}(un),Tv=function(e){function t(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.a.getUser().isLogin();return L()(this,t),(i=V()(this,F()(t).call(this))).designResourceType=e,i.needFromParent=n,i.isLogin=a,i}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return this.designResourceType!==e.designResourceType||this.needFromParent!==e.needFromParent||this.isLogin!==e.isLogin}},{key:"isVisible",value:function(){return this.isLogin&&this.needFromParent&&!!this.designResourceType}}]),t}(He.b),Iv=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).props=e,n.designResourceType=gn.a.TEMPLATE,En.addListener(H()(n)),n}return z()(t,e),w()(t,[{key:"renderView",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.contentsStates?this.contentsStates.designResourceType:void 0;if(he()(F()(t.prototype),"renderView",this).call(this),this.checkUpContentsChange(new Tv(e,this.props.needFromParent())),this.contentsStatesChanged){var n=this.isVisibleState();this.setVisibility(n),n&&(this.designResourceType=e,En.fetchList(this.designResourceType))}}},{key:"makeListItemView",value:function(e){return this.props.makeListItemView(e)}},{key:"isVisibleState",value:function(){return this.contentsStates.isVisible()}}]),t}(Cp),Cv=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).containerRef=Object(sa.createRef)(),n}return z()(t,e),w()(t,[{key:"render",value:function(){var e=this.props,t=e.templateShape,n=e.selected;return ra.a.createElement("div",{ref:this.containerRef,key:t,className:n?r.a.SELECTED:"","data-shape":t},ra.a.createElement("div",{className:r.a.ICON}),ra.a.createElement("div",{className:r.a.NAME},ev.getName(t)),ra.a.createElement(la.a,{icon:ne.ToolsIcon.CHECK}))}},{key:"componentDidMount",value:function(){var e=this;this.containerRef.current.addEventListener("click",function(t){return e.props.onToggleTemplateShape(e.props.templateShape,!e.props.selected)})}}]),t}(sa.Component),kv=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).state={shapeMenuItems:[],selectedShapes:new Set},n}return z()(t,e),w()(t,[{key:"renderBody",value:function(){var e=this,t=this.state,n=t.shapeMenuItems,i=t.selectedShapes;return ra.a.createElement(ra.a.Fragment,null,ra.a.createElement("div",{className:r.a.TITLE},"형태"),ra.a.createElement("div",{className:r.a.CONTENTS},n.map(function(t){return ra.a.createElement(Cv,{key:t.value,selected:i.has(t.value),templateShape:t.value,onToggleTemplateShape:e.onToggleTemplateShape.bind(e)})})))}},{key:"refresh",value:function(){var e=uv.getShapeMenuItems(),t=new Set(e.filter(function(e){return e.selected}).map(function(e){return e.value}));this.setState({shapeMenuItems:e,selectedShapes:t})}},{key:"onToggleTemplateShape",value:function(e,t){var n=new Set(this.state.selectedShapes);t?n.add(e):n.delete(e),this.state.selectedShapes.size!==n.size&&this.setState({selectedShapes:n})}},{key:"onApplyFilter",value:function(){uv.setFilterState(new cv(this.state.selectedShapes))}},{key:"onClearFilter",value:function(){this.setState({selectedShapes:new Set})}}]),t}(om),Lv=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add(r.a.TEMPLATE_PANEL)}},{key:"getFilterMenu",value:function(){if(this.filterMenu)return this.filterMenu;var e=document.createElement("div");return e.className=r.a.SEARCH_FILTER_MENU,this.filterMenu=_a.a.render(ra.a.createElement(kv),e),this.container.appendChild(e),this.filterMenu}},{key:"getSelectedFilterItemCount",value:function(){return uv.hasSelectedShapes()?1:0}}]),t}(am),_v=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.filterView=new Lv,this.filterView.setOnClickListener(this),this.filterView.setVisibility(!1),this.container.insertBefore(this.filterView.getContainer(),this.container.firstChild)}},{key:"renderView",value:function(e){he()(F()(t.prototype),"renderView",this).call(this),this.filterView.setVisibility(e.isAllType())}}]),t}(dh.a),wv=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"dispatchTemplateLoadAction",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];X.a.instance.dispatch(new lc.a(e,t,n,i))}},{key:"getTemplateType",value:function(){}},{key:"isKeepSheetSizeWhenLoadTemplate",value:function(){return!0}}]),t}(mv),Sv=function e(t,n){L()(this,e),this.title=t,this.url=n},bv=function(){function e(){L()(this,e)}return w()(e,null,[{key:"initTemplateBannerDataListMap",value:function(){var e="http://www.bizhows.com";this.templateBannerDataListMap=new Map([["presentation",new Sv("PPT","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26924&pog_seq=992&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_ppt&utm_campaign=PR1_promotion_type1"))],["youtube_thumb",new Sv("유튜브 썸넬","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26923&pog_seq=991&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_youtube&utm_campaign=PR1_promotion_type1"))],["youtube_cover",new Sv("채널아트","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26923&pog_seq=991&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_youtube&utm_campaign=PR1_promotion_type1"))],["detail_page",new Sv("상세페이지","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26921&pog_seq=989&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_detail&utm_campaign=PR1_promotion_type1"))],["social_media_square",new Sv("SNS이미지","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26925&pog_seq=993&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_sns&utm_campaign=PR1_promotion_type1"))],["card_news",new Sv("카드뉴스","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26926&pog_seq=994&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_cardnews&utm_campaign=PR1_promotion_type1"))],["web_post_hor_poster",new Sv("웹포스터","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26964&pog_seq=988&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_webposter&utm_campaign=PR1_promotion_type1"))],["web_post_ver_poster",new Sv("웹포스터","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26964&pog_seq=988&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_webposter&utm_campaign=PR1_promotion_type1"))],["groobee_big",new Sv("이벤트","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26922&pog_seq=990&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_event&utm_campaign=PR1_promotion_type1"))],["logo",new Sv("로고","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26910&pog_seq=986&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_logo&utm_campaign=PR1_promotion_type1"))],["web_banner_hor",new Sv("웹 배너","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26920&pog_seq=999&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_webbanner&utm_campaign=PR1_promotion_type1"))],["web_post_ver",new Sv("웹 배너","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26920&pog_seq=999&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_webbanner&utm_campaign=PR1_promotion_type1"))],["web_post_square",new Sv("웹 배너","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26920&pog_seq=999&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_webbanner&utm_campaign=PR1_promotion_type1"))],["web_banner_ver",new Sv("웹 배너","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26920&pog_seq=999&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_webbanner&utm_campaign=PR1_promotion_type1"))],["business_card_hor",new Sv("명함","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26860&pog_seq=968&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_business&utm_campaign=PR1_promotion_type1"))],["business_card_ver",new Sv("명함","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26860&pog_seq=968&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_business&utm_campaign=PR1_promotion_type1"))],["sticker_square",new Sv("스티커","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26861&pog_seq=969&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_sticker&utm_campaign=PR1_promotion_type1"))],["sticker_circle",new Sv("스티커","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26861&pog_seq=969&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_sticker&utm_campaign=PR1_promotion_type1"))],["sticker_rect",new Sv("스티커","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26861&pog_seq=969&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_sticker&utm_campaign=PR1_promotion_type1"))],["sticker_oval",new Sv("스티커","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26861&pog_seq=969&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_sticker&utm_campaign=PR1_promotion_type1"))],["sticker_vertical_rect",new Sv("스티커","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26861&pog_seq=969&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_sticker&utm_campaign=PR1_promotion_type1"))],["placard_hor",new Sv("현수막","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26850&pog_seq=962&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_placard&utm_campaign=PR1_promotion_type1"))],["placard_ver",new Sv("현수막","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26850&pog_seq=962&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_placard&utm_campaign=PR1_promotion_type1"))],["placard_square",new Sv("현수막","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26850&pog_seq=962&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_placard&utm_campaign=PR1_promotion_type1"))],["placard_poster_hor",new Sv("현수막","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26850&pog_seq=962&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_placard&utm_campaign=PR1_promotion_type1"))],["placard_poster_ver",new Sv("현수막","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26850&pog_seq=962&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_placard&utm_campaign=PR1_promotion_type1"))],["placard_banner_ver",new Sv("현수막","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26850&pog_seq=962&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_placard&utm_campaign=PR1_promotion_type1"))],["banner",new Sv("배너","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26851&pog_seq=963&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_banner&utm_campaign=PR1_promotion_type1"))],["poster_ver_print",new Sv("포스터","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26872&pog_seq=974&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_poster&utm_campaign=PR1_promotion_type1"))],["poster_hor_print",new Sv("포스터","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26872&pog_seq=974&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_poster&utm_campaign=PR1_promotion_type1"))],["real_print_ver",new Sv("실사출력","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26853&pog_seq=965&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_realistic&utm_campaign=PR1_promotion_type1"))],["real_print_hor",new Sv("실사출력","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26853&pog_seq=965&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_realistic&utm_campaign=PR1_promotion_type1"))],["web_flyer_single",new Sv("전단지","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26870&pog_seq=971&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_flyer&utm_campaign=PR1_promotion_type1"))],["web_flyer_double",new Sv("전단지","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26870&pog_seq=971&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_flyer&utm_campaign=PR1_promotion_type1"))],["flyer_magnetic_single",new Sv("전단지","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26871&pog_seq=972&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_papermagnet&utm_campaign=PR1_promotion_type1"))],["flyer_magnetic_paper",new Sv("전단지","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26871&pog_seq=972&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_papermagnet&utm_campaign=PR1_promotion_type1"))],["flyer_magnet_circle",new Sv("전단지","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26962&pog_seq=973&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_magnet&utm_campaign=PR1_promotion_type1"))],["flyer_magnet_rounded_rect",new Sv("전단지","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26962&pog_seq=973&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_magnet&utm_campaign=PR1_promotion_type1"))],["magnet_opener_circle",new Sv("자석 오프너","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26963&pog_seq=981&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_opener&utm_campaign=PR1_promotion_type1"))],["magnet_opener_pet",new Sv("자석 오프너","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26963&pog_seq=981&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_opener&utm_campaign=PR1_promotion_type1"))],["magnet_opener_tongs",new Sv("자석 오프너","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26963&pog_seq=981&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_opener&utm_campaign=PR1_promotion_type1"))],["hand_fan",new Sv("부채","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26874&pog_seq=980&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_fan&utm_campaign=PR1_promotion_type1"))],["leaflet_2_stages",new Sv("리플렛","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26877&pog_seq=976&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_leaflet&utm_campaign=PR1_promotion_type1"))],["leaflet_3_stages",new Sv("리플렛","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26877&pog_seq=976&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_leaflet&utm_campaign=PR1_promotion_type1"))],["brochure_catalogue_ver",new Sv("브로셔","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26878&pog_seq=977&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_brochure&utm_campaign=PR1_promotion_type1"))],["brochure_catalogue_hor",new Sv("브로셔","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26878&pog_seq=977&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_brochure&utm_campaign=PR1_promotion_type1"))],["l_holder",new Sv("홀더","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26873&pog_seq=979&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_holder&utm_campaign=PR1_promotion_type1"))],["ticket_hor",new Sv("티켓","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26875&pog_seq=975&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_ticket&utm_campaign=PR1_promotion_type1"))],["ticket_ver",new Sv("티켓","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26875&pog_seq=975&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_ticket&utm_campaign=PR1_promotion_type1"))],["ticket_perforation_hor",new Sv("티켓","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26875&pog_seq=975&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_ticket&utm_campaign=PR1_promotion_type1"))],["ticket_perforation_ver",new Sv("티켓","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26875&pog_seq=975&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_ticket&utm_campaign=PR1_promotion_type1"))],["ticket_perforation_hor_S",new Sv("티켓","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26875&pog_seq=975&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_ticket&utm_campaign=PR1_promotion_type1"))],["ticket_perforation_hor_M",new Sv("티켓","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26875&pog_seq=975&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_ticket&utm_campaign=PR1_promotion_type1"))],["ticket_perforation_hor_L",new Sv("티켓","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26875&pog_seq=975&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_ticket&utm_campaign=PR1_promotion_type1"))],["ticket_perforation_ver_S",new Sv("티켓","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26875&pog_seq=975&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_ticket&utm_campaign=PR1_promotion_type1"))],["ticket_perforation_ver_M",new Sv("티켓","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26875&pog_seq=975&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_ticket&utm_campaign=PR1_promotion_type1"))],["ticket_perforation_ver_L",new Sv("티켓","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26875&pog_seq=975&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_ticket&utm_campaign=PR1_promotion_type1"))],["envelope_jacket",new Sv("봉투","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26876&pog_seq=978"))],["envelope_small",new Sv("봉투","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26876&pog_seq=978"))],["envelope_big",new Sv("봉투","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26876&pog_seq=978"))],["envelope_ticket",new Sv("봉투","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26876&pog_seq=978"))],["led_panel_ver",new Sv("LED","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26853&pog_seq=965&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_realistic&utm_campaign=PR1_promotion_type1"))],["led_panel_hor",new Sv("LED","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26853&pog_seq=965&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_realistic&utm_campaign=PR1_promotion_type1"))],["stand_sign_small",new Sv("입간판","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26854&pog_seq=967&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_stand&utm_campaign=PR1_promotion_type1"))],["stand_sign_normal",new Sv("입간판","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26854&pog_seq=967&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_stand&utm_campaign=PR1_promotion_type1"))],["stand_sign_big",new Sv("입간판","".concat(e,"/mall/option/design_request_option.jsp?site_map_idx=26854&pog_seq=967&utm_source=miricanvas&utm_medium=promotion&utm_term=200723_%3F%3F_stand&utm_campaign=PR1_promotion_type1"))]])}},{key:"getTemplateBannerData",value:function(e){return this.templateBannerDataListMap||this.initTemplateBannerDataListMap(),this.templateBannerDataListMap.get(e)}}]),e}(),Rv=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add("clova_banner"),us.a.createElement('\n            <div class="left">\n                <img src="https://resource.miricanvas.com/image/library/clova_banner.png" />\n                <div>쉽게 영상 만드는 법 공개!</div>\n            </div>\n        ',this.container),us.a.createElement('\n            <div class="right">\n                <button>\n                    <span>바로가기</span><i class="tools_icon icon_greater_than"></i>\n                </button>\n            </div>\n        ',this.container),this.container.addEventListener("click",this.onClickClovaBanner.bind(this))}},{key:"renderView",value:function(e,n){e&&e.id===t.TEMPLATE_TYPE?this.clovaLinkUrl=t.TEMPLATE_TYPE_LINK:n&&n===t.KEYWORD?this.clovaLinkUrl=t.KEYWORD_LINK:this.clovaLinkUrl=""}},{key:"onClickClovaBanner",value:function(){window.open(this.clovaLinkUrl||t.TEMPLATE_TYPE_LINK,"_blank")}}],[{key:"isVisibleClova",value:function(e,n){return n&&n===t.KEYWORD||e&&e.id===t.TEMPLATE_TYPE}}]),t}(He.a);Rv.KEYWORD="학교 / 교육",Rv.TEMPLATE_TYPE="presentation",Rv.KEYWORD_LINK="https://www.miricanvas.com/s/258",Rv.TEMPLATE_TYPE_LINK="https://www.miricanvas.com/s/264";var Av=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this))).templateType=e,i.keyword=n,i}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return this.templateType!==e.templateType||this.keyword!==e.keyword}},{key:"isVisibleClova",value:function(){return Rv.isVisibleClova(this.templateType,this.keyword)}},{key:"isVisible",value:function(){return this.isVisibleClova()||this.templateType&&this.templateType.purpose&&(this.templateType.purpose===tn.a.WEB||this.templateType.purpose===tn.a.PRINT)}}]),t}(He.b),Ov=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.appendChild(this.replaceViewContainer=document.createElement("div")),this.container.id="templateBannerView",this.replaceViewContainer.classList.add("replace_view")}},{key:"renderView",value:function(e,n){if(he()(F()(t.prototype),"renderView",this).call(this),this.checkUpContentsChange(new Av(e,n)),this.contentsStatesChanged){var i=this.contentsStates.isVisible();if(this.setVisibility(i),i){var a=this.contentsStates.isVisibleClova();a?this.renderClova():this.renderDefault(),this.enableStyle(a,this.container,"replace")}}}},{key:"renderClova",value:function(){$(this.container).off("click"),this.replaceViewContainer.innerHTML="",this.clovaView||(this.clovaView=new Rv);var e=this.contentsStates,t=e.templateType,n=e.keyword;this.clovaView.renderView(t,n),this.replaceViewContainer.appendChild(this.clovaView.getContainer())}},{key:"renderDefault",value:function(){var e=bv.getTemplateBannerData(this.contentsStates.templateType.id),t=new Rf;e?t.setTitle("".concat(e.title," 디자인이 막막할 때,")).setContent("디자이너에게 의뢰하세요.").setImgUrl("".concat(fs.a.RESOURCE_DOMAIN,"image/library/web_promotion_banner.png")).setOnClickListener(this.onClickBanner.bind(this,e.url)):t.setTitle("디자인이 막막하시다면?").setContent("전문 디자이너에게 의뢰하세요!").setImgUrl("".concat(fs.a.RESOURCE_DOMAIN,"image/library/print_banner.png")).setOnClickListener(this.onClickBanner.bind(this,"http://www.bizhows.com/cms/design-intro/design-service/")),this.setContent(t)}},{key:"onClickBanner",value:function(e){var t=this;Ye.a.openLoginPopup(Ie.a.DESIGN_REQUEST_BANNER,s()(a.a.mark(function n(){var i,o,r,l;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if((i=f.a.getUser()).authStatus){n.next=10;break}return n.next=4,f.a.sendAuthEmail(i.email);case 4:o=function(){var n=s()(a.a.mark(function n(){var i;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ro.a.login(!0);case 2:i=n.sent.authStatus,t.openLinkWithDesignInfo(e,i);case 4:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}(),r=function(){var n=s()(a.a.mark(function n(){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ro.a.login(!0);case 2:if(n.sent.authStatus){n.next=6;break}return l.show(),alert("아직 인증이 완료되지 않았어요."),n.abrupt("return");case 6:i.authStatus=!0,t.openLinkWithDesignInfo(e,!0);case 8:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}(),(l=(new mc.a).setTitle("이메일 인증 완료하기").setSubtitle("인증을 완료하시면 미리캔버스의 모든 기능을 사용할 수 있어요.\n".concat(i.email,"의 메일함으로 이동하여\n이메일 인증을 완료해주세요.")).addButton("나중에 하기",o,!0,Lc.b.SECONDARY,3).addButton("인증 완료",r,!0,Lc.b.PRIMARY,2).activateXCloseButton().activateShowingUpFromBottomOnMobile()).show(),n.next=11;break;case 10:t.openLinkWithDesignInfo(e,!0);case 11:case"end":return n.stop()}},n)})))}},{key:"openLinkWithDesignInfo",value:function(e,t){var n=le.a.get();t?Rc.a.openLinkWithEncryptedParameters(e,"miriAuth",encodeURI(JSON.stringify({designIdx:n.getIdx(),historyIdx:n.getLatestDesignHistoryIdx(),userName:f.a.getUser().getName(),email:f.a.getUser().email,date:(new Date).getTime()}))):window.open("".concat(e).concat(-1===e.indexOf("?")?"?":"&","designIdx=").concat(n.getIdx(),"&historyIdx=").concat(n.getLatestDesignHistoryIdx(),"&email=").concat(f.a.getUser().email),"_blank")}}]),t}(Af),Pv=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).isReadyList=!1,e.isPrevAdminMode=!1,e.lib=new yn({makeListItem:function(t){return e.makeListItem(t)}}),e.leftPanelType=So.b.TEMPLATE_LIB,e.paginationListTool.setListEmptyView(new yp.a("검색 결과가 없어요...","원하는 템플릿에 관해 의견을 보내주시거나\n저렴한 비용으로 디자인을 의뢰하세요!",Tp.a.TEMPLATE_REQUEST).getContainer()),e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.className=r.a.LIBRARY_TEMPLATE,this.container.appendChild(this.makeAdminUI()),this.container.appendChild(this.makeSearchTool()),this.container.appendChild(this.makeTemplateTypeTool()),this.container.appendChild(this.makeListSection())}},{key:"makeListSection",value:function(){var e=document.createElement("div");return e.classList.add(r.a.LIST_SECTION),e.appendChild(this.paginationListTool.getContainer()),this.paginationListTool.prependElementToScrollContents(this.makeMultipleListView()),e.appendChild(this.makeSubPagesTool()),e}},{key:"makeMultipleListView",value:function(){var e=this;this.templateRecentListVC=new Iv({makeListItemView:this.makeListItem.bind(this),needFromParent:this.needMultipleList.bind(this)}),this.templateRecentListVC.setListener(this);var t={getStatusParameter:function(){return e.lib.getTemplateStatus()},makeListItem:this.makeListItem.bind(this)};this.categoryTemplateListVC=new yv(Object.assign({isActive:this.needMultipleList.bind(this)},t)),this.categoryTemplateListVC.setListener(this),this.allTypeTemplateListVC=new gv(Object.assign({isActive:function(){return e.lib.isMultiType()&&e.needMultipleList()&&e.isReadyList}},t)),this.allTypeTemplateListVC.setListener(this);var n=document.createElement("div");return n.className=r.a.MULTIPLE_LIST,n.appendChild(this.templateRecentListVC.getContainer()),n.appendChild(this.categoryTemplateListVC.getContainer()),n.appendChild(this.allTypeTemplateListVC.getContainer()),n}},{key:"makeSearchTool",value:function(){var e=this;return this.searchTool=new _v(function(t){return e.setKeyword(d.b.nvl(t))},"".concat(So.b.getNameResourceKey(this.leftPanelType)," 검색"),void 0,void 0,void 0,gn.a.TEMPLATE),uv.setListener(this),this.searchTool.getContainer()}},{key:"onChangeFilter",value:function(e){this.searchTool.initUI(),this.updateFilterParameter(),this.loadListSync()}},{key:"updateFilterParameter",value:function(){var e=uv.getSelectedShapes();if(it.a.isEmpty(e))this.lib.setTemplateTypeIdList(null);else{var t=this.templateTypeSelectVC.getTemplateTypes(),n=vl.a.getPageByIndex(0).sheetSize,i=e.map(function(e){return ev.getRatioRange(e)}),a=[];i.forEach(function(e){t.forEach(function(t){!a.includes(t.id)&&e.isInRange(t,n)&&a.push(t.id)})}),this.lib.setTemplateTypeIdList(a.length>0?a.join(","):null)}}},{key:"makeTemplateTypeTool",value:function(){var e=this;this.templateTypeSelectVC=new dc.a(this,an.b.TEMPLATE_LIST,void 0,!0,!0,dc.a.TEMPLATE_TYPE_MAX_HEIGHT),rc.a.setTemplateTypeSelectListener(this),this.templateTypeSelectVC.setGtmData("lib_template");var t=document.createElement("div");t.className=r.a.TEMPLATE_TYPE_SELECT,this.btnBack=new dv(function(){var t=an.d.getDefaultType(e.templateTypeSelectVC.getSelectedPrintType());e.setTemplateType(t,!0)}),t.appendChild(this.btnBack.container);var n=this.btnTemplateTypeSelect=document.createElement("button");n.className=r.a.BUTTON_TOOL_TAB_TOGGLE,n.addEventListener("click",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.a.instance.dispatch(new K.c(function(t,n){e.templateTypeSelectVC.dispatchSheetSizeUpdate(Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().adminMode,t.pages[0].sheetSize,n.option.pageSize)}));case 2:case"end":return t.stop()}},t)}))),this.btnLabelTemplateTypeSelect=document.createElement("span"),n.appendChild(this.btnLabelTemplateTypeSelect),Object(ne.setToolsIcon)(n,ne.ToolsIcon.GREATER_THAN,!0,void 0,90),t.appendChild(n);var i=document.createElement("div");return i.className=r.a.TOOLS_TAB,i.appendChild(this.templateTypeSelectVC.getContainer()),t.appendChild(i),t}},{key:"getJustifiedListToolOption",value:function(){return null}},{key:"makeAdminUI",value:function(){var e=this,t=this.adminUIElement=document.createElement("div");t.className=r.a.ADMIN_UI,this.statusBtnUl=document.createElement("ul");var n=document.createElement("li");n.className=r.a.ACTIVE,n.setAttribute("data-value",nn.a.ACTIVE),n.addEventListener("click",function(){return o(n)}),n.innerText="공개",this.statusBtnUl.appendChild(n);var i=document.createElement("li");i.setAttribute("data-value",nn.a.INACTIVE),i.addEventListener("click",function(){return o(i)}),i.innerText="비공개",this.statusBtnUl.appendChild(i),this.adminUIElement.appendChild(this.statusBtnUl);var o=function(){var t=s()(a.a.mark(function t(n){var i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:$(e.statusBtnUl).children().removeClass(r.a.ACTIVE),n.classList.add(r.a.ACTIVE),i=n.getAttribute("data-value"),e.lib.setTemplateStatus(i),e.loadListSync();case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return t}},{key:"loadTemplateTypeList",value:function(e){var t=this;this.isPrevAdminMode=Ke.a.getUserSetting().adminMode,this.templateTypeSelectVC.loadTemplateTypeList(an.b.TEMPLATE_LIST,function(){t.templateTypeSelectVC.setHeightAuto(),e()})}},{key:"onTemplateTypesResult",value:function(e,t){}},{key:"onChangeSelectedTemplateType",value:function(e){this.setTemplateType(e)}},{key:"onSelectTemplateType",value:function(e,t){this.setTemplateType(t)}},{key:"setKeyword",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=e?e.trim():"",this.searchTool.updateUI(e),this.lib.setKeyword(e),this.isReadyList&&!t||this.renderBanner(),t&&this.loadListSync()}},{key:"updateUI",value:function(e){he()(F()(t.prototype),"updateUI",this).call(this,e),this.onCreateViewIfNotCreated();var n=Ke.a.getUserSetting(),i=n.adminMode,a=n.devMode;i?this.adminUIElement.classList.add(r.a.ACTIVE):this.adminUIElement.classList.remove(r.a.ACTIVE),this.templateTypeSelectVC.setStyleByModes(a,i),this.renderSlideListViews(),this.updateListTitle(),this.renderBanner(),!this.isReadyList&&Ke.a.getUserSetting().adminMode===this.isPrevAdminMode||e||this.loadTemplateTypeList(this.onTemplateTypeListResult.bind(this,Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().adminMode))}},{key:"setTemplateType",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.templateTypeSelectVC.selectTemplateType(e,!1,Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().adminMode);this.btnBack.setActive(!n.isAllType()),this.btnLabelTemplateTypeSelect.innerText=n?n.getTitleWithGroupPrefix():"",this.btnTemplateTypeSelect.classList.remove(r.a.ACTIVE),this.lib.setTemplateType(n),this.updateFilterParameter(),this.searchTool.renderView(n),this.isReadyList&&!t||this.renderBanner(),t&&this.loadListSync()}},{key:"updateListTitle",value:function(){var e=this.lib.getTemplateType();if(e){var t=e.title,n=e.groupTitle,i=this.needMultipleList()?"".concat(n?n+" ":"").concat(t," 전체"):"";this.paginationListTool.titleView.renderView(i)}}},{key:"setListColSize",value:function(){var e=S.a.getTemplatePanelOption().shouldSetColumnCountByPageSize?yn.getColsByRatio(Y.a.instance.option.pageSize.width/Y.a.instance.option.pageSize.height):this.getListColSize();e>0&&this.paginationListTool.setColSize(e)}},{key:"getListColSize",value:function(){return yn.getColsByTemplateType(this.lib.getTemplateType())}},{key:"onAfterTemplateLoad",value:function(e){En.addRecentSingleResource(e,this.searchTool.getKeyword())}},{key:"makeListItem",value:function(e){var t=this,n=new(S.a.getExecutionMode().isBizhowsChannelAndOrderPurpose()?wv:mv)(e,function(e){return t.openSubPage(e)},function(e){return t.setKeyword(e)},this.onAfterTemplateLoad.bind(this,e));return n.getContainer().addEventListener("click",function(n){n.stopPropagation(),e.pageList.length<=1&&En.addRecentSingleResource(e,t.searchTool.getKeyword())}),this.lib.isMultiType()||n.setTemplateType(this.lib.getTemplateType()),n}},{key:"openSubPage",value:function(e){var t=this,n=e.getTemplateType(),i=n?yn.getColsByTemplateType(n):this.getListColSize();this.subPagesTool.updateUI({listItem:e,cols:i,onClickItem:function(){return En.addRecentSingleResource(e.resourceData,t.searchTool.getKeyword())}}),this.subPagesTool.setVisibility(!0)}},{key:"renderBanner",value:function(){this.libBannerView||(this.libBannerView=new Ov,this.paginationListTool.prependElementToScrollContents(this.libBannerView.getContainer())),this.libBannerView.renderView(this.lib.getTemplateType(),this.lib.getKeyword())}},{key:"loadListSync",value:function(){this.onCreateViewIfNotCreated(),this.subPagesTool.setVisibility(!1),this.isReadyList?this.loadListSyncInternal():this.loadTemplateTypeList(this.onTemplateTypeListResult.bind(this,Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().adminMode))}},{key:"loadListSyncInternal",value:function(){this.paginationListTool.setListToolVisibility(!1);var e=this.lib.getTemplateType();this.templateRecentListVC.renderView(e&&e.isAllType()?tn.a.getDesignResourceType(e.purpose):null),this.categoryTemplateListVC.renderView(e),this.loadAllTypeTemplateList(),this.loadPaginationList()}},{key:"loadPaginationList",value:function(){this.needPaginationList()&&(this.lib.isMultiType()||this.setListColSize(),this.paginationListTool.listTool.setOption(this.lib.isMultiType()?he()(F()(t.prototype),"getJustifiedListToolOption",this).call(this):null),this.paginationListTool.setListToolVisibility(!0),this.paginationListTool.initList(),this.updateListTitle())}},{key:"onScrollBottomEnd",value:function(){!this.needPaginationList()&&this.lib.isMultiType()&&this.allTypeTemplateListVC.fetchListMore()}},{key:"needPaginationList",value:function(){return!this.lib.isMultiType()||Boolean(this.lib.getKeyword())||uv.hasSelectedShapes()}},{key:"onTemplateTypeListResult",value:function(e,t){if(S.a.getTemplatePanelOption().decidedTemplateTypeWhenInitialize){var n=S.a.getEditorOpenOption().getUnicornTemplateId();this.onTemplateTypeDecided(d.b.isEmpty(n)?an.d.ALL_TYPE:new an.c(n))}else rc.a.getTemplateTypeFromRequestParam(an.b.SHEET_SIZE,this.templateTypeSelectVC.getSelectedPrintType(),this.onTemplateTypeDecided.bind(this),e,t)}},{key:"onTemplateTypeDecided",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setTemplateType(e,t);var n=No.c.get(No.b.TEMPLATE_SEARCH_WORD,!1);n&&this.setKeyword(n,!1),this.isReadyList=!0,this.loadListSyncInternal()}},{key:"loadAllTypeTemplateList",value:function(){if(this.isReadyList){var e=this.templateTypeSelectVC.getTemplateTypes().filter(function(e){return d.b.isEmpty(e.productTypeId)&&!t.HIDDEN_TYPE_IN_ALL_LIST.includes(e.id)});this.allTypeTemplateListVC.renderView(e)}}},{key:"needMultipleList",value:function(){return!Boolean(this.lib.getKeyword())&&!uv.hasSelectedShapes()&&(this.lib.isMultiType()||Ke.a.getUserSetting().leftPanelPaginationMode!==au.a.BUTTON||1===this.paginationListTool.paginationParam.page)}},{key:"onNeedMoreElementSync",value:function(e,n,i){he()(F()(t.prototype),"onNeedMoreElementSync",this).call(this,e,n,i),this.renderSlideListViews()}},{key:"renderSlideListViews",value:function(){this.templateRecentListVC.renderView(),this.categoryTemplateListVC.renderView(),this.allTypeTemplateListVC.renderView()}},{key:"onRenderedMultipleList",value:function(e){e===this.allTypeTemplateListVC&&this.isActive()&&!this.paginationListTool.scrollElement.hasScroll()&&this.allTypeTemplateListVC.fetchListMore()}},{key:"onFetchMultipleListAll",value:function(e){if(this.lib.isMultiType())try{var n=this.templateTypeSelectVC.getSelectedTypeTitle(),i=n.groupTitle,a=n.title,o=this.lib.getKeyword()||"",s=(null!=i?i+" ":"")+a;o&&Te.a.sendSearchReport({type:Te.b.TEMPLATE,keyword:o,category:s,totalRow:e.length}),this.lib.setGTMLibDataForce(d.b.nvl(this.lib.getKeyword())),Ft.a.sendImpressions({items:e,category:t.ALL_TYPE_CATEGORY,listTitle:t.ALL_TYPE_TITLE,pageNo:1,pageSize:10})}catch(e){0}}},{key:"onMoveDetail",value:function(e){var t=e.templateType,n=e.keyword;t?this.setTemplateType(t):n&&this.setKeyword(n)}},{key:"onRecentMore",value:function(e){this.setKeyword(e)}},{key:"getItemUseEventData",value:function(){var e=this.lib.getGTMLibData();return{type:Te.b.TEMPLATE,category:e.category,keyword:e.keyword}}},{key:"setActive",value:function(e){return he()(F()(t.prototype),"setActive",this).call(this,e),this}},{key:"onDataChanged",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return he()(F()(t.prototype),"onDataChanged",this).call(this,e,n),this.isActive()&&this.fetchList(),this.container}}]),t}(Ih);Pv.HIDDEN_TYPE_IN_ALL_LIST=["fancy_banner_circle","fancy_banner_oval","youtube_cover","groobee_normal","groobee_small"],Pv.ALL_TYPE_CATEGORY="템플릿>전체",Pv.ALL_TYPE_TITLE="템플릿 > 전체";var Dv,Mv=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).leftPanelType=So.b.TEXT_LIB,e.elementClass=r.a.LIBRARY_TEXT,e.searchDesignResourceType=gn.a.COMBINATION,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.insertBefore(this.makeBtnAdd(),this.adminUIElement.nextSibling),this.addRadioButtons([So.b.TEXT_COMBINATION_LIB,So.b.TEXT_STYLE_LIB]),this.setFirstMenu()}},{key:"makeBtnAdd",value:function(){var e=document.createElement("button");return e.innerText="텍스트 추가",e.addEventListener("click",s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Y.a.instance.editorMainVC.leftBarVC.setActive(!1),X.a.instance.dispatch(new at);case 2:case"end":return e.stop()}},e)}))),e}}]),t}(Jp),Nv=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).leftPanelType=So.b.VIDEO_PANEL,e.elementClass=r.a.LIBRARY_VIDEO_PANEL,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.addRadioButtons([So.b.VIDEO,So.b.YOUTUBE]),this.radioTool.select(So.b.YOUTUBE)}},{key:"setKeyword",value:function(e){console.log("키워드 검색 막기")}}]),t}(Jp);(Dv||(Dv={})).make=function(e){switch(e){case So.b.TEMPLATE_LIB:return new Pv;case So.b.BIZ_TEMPLATE_LIB:return new iv;case So.b.DESIGN_LIB:return new jm;case So.b.PHOTO_LIB:return new jf;case So.b.ITEM_LIB:return new um;case So.b.TEXT_LIB:return new Mv;case So.b.BACKGROUND_LIB:return new jp;case So.b.MY_IMAGE_LIB:return new Xf;case So.b.FAVORITE_LIB:return new bm;case So.b.VIDEO_PANEL:return new Nv;case So.b.ADMIN_TOOL:return new Oh;default:throw new Error("잘못된 타입입니다")}};var xv,Bv=Dv,Vv=function(){function e(t){L()(this,e),this.leftPanelMap=new Map,this.leftBarVC=t,this.leftBarVC.setSelectListener(this)}return w()(e,[{key:"onSelect",value:function(e){(!this.activeItemMenu||this.selectedPanel&&!this.selectedPanel.isSameType(e))&&(this.leftBarVC.expand(),this.activePanel(e))}},{key:"activePanel",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.selectedPanel&&this.selectedPanel.setActive(!1),this.selectedPanel=this.getPanel(e,!0),this.leftBarVC.setActivePanelContents(this.selectedPanel.getLeftPanelType(),this.selectedPanel.getContainer()),t&&this.selectedPanel.setActive(!0),this.selectedPanel}},{key:"getPanel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.leftPanelMap.has(e)&&t&&this.createLeftPanel(e),this.leftPanelMap.get(e)}},{key:"createLeftPanel",value:function(e){var t=Bv.make(e);this.leftPanelMap.set(e,t),X.a.instance.dispatch(new K.c(function(e,n){return t.onDataChanged(e)}))}},{key:"renderPanels",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.leftPanelMap.forEach(function(n){try{n.onDataChanged(e,t)}catch(e){console.error(e)}})}},{key:"getActivePanel",value:function(){return this.selectedPanel}},{key:"setActiveItemMenu",value:function(e){this.activeItemMenu=e}}]),e}(),Uv=n(362),Fv=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this))).elemId="designProjectItemDddotPopup".concat(d.b.random()),a.addAction=e,a.copyAction=n,a.deleteAction=i,a.isAutoDirection=!0,a.makeElement(),a}return z()(t,e),w()(t,[{key:"makeElement",value:function(){return this.contents=document.createElement("div"),this.contents.className=r.a.DESIGN_PROJECT_ITEM_DDDOT_POPUP_CONTENTS,this.makeRow1(),this.makeRow2(),this.makeRow3(),this.contents}},{key:"getContents",value:function(){return this.contents}},{key:"makeRow1",value:function(){var e=document.createElement("div");e.className=r.a.TOOLS_ROW,this.titleElem=document.createElement("div"),this.titleElem.className=r.a.TITLE,e.appendChild(this.titleElem),this.sizeElem=document.createElement("div"),this.sizeElem.className=r.a.SIZE_LABEL,e.appendChild(this.sizeElem),this.contents.appendChild(e)}},{key:"makeRow2",value:function(){var e=this,t=document.createElement("div");t.className=r.a.TOOLS_ROW;var n=document.createElement("button");n.innerText="새 문서 추가하기",Object(ne.setToolsIcon)(n,ne.ToolsIcon.NEW_FILE),n.addEventListener("click",function(){e.close(),e.addAction()}),t.appendChild(n);var i=document.createElement("button");i.innerText="복제하기",Object(ne.setToolsIcon)(i,ne.ToolsIcon.COPY),i.addEventListener("click",function(){e.close(),e.copyAction()}),t.appendChild(i);var a=this.btnDelete=document.createElement("button");a.innerText="삭제하기",Object(ne.setToolsIcon)(a,ne.ToolsIcon.DELETE),a.addEventListener("click",function(){confirm("삭제한 문서는 다시 복구할 수 없습니다. 정말로 삭제하시겠습니까?")&&(e.close(),e.deleteAction())}),t.appendChild(a),this.contents.appendChild(t)}},{key:"makeRow3",value:function(){var e=document.createElement("div");e.className=r.a.TOOLS_ROW;var t=document.createElement("div");this.profileElem=Object(ne.setToolsIcon)(t,ne.ToolsIcon.USER_PROFILE),this.updateDateElem=document.createElement("span"),this.updateDateElem.className=r.a.UPDATE_DATE,t.appendChild(this.updateDateElem),e.appendChild(t),this.contents.appendChild(e)}},{key:"getId",value:function(){return this.elemId}},{key:"updateUI",value:function(){}},{key:"renderView",value:function(e){this.titleElem.innerText=e.title;var t=e.pageList[0];this.sizeElem.innerText="".concat(t.width,"px × ").concat(t.height,"px"),new Le.a(this.profileElem,Ge.a.T,{title:{name:e.accountName}}),this.updateDateElem.innerText=re.a.toString(new Date(e.updateDate),"yyyy-MM-dd HH:mm")}},{key:"setDeletable",value:function(e){e?this.btnDelete.removeAttribute("disabled"):this.btnDelete.setAttribute("disabled","disabled")}}]),t}(u.a),Gv=function(){function e(t,n,i,a){L()(this,e),this.selectAction=t,this.dddotPopup=new Fv(n,i,a),this.makeElement()}return w()(e,[{key:"makeElement",value:function(){var e=this;this.element=document.createElement("div"),this.element.className=r.a.DESIGN_PROJECT_ITEM,this.element.addEventListener("click",s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.selectAction();case 1:case"end":return t.stop()}},t)})));var t=document.createElement("div");t.className=r.a.THUMB;var n=this.thumbImg=document.createElement("img");t.appendChild(n),this.pageCntLabel=document.createElement("div"),this.pageCntLabel.className=r.a.PAGE_CNT,t.appendChild(this.pageCntLabel),this.dddot=Object(ne.setToolsIcon)(t,ne.ToolsIcon.DDDOT,!0),this.dddot.addEventListener("click",function(t){t.stopPropagation(),e.dddotPopup.open(e.getDddotOffset())}),this.loadingUI=new mh.a(t),this.element.appendChild(t);var i=document.createElement("div");i.className=r.a.FOOTER,this.designNoLabel=document.createElement("span"),this.designNoLabel.className=r.a.NUMBER_LABEL,i.appendChild(this.designNoLabel),this.templateTypeLabel=document.createElement("span"),this.templateTypeLabel.className=r.a.TYPE_NAME,i.appendChild(this.templateTypeLabel),this.element.appendChild(i)}},{key:"render",value:function(e){var t=this;if(e.designNo&&e.designNo>0&&(this.designNo=e.designNo,this.designNoLabel.innerText=String(e.designNo)),e.designData){(null==this.designData||this.designData.idx!==e.designData.idx||this.designData.updateDate<e.designData.updateDate||this.designData.pageList[0].thumbKey!==e.designData.pageList[0].thumbKey)&&(this.designData=Object.assign({},e.designData),setTimeout(function(){qm.b.fetchKeyList([e.designData.pageList[0].thumbKey]).then(function(){return t.thumbImg.src=qm.b.getUrl(e.designData.pageList[0].thumbKey)})},3e3),this.designData.pageList.length>1?(this.pageCntLabel.classList.add(r.a.ACTIVE),this.pageCntLabel.innerText=String(this.designData.pageList.length)):this.pageCntLabel.classList.remove(r.a.ACTIVE),this.dddotPopup.renderView(this.designData));var n,i=e.designData.templateType;if(i)n=d.b.isEmpty(i.groupTitle)?i.title:"".concat(i.groupTitle," ").concat(i.title);else{var a;if(!d.b.isEmpty(this.designData.sizeOption))try{a=Mo.a.createFromObject(JSON.parse(this.designData.sizeOption))}catch(e){console.error(e)}var o=this.designData.pageList[0];void 0!==a&&a.isValid()&&a.isSamePixel(o.width,o.height,xo.a.getMaxSheetSize(!0))||(a=new Mo.a(o.width,o.height,De.a.PX));var s=a.unit.toLowerCase(),l=Ga.a.floorFromDecimalPlace(a.width,1),c=Ga.a.floorFromDecimalPlace(a.height,1);n="".concat(l).concat(s," × ").concat(c).concat(s)}this.templateTypeLabel.innerText=n,this.templateTypeLabel.title=n}return e.active?this.element.classList.add(r.a.ACTIVE):this.element.classList.remove(r.a.ACTIVE),this.setDeletable(!0),this.element}},{key:"setDeletable",value:function(e){this.dddotPopup.setDeletable(e)}},{key:"getDesignNo",value:function(){return this.designNo}},{key:"getDesignData",value:function(){return this.designData}},{key:"getDddotOffset",value:function(){return $(this.dddot).offset()}},{key:"showLoading",value:function(){return this.loadingUI.show(),this}},{key:"hideLoading",value:function(){return this.loadingUI.hide(),this}},{key:"getElementPos",value:function(){return $(this.element).position()}},{key:"getElementRect",value:function(){return this.element.getBoundingClientRect()}}]),e}(),Hv=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).elemId="designTypeSelectorPopup".concat(d.b.random()),n.designNo=-1,n.selectAction=e,n.isAutoDirection=!0,n.makeContents(),n}var n,i;return z()(t,e),w()(t,[{key:"setReady",value:(i=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.templateTypeTool.readyTemplateTypeList(!0);case 1:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"makeContents",value:function(){this.templateTypeTool=new dc.a(this,an.b.SHEET_SIZE,"새 문서 추가",!1,!1),this.templateTypeTool.isCanSend=!0,this.contents=this.templateTypeTool.getContainer(),this.contents.classList.add(r.a.DESIGN_TYPE_SELECTOR)}},{key:"getContents",value:function(){return this.contents}},{key:"getId",value:function(){return this.elemId}},{key:"updateUI",value:function(){}},{key:"onSelectTemplateType",value:function(e,t){this.close(),this.selectAction(e,t,this.designNo)}},{key:"openWithData",value:(n=s()(a.a.mark(function e(t,n){var i=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.designNo=n,this.templateTypeTool.updateDOMCustomSizeInputs(),e.next=4,X.a.instance.dispatch(new K.c(function(e,t){i.templateTypeTool.dispatchSheetSizeUpdate(Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().adminMode,e.pages[0].sheetSize,t.option.pageSize)}));case 4:this.open(t);case 5:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})}]),t}(u.a),Wv=function(e){function t(e,n,i){var a;return L()(this,t),(a=V()(this,F()(t).call(this))).loaded=e,a.designCnt=n,a.designLastUpdateDate=i,a}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return this.loaded!==e.loaded||this.isChangeStatusDesignCnt(e)||this.designLastUpdateDate!==e.designLastUpdateDate}},{key:"isChangeStatusDesignCnt",value:function(e){return void 0===e||this.designCnt!==e.designCnt}}]),t}(He.b),zv=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,!0,sc.a.designProjectMenu,"section"))).designProjectItems=[],e}var n,i,o,l,c,u,h,p;return z()(t,e),w()(t,[{key:"onCreateView",value:function(){var e=this;he()(F()(t.prototype),"onCreateView",this).call(this),this.designTypeSelectorPopup=new Hv(function(t,n,i){return e.addDesign(t,n,i)}),this.makeHeader(),this.makeBody()}},{key:"onStartView",value:function(){var e=this;he()(F()(t.prototype),"onStartView",this).call(this),s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.designTypeSelectorPopup.setReady();case 2:case"end":return t.stop()}},t)}))()}},{key:"makeHeader",value:function(){var e=this,n=document.createElement("div");n.className=r.a.HEADER;var i=document.createElement("input");i.type="checkbox",i.checked=!0,this.container.classList.add(r.a.OPEN),this.container.appendChild(i);var a=document.createElement("div");a.className=r.a.LEFT_SIDE;var o=Object(ne.setToolsIcon)(n,ne.ToolsIcon.GREATER_THAN);o.addEventListener("click",function(){i.checked=!i.checked,e.enableStyle(i.checked,e.container,r.a.OPEN),t.refreshCanvasSize()}),a.appendChild(o),this.projectTitleElem=new fu(function(t){d.b.isEmpty(t)&&(t="제목없음",e.projectTitleElem.render(t)),Uv.a.updateDesignProject(Uv.a.getDesignProject()&&Uv.a.getDesignProject().idx,{title:t})}),a.appendChild(this.projectTitleElem.render("제목없음")),n.appendChild(a);var s=document.createElement("div");s.className=r.a.RIGHT_SIDE;var l=this.prevBtn=Object(ne.setToolsIcon)(s,ne.ToolsIcon.GREATER_THAN,!0);l.classList.add(r.a.PREV),l.addEventListener("click",function(){return e.prevItem()}),new Le.a(l,Ge.a.T,{title:{name:"이전 문서 보기"}});var c=this.currentDesignNoLabel=document.createElement("span");c.innerText="0",s.appendChild(c);var u=document.createElement("span");u.innerText="/",s.appendChild(u);var h=this.lastDesignNoLabel=document.createElement("span");h.innerText="0",s.appendChild(h);var p=this.nextBtn=Object(ne.setToolsIcon)(s,ne.ToolsIcon.GREATER_THAN,!0);p.classList.add(r.a.NEXT),p.addEventListener("click",function(){return e.nextItem()}),new Le.a(p,Ge.a.T,{title:{name:"다음 문서 보기"}});var m=document.createElement("div");m.className=r.a.BTN_ADD_DESIGN;var f=Object(ne.setToolsIcon)(m,ne.ToolsIcon.ADD,!0);new Le.a(f,Ge.a.TL,{title:{name:"새 문서 추가하기"}}),f.addEventListener("click",function(){return e.openDesignTypeSelectorPopup($(f).offset())}),s.appendChild(m),n.appendChild(s),this.container.appendChild(n)}},{key:"openDesignTypeSelectorPopup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.designProjectItems.length>=Uv.a.MAX_DESIGN_CNT?alert("한 프로젝트당 디자인은 20개까지 추가할 수 있습니다."):this.designTypeSelectorPopup.openWithData(e,t)}},{key:"addDesign",value:(p=s()(a.a.mark(function e(t,n){var i,o,s,r,l=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=l.length>2&&void 0!==l[2]?l[2]:-1,e.next=3,this.saveDesign();case 3:if(e.sent){e.next=7;break}return alert("현재 디자인이 완전히 저장되지 않았습니다."),e.abrupt("return");case 7:return n&&(o=n.id,t=new Mo.a(n.width,n.height,n.unit,Mo.a.DEFAULT_DPI)),e.next=10,Uv.a.addDesign(t,o,i);case 10:return s=e.sent,r=this.addDesignProjectItem(s,i,!0),e.next=14,this.activeItem(r);case 14:case"end":return e.stop()}},e,this)})),function(e,t){return p.apply(this,arguments)})},{key:"prevItem",value:(h=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.activeDesignProjectItem){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.activeItemByArrayIdx(this.activeDesignProjectItem.getDesignNo()-2);case 4:case"end":return e.stop()}},e,this)})),function(){return h.apply(this,arguments)})},{key:"nextItem",value:(u=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.activeDesignProjectItem){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.activeItemByArrayIdx(this.activeDesignProjectItem.getDesignNo());case 4:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},{key:"activeItemByArrayIdx",value:(c=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>=0&&this.designProjectItems.length>t)){e.next=10;break}return e.next=3,this.saveDesign();case 3:if(e.sent){e.next=8;break}alert("현재 디자인이 완전히 저장되지 않았습니다."),e.next=10;break;case 8:return e.next=10,this.activeItem(this.designProjectItems[t]);case 10:case"end":return e.stop()}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"activeItem",value:(l=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkScroll(t),n=t.getDesignData().idx,!this.activeDesignProjectItem||this.activeDesignProjectItem.getDesignData().idx!==n){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,I.b.load(n,Uv.a.getDesignProject()&&Uv.a.getDesignProject().idx);case 6:this.activeDesignProjectItem&&this.activeDesignProjectItem.render({active:!1}),t.render({active:!0}),this.activeDesignProjectItem=t,this.renderDesignNavigator();case 10:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"saveDesign",value:(o=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!vl.a.changedDesign){e.next=5;break}return this.activeDesignProjectItem.showLoading(),e.next=4,C.a.save({isAutoSaved:!0});case 4:this.activeDesignProjectItem.hideLoading();case 5:return e.abrupt("return",Ht.a.isSaveComplete());case 6:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"checkScroll",value:function(e){if(this.designProjectItems.indexOf(e)<0)throw new Error("스크롤 타겟이 존재하지 않습니다");var t=e.getElementPos().left,n=e.getElementRect().width,i=this.scrollElement.getScrollX(),a=this.scrollElement.contents.clientWidth;t<i?this.scrollElement.setScrollX(t):t+n>i+a&&this.scrollElement.setScrollX(t+n-a)}},{key:"makeBody",value:function(){var e=this,t=document.createElement("div");t.className=r.a.BODY;var n=document.createElement("div");n.className=r.a.LIST_WRAP,this.designListElem=document.createElement("div"),this.designListElem.className=r.a.DESIGN_LIST,n.appendChild(this.designListElem);var i=document.createElement("div");i.className=r.a.BTN_ADD_DESIGN,Object(ne.setToolsIcon)(i,ne.ToolsIcon.ADD),i.addEventListener("click",function(){return e.openDesignTypeSelectorPopup($(i).offset())}),n.appendChild(i),new Le.a(i,Ge.a.T,{title:{name:"새 문서 추가"}});var a=this.scrollElement=new Ce.a(!0,!1,"100%");t.appendChild(a.render(n)),this.container.appendChild(t)}},{key:"addDesignProjectItem",value:function(e,t,n){var i=this.makeDesignProjectItem();if(t<0||t>=this.designProjectItems.length){this.designProjectItems.push(i);var a=i.render({designData:e,designNo:this.designProjectItems.length,active:n});this.designListElem.appendChild(a)}else{this.designProjectItems.splice(t,0,i);var o=i.render({designData:e,designNo:t+1,active:n});$(this.designListElem).children().eq(t).before(o)}return i}},{key:"makeDesignProjectItem",value:function(){var e=this,t=new Gv(s()(a.a.mark(function n(){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.saveDesign();case 2:if(n.sent){n.next=7;break}alert("현재 디자인이 완전히 저장되지 않았습니다."),n.next=9;break;case 7:return n.next=9,e.activeItem(t);case 9:case"end":return n.stop()}},n)})),function(){return e.openDesignTypeSelectorPopup(t.getDddotOffset(),t.getDesignNo())},function(){return e.copyDesignProjectItem(t)},function(){return e.deleteDesignProjectItem(t)});return t}},{key:"copyDesignProjectItem",value:(i=s()(a.a.mark(function e(t){var n,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.designProjectItems.length>=Uv.a.MAX_DESIGN_CNT)){e.next=3;break}return alert("디자인 생성 개수가 초과되었습니다"),e.abrupt("return");case 3:return e.next=5,this.saveDesign();case 5:if(e.sent){e.next=9;break}return alert("현재 디자인이 완전히 저장되지 않았습니다."),e.abrupt("return");case 9:return e.next=11,Uv.a.copyDesign(t.getDesignData().idx);case 11:return n=e.sent,i=this.addDesignProjectItem(n,this.designProjectItems.indexOf(t)+1,!0),e.next=15,this.activeItem(i);case 15:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"deleteDesignProjectItem",value:(n=s()(a.a.mark(function e(t){var n,i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==this.designProjectItems.length){e.next=2;break}throw new Error("디자인이 한개일 때에는 삭제할 수 없습니다");case 2:return n=t.getDesignData().idx,e.next=5,Uv.a.deleteDesign(n);case 5:if(n!==this.activeDesignProjectItem.getDesignData().idx){e.next=10;break}return i=this.designProjectItems.indexOf(this.activeDesignProjectItem),o=i>0?this.designProjectItems[i-1]:this.designProjectItems[i+1],e.next=10,this.activeItem(o);case 10:this.onDataChanged(void 0);case 11:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"renderView",value:function(){var e=this;he()(F()(t.prototype),"renderView",this).call(this);var n=this.contentsStates;if(this.checkUpContentsChange(this.getRenderStates()),this.contentsStatesChanged)if(this.enableStyle(this.contentsStates.loaded,this.container,r.a.ACTIVE),this.contentsStates.loaded){t.refreshCanvasSize();var i=Uv.a.getDesignProject();this.projectTitleElem.render(i.title);var a=le.a.get().getIdx();this.activeDesignProjectItem=null,this.contentsStates.isChangeStatusDesignCnt(n)?(this.designProjectItems=[],this.designListElem.innerHTML="",i.designList.forEach(function(t,n){var i=!e.activeDesignProjectItem&&a===t.idx,o=e.addDesignProjectItem(t,n,i);i&&(e.activeDesignProjectItem=o)})):this.designProjectItems.forEach(function(t,n){var o=i.designList[n],s=!e.activeDesignProjectItem&&a===o.idx;s&&(e.activeDesignProjectItem=t),t.render({designData:o,active:s,designNo:n+1})}),this.activeDesignProjectItem||console.error("에디터에 로드된 디자인이 프로젝트에 존재하지 않음."),1===this.designProjectItems.length&&this.designProjectItems[0].setDeletable(!1),this.renderDesignNavigator()}else t.refreshCanvasSize()}},{key:"renderDesignNavigator",value:function(){this.lastDesignNoLabel.innerText=String(this.designProjectItems.length);var e=this.activeDesignProjectItem?this.activeDesignProjectItem.getDesignNo():0;this.currentDesignNoLabel.innerText=String(e),this.enableStyle(!(e>1),this.prevBtn,r.a.DISABLE),this.enableStyle(!(e<this.designProjectItems.length),this.nextBtn,r.a.DISABLE)}},{key:"getRenderStates",value:function(){var e=Uv.a.getDesignProject()&&Uv.a.getDesignProject().designList||[];return new Wv(void 0!==Uv.a.getDesignProject(),e&&e.length,Math.max.apply(Math,Yn()(e.map(function(e){return isNaN(e.updateDate)?0:e.updateDate}))))}}],[{key:"refreshCanvasSize",value:function(){X.a.instance.dispatch(new K.c(function(){var e=s()(a.a.mark(function e(t,n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.canvasAreaVC.updateCanvasSize(),e.next=3,i.canvasAreaVC.renderAuto(t,n);case 3:i.renderHandler(t,n);case 4:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}()))}}]),t}(He.a),Kv=function(e){function t(e,n){var i;return L()(this,t),(i=V()(this,F()(t).call(this))).doSaveQueue=!0,i.actionType=K.a.LAYER_NAME_EDIT,i.changeDesign=function(){return!1},i.commitAction=function(){var e=s()(a.a.mark(function e(t,n,o){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.setName(t,n,i.newName),o.renderLayer(t,n);case 2:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),i.rollbackAction=function(e,t,n){i.setName(e,t,i.lastName),n.renderLayer(e,t)},i.recycle=function(){},i.targetKey=e,i.newName=n,i}return z()(t,e),w()(t,[{key:"setName",value:function(e,t,n){var i=this,a=e.pages[t.renderPageIdx];if(a.background.getItemKey()!==this.targetKey){var o=a.getAllSingleItems().find(function(e){return e.getItemKey()===i.targetKey})||a.getAllGroupItems().find(function(e){return e.getGroupId()===i.targetKey});o&&(o.layerName=n)}else a.background.layerName=n}}]),t}(K.b),Yv=function(){function e(){L()(this,e)}return w()(e,null,[{key:"unfoldAllGroupWrapperElementAttachedElement",value:function(e){var t=this.getMostHigherGroupWrapperElement(e);t&&(this.removeFoldClassName(t),this.unfoldAllChildGroupWrapperElement(t))}},{key:"unfoldGroupWrapperElementToAttachedElement",value:function(e){this.unfoldAllParentGroupWrapperElement(e)}},{key:"getMostHigherGroupWrapperElement",value:function(e){return e.parentElement&&this.isWrapperElement(e.parentElement)?this.getMostHigherGroupWrapperElement(e.parentElement):this.isWrapperElement(e)?e:null}},{key:"unfoldAllChildGroupWrapperElement",value:function(e){var t=!0,n=!1,i=void 0;try{for(var a,o=e.children[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value;this.isWrapperElement(s)&&(this.removeFoldClassName(s),this.unfoldAllChildGroupWrapperElement(s))}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"unfoldAllParentGroupWrapperElement",value:function(e){var t=e.parentElement;t&&this.isWrapperElement(t)&&(this.removeFoldClassName(t),this.unfoldAllParentGroupWrapperElement(t))}},{key:"isWrapperElement",value:function(e){return e.classList.contains(r.a.LAYER_WRAP)}},{key:"removeFoldClassName",value:function(e){e.classList.remove(r.a.FOLD)}}]),e}(),Xv=function(e){function t(e,n,i,a,o,s,r,l){var c;return L()(this,t),(c=V()(this,F()(t).call(this))).revKey=e,c.selectKey=n,c.lockKey=i,c.selCount=a,c.activeBtnGroup=o,c.activeBtnLock=s,c.activeBtnDelete=r,c.fakeSelectSolidSkin=l,c}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return e.revKey!==this.revKey||this.isChangeFooterStyleStatus(e)||this.isChangeStyleStatus(e)}},{key:"isNonStyleChangeFrom",value:function(e){return void 0===e||e.revKey!==this.revKey}},{key:"isChangeStyleStatus",value:function(e){return void 0===e||e.selectKey!==this.selectKey||e.lockKey!==this.lockKey||e.fakeSelectSolidSkin!==this.fakeSelectSolidSkin}},{key:"isChangeFooterStyleStatus",value:function(e){return void 0===e||e.selectKey!==this.selectKey||e.selCount!==this.selCount||e.activeBtnGroup!==this.activeBtnGroup||e.activeBtnLock!==this.activeBtnLock||e.activeBtnDelete!==this.activeBtnDelete||e.fakeSelectSolidSkin!==this.fakeSelectSolidSkin}}]),t}(He.b),jv=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this))).key=e,n}return z()(t,e),w()(t,[{key:"isChangedFrom",value:function(e){return e.key!==this.key}}]),t}(He.c),Zv=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this,!0,sc.a.layerToolBox,"div",document.getElementById(sc.a.layerToolBox)))).itemElementMap=new Map,e.thumbMap=new Map,e.thumbRevisionMap=new Map,e.debounceMap=new Map,e.isSelectLayerInContent=!1,e}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){he()(F()(t.prototype),"onCreateView",this).call(this),this.container.classList.add("show"),this.makeToolBox(),this.addEventListeners()}},{key:"getRenderStates",value:function(e){var t=e.pageId,n="",i="",a="",o=0,s=!1,r=e.background.backgroundItem,l=r&&r.select;e.getAllSingleItems().forEach(function(e){var r=Qe.b.getRootGroup(e.groupId);if(r){var l="_rootGroupId_".concat(r.getGroupId());t.includes(l)||(t+=l)}t+=e.tbpeId+e.groupId,e.select&&(n+=e.tbpeId,o++),e.isLock()?i+="1":i+="0",e.select&&e.isLock()&&(s=!0),a+=e.props.getRevision()+"|"+e.props.getStyleRevision()}),(l||0===o)&&(s=!0);var c=!l&&o>1,u=!l&&o>0;return{position:new jv(t),contents:new Xv(a,n,i,o,c,u,!1===s,null==r&&0===o)}}},{key:"makeToolBox",value:function(){this.container.appendChild(this.makeHeader()),this.container.appendChild(this.makeBody().element),this.container.appendChild(this.makeFooter())}},{key:"makeHeader",value:function(){var e=document.createElement("div");e.className=r.a.HEADER;var t=document.createElement("label");t.className=r.a.TITLE,t.innerText="레이어";var n=document.createElement("button");return Object(ne.setToolsIcon)(n,ne.ToolsIcon.CLOSE),n.addEventListener("click",function(){Ke.a.setIsLayerVisible(!1)}),e.appendChild(t),e.appendChild(n),e}},{key:"makeBody",value:function(){return this.layerBody=new Ce.a(!1,!0,"calc(100% - 108px)"),this.layerBody.element.classList.add(r.a.BODY),this.layerBody}},{key:"makeFooter",value:function(){var e=document.createElement("div");return e.className=r.a.FOOTER,this.selectInfo=document.createElement("span"),this.selectInfo.className=r.a.LAYER_SELECT_INFO,this.selectInfo.innerText="0개의 요소 선택",e.appendChild(this.selectInfo),this.groupBtn=t.makeBtn(ne.ToolsIcon.ITEM_GROUP,r.a.BTN_GROUP),new Le.a(this.groupBtn,Ge.a.T,{title:{name:"그룹"}}).onStartView(),this.groupBtn.addEventListener("click",function(e){if($(e.currentTarget).hasClass(r.a.ACTIVE)){var t=Y.a.instance.activeItems.slice();Qe.b.isSameGroup(t)?X.a.instance.dispatch(new On.d):X.a.instance.dispatch(new On.a)}}),this.lockBtn=t.makeBtn(ne.ToolsIcon.LOCK_ON,r.a.BTN_LOCK),new Le.a(this.lockBtn,Ge.a.T,{title:{name:"잠금"}}).onStartView(),this.lockBtn.addEventListener("click",function(e){$(e.currentTarget).hasClass(r.a.ACTIVE)&&(Y.a.instance.activeItems.slice().filter(function(e){return!e.isLock()}).length?X.a.instance.dispatch(new On.l):X.a.instance.dispatch(new On.p))}),this.delBtn=t.makeBtn(ne.ToolsIcon.DELETE,r.a.BTN_DELETE),new Le.a(this.delBtn,Ge.a.T,{title:{name:"삭제"}}).onStartView(),this.delBtn.addEventListener("click",function(e){$(e.currentTarget).hasClass(r.a.ACTIVE)&&X.a.instance.dispatch(new An.a)}),e.appendChild(this.lockBtn),e.appendChild(this.groupBtn),e.appendChild(this.delBtn),e}},{key:"renderView",value:function(){if(he()(F()(t.prototype),"renderView",this).call(this),!je.a.isMobilePortraitSize()){var e=this.contentsStates,n=this.designDoc.pages[Y.a.instance.renderPageIdx];this.checkUpStatesChange(this.getRenderStates(n)),this.positionStatesChanged&&this.renderLayerTree(n),(this.positionStatesChanged||this.contentsStates.isChangeStyleStatus(e))&&(this.renderLayerStyle(n),this.isSelectLayerInContent||this.moveScrollToSelectedLayerByCenter()),(this.positionStatesChanged||this.contentsStates.isChangeFooterStyleStatus(e))&&this.renderFooter(),(this.positionStatesChanged||this.contentsStates.isNonStyleChangeFrom(e))&&this.renderContents(n.getAllSingleItems()),this.isSelectLayerInContent=!1}}},{key:"renderLayerTree",value:function(e){var t=this,n=document.createDocumentFragment(),i=e.background.backgroundItem;this.itemElementMap.clear();for(var a=e.items,o=a.length-1;o>-1;o--){var s=a[o];if(s!==i){var r=this.renderLayerTreeItem(s);n.appendChild(r)}}var l=this.renderBackgroundLayer(e);n.appendChild(l),this.layerBody.contents.innerHTML="",this.layerBody.contents.appendChild(n);var c=e.getAllSingleItems();a.forEach(function(e,n){if(e instanceof Qe.a){var i=[];e.getAllSingleMembers().forEach(function(e){i.push(c.indexOf(e))}),i.sort(function(e,t){return e-t}),$(t.itemElementMap.get(e.getItemKey())).parent().data("itemIdxList",i)}else $(t.itemElementMap.get(e.getItemKey())).data("itemIdxList",[c.indexOf(e)])})}},{key:"renderFooter",value:function(){this.contentsStates.activeBtnGroup?this.groupBtn.classList.add(r.a.ACTIVE):this.groupBtn.classList.remove(r.a.ACTIVE),this.contentsStates.activeBtnLock?this.lockBtn.classList.add(r.a.ACTIVE):this.lockBtn.classList.remove(r.a.ACTIVE),this.contentsStates.activeBtnDelete?this.delBtn.classList.add(r.a.ACTIVE):this.delBtn.classList.remove(r.a.ACTIVE);var e=this.contentsStates.fakeSelectSolidSkin?1:this.contentsStates.selCount;this.selectInfo.innerText="".concat(e,"개의 요소 선택")}},{key:"addEventListeners",value:function(){var e=$(this.layerBody.contents);t.addTextEditEventListener(e),t.addLayerEventListener(e),this.addLayerCommonEventListener(e),t.addDragEventListener(e)}},{key:"addLayerCommonEventListener",value:function(e){var t=this;e.on("click",".layer",function(){return t.isSelectLayerInContent=!0})}},{key:"renderLayerTreeItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=null;return n=e instanceof Qe.a?this.renderGroupItemLayer(e,t):this.renderSingleItemLayer(e,t),0===t&&n.classList.add(r.a.NOT_DEEP),n}},{key:"renderSingleItemLayer",value:function(e,n){var i,a,o;e instanceof q.a?(o=ne.ToolsIcon.ITEM_TEXT,i=e.props.getText().replace("\n"," ")):(e instanceof Z.a?o=ne.ToolsIcon.ITEM_GRID:this.thumbMap.has(e.getItemKey())?a=this.thumbMap.get(e.getItemKey()):(a=e instanceof ee.b?document.createElement("div"):new Image,this.thumbMap.set(e.getItemKey(),a)),i=Q.b.getText(e.getResourceType())),e.layerName&&(i=e.layerName);var s=t.renderLayerRow(i,n,a,o);return s.classList.add(r.a.SINGLE),$(s).data("itemKey",e.getItemKey()),this.itemElementMap.set(e.getItemKey(),s),s}},{key:"renderGroupItemLayer",value:function(e,n){var i=t.renderLayerRow(e.layerName?e.layerName:"그룹",n,null,ne.ToolsIcon.FOLDER_FILL);Object(ne.setToolsIcon)(i,ne.ToolsIcon.GREATER_THAN,!1,"left");Object(ne.getToolsIconName)(ne.ToolsIcon.GREATER_THAN);i.childNodes.forEach(function(e){e.classList.contains(r.a.THUMB)&&Object(ne.setToolsIcon)(e,ne.ToolsIcon.FOLDER_OUTLINE)}),i.classList.add(r.a.GROUP);var a=document.createElement("div");a.className=r.a.LAYER_WRAP,$(a).data("groupId",e.getGroupId()),$(i).data("groupId",e.getGroupId()),a.appendChild(i);for(var o=e.getMembers(),s=o.length-1;s>=0;s--){var l=this.renderLayerTreeItem(o[s],n+1);a.appendChild(l)}return a.classList.add(r.a.FOLD),this.itemElementMap.set(e.getItemKey(),i),a}},{key:"renderBackgroundLayer",value:function(e){var n,i,a=e.background,o=a.backgroundItem;o?(this.thumbMap.has(o.getItemKey())?n=this.thumbMap.get(o.getItemKey()):((n=document.createElement("img")).setAttribute("data-bg","true"),this.thumbMap.set(o.getItemKey(),n)),i=o instanceof Je.d?"사진 배경":"패턴 배경"):((n=document.createElement("div")).style.backgroundColor=a.color,i="단색 배경"),a.layerName&&(i=a.layerName);var s=t.renderLayerRow(i,0,n,null,!1);return s.classList.add(r.a.BACKGROUND),this.itemElementMap.set(a.getItemKey(),s),$(s).data("itemKey",a.getItemKey()),s}},{key:"renderLayerStyle",value:function(e){var t=e.background,n=this.itemElementMap.get(t.getItemKey());this.updateLayerStyles(e.items),this.unfoldGroupDepth(e.items),this.contentsStates.fakeSelectSolidSkin||t.backgroundItem&&t.backgroundItem.select?n.classList.add(r.a.SELECTED):n.classList.remove(r.a.SELECTED)}},{key:"updateLayerStyles",value:function(e){var t=this;e.forEach(function(e){e instanceof Qe.a?t.updateGroupLayerStyle(e):e instanceof qe.d&&t.updateSingleLayerStyle(e)})}},{key:"updateGroupLayerStyle",value:function(e){var t=e.getMembers(),n=t.filter(function(e){return e instanceof Qe.a}),i=t.filter(function(e){return e instanceof qe.d}),a=n.concat(i);this.updateLayerStyles(a);var o=this.itemElementMap.get(e.getItemKey());if(o){var s=Qe.b.convertItemsToSingles(t);s.every(function(e){return e.select})?o.classList.add(r.a.SELECTED):o.classList.remove(r.a.SELECTED);var l=s.some(function(e){return e.isLock()});l?o.classList.add(r.a.ITEM_LOCKED):o.classList.remove(r.a.ITEM_LOCKED),o.draggable=!l}}},{key:"updateSingleLayerStyle",value:function(e){var t=this.itemElementMap.get(e.getItemKey());t&&(e.select?t.classList.add(r.a.SELECTED):t.classList.remove(r.a.SELECTED),e.isLock()?t.classList.add(r.a.ITEM_LOCKED):t.classList.remove(r.a.ITEM_LOCKED),t.draggable=!e.isLock())}},{key:"unfoldGroupDepth",value:function(e){var t=this,n=$o.a.getAllSingleItems(e).filter(function(e){return e.select});n.length>1||n.forEach(function(e){if(e.select&&e.groupId){var n=t.itemElementMap.get(e.tbpeId);n&&Yv.unfoldGroupWrapperElementToAttachedElement(n)}})}},{key:"renderContents",value:function(e){var n=this;e.forEach(function(e){var i=n.thumbMap.get(e.getItemKey());if(null!=i){var a=e.props.getRevision()+"|"+e.props.getStyleRevision();n.thumbRevisionMap.get(e.getItemKey())!==a&&(n.thumbRevisionMap.set(e.getItemKey(),a),e instanceof ee.b?null!=e.svgElements.imageElement.getAttributeNS(Cr.a.XLINK,"href")?t.setImageFrameThumb(i,e.getThumbString(36)):(n.thumbRevisionMap.set(e.getItemKey(),"1"),setTimeout(function(){n.renderContents([e])},500)):(i.getAttribute("data-bg")?e.getFillFullThumbUrl(36,36):e.getThumbUrl(36,36)).then(function(e){i&&(i.src=e)}))}})}},{key:"updateThumbs",value:function(e){this.debounce(e)}},{key:"debounce",value:function(e){var t=this,n=e.reduce(function(e,t){return e+t.getItemKey()},"");this.debounceMap.has(n)&&clearTimeout(this.debounceMap.get(n));var i=setTimeout(function(){t.debounceMap.delete(n),t.renderContents(e),e=null},200);this.debounceMap.set(n,i)}},{key:"containsClass",value:function(e,t){return e.classList.contains(t)}},{key:"moveScrollToSelectedLayerByCenter",value:function(){var e=this.layerBody,t=e.contents,n=t.querySelector(".".concat(r.a.SELECTED));if(n&&t.querySelectorAll(".layer")){var i=n.offsetHeight,a=(t.offsetHeight-i)/2;e.setScrollY(this.getOffsetTop(n)-a)}}},{key:"getOffsetTop",value:function(e){var t;if(this.containsClass(e,"group")&&e.parentElement)t=e.parentElement.offsetTop;else{t=e.offsetTop;for(var n=e.parentElement;n&&this.containsClass(n,"layer_wrap");)t+=n.offsetTop,n=n.parentElement}return t}}],[{key:"makeBtn",value:function(e,t){var n=document.createElement("button");return Object(ne.setToolsIcon)(n,e),n.className=t,n}},{key:"addTextEditEventListener",value:function(e){var t=".".concat(r.a.TITLE);e.on("click",t,function(e){var t=$(e.currentTarget),n=t[0];t.parent().parent().hasClass(r.a.SELECTED)&&(e.stopPropagation(),"true"!==n.contentEditable&&(t.data("lastTitle",n.innerText),n.contentEditable="true",n.focus(),$(document.body).one("click",function(){n.blur()})))}).on("keydown keyup",t,function(e){var t=$(e.currentTarget)[0];e.stopPropagation(),13!==e.keyCode&&27!==e.keyCode||t.blur(),t.innerText.length>=255&&(t.innerText=t.innerText.substr(0,255))}).on("focus",t,function(e){var t=$(e.currentTarget)[0];e.stopPropagation(),t.parentElement.classList.add(r.a.ACTIVE),document.execCommand("selectAll")}).on("blur",t,function(e){var t=$(e.currentTarget),n=t[0],i=t.parent().parent(),a=t.data("lastTitle");if(n.contentEditable="false",n.scrollLeft=0,n.innerText.length||(n.innerText=a),a!==n.innerText){var o=i.hasClass("group")?i.data("groupId"):i.data("itemKey");X.a.instance.dispatch(new Kv(o,n.innerText)),t.data("lastTitle",n.innerText)}})}},{key:"addLayerEventListener",value:function(e){var t=Object(ne.getToolsIconName)(ne.ToolsIcon.GREATER_THAN);e.on("click",".layer.single",function(e){var t=$(e.currentTarget).data("itemKey");X.a.instance.dispatch(new K.c(function(n,i){var a=n.pages[i.renderPageIdx],o=e.ctrlKey||e.shiftKey,s=a.background.backgroundItem;if(!(o&&s&&s.select)){var r=a.getAllSingleItems(),l=r.find(function(e){return e.getItemKey()===t});if(e.ctrlKey)l.select?J.a.unselectItem(l):J.a.appendSelectedItem(l);else if(e.shiftKey){var c=[],u=r.indexOf(i.activeItems[i.activeItems.length-1]),d=r.indexOf(i.activeItems[0]),h=r.indexOf(l),p=!0,m=!1,f=void 0;try{for(var v,g=r[Symbol.iterator]();!(p=(v=g.next()).done);p=!0){var E=v.value,y=r.indexOf(E);d>y&&(y>=d||y<h)||u<y&&(y<=u||y>h)||E.isOnlyOneItem()||c.push(E)}}catch(e){m=!0,f=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw f}}J.a.appendSelectedItems(c)}else{J.a.selectItem(l);var T=i.pageController.getPageRenderer(a);T&&T.updateHoverLayer()}}},!0))}).on("click",".layer.single .lock",function(e){var t=$(e.currentTarget).parent().data("itemKey");t&&X.a.instance.dispatch(new K.c(function(e,n){var i=e.pages[n.renderPageIdx].getAllSingleItems().find(function(e){return e.getItemKey()===t});i.isLock()?X.a.instance.dispatch(new On.p(Qe.b.getGroupItemsAddedArray([i]))):X.a.instance.dispatch(new On.l(Qe.b.getGroupItemsAddedArray([i])))}))}).on("click",".layer.background",function(e){X.a.instance.dispatch(new K.c(function(t,n,i){if(!(e.ctrlKey||e.shiftKey)||!n.activeItems.length){var a=t.pages[n.renderPageIdx].background.backgroundItem;a?(J.a.selectItem(a),i.renderItemTools(t,n)):J.a.unselectAllItems()}},!0))}).on("click",".layer.group",function(e){var n=$(e.target),i=$(e.currentTarget),a=i.data("groupId");if(n.hasClass(r.a.THUMB)||n.parent().hasClass(r.a.THUMB)||n.hasClass(t))i.parent().toggleClass(r.a.FOLD);else if(n.hasClass(r.a.LOCK)||n.parent().hasClass(r.a.LOCK)){var o=Qe.b.getRootGroup(a).getAllSingleMembers(),s=o.filter(function(e){return!e.isLock()});s.length?X.a.instance.dispatch(new On.l(s)):X.a.instance.dispatch(new On.p(o))}else X.a.instance.dispatch(new K.c(function(t,n){var i=e.ctrlKey||e.shiftKey,o=t.pages[n.renderPageIdx].background.backgroundItem;if(!(i&&o&&o.select)){var s=Qe.b.getRootGroup(a).getAllSingleMembers();if(e.ctrlKey)s.every(function(e){return e.select})?J.a.unselectItem(s[0]):J.a.appendSelectedItems(s);else if(e.shiftKey){var r=[],l=t.pages[n.renderPageIdx].getAllSingleItems(),c=l.indexOf(n.activeItems[n.activeItems.length-1]),u=l.indexOf(n.activeItems[0]),d=l.indexOf(s[0]),h=l.indexOf(s[s.length-1]),p=!0,m=!1,f=void 0;try{for(var v,g=l[Symbol.iterator]();!(p=(v=g.next()).done);p=!0){var E=v.value,y=l.indexOf(E);u>y&&(y>=u||y<h)||c<y&&(y<=c||y>d)||E.isOnlyOneItem()||r.push(E)}}catch(e){m=!0,f=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw f}}J.a.appendSelectedItems(r)}else{J.a.unselectAllItems();var T=Qe.b.getGroup(a);J.a.appendSelectedItems(T.getAllSingleMembers())}}},!0))})}},{key:"addDragEventListener",value:function(e){var t,n=-1,i=-1,a=null,o=null;e.on("dragstart",".".concat(r.a.NOT_DEEP),function(e){(t=$(e.currentTarget)).attr("style","opacity:.5 !important;").addClass("target"),i=t.index(),n=i,o=t.data("itemIdxList"),e.originalEvent.dataTransfer.setData("text",o.join(",")),e.originalEvent.dataTransfer.dropEffect="move"}).on("dragover",".".concat(r.a.NOT_DEEP),function(e){var n=$(e.currentTarget),s=n.index();if(e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="move",i!==s){var r=n.data("itemIdxList");if(r&&r[0]===o[0])return;i<s?n.after(t):n.before(t),i=t.index(),a=r}}).on("drop",".".concat(r.a.NOT_DEEP),function(e){e.preventDefault()}).on("dragend",".".concat(r.a.NOT_DEEP),function(){t.removeAttr("style").removeClass("target"),X.a.instance.dispatch(new Qn(n,i,a,o))})}},{key:"setImageFrameThumb",value:function(e,t){e.innerHTML=t;var n=e.firstElementChild;n.style.top="50%",n.style.left="50%",n.style.transform="translate(-50%, -50%)"}},{key:"renderLayerRow",value:function(e,t,n,i){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=document.createElement("div");o.className=r.a.LAYER,t>0&&(t<11?(o.classList.add(r.a.DEEP),o.style.paddingLeft="".concat(32+16*t,"px")):(o.classList.add(r.a.DEEP,r.a.VERY_DEEP),o.style.paddingLeft="".concat(192,"px")));var s=document.createElement("div");s.className=r.a.THUMB,n?(n.draggable=!1,s.appendChild(n)):i&&(Object(ne.setToolsIcon)(s,i),s.classList.add("icon")),o.appendChild(s);var l=document.createElement("div");l.className=r.a.TITLE_WRAP;var c=document.createElement("div");c.className=r.a.TITLE,c.innerText=e;var u=t<11?16*t:170;c.style.maxWidth="calc(78% - ".concat(u,"px)"),l.style.maxWidth="calc(56% - ".concat(u-24,"px)"),l.appendChild(c),Object(ne.setToolsIcon)(l,ne.ToolsIcon.PENCIL,!0),o.appendChild(l);var d=document.createElement("div");return Object(ne.setToolsIcon)(d,ne.ToolsIcon.LOCK_ON),d.className=r.a.LOCK,a?Object(ne.setToolsIcon)(d,ne.ToolsIcon.LOCK_OFF):d.classList.add(r.a.DISABLE),o.appendChild(d),o}}]),t}(He.a);!function(e){e.DEFAULT="default",e.WARNING="warning_resolution",e.CAUTION="caution_resolution",e.GOOD="good_resolution",e.ALERT_LIST_CONFIRM="alert_list_confirm"}(xv||(xv={}));var qv,$v=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"render",value:function(){var e=this.props.type;return ra.a.createElement("div",{className:"info_box ".concat(e.toString())},e===xv.DEFAULT&&ra.a.createElement("p",null,"실제 출력물은 모니터의 색감과 큰 차이가 발생할 수 있습니다."),e===xv.WARNING&&ra.a.createElement(ra.a.Fragment,null,ra.a.createElement("p",null,"하단의 요소 목록을 모두 확인해주세요."),ra.a.createElement("p",null,"빨간색으로 표시된 경고가 있을 경우 주문이 불가능하므로 반드시 수정해주세요!")),e===xv.CAUTION&&ra.a.createElement(ra.a.Fragment,null,ra.a.createElement("p",null,"하단의 요소 목록을 모두 확인해주세요."),ra.a.createElement("p",null,"제작 진행 중 표시된 경고 내용 또는 고객변심으로 인한 주문 취소 및 수정은 불가능합니다.")),e===xv.GOOD&&ra.a.createElement("p",null,"모든 이미지의 해상도 상태가 좋아요!"),e===xv.ALERT_LIST_CONFIRM&&ra.a.createElement("p",null,"위의 사항을 모두 체크해주세요."))}}]),t}(ra.a.Component),Qv=n(65);!function(e){e.TEXT="ITEM_TEXT",e.GRID="ITEM_GRID",e.DEFAULT="ITEM_DEFAULT",e.SVG="SVG"}(qv||(qv={})),(qv||(qv={})).getThumbnailType=function(e){return e instanceof rs.a?qv.TEXT:e instanceof Z.a?qv.GRID:e instanceof ee.b?qv.SVG:qv.DEFAULT};var Jv,eg=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"render",value:function(){return ra.a.createElement("div",{className:r.a.THUMB},this.props.thumbnailType===qv.TEXT&&ra.a.createElement(Qv.a,{icon:ne.ToolsIcon.ITEM_TEXT}),this.props.thumbnailType===qv.GRID&&ra.a.createElement(Qv.a,{icon:ne.ToolsIcon.ITEM_GRID}),this.props.thumbnailType===qv.SVG&&ra.a.createElement("div",{className:"thumb_svg_container",dangerouslySetInnerHTML:{__html:this.props.imgUrl}}),this.props.thumbnailType===qv.DEFAULT&&ra.a.createElement("img",{src:this.props.imgUrl}))}}]),t}(sa.Component),tg=function(){function e(){L()(this,e)}return w()(e,null,[{key:"findThumbnailType",value:function(e){return qv.getThumbnailType(this.findTbpeItem(e))}},{key:"findTbpeItem",value:function(e){var t=null;return X.a.instance.dispatch(new K.c(function(n){for(var i=n.pages,a=0;a<i.length;a++){var o=i[a].getAllSingleItems();if(t=o.find(function(t){return t.tbpeId===e}))break}})),t}}]),e}(),ng=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e)))._isMounted=!1,n.containerRef=ra.a.createRef(),n.state={imgUrl:""},n}var n;return z()(t,e),w()(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.setThumbnail()}},{key:"componentDidUpdate",value:function(e,t,n){var i=this;(e.data!==this.props.data||this.props.isOpen!==e.isOpen&&this.props.isOpen)&&(this.thumbnailTimer?this.thumbnailTimer.resetExecCallBack():this.thumbnailTimer=new Va.a(1e3,function(){return i.setThumbnail()}))}},{key:"isSelected",value:function(){return this.props.data.isSelected}},{key:"getOffsetHeight",value:function(){return this.containerRef.current.offsetHeight}},{key:"getOffsetTop",value:function(){return this.containerRef.current.offsetTop}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.thumbnailTimer&&this.thumbnailTimer.clear()}},{key:"setThumbnail",value:(n=s()(a.a.mark(function e(){var t,n=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=tg.findTbpeItem(this.props.data.tbpeId))&&!(t instanceof rs.a)){e.next=3;break}return e.abrupt("return");case 3:t instanceof ee.b?this._isMounted&&this.setState({imgUrl:t.getThumbString(36)}):t.getThumbUrl(36,36).then(function(e){n._isMounted&&n.setState({imgUrl:e})}).catch(function(e){0});case 4:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"onErrorClicked",value:function(e){e.stopPropagation(),e.preventDefault(),this.props.onErrorClicked(this.props.data.tbpeId)}},{key:"onItemClicked",value:function(e){e.stopPropagation(),e.preventDefault();var t=this.props.data,n=t.tbpeId,i=t.level;this.props.onItemClicked(n,i)}},{key:"render",value:function(){return ra.a.createElement("div",{ref:this.containerRef,className:"accordion_list_item ".concat(this.props.data.isSelected?r.a.SELECTED:""),onClick:this.onItemClicked.bind(this)},ra.a.createElement(Qv.a,{icon:ne.ToolsIcon.ERROR,onClick:this.onErrorClicked.bind(this)}),ra.a.createElement(eg,{thumbnailType:tg.findThumbnailType(this.props.data.tbpeId),imgUrl:this.state.imgUrl}),ra.a.createElement("p",null,this.props.data.title?this.props.data.title:""))}}]),t}(ra.a.Component);!function(e){e.DEFAULT="DEFAULT",e.RECOMMEND="RECOMMEND",e.CAUTION="CAUTION",e.WARNING="WARNING"}(Jv||(Jv={}));var ig,ag=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"getMessagesWithHighlight",value:function(){var e=[];return this.props.highlightTextInMessage?((e=this.props.message.split(this.props.highlightTextInMessage)).splice(1,0,this.props.highlightTextInMessage),e):e}},{key:"getClassNameWithType",value:function(e){return Yr()(e,{default:this.props.type===Jv.DEFAULT,recommend:this.props.type===Jv.RECOMMEND,caution:this.props.type===Jv.CAUTION,warning:this.props.type===Jv.WARNING,animation_blink:this.props.runAnimation})}},{key:"render",value:function(){var e=this;return ra.a.createElement("div",{className:this.getClassNameWithType("info_box")},!d.b.isEmpty(this.props.title)&&ra.a.createElement("div",{className:"title"},ra.a.createElement(og,null),ra.a.createElement("label",null,this.props.title)),ra.a.createElement("div",{className:this.getClassNameWithType("message")},this.props.highlightTextInMessage?this.getMessagesWithHighlight().map(function(t,n){return ra.a.createElement("span",{key:n,className:t===e.props.highlightTextInMessage?"highlight":""},t)}):d.b.isEmpty(this.props.title)&&this.props.type===Jv.WARNING&&ra.a.createElement(ra.a.Fragment,null,ra.a.createElement(og,null),ra.a.createElement("span",null,this.props.message))),this.props.reference&&ra.a.createElement("div",{className:"reference"},this.props.reference))}}]),t}(sa.Component),og=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"render",value:function(){return ra.a.createElement("i",{className:"tools_icon icon_caution"})}}]),t}(sa.Component),sg=ag,rg=function e(){L()(this,e)},lg=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).state=new rg,n}return z()(t,e),w()(t,[{key:"onAnimation",value:function(){var e=this;this.animationTimeoutId||(this.setState({runAnimation:!0}),this.animationTimeoutId=window.setTimeout(function(){e.setState({runAnimation:!1}),e.animationTimeoutId=null},2e3))}},{key:"render",value:function(){return ra.a.createElement(ra.a.Fragment,null,this.props.requiredPageCountList&&this.props.requiredPageCountList.length>0&&!this.props.requiredPageCountList.includes(this.props.pageCount)&&ra.a.createElement(sg,{type:Jv.WARNING,title:"페이지수를 맞춰주세요!",message:"해당 상품은 ".concat(this.props.requiredPageCountList.join(", ")," 페이지로 제작할 수 있어요."),highlightTextInMessage:this.props.requiredPageCountList.join(", "),reference:"* 현재 페이지 수 : ".concat(this.props.pageCount," 페이지"),runAnimation:this.state.runAnimation}))}}]),t}(sa.Component),cg=function(e){function t(e){var n;return L()(this,t),(n=V()(this,F()(t).call(this,e))).verticalScrollView=ra.a.createRef(),n.messageBoxList=ra.a.createRef(),n.warningRefList=[],n.recommendRefList=[],n.cautionRefList=[],n}return z()(t,e),w()(t,[{key:"getSelectedLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.find(function(e){if(e)return e.props.data.isSelected})}},{key:"getFirstSelectedLayer",value:function(){return this.getSelectedLayer(this.warningRefList)||this.getSelectedLayer(this.cautionRefList)||this.getSelectedLayer(this.recommendRefList)}},{key:"componentDidUpdate",value:function(e,t,n){var i=this,o=this.props,r=o.recommendList,l=o.cautionList,c=o.warningList,u=r.length!==e.recommendList.length||l.length!==e.cautionList.length||c.length!==e.warningList.length;(this.props.scrollRequired||u)&&s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.moveScrollToSelectedLayerByCenter();case 1:case"end":return e.stop()}},e)}))()}},{key:"onItemClicked",value:function(e,t){this.props.onItemClicked(e,t)}},{key:"moveScrollToSelectedLayerByCenter",value:function(){var e=this.getFirstSelectedLayer();if(e){var t=(this.verticalScrollView.current.getContentOffsetHeight()-e.getOffsetHeight())/2;this.verticalScrollView.current.setScrollY(e.getOffsetTop()-t)}}},{key:"moveScrollToTop",value:function(){this.verticalScrollView.current.setScrollY(0)}},{key:"onAnimationMessage",value:function(){this.messageBoxList.current.onAnimation()}},{key:"render",value:function(){var e=this,t=this.props,n=t.recommendList,i=t.warningList,a=t.cautionList,o=i.length,s=n.length+o+a.length,r=s>0&&0===o,l=s>0&&o>0;return this.warningRefList=[],this.cautionRefList=[],this.recommendRefList=[],ra.a.createElement("div",{className:"message_list_body"},ra.a.createElement(pa.a,{ref:this.verticalScrollView},ra.a.createElement("div",{className:"contents_wrapper"},ra.a.createElement($v,{type:xv.DEFAULT}),ra.a.createElement(lg,{ref:this.messageBoxList,requiredPageCountList:this.props.requiredPageCountList,pageCount:this.props.pageCount}),r&&ra.a.createElement($v,{type:xv.CAUTION}),l&&ra.a.createElement($v,{type:xv.WARNING}),this.props.isPhotoIncluded&&!this.props.isLowRes&&ra.a.createElement($v,{type:xv.GOOD}),this.props.loading&&ra.a.createElement(ug,null),ra.a.createElement("div",{className:"body_list_wrapper"},ra.a.createElement("div",{className:"warning_list"},o>0&&this.props.warningList.map(function(t){return ra.a.createElement(ng,{key:t.tbpeId,ref:function(t){return e.warningRefList.push(t)},isOpen:e.props.isOpen,onItemClicked:e.onItemClicked.bind(e),onErrorClicked:e.props.onErrorClicked,data:t})})),ra.a.createElement("div",{className:"caution_list"},a.length>0&&this.props.cautionList.map(function(t){return ra.a.createElement(ng,{key:t.tbpeId,ref:function(t){return e.cautionRefList.push(t)},isOpen:e.props.isOpen,onItemClicked:e.onItemClicked.bind(e),onErrorClicked:e.props.onErrorClicked,data:t})})),ra.a.createElement("div",{className:"recommend_list"},n.length>0&&this.props.recommendList.map(function(t){return ra.a.createElement(ng,{key:t.tbpeId,ref:function(t){return e.recommendRefList.push(t)},isOpen:e.props.isOpen,onItemClicked:e.onItemClicked.bind(e),onErrorClicked:e.props.onErrorClicked,data:t})}))))))}}]),t}(ra.a.Component),ug=function(e){function t(){return L()(this,t),V()(this,F()(t).apply(this,arguments))}return z()(t,e),w()(t,[{key:"render",value:function(){for(var e=[],t=0;t<3;t++)e.push(ra.a.createElement("div",{key:t,className:"loading_box"}));return e}}]),t}(sa.Component),dg=cg,hg=function(e){function t(){var e,n;L()(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=V()(this,(e=F()(t)).call.apply(e,[this].concat(a)))).SAVE_BUTTON_DISABLED="disable",n}return z()(t,e),w()(t,[{key:"onClick",value:function(e){e.stopPropagation(),this.props.onClick()}},{key:"render",value:function(){return ra.a.createElement("div",{className:"save_button ".concat(this.props.isActive?"":this.SAVE_BUTTON_DISABLED),onClick:this.onClick.bind(this)},this.props.text)}}]),t}(ra.a.Component),pg=function(){function e(t){L()(this,e),this.CLAP_ANIMATION_VIEW="clap_animation_view",this.CHARACTER="character",this.LEFT_HAND_STYLE="left_hand",this.RIGHT_HAND_STYLE="right_hand",this.CLAP_EFFECT_STYLE="clap_effect",this.listener=t}return w()(e,[{key:"makeElement",value:function(){var e=this,t=document.createElement("div");t.className=this.CLAP_ANIMATION_VIEW;var n=this.leftHand=document.createElement("div");n.classList.add(this.CHARACTER,this.LEFT_HAND_STYLE),t.appendChild(n);var i=this.rightHand=document.createElement("div");i.classList.add(this.CHARACTER,this.RIGHT_HAND_STYLE),t.appendChild(i);var a=this.clapEffect=document.createElement("div");a.classList.add(this.CHARACTER,this.CLAP_EFFECT_STYLE),t.appendChild(a);return $([n,i,a]).on("click",function(){if(e.listener){var t=e.listener,n=t.onClickClapEffect,i=t.onClickRightHand,a=t.onClickLeftHand;i(),a(),n()}}),t}}]),e}(),mg=function(e){function t(){var e;return L()(this,t),(e=V()(this,F()(t).call(this))).characterView=new pg,e.id="printoutFinalConfirm",e}return z()(t,e),w()(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),w()(t,[{key:"initPopupType",value:function(){S.a.getEditorOpenOption().isChangeNewMode()?(this.title.innerText="편집중인 디자인을 장바구니에 추가하였습니다.",this.subTitle.innerHTML="편집을 계속하거나 <span>장바구니</span>로 이동하여 상품을 확인하세요.",this.btnMove.innerText="장바구니로 이동하기"):(this.title.innerText="디자인 수정을 완료하였습니다.",this.subTitle.innerHTML="비즈하우스로 이동합니다.",this.btnMove.innerText="확인",this.btnMove.classList.add("update_mode"))}},{key:"makeElement",value:function(e){var n=this;this.contents=Ys.a.makeDiv("printout_final_confirm_popup"),this.makeBtnClose=!0,this.title=Ys.a.makeDiv("title"),this.subTitle=Ys.a.makeDiv("sub_title");var i=this.btnContinue=Ys.a.makeDiv("button_continue");i.innerText="계속 편집하기",i.addEventListener("click",function(){t.close(),e&&e()}),this.btnMove=Ys.a.makeDiv("button_move"),this.btnMove.addEventListener("click",function(){n.close(),S.a.getEditorOpenOption().getActionOnSuccess().execute()});var a=this.characterView.makeElement();this.contents.appendChild(a),this.contents.appendChild(this.title),this.contents.appendChild(this.subTitle),this.contents.appendChild(i),this.contents.appendChild(this.btnMove)}},{key:"getContents",value:function(){return this.contents}},{key:"isPreventBackgroundCloseEvent",value:function(){return!0}},{key:"updateUI",value:function(){this.updateContinueButton()}},{key:"updateContinueButton",value:function(){S.a.getEditorOpenOption().isChangeNewMode()?this.btnContinue.classList.remove(r.a.HIDE):this.btnContinue.classList.add(r.a.HIDE)}}],[{key:"show",value:function(e){this.instance.contents||this.instance.makeElement(e),this.instance.initPopupType(),this.instance.open()}},{key:"close",value:function(){this.instance.close(),this._instance=null}}]),t}(u.a);!function(e){e.NEW_CART="new_cart",e.NEW_COLLECTION="new_collection",e.UPDATE="update",e.UPDATE_CART="update_cart",e.UPDATE_COLLECTION="update_collection"}(ig||(ig={}));var fg=function(){function e(){L()(this,e)}return w()(e,null,[{key:"getActionSet",value:function(){return{createDesignToCart:(t=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.save({categoryIdx:Wt.a.getSaveCategoryIdx(),isCreateToCart:!0,afterSaveCallback:t});case 2:e.sent!==I.a.SAVE_COMPLETE&&alert("문서가 완전히 저장되지 않았습니다.");case 4:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),updateDesignToCart:(e=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.save({categoryIdx:Wt.a.getSaveCategoryIdx(),isUpdateToCart:!0,afterSaveCallback:t});case 2:e.sent!==I.a.SAVE_COMPLETE&&alert("문서가 완전히 저장되지 않았습니다.");case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}),checkIncludePhotoItem:function(){return vl.a.checkIncludePhotoItem()}};var e,t}}]),e}();function vg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}var gg,Eg=function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];L()(this,e),this.cautionList=[],this.warningList=[],this.recommendList=[],this.isShownCheckAllAlert=!1,this.isBtnAddCartActive=!0,this.pageCount=1,this.loading=!0,this.isAllListConfirm=t,this.isAllTypoCheck=n},yg=function(e){function t(e){var n;L()(this,t),(n=V()(this,F()(t).call(this,e))).isScrollMoving=!1,n.messageList=Object(sa.createRef)(),n.state=new Eg(ie.a.checkedListConfirmFromUser,ie.a.checkedTypoFromUser),ie.a.setListener(H()(n));var i=fg.getActionSet();return n.actionSet={saveDesignToCart:i.createDesignToCart,updateDesign:i.updateDesignToCart,checkIncludePhotoItem:i.checkIncludePhotoItem},n.requiredPageCountList=S.a.getEditorOpenOption().getPageCount().getRequiredPageCountList(),n}return z()(t,e),w()(t,[{key:"onClear",value:function(){this.setState(new Eg(ie.a.checkedListConfirmFromUser,ie.a.checkedTypoFromUser))}},{key:"onChangeAlerts",value:function(e,t,n,i){i&&(this.setState({cautionList:e,warningList:t,recommendList:n,loading:!1,pageCount:vl.a.getPageCount()}),this.isScrollMoving=i)}},{key:"setOnCloseListener",value:function(e){this.onCloseListener=e}},{key:"close",value:function(){ie.a.removeListener(),this.onCloseListener&&this.onCloseListener()}},{key:"componentDidMount",value:function(){window.setTimeout(function(){return X.a.instance.dispatch(new se.d)},300)}},{key:"componentDidUpdate",value:function(e,t,n){t.isAllListConfirm!==this.state.isAllListConfirm&&(ie.a.checkedListConfirmFromUser=this.state.isAllListConfirm),t.isAllTypoCheck!==this.state.isAllTypoCheck&&(ie.a.checkedTypoFromUser=this.state.isAllTypoCheck)}},{key:"onItemClicked",value:function(e){ie.a.onItemClicked(e)}},{key:"onClickAddCartButton",value:function(){var e=this;if(this.isCheckedAllConfirm())return this.shouldCheckWarning()?(this.messageList.current.moveScrollToTop(),void this.messageList.current.onAnimationMessage()):void(this.isCheckedAllConfirm()&&this.actionSet&&(S.a.getEditorOpenOption().isChangeNewMode()?this.actionSet.saveDesignToCart(function(){return mg.show(function(){return e.close()})}):this.actionSet.updateDesign(function(){return mg.show(function(){return e.close()})})));this.setState({isShownCheckAllAlert:!0,isBtnAddCartActive:!1})}},{key:"onChangeChecked",value:function(e,t){var n,i=this;this.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vg(n,!0).forEach(function(t){Wc()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vg(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},this.state,(n={},Wc()(n,e,t),Wc()(n,"isShownCheckAllAlert",!1),n)),function(){i.setState({isBtnAddCartActive:i.isCheckedAllConfirm()})})}},{key:"onErrorClicked",value:function(e){ie.a.onErrorClicked(e)}},{key:"checkIncludePhotoItem",value:function(){return!!this.actionSet&&this.actionSet.checkIncludePhotoItem()}},{key:"isCheckedAllConfirm",value:function(){var e=this.state.cautionList.length+this.state.warningList.length+this.state.recommendList.length;return this.state.isAllTypoCheck&&(0===e||this.state.isAllListConfirm)}},{key:"shouldCheckWarning",value:function(){return this.requiredPageCountList.length>0&&!this.requiredPageCountList.includes(this.state.pageCount)}},{key:"onChangePages",value:function(){this.onClear(),window.setTimeout(function(){return X.a.instance.dispatch(new se.d)},300)}},{key:"render",value:function(){var e=this,t=this.state.cautionList.length+this.state.recommendList.length+this.state.warningList.length;return ra.a.createElement("div",{className:"printout_confirm_container active"},ra.a.createElement("div",{className:"header"},ra.a.createElement("div",{className:"title"},"최종 확인"),ra.a.createElement("div",{className:"icon_close",onClick:function(){return e.close()}})),ra.a.createElement(dg,{cautionList:this.state.cautionList,warningList:this.state.warningList,recommendList:this.state.recommendList,ref:this.messageList,isOpen:!0,scrollRequired:this.isScrollMoving,isLowRes:lr.getNumberOfImageDpiAlert(hr.a.getAllAlerts())>0,isPhotoIncluded:this.checkIncludePhotoItem(),onItemClicked:this.onItemClicked.bind(this),onErrorClicked:this.onErrorClicked.bind(this),pageCount:this.state.pageCount,requiredPageCountList:this.requiredPageCountList,loading:this.state.loading}),ra.a.createElement("div",{className:"footer"},t>0&&ra.a.createElement(va,{isChecked:this.state.isAllListConfirm,text:"위의 요소 목록을 모두 확인하였습니다.",name:"isAllListConfirm",onChange:this.onChangeChecked.bind(this)}),ra.a.createElement(va,{isChecked:this.state.isAllTypoCheck,text:"모든 페이지의 오탈자를 체크하였습니다.",name:"isAllTypoCheck",onChange:this.onChangeChecked.bind(this)}),this.state.isShownCheckAllAlert&&ra.a.createElement($v,{type:xv.ALERT_LIST_CONFIRM}),this.shouldCheckWarning()&&ra.a.createElement(sg,{type:Jv.WARNING,message:"위 경고를 확인해주세요."}),ra.a.createElement(hg,{isActive:this.state.isBtnAddCartActive,onClick:this.onClickAddCartButton.bind(this),text:S.a.getPrintoutOption().saveCartConfirmButtonLabel})))}}]),t}(sa.Component),Tg=function(e){function t(){return L()(this,t),V()(this,F()(t).call(this,!0))}return z()(t,e),w()(t,[{key:"onCreateView",value:function(){this.container.classList.add("multi_select_view"),ss.a.setListener(this)}},{key:"onChangeState",value:function(e,t){if(e=e&&t>0,this.setVisibility(e),e){this.container.innerHTML="";var n=t>1;Object(ne.setToolsIcon)(this.container,n?ne.ToolsIcon.CHECK_OUTLINE:ne.ToolsIcon.OUTLINE),us.a.createElement(n?'<div class="label">'.concat(t,"개 선택</div>"):'<div class="label">여러개의 요소를 선택하세요</div>',this.container)}}}]),t}(He.a),Ig=function(){function e(){if(L()(this,e),Uo.setListener(this),this.headerBarVC=new Ru,this.itemToolsRenderer=new ih,hu.start(),this.itemGuideAlertMobile=new jo,this.appElement=document.getElementById("app"),null==this.appElement)throw Error("와 조작당함: ".concat("app"));var t=this.headerBarVC.getContainer();t&&t.parentElement!==this.appElement&&this.appElement.appendChild(t),this.leftBarVC=new Pu,this.leftPanelMainVC=new Vv(this.leftBarVC),this.leftPanelMainVC.activePanel(So.b.TEMPLATE_LIB),this.helpCenterVC=new oc;var n=document.getElementById(sc.a.editorWrap);n.appendChild(this.leftBarVC.getContainer()),n.appendChild(this.makeEditorSection()),this.rightPanelContainer=document.createElement("div"),this.rightPanelContainer.id=sc.a.RightPanelMainVC,n.appendChild(this.rightPanelContainer);var i=document.createElement("div");i.id=sc.a.rightBar,this.rightPanelContainer.appendChild(i);var a=document.createElement("div");a.id=sc.a.layerToolBox,this.rightPanelContainer.appendChild(a),Ko.open()}var t,n,i;return w()(e,[{key:"setReady",value:(i=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.headerBarVC.onStartView(),this.canvasAreaVC.onStartView(),e.next=4,this.itemToolsRenderer.setReady();case 4:this.itemHandleVC.onStartView(),this.zoomSettingVC.onStartView(),this.helpCenterVC.onStartView(),this.designProjectMenuVC&&this.designProjectMenuVC.onStartView(),S.a.getCanvasAreaOption().showDesignCommissionSuggestionPopup&&Zl.onShowSuggestionPopup(),Uo.setPrintoutGuideVisibility(!je.a.isMobilePortrait());case 10:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"renderAll",value:(n=s()(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.renderAuto(t,n);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"renderItemTools",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return n?this.itemToolsRenderer.render(e,t,nh.HIDE):i?this.itemToolsRenderer.render(e,t,nh.FORCE_UPDATE):this.itemToolsRenderer.render(e,t),this}},{key:"renderItemToolsByItem",value:function(e,t,n,i){n===pl.a.ADMIN?this.itemToolsRenderer.renderItem(e,t,nh.ADMIN):n===pl.a.MOCKUP_EDIT?this.itemToolsRenderer.renderItem(e,t,nh.MOCKUP_EDIT,i):this.itemToolsRenderer.renderItem(e,t)}},{key:"renderPageNavigator",value:function(e,t){return this.zoomSettingVC.onDataChanged(e),this}},{key:"renderCanvas",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.canvasAreaVC.renderAuto(e,t,n).catch(function(e){return null}),this}},{key:"renderLayer",value:function(e,t){return this.layerPanelVC&&this.layerPanelVC.onDataChanged(e),this}},{key:"renderDesignProjectMenu",value:function(){return this.designProjectMenuVC&&this.designProjectMenuVC.onDataChanged(void 0),this}},{key:"renderAuto",value:(t=s()(a.a.mark(function e(t,n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=8;break}return e.next=3,this.canvasAreaVC.renderAuto(t,n);case 3:try{this.renderOther(t,n)}catch(e){console.log(e)}return i(),e.abrupt("return",this);case 8:return e.next=10,this.canvasAreaVC.renderAuto(t,n).catch(function(e){return console.log(e)});case 10:return e.abrupt("return",this.renderOther(t,n));case 11:case"end":return e.stop()}},e,this)})),function(e,n,i){return t.apply(this,arguments)})},{key:"setRotateSpecialBtn",value:function(e){je.a.isMobilePortraitSize()&&e?this.specialBtn.classList.add("rotate"):this.specialBtn.classList.remove("rotate")}},{key:"onChangeUserSetting",value:function(e,t){t===Yo.b.FIELD_IS_RULER_VISIBLE?this.canvasAreaVC.setRulerVisible(e.isRulerVisible):t===Yo.b.FIELD_IS_LAYER_VISIBLE&&this.showLayerPanel(e.isLayerVisible)}},{key:"setVisibleSpecialBtn",value:function(e){e?this.specialBtn.classList.remove(r.a.MOBILE_HIDE):this.specialBtn.classList.add(r.a.MOBILE_HIDE)}},{key:"setPositionFloatingButtons",value:function(e){if(this.specialBtn){switch(e){case nl.default:this.specialBtn.classList.remove(r.a.FLOATING_TOP);break;case nl.top:this.specialBtn.classList.add(r.a.FLOATING_TOP)}this.zoomSettingVC&&this.zoomSettingVC.setFloatingPosition(e)}}},{key:"renderHandler",value:function(e,t,n,i){return this.itemHandleVC.onDataChanged(e,n,i),this}},{key:"renderOther",value:function(e,t,n){this.renderHandler(e,t);var i=n===pl.b.ITEM_TOOLS_UPDATE_PREVENT,a=n===pl.b.NO_RENDER_LAYER;return i||a||this.itemToolsRenderer.render(e,t),this.headerBarVC.onDataChanged(e),this.zoomSettingVC.onDataChanged(e),this.renderDesignProjectMenu(),this.templateProjectVC&&this.templateProjectVC.renderView(),!a&&this.layerPanelVC&&this.layerPanelVC.onDataChanged(e),this.leftBarVC.onDataChanged(e),this.leftPanelMainVC.renderPanels(e),ss.a.updateStateByActiveItems(),this}},{key:"hasScroll",value:function(){return this.canvasAreaVC.scrollElement.hasScroll()}},{key:"scrollView",value:function(e,t){this.canvasAreaVC.scrollElement.moveScrollX(e).moveScrollY(t)}},{key:"moveScroll",value:function(e,t){this.canvasAreaVC.scrollElement.moveScroll(e,t)}},{key:"setScroll",value:function(e,t){this.canvasAreaVC.scrollElement.setScrollX(e),this.canvasAreaVC.scrollElement.setScrollY(t)}},{key:"scrollCenter",value:function(){this.canvasAreaVC.scrollElement.moveScrollCenter()}},{key:"renderLayerThumb",value:function(e){this.layerPanelVC&&this.layerPanelVC.updateThumbs(e)}},{key:"makeEditorSection",value:function(){var e=this,t=S.a.getCanvasAreaOption(),n=document.getElementById(sc.a.editorSection);null==n&&(n=document.createElement("section")),n.id="editorSection",void 0!==Uv.a.getDesignProject()&&(this.designProjectMenuVC=new zv,n.appendChild(this.designProjectMenuVC.getContainer()));var i=document.createElement("div");i.id="playground";var a=document.createElement("div");a.id="itemArrangeTypeSelector";var o=as.a.getElement();this.canvasAreaVC=new tl,this.itemHandleVC=new Ts,this.zoomSettingVC=new hl;var s=this.specialBtn=document.createElement("div");s.id="specialButton",this.pintoutGuideButtonView=new al(Uo.option.showPrintOutGuide,function(e){Uo.setPrintoutGuideVisibility(e)}),Ke.a.addListener(this);var l=document.createElement("div");je.a.isMobileDevice()&&l.appendChild(ol.getElement()),l.addEventListener("click",function(t){t.stopPropagation(),ol.close(),e.leftBarVC.toggleActive()}),l.id="showLibrary",Object(ne.setToolsIcon)(l,ne.ToolsIcon.ADD),s.appendChild(l);var c=document.createElement("div");c.id="helpCenter",c.className=r.a.HELP_CENTER;var u=t.bizhowsCenter?ne.ToolsIcon.HELP:ne.ToolsIcon.MESSAGE_ROUNDED;return Object(ne.setToolsIcon)(c,u),c.addEventListener("click",function(t){t.stopPropagation(),e.helpCenterVC.openHelpPopup(c)}),s.appendChild(c),i.appendChild(this.canvasAreaVC.getContainer()),i.appendChild(a),i.appendChild(o),i.appendChild((new Tg).getContainer()),i.appendChild(this.zoomSettingVC.getContainer()),i.appendChild(this.itemGuideAlertMobile.getMobileAlertBtn()),t.showMessageBoxBtn&&i.appendChild(hu.getMailboxFloatingButton()),i.appendChild(s),n.appendChild(i),n}},{key:"onLogin",value:function(e,t){var n=Ke.a.getUserSetting(),i=!0,a=!1,o=void 0;try{for(var s,r=e.pages[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value;if(!t.pageController.getPageRenderer(l))return;t.pageController.getPageRenderer(l).guidelineRenderer.setGuidelineVisibility(n.isGuidelineVisible),t.pageController.getPageRenderer(l).guidelineRenderer.setGuidelineLock(n.isGuidelineLock),t.pageController.getPageRenderer(e.pages[t.renderPageIdx]).setDesignGuide(),Ke.a.replaceMask(n.isSnapGuideVisible,e.pages,t.pageController)}}catch(e){a=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(a)throw o}}this.showLayerPanel(n.isLayerVisible)}},{key:"showLayerPanel",value:function(e){e?(this.showPrintoutConfirmView(!1),this.layerPanelVC=this.layerPanelVC||new Zv):(this.layerPanelVC&&this.layerPanelVC.destroy(),this.layerPanelVC=void 0),X.a.instance.dispatch(new ks)}},{key:"showTemplateProjectPanel",value:function(e){void 0===e&&(e=void 0===this.templateProjectVC||!this.templateProjectVC.isVisible()),!this.templateProjectVC&&pv.a.isReady()&&e&&(this.templateProjectVC=pv.a.makeTemplateProjectVC(),this.templateProjectVC.setViewComponentListener(this),this.templateProjectVC.onStartView()),this.templateProjectVC&&this.templateProjectVC.setVisibility(e)}},{key:"onClose",value:function(e){e==this.templateProjectVC&&X.a.instance.dispatch(new ks)}},{key:"onSetPrintoutGuideVisibility",value:function(e){this.canvasAreaVC.printout.setGuideIconsVisible(e),this.itemGuideAlertMobile.setForceDisabled(!e),this.pintoutGuideButtonView.setActive(e)}},{key:"showPrintoutConfirmView",value:function(e){void 0===e&&(e=void 0===this.printoutConfirmDomView),e?(Ke.a.setIsLayerVisible(!1),this.templateProjectVC&&this.templateProjectVC.setVisibility(!1),this.printoutConfirmDomView||(this.printoutConfirmDomView=new Fo.a(this.rightPanelContainer,yg,void 0),this.printoutConfirmDomView.getContainer().style.height="100%"),Uo.setPrintoutGuideVisibility(!0),this.getPrintoutConfirmVC()&&this.getPrintoutConfirmVC().setOnCloseListener(this.showPrintoutConfirmView.bind(this))):(this.printoutConfirmDomView&&this.printoutConfirmDomView.destroy(),this.printoutConfirmDomView=void 0),this.pintoutGuideButtonView.show(!e),X.a.instance.dispatch(new ks)}},{key:"getPrintoutConfirmVC",value:function(){return this.printoutConfirmDomView&&this.printoutConfirmDomView.getReactComponent()}}]),e}(),Cg=n(176),kg=function(){function e(){L()(this,e)}return w()(e,null,[{key:"showUpdateButtonInfoPusher",value:function(t){if(t){e.showLoaderPusher("수정 후 수정완료 버튼 클릭!","디자인 수정을 완료하였다면 반드시 수정완료 버튼을 클릭해주세요!")}}},{key:"showLoaderPusher",value:function(e,t){var n=document.createElement("span");Object(ne.setToolsIcon)(n,ne.ToolsIcon.INFO).classList.add("loader_popup_icon");var i=new Dr.a({}),a={type:zo.b.CUSTOM,customTypeElement:n,title:e,content:t};i.pushNotification(a,5e3)}},{key:"onPopupClose",value:function(){hu.showMailboxIfRequired(),je.a.isMobileDevice()&&ol.ready()}},{key:"showSkinCompatibilityFailurePopup",value:function(){if(vl.a.hasSkinCompatibilityFailurePage()){(new yc.a).setImg(pc.b.ARGO_EMBARRASSED).setTitle("배경(스킨) 이미지를 불러오지 못했어요.").setSubtitle("호환 문제로 배경 이미지를 불러오지 못했어요.\n에디터 좌측 '배경' 또는 '사진' 메뉴에 있는 이미지를 배경으로 활용해보세요. 불편을 드려 죄송합니다.").addButton("확인",function(){return e.onPopupClose()}).activateXCloseButton().activateShowingUpFromBottomOnMobile().show()}else e.onPopupClose()}},{key:"showPopupsAfterLoading",value:function(){if(Cg.a.isAlreadyOpened())Cg.a.addAfterCloseHandler(function(){e.showSkinCompatibilityFailurePopup()});else if(S.a.getPopupOption().maintenanceNotification){new Cg.a("".concat(fs.a.RESOURCE_DOMAIN,"image/popup/maintenance/200415.png"),"https://miricanvas.zendesk.com/hc/ko/articles/360042158151",function(){var e=new Date(2020,3,15,0);return new Date<e&&f.a.getUser().isLogin()},function(){e.showSkinCompatibilityFailurePopup()}).open()}else e.showSkinCompatibilityFailurePopup()}}]),e}(),Lg=n(275),_g=function(){function e(){L()(this,e)}return w()(e,null,[{key:"changeAllPageSheetSizeBySizeOption",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Lg.a.FIT,i=Mo.a.DEFAULT_DPI,a=t.unit,o=Math.round(De.a.getPixel(t.width,i,a)),s=Math.round(De.a.getPixel(t.height,i,a)),r=new Nn.a(o,s);e.changeSheetSize(r,n)}}]),e}(),wg=new(function(){function e(){L()(this,e)}var t,n,i;return w()(e,[{key:"getDesignDC",value:(i=s()(a.a.mark(function e(t,n,i){var o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t.idx>0)){e.next=4;break}return e.next=3,Uv.a.fetchDesignProject(t.idx);case 3:o=e.sent;case 4:if(!o||!o.isValid()){e.next=8;break}return e.next=7,Uv.a.getDesignDC();case 7:return e.abrupt("return",e.sent);case 8:if(!n||i.useOverWrite){e.next=10;break}return e.abrupt("return",zt.a.makeDesignDC(n));case 10:if(!S.a.getEditorOpenOption().hasKeyToLoadDesign()){e.next=16;break}return e.next=13,this.getDesignByLauncherOption();case 13:s=e.sent,e.next=19;break;case 16:return e.next=18,this.getUnicornDesign();case 18:s=e.sent;case 19:return e.abrupt("return",zt.a.makeDesignDC(s));case 20:case"end":return e.stop()}},e,this)})),function(e,t,n){return i.apply(this,arguments)})},{key:"getDesignByLauncherOption",value:(n=s()(a.a.mark(function e(){var t,n,i,o,s,r,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=S.a.getEditorOpenOption()).hasValidUnicornTemplateId()){e.next=3;break}return e.abrupt("return",{repositoryType:Do.a.UNICORN,idx:S.a.getEditorOpenOption().getTemplateIdx(),resourceType:Q.a.TEMPLATE,templateTypeId:S.a.getEditorOpenOption().getUnicornTemplateId(),referenceIdxList:S.a.getEditorOpenOption().getTemplateReferenceIdxList()});case 3:if(!(n=t.getBizhowsTemplate())){e.next=22;break}if(!((i=n.designIndex||0)>0)){e.next=22;break}return e.prev=7,o="/api/template/biz-template/${designIdx}".replace("${designIdx}",""+i),e.next=11,ce.b.get(o);case 11:if(!("SUCCESS"===(s=e.sent).resultCode&&s.data.templateIdx>0)){e.next=16;break}return e.abrupt("return",{repositoryType:Do.a.UNICORN,idx:s.data.templateIdx,resourceType:Q.a.TEMPLATE});case 16:0;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7);case 22:return l=t.getDesign(),r=l?{repositoryType:Do.a.UNICORN,idx:l.id,historyIdx:l.revision}:{repositoryType:Do.a.BIZHOWS,code1:0,code2:0,code3:0,copyIdx:n.commodityIndex,pkName:n.id},e.abrupt("return",r);case 25:case"end":return e.stop()}},e,null,[[7,19]])})),function(){return n.apply(this,arguments)})},{key:"getUnicornDesign",value:(t=s()(a.a.mark(function e(){var t,n,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=Number(No.c.get(No.b.TEMPLATE_IDX)))>0)){e.next=5;break}return e.abrupt("return",{idx:t,repositoryType:Do.a.UNICORN,resourceType:Q.a.TEMPLATE,width:Number(No.c.get(No.b.SHEET_W)),height:Number(No.c.get(No.b.SHEET_H)),templateTypeId:No.c.get(No.b.TEMPLATE_TYPE_ID)});case 5:if(n={blank:!0,idx:0,repositoryType:Do.a.UNICORN,resourceType:Q.a.TEMPLATE,width:Number(No.c.get(No.b.SHEET_W)),height:Number(No.c.get(No.b.SHEET_H)),templateTypeId:No.c.get(No.b.TEMPLATE_TYPE_ID),templateReference:new Gt.b},De.a.isValidSize(n.width)||De.a.isValidSize(n.height)||d.b.isEmpty(n.templateTypeId)){e.next=11;break}return e.next=9,rc.a.getTemplateTypeFromRequestParamAsync(an.b.SHEET_SIZE,Ke.a.getUserSetting().devMode,Ke.a.getUserSetting().adminMode);case 9:(i=e.sent)&&(n.width=i.width,n.height=i.height);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)})},{key:"updateOption",value:function(e,t){S.a.getExecutionMode().isMiricanvasChannel()&&!Y.a.instance.option.pageSize&&Y.a.instance.option.initSizeByMeta(e);var n=S.a.getEditorOpenOption().getOutput();if(n&&n.getSize()){var i=n.getSize();Y.a.instance.setDesignSize(new Mo.a(i.getWidth(),i.getHeight(),i.getUnit(),i.getDpi()))}this.updateMetaSheetSize(t,e)}},{key:"updateMetaSheetSize",value:function(e,t){var n=e.designBean;if(n){var i=Mo.a.createFromObject(JSON.parse(n.sizeOption));this.updateMetaSizeOption(t,i,Y.a.instance.option)}else if(e.isTemplateDesign()){var a=Lg.a[S.a.getEditorOpenOption().getObjectFitType()];this.changeSheetSizeBySizeOption(t,Y.a.instance.option.pageSize,a)}}},{key:"updateMetaSizeOption",value:function(e,t,n){t&&!n.equalsSizeOption(t)&&this.changeSheetSizeBySizeOption(e,n.pageSize)}},{key:"changeSheetSizeBySizeOption",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Lg.a.FIT;_g.changeAllPageSheetSizeBySizeOption(e,t,n),Y.a.changeMeta(e)}}]),e}());n.d(t,"EditorStartController",function(){return gg}),function(e){function t(){return(t=s()(a.a.mark(function e(){var t,o,s,r,l,c,u,d,h,p,g,y,T,C,L;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Y.a.STOP_WATCH.start(),t=window.newAPI,e.prev=2,n(t),e.next=6,i(t);case 6:return o=e.sent,s=o.editorConfig,r=o.unicornProfile,l=o.designData,c=o.launcherParameter,u=o.designHistoryExtraData,d=o.designHistoryExtraDataLatest,h=o.designProjectData,e.next=16,f.a.setUser(new v.b(r),!1);case 16:return p=new P(c,l,u,d),e.next=19,wg.getDesignDC(h,l,p);case 19:return g=e.sent,y=null!=h?h.idx:0,T=null!=l?l.idx:0,e.next=23,m.a.updateUserTeamStatus(f.a.getUser().accountId,y,T,Ke.a.getUserSetting().selectedTeamIndex);case 23:return Uo.initEditorOption(s),(C=Uo.option).showPrintOutGuide=S.a.getSettingOption().printoutGuideInitialVisible,Y.a.setUnicornParam({option:C,designDC:g,launcherOption:p}),e.next=29,I.b.loadDesignMeta(g);case 29:return L=e.sent,wg.updateOption(L,g),Y.a.setMetaData(L,new Ig),E.a.report(l),e.next=35,f.a.onLogin(!0);case 35:return e.next=37,Y.a.instance.editorMainVC.setReady();case 37:return e.next=39,k(p);case 39:kg.showPopupsAfterLoading(),kg.showUpdateButtonInfoPusher(S.a.getEditorSaveGuideOption().showUpdateButtonInfoPusher),e.next=46;break;case 43:e.prev=43,e.t0=e.catch(2),A(e.t0);case 46:return X.a.instance.dispatch(new ye),e.next=50,Po.keepAliveSession();case 50:R();case 51:case"end":return e.stop()}},e,null,[[2,43]])}))).apply(this,arguments)}function n(e){h.a.init(e.API_CLIENT),l.d.init({pageUrl:"/myspace"}),u.a.addGlobalListener({beforeOpen:function(){y.a.scrollOff()},beforeClose:function(){y.a.scrollOn()}}),c.a.setSendSignupEvent(!0),f.a.addOnLoginListener(function(){var e=s()(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n||X.a.instance.dispatch(new K.c(function(){var e=s()(a.a.mark(function e(t,n,i){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.leftPanelMainVC.activePanel(So.b.TEMPLATE_LIB),i.onLogin(t,n),i.leftBarVC.onDataChanged(t),i.leftPanelMainVC.renderPanels(t);case 4:case"end":return e.stop()}},e)}));return function(t,n,i){return e.apply(this,arguments)}}(),!1));case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}())}function i(e){return o.apply(this,arguments)}function o(){return(o=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([new Promise(function(){var e=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D.a.fetchAllResourceStylesMap();case 3:return x.a.getAndMapFontFamilyList(),Y.a.STOP_WATCH.split("resource style loaded."),e.next=7,g.a.loadDefaultFont();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:t();case 13:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t){return e.apply(this,arguments)}}()),Uo.fetchData(t)]);case 2:return n=e.sent,e.abrupt("return",n[1]);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function k(e){return L.apply(this,arguments)}function L(){return(L=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b(),T.a.createProgram(),X.a.instance.dispatch(new Ze),X.a.instance.dispatch(new wo),e.next=6,_();case 6:return e.next=8,new Promise(function(e,n){X.a.instance.dispatch(new K.c(function(){var i=s()(a.a.mark(function i(o,s,r){return a.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,o.overWriteDesignIfValid(t.localSaveParameter);case 2:return i.next=4,r.renderAuto(o,s,function(){try{r.onLogin(o,s),vl.a.fetchDesignDocResource().then(function(){t.shouldPrintInspectWhenOpen()&&X.a.instance.dispatch(new se.d)}).catch(function(e){return console.error(e)}),e()}catch(e){n(e)}});case 4:case"end":return i.stop()}},i)}));return function(e,t,n){return i.apply(this,arguments)}}(),!1))});case 8:le.a.get().isLoaded()||X.a.instance.dispatch(new K.c(function(e){N.a.applyPresetToMeta(e)})),Y.a.STOP_WATCH.split("load canvas.");case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _(){return w.apply(this,arguments)}function w(){return(w=s()(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(X.a.instance.dispatch(new oe),t=Y.a.instance.editorMainVC.canvasAreaVC.printout,n=Y.a.instance.launcherOption,!(t&&n.hasOption()&&n.printGuides&&n.printGuides.length)){e.next=6;break}return e.next=6,t.setGuideInfo(n.printGuides);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function b(){window.onbeforeunload=function(){if(Y.a.instance.checkConfirmWhenLeaveEditor&&vl.a.changedDesign)return"변경사항이 저장되지 않을 수 있습니다."},X.a.instance.addActionListener(function(e){C.a.saveAuto(e)}),vi.instance.addEventListener("keydown",function(e){X.a.instance.dispatch(new di(e))}),vi.instance.addEventListener("keyup",function(e){X.a.instance.dispatch(new gi(e))}),vi.instance.addEventListener("paste",function(e){X.a.instance.dispatch(new hi(e))}),vi.instance.addEventListener("drop",function(e){e.preventDefault()}),vi.instance.addEventListener("dragover",function(e){e.preventDefault()});var e="click.".concat(d.b.random()),t="mousedown.".concat(d.b.random()),n="mousedown.".concat(d.b.random());$("body").on("click",".".concat(r.a.BUTTON_TOOL_TAB_TOGGLE),function(i){i.stopPropagation();var a=!this.classList.contains(r.a.ACTIVE);if($(document.body).trigger("click"),!this.classList.contains(r.a.DISABLE)&&a){var o=$(this).next(".".concat(r.a.TOOLS_TAB));if(0===o.length)return;this.classList.add(r.a.ACTIVE);var s=!1;o.on(n,function(e){e.stopPropagation(),s=!0}).attr("tabindex",-1),o[0].focus({preventScroll:!0}),$(document.body).on(t,function(){s=!1}),$(document.body).on(e,function(){s||(y.a.scrollOn(),$(".".concat(r.a.BUTTON_TOOL_TAB_TOGGLE,".").concat(r.a.ACTIVE)).removeClass(r.a.ACTIVE),$(document.body).off(e).off(t),o.off(n))})}}).on("click keydown",".".concat(r.a.TOOLS_TAB),function(e){e.stopPropagation()})}function R(){if(window.s=Y.a.instance,window.designDocDC=vl.a,window.action=X.a.instance,window.store=Y.a.instance,window.ResourceManager=M.b,window.loadedTime=(new Date).getTime(),f.a.getUser().isAdmin()){var e=Y.a.STOP_WATCH.split("complete.").report();window.location.search.indexOf("skaksTmsmsdlatlvkfkalxj")>=0&&setTimeout(function(){return alert(e)},0)}}function A(e){e instanceof p.b||console.log("초기화 하다가 오류",e)}(gg||(gg={})).start=function(){return t.apply(this,arguments)}}()}}]);