(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{248:function(e,t,o){"use strict";o.d(t,"a",function(){return C});var r=o(0),n=o.n(r),a=o(1),s=o.n(a),i=o(6),l=o.n(i),c=o(3),d=o.n(c),h=o(7),u=o.n(h),p=o(8),C=function(e){function t(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return n()(this,t),(e=l()(this,d()(t).call(this,!0,void 0,o))).active=!0,e.container.className=p.a.TOOLS_ITEM,r.forEach(function(t){e.container.classList.add(t.toString().toLowerCase())}),e}return u()(t,e),s()(t,[{key:"addClass",value:function(e){return this.container.classList.add(e),this}},{key:"setDisplay",value:function(e){!0===e?this.show():this.hide()}},{key:"show",value:function(){this.container.style.display=""}},{key:"hide",value:function(){this.container.style.display="none"}}]),t}(o(31).a)},278:function(e,t,o){"use strict";o.d(t,"a",function(){return S});var r=o(0),n=o.n(r),a=o(1),s=o.n(a),i=o(6),l=o.n(i),c=o(3),d=o.n(c),h=o(9),u=o.n(h),p=o(7),C=o.n(p),m=o(248),v=o(8),E=o(445),f=o(10),S=function(e){function t(e,o,r){var a,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return n()(this,t),(a=l()(this,d()(t).call(this,"div",[v.a.COLOR_PICKER_ITEM]))).canNotAppend=!1,a.listener=e,a.icon=o,a.titleKey=r,a.useTransparent=s,a.useChangeSameColors=i,a}return C()(t,e),s()(t,[{key:"onCreateView",value:function(){if(u()(d()(t.prototype),"onCreateView",this).call(this),this.isAccordionItem=null!=this.titleKey,this.colorControl=new E.a(this.listener,this.useTransparent,this.useChangeSameColors),this.isAccordionItem){var e=document.createElement("label");e.innerText=this.titleKey||"",this.container.appendChild(e)}else{var o=document.createElement("div");Object(f.setToolsIcon)(o,this.icon),this.container.appendChild(o)}var r=document.createElement("div");r.className=v.a.VALUE_ELEMENT,this.container.appendChild(r),this.valueBoxOuter=r;var n=document.createElement("div");n.className=v.a.COLOR_ELEMENT,r.appendChild(n),this.valueBoxInner=n,this.addEventListener()}},{key:"updateUI",value:function(e){this.onCreateViewIfNotCreated(),this.enableStyle(e.isMultiColor,this.valueBoxInner,v.a.MULTI_COLOR);var t,o=e.value;t=8===o.length?"00"===o.substr(6,2)?"":"#"+o.substr(0,6):9===o.length&&"#"===o.substr(0,1)?"00"===o.substr(7,2)?"":o.substr(0,7):o,null!=e.active&&(this.active=!0===e.active),this.valueBoxOuter&&this.valueBoxInner&&(this.valueBoxInner.style.backgroundColor=e.isMultiColor?"rgb(0, 0, 0, 0)":t,this.colorControl.updateUI({value:this.valueBoxInner.style.backgroundColor}),this.valueBoxInner.style.backgroundColor?(this.valueBoxOuter.removeAttribute("data-transparent"),this.valueBoxInner.classList.remove(v.a.TRANSPARENT)):(this.valueBoxOuter.setAttribute("data-transparent","true"),this.valueBoxInner.classList.add(v.a.TRANSPARENT)))}},{key:"getColorPickerPopup",value:function(){return this.onCreateViewIfNotCreated(),this.colorControl.getPopup()}},{key:"addEventListener",value:function(){var e=this;$(this.valueBoxOuter).on("mousedown touchstart",function(e){return e.stopPropagation()}).on("click",function(t){if(e.active){var o=e.valueBoxInner.style.backgroundColor,r=$(e.valueBoxOuter).offset(),n=r.left+e.valueBoxOuter.offsetWidth/2,a=r.top+e.valueBoxOuter.offsetHeight/2;e.colorControl.openColorControl({value:o,canNotAppend:e.canNotAppend,isMultiColor:"rgba(0, 0, 0, 0)"===o},n,a)}})}},{key:"setColor",value:function(e){this.updateUI({value:e}),this.listener(e)}}]),t}(m.a)},445:function(e,t,o){"use strict";var r=o(2),n=o.n(r),a=o(4),s=o.n(a),i=o(0),l=o.n(i),c=o(6),d=o.n(c),h=o(3),u=o.n(h),p=o(9),C=o.n(p),m=o(1),v=o.n(m),E=o(7),f=o.n(E),S=o(10),T=o(8),L=o(91),g=o(11),P=o(12),O=o(240),A=o(360),I=o(268),_=o(243),R=o(231),y=o(301),M=o(335),x=o(265),D=o(238),b=o(224),k=function(e){function t(e,o,r){var n;return l()(this,t),(n=d()(this,u()(t).call(this))).actionType=b.a.COMMON_SAME_COLOR_LINK,n.changeDesign=function(){return!0},n.timeout=3e3,n.renderAuto=!0,n.commitAction=function(e,o,r){n.doSaveQueue&&(n.changeItemsColor(n.newColor,o),t.renderAfter(e,o,r))},n.rollbackAction=function(e,o,r){n.changeItemsColor(n.oldColor,o),t.renderAfter(e,o,r)},n.recycle=function(){n.colorSetInfos=null,n.oldColor=null,n.newColor=null},n.colorSetInfos=e,n.oldColor=o,n.newColor=r,n.commitTime=(new Date).getTime(),n.doSaveQueue=o!==r&&n.colorSetInfos.length>0,n}return f()(t,e),v()(t,[{key:"changeItemsColor",value:function(e,o){var r=t.isTransparentColor(e),n=!0,a=!1,s=void 0;try{for(var i,l=function(){var t=i.value,n=t.item;if(n instanceof I.a&&!r){var a=t;a.originColors&&a.originColors.forEach(function(t){n.props.setCurrentOriginColor(t),n.props.setColor(e),n.svgElements.changeColor(t,e)}),a.isSameOutlineColor&&n instanceof M.a&&n.props.isActiveOutline()&&n.props.setOutlineColor(e),a.isSameShadowColor&&n.props.isActiveShadow()&&n.props.setShadowColor(e)}else if(n instanceof D.a){var s=t;if(s.isSameFontColor&&!r){var l=n.props.getCharsOfLines();s.targetSelPosList.forEach(function(t){l[t.row][t.col].color=e})}s.isSameOutlineColor&&!r&&n.props.setOutlineColor(e),s.isSameShadowColor&&!r&&n.props.setShadowColor(e),s.targetGradationPosList.forEach(function(t){return n.props.setGradientColor(t,e)}),(s.isSameFontColor||s.isSameBgColor||s.isSameOutlineColor||s.isSameShadowColor||s.targetGradationPosList.length>0)&&n.props.updateRevision()}else if(n instanceof R.d&&!r){if(n.props.isActiveShadow())t.isSameShadowColor&&n.props.setShadowColor(e)}else if(n instanceof _.a){if(n.select&&n.existSelectedCell()||!n.select){var c=t;c.isSameCellBorderColor&&!r&&n.props.setCellBorderColor(e),c.cellColorInfos.length>0&&n.cells.forEach(function(t,o){t.forEach(function(t,n){var a=c.cellColorInfos.find(function(e){return e.row===o&&e.col===n});a&&(a.bg&&t.cellProps.setCellBackgroundColor(e),r||(a.left&&(t.borders.left.color=e),a.top&&(t.borders.top.color=e),a.right&&(t.borders.right.color=e),a.bottom&&(t.borders.bottom.color=e),a.downDiagonal&&(t.borders.downDiagonal.color=e),a.upDiagonal&&(t.borders.upDiagonal.color=e),a.text&&t.textProps.setColor(e)))})})}}else if(void 0===n&&!r){var d=t;o.pageController.getPageRenderer(d.page).backgroundRenderer.updateColor(e)}},c=this.colorSetInfos[Symbol.iterator]();!(n=(i=c.next()).done);n=!0)l()}catch(e){a=!0,s=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw s}}}}],[{key:"renderAfter",value:function(e,t,o){o.renderItemTools(e,t,!1,!0)}},{key:"isTransparentColor",value:function(e){return 9===e.length&&"00"===e.substr(e.length-2,2)}}]),t}(b.b),w=o(241),N=o(226),U=o(225),B=o(111),F=o(13),H=function e(t){l()(this,e),Object.assign(this,t),this.colors||(this.colors=[])},V=function(e){function t(){return l()(this,t),d()(this,u()(t).apply(this,arguments))}var o,r,a,i;return f()(t,e),v()(t,null,[{key:"addPalette",value:(i=s()(n.a.mark(function e(o){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=H,e.next=3,C()(u()(t),"requestV3",this).call(this,void 0,F.b.POST,"/api/user-palette/",JSON.stringify({name:o}));case 3:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 5:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"fetchUserPalettes",value:(a=s()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C()(u()(t),"requestList",this).call(this,void 0,F.b.GET,"/api/user-palette",void 0,void 0,!0);case 2:return e.t0=function(e){return new H(e)},e.abrupt("return",e.sent.map(e.t0));case 4:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},{key:"updatePalette",value:(r=s()(n.a.mark(function e(o,r,a){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C()(u()(t),"requestV3",this).call(this,void 0,F.b.PUT,"/api/user-palette/".concat(o),JSON.stringify({name:r,colors:a}));case 2:case"end":return e.stop()}},e,this)})),function(e,t,o){return r.apply(this,arguments)})},{key:"deletePalette",value:(o=s()(n.a.mark(function e(o){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C()(u()(t),"requestV3",this).call(this,void 0,F.b.DELETE,"/api/user-palette/".concat(o));case 2:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})}]),t}(F.a),G=new(function(){function e(){var t=this;l()(this,e),this.MAX_PALETTE_COUNT=20,this.colorPaletteMap=new Map,this.onLoginListener=function(e){t.fetchColorPalettes(e)}}var t,o,r,a,i,c;return v()(e,[{key:"addPalette",value:(c=s()(n.a.mark(function e(t){var o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.addPalette(t);case 2:return o=e.sent,this.colorPalettes.unshift(o),e.abrupt("return",o.idx);case 5:case"end":return e.stop()}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"fetchColorPalettes",value:(i=s()(n.a.mark(function e(t){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(P.a.getUser().isLogin()){e.next=3;break}return P.a.addOnLoginListener(this.onLoginListener.bind(this,t)),e.abrupt("return",void 0);case 3:if(this.colorPalettes){e.next=7;break}return e.next=6,V.fetchUserPalettes();case 6:this.colorPalettes=e.sent;case 7:t.onResultUserColorPalettes(this.colorPalettes);case 8:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"getPalette",value:function(e){return this.colorPalettes.find(function(t){return t.idx===e})}},{key:"getPaletteCount",value:function(){return this.colorPalettes.length}},{key:"updatePalette",value:(a=s()(n.a.mark(function e(t){var o,r,a=arguments;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.length>1&&void 0!==a[1]?a[1]:this.getPalette(t).name,(r=a.length>2&&void 0!==a[2]?a[2]:this.getPalette(t).colors).forEach(function(e){0===e.indexOf("#")||alert("잘못된 컬러가 포함되어있습니다.\n\n                palette idx: ".concat(t,"\n\n                palette name: ").concat(o,"\n\n                color: ").concat(e,"\n\n                whole colors: ").concat(r))}),this.getPalette(t).name=o,this.getPalette(t).colors=r,e.next=7,V.updatePalette(t,o,r);case 7:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"deletePalette",value:(r=s()(n.a.mark(function e(t){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.colorPaletteMap.delete(t),e.next=3,V.deletePalette(t);case 3:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"addColor",value:(o=s()(n.a.mark(function e(t,o){var r,a,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getPalette(t),a=r.colors,(s=a.indexOf(o))<0?a.unshift(o):(a.splice(s,1),a.unshift(o)),e.next=6,this.updatePalette(t,r.name,a);case 6:case"end":return e.stop()}},e,this)})),function(e,t){return o.apply(this,arguments)})},{key:"removeColors",value:(t=s()(n.a.mark(function e(t,o){var r,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getPalette(t),a=r.colors,o.forEach(function(e){var t=a.indexOf(e);t>=0&&a.splice(t,1)}),e.next=5,this.updatePalette(t,r.name,a);case 5:case"end":return e.stop()}},e,this)})),function(e,o){return t.apply(this,arguments)})}]),e}()),W=o(248),Y=o(90),X=o(84),j=o(67);o.d(t,"a",function(){return Q});var K,z,Q=function(e){function t(e){var o,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return l()(this,t),(o=d()(this,u()(t).call(this,"div",[T.a.COLOR_CONTROL_ITEM]))).moveColorSpectrumSelector=!1,o.moveColorBarSelector=!1,o.usedColors=new Set,o.sameColorSetInfos=[],o.numOfSelectedColors=0,o.backupColorSetInfos=[],o.isContinuousSameColorChange=!1,o.spoidDownHandler=function(e){e.stopPropagation(),o.endSpoidMode(o.spoidColor)},o.keyDownHandler=function(e){27===e.keyCode&&(N.a.isSpoidMode()?o.endSpoidMode():o.colorControlPopup.parentElement&&o.closeColorControl())},o.resizeHandler=function(){j.a.isMobileDevice()?(j.a.isMobilePortraitSize()?o.appendHexAreaTo(o.headerRight):o.appendHexAreaTo(o.statusRight),o.currMode===K.DIRECT_MODE&&o.initColorSelectAreaUI()):o.closeColorControl()},o.mouseDownHandler=function(e){N.a.isSpoidMode()&&(e.stopPropagation(),o.endSpoidMode())},o.colorBarDownHandler=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&e.preventDefault(),o.onStartChangeColor&&o.onStartChangeColor();var r=t?e.touches[0]:e;o.setColorBarPoint(r),o.moveColorBarSelector=!0},o.colorSpectrumDownHandler=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&e.preventDefault(),o.onStartChangeColor&&o.onStartChangeColor();var r=t?e.touches[0]:e;o.setColorSpectrumPoint(r),o.moveColorSpectrumSelector=!0},o.colorSelectorsMoveHandler=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t?e.touches[0]:e;o.moveColorBarSelector&&o.setColorBarPoint(r),o.moveColorSpectrumSelector&&o.setColorSpectrumPoint(r)},o.colorSelectorsUpHandler=function(){o.moveColorSpectrumSelector=!1,o.moveColorBarSelector=!1,o.onFinishChangeColor&&o.onFinishChangeColor()},o.listener=e,o.useTransparent=r,o.useChangeSameColors=n,o.onStartChangeColor=a,o.onFinishChangeColor=s,o.container.tabIndex=-1,o}var o;return f()(t,e),v()(t,[{key:"getPopup",value:function(){return this.onCreateViewIfNotCreated(),this.colorControlPopup}}]),v()(t,[{key:"onCreateView",value:function(){C()(u()(t.prototype),"onCreateView",this).call(this),this.makeColorContainer(),this.addEventListener()}},{key:"appendHexAreaTo",value:function(e){if(e){this.hexArea||(this.hexArea=this.makeHexArea());var t=this.hexArea.parentElement;if(t){if(t===e)return;t.removeChild(this.hexArea)}e.appendChild(this.hexArea)}}},{key:"makePaletteSet",value:function(e){var t=this;if(!e)return null;var o=document.createElement("div");if(o.classList.add(T.a.PALETTE_SET),e.name){var r=document.createElement("div");r.classList.add(T.a.PALETTE_HEADER),o.appendChild(r);var n=document.createElement("div");if(n.classList.add(T.a.PALETTE_NAME),n.innerText=e.name,r.appendChild(n),e.idx&&(e.canAddColor||e.canDeleteColor))Object(S.setToolsIcon)(r,S.ToolsIcon.GREATER_THAN,!0).addEventListener("click",function(){t.selectedPaletteSet=o,t.selectedPaletteIdx=e.idx,t.setCustomMode()})}if(e.containsTransparent){var a=document.createElement("div");a.classList.add(T.a.PALETTE,T.a.TRANSPARENT_PALETTE),o.appendChild(a);var s=document.createElement("div");s.classList.add(T.a.COLOR_CHIP,T.a.TRANSPARENT_CHIP),a.appendChild(s);var i=document.createElement("div");i.classList.add(T.a.TRANSPARENT_TEXT),i.innerText=z.TRANSPARENT,a.appendChild(i);var l=document.createElement("div");l.classList.add(T.a.TRANSPARENT_AREA),a.appendChild(l),$([s,l]).on("click",function(){t.setColor("#00000000")})}var c=document.createElement("div");if(c.classList.add(T.a.PALETTE),o.appendChild(c),e.canAddColor){var d=document.createElement("div");d.classList.add(T.a.COLOR_CHIP,T.a.ADD_COLOR),c.appendChild(d),Object(S.setToolsIcon)(d,S.ToolsIcon.ADD),d.addEventListener("click",function(){if(t.currMode!==K.EDIT_MODE&&(t.setDirectMode(),t.initColorSelectAreaUI(),t.prevMode===K.CUSTOM_MODE&&(t.currColor&&t.isTransparent(t.currColor)||!t.currColor&&t.prevColor&&t.isTransparent(t.prevColor)))){t.updateColorDisplayUI("#000000FF"),t.updateHexAreaUI({value:"#000000FF"})}})}return e.colors.forEach(function(o){var r=document.createElement("div");r.classList.add(T.a.COLOR_CHIP),r.setAttribute("style","background-color:"+o.substr(0,7)),r.addEventListener("click",function(){t.currMode===K.EDIT_MODE?(r.classList.contains(T.a.ACTIVE)?(r.classList.remove(T.a.ACTIVE),t.numOfSelectedColors-=1):(r.classList.add(T.a.ACTIVE),t.numOfSelectedColors+=1),t.txtNumberToDelete.innerText="".concat(t.numOfSelectedColors),t.numOfSelectedColors<=0?t.container.classList.remove(T.a.ACTIVE):t.container.classList.add(T.a.ACTIVE)):t.setColor(o)}),c.appendChild(r),e.canDeleteColor&&Object(S.setToolsIcon)(r,S.ToolsIcon.CHECK)}),o}},{key:"makeHeader",value:function(){this.header=document.createElement("div"),this.header.classList.add(T.a.COLOR_CONTROL_HEADER),this.container.appendChild(this.header);var e=document.createElement("span");this.header.appendChild(e),this.headerRight=document.createElement("span"),this.header.appendChild(this.headerRight),this.txtTitle=document.createElement("span"),this.txtTitle.classList.add(T.a.COLOR_CONTROL_TITLE),e.appendChild(this.txtTitle),j.a.isMobilePortraitSize()&&(this.hexArea=this.makeHexArea(),this.headerRight.appendChild(this.hexArea)),this.txtNumberToDelete=document.createElement("span"),this.txtNumberToDelete.classList.add(T.a.COLOR_CONTROL_NUMBER_TO_DELTE),this.headerRight.appendChild(this.txtNumberToDelete),this.txtQuantityToDelete=document.createElement("span"),this.txtQuantityToDelete.classList.add(T.a.COLOR_CONTROL_QUANTITY_TO_DELETE),this.headerRight.appendChild(this.txtQuantityToDelete),this.btnBack=Object(S.setToolsIcon)(e,S.ToolsIcon.GREATER_THAN),this.btnBack.classList.add(T.a.COLOR_CONTROL_BACK),this.btnMore=Object(S.setToolsIcon)(this.headerRight,S.ToolsIcon.MORE_VERT),this.btnMore.classList.add(T.a.COLOR_CONTROL_MORE),this.btnClose=Object(S.setToolsIcon)(this.headerRight,S.ToolsIcon.CLOSE),this.btnClose.classList.add(T.a.COLOR_CONTROL_CLOSE)}},{key:"makeBody",value:function(){this.body=document.createElement("div"),this.body.classList.add(T.a.COLOR_CONTROL_BODY),this.container.appendChild(this.body);var e=this.makeScrollElement();this.body.appendChild(e);var o=e.getElementsByClassName(T.a.SCROLL_CONTENT)[0];this.paletteWrapper=document.createElement("div"),this.paletteWrapper.classList.add(T.a.PALETTE_WRAPPER),o.appendChild(this.paletteWrapper),this.usedColorsArea=document.createElement("div"),this.usedColorsArea.classList.add(T.a.USED_COLORS_AREA),this.paletteWrapper.appendChild(this.usedColorsArea),this.basicPaletteArea=document.createElement("div"),this.basicPaletteArea.classList.add(T.a.BASIC_PALETTE_AREA),this.paletteWrapper.appendChild(this.basicPaletteArea);var r=this.makePaletteSet({name:z.BASIC_PALETTE,containsTransparent:this.useTransparent,colors:t.BASE_COLOR_CHART});this.basicPaletteArea.appendChild(r),this.userPaletteArea=document.createElement("div"),this.userPaletteArea.classList.add(T.a.USER_PALETTE_AREA),this.paletteWrapper.appendChild(this.userPaletteArea),this.pickerWrapper=document.createElement("div"),this.pickerWrapper.classList.add(T.a.PICKER_WRAPPER),o.appendChild(this.pickerWrapper),this.colorSelectArea=this.makeColorSelectArea(),this.pickerWrapper.appendChild(this.colorSelectArea),this.userPaletteWrapper=document.createElement("div"),this.userPaletteWrapper.classList.add(T.a.USER_PALETTE_WRAPPER),o.appendChild(this.userPaletteWrapper)}},{key:"makeFooter",value:function(){var e=this;this.footer=document.createElement("div"),this.footer.classList.add(T.a.COLOR_CONTROL_FOOTER),this.container.appendChild(this.footer);var o=this.makeColorStatus();this.footer.appendChild(o);var r=document.createElement("div");r.classList.add(T.a.DELETE_COLOR_BUTTONS),this.footer.appendChild(r);var n=document.createElement("span");n.classList.add(T.a.CANCEL_TO_DELETE),n.innerText=z.CANCEL,r.appendChild(n),n.addEventListener("click",function(){Array.from(e.selectedPaletteSet.getElementsByClassName(T.a.COLOR_CHIP)).forEach(function(e){e.classList.remove(T.a.ACTIVE)}),e.numOfSelectedColors=0,e.container.classList.remove(T.a.ACTIVE),e.setCustomMode()});var a=document.createElement("span");a.classList.add(T.a.COMPLETE_TO_DELETE),a.innerText=z.COMPLETE,r.appendChild(a),a.addEventListener("click",function(){if(!(e.numOfSelectedColors<=0)){var o=[];Array.from(e.userPaletteWrapper.getElementsByClassName(T.a.COLOR_CHIP)).forEach(function(t){if(t.classList.contains(T.a.ACTIVE)){var r=e.toHexString(t.style.backgroundColor).substr(0,7);o.push(r)}}),G.removeColors(e.selectedPaletteIdx,o).then(function(){e.updateSelectedUserPalette()}).catch(function(){alert(t.ERROR_MSG)}),e.numOfSelectedColors=0,e.container.classList.remove(T.a.ACTIVE),e.setCustomMode()}})}},{key:"setDefaultMode",value:function(){this.onCreateViewIfNotCreated(),this.prevMode=this.currMode,this.currMode=K.DEFAULT_MODE,this.container.classList.add(T.a.DEFAULT_MODE),this.container.classList.remove(T.a.DIRECT_MODE),this.container.classList.remove(T.a.CUSTOM_MODE),this.container.classList.remove(T.a.EDIT_MODE),this.txtTitle.innerText=z.COLOR}},{key:"setDirectMode",value:function(){this.prevMode=this.currMode,this.currMode=K.DIRECT_MODE,this.container.classList.remove(T.a.DEFAULT_MODE),this.container.classList.add(T.a.DIRECT_MODE),this.container.classList.remove(T.a.CUSTOM_MODE),this.container.classList.remove(T.a.EDIT_MODE),this.txtTitle.innerText=z.SET_DIRECTLY}},{key:"setCustomMode",value:function(){this.selectedPaletteSet.classList.add(T.a.ACTIVE);var e=this.selectedPaletteSet.getElementsByClassName(T.a.PALETTE_NAME)[0].innerText;this.txtTitle.innerText=e,this.prevMode=this.currMode,this.currMode=K.CUSTOM_MODE,this.container.classList.remove(T.a.DEFAULT_MODE),this.container.classList.remove(T.a.DIRECT_MODE),this.container.classList.add(T.a.CUSTOM_MODE),this.container.classList.remove(T.a.EDIT_MODE),this.updateUserPaletteWrapperUI()}},{key:"setEditMode",value:function(){this.prevMode=this.currMode,this.currMode=K.EDIT_MODE,this.container.classList.remove(T.a.DEFAULT_MODE),this.container.classList.remove(T.a.DIRECT_MODE),this.container.classList.remove(T.a.CUSTOM_MODE),this.container.classList.add(T.a.EDIT_MODE),this.txtTitle.innerText=z.SELECT_COLORS_TO_DELETE,this.txtNumberToDelete.innerText="".concat(this.numOfSelectedColors),this.txtQuantityToDelete.innerText=z.QUANTITY}},{key:"makeColorContainer",value:function(){this.colorControlPopup=document.createElement("div"),this.colorControlPopup.classList.add(T.a.COLOR_CONTROL_POPUP),this.makeHeader(),this.makeBody(),this.makeFooter()}},{key:"isTransparent",value:function(e){return!e||9===e.length&&"00"===e.substr(e.length-2,2)}},{key:"toHexString",value:function(e){if(void 0===e)return null;if("#"===e.substr(0,1))return 9===e.length?e.toUpperCase():7===e.length?"".concat(e,"FF").toUpperCase():4===e.length?"".concat(e[0]).concat(e[1]).concat(e[1]).concat(e[2]).concat(e[2]).concat(e[3]).concat(e[3],"FF").toUpperCase():null;if("rgba"===e.substr(0,4)){var t=/(.*?)rgba\((\d+), (\d+), (\d+), (\d+)\)/.exec(e),o=parseInt(t[2]),r=parseInt(t[3]),n=parseInt(t[4]),a=255*parseInt(t[5])|n<<8|r<<16|o<<24;return t[1]+"#".concat(g.b.padStart(a.toString(16),8,"0").toUpperCase())}if("rgb"===e.substr(0,3)){var s=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(e),i=parseInt(s[2]),l=parseInt(s[3]),c=parseInt(s[4])|l<<8|i<<16;return s[1]+"#".concat(g.b.padStart(c.toString(16),6,"0").toUpperCase(),"FF")}return 8===e.length?"#".concat(e):6===e.length?"#".concat(e,"FF"):0===e.length||"transparent"===e||"none"===e?"#00000000":null}},{key:"setColorToSpectrumRGB",value:function(){var e=this.getSelectedRGB();this.setColor("rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")"))}},{key:"setColorSpectrumPoint",value:function(e){var t=this.colorSpectrumSelector.offsetWidth/2,o=this.colorSpectrum.offsetWidth;o?o+=2-2*t:o=240;var r,n,a=this.colorSpectrum.offsetHeight;if(a?a+=2-2*t:a=184,e?((r=e.clientX-this.colorSpectrumLeft-t)<0?r=0:r>o&&(r=o),(n=e.clientY-this.colorSpectrumTop-t)<0?n=0:n>a&&(n=a)):(r=o,n=0),this.colorSpectrumXRatio=r/o,this.colorSpectrumYRatio=n/a,this.colorSpectrumSelector.style.left="".concat((r+this.colorSpectrum.offsetLeft).toString(),"px"),this.colorSpectrumSelector.style.top="".concat((n+this.colorSpectrum.offsetTop).toString(),"px"),e)if(this.prevMode===K.DEFAULT_MODE)this.setColorToSpectrumRGB();else{var s=this.getSelectedRGB(),i=this.toHexString("rgb(".concat(s.r,", ").concat(s.g,", ").concat(s.b,")"));this.updateColorDisplayUI(i),this.updateHexAreaUI({value:i})}}},{key:"updateColorBarPoint",value:function(e){var t,o=[(t={r:e.r,g:e.g,b:e.b}).r,t.g,t.b].sort(function(e,t){return e-t}),r=-1;o[2]-o[0]>0&&(r=Math.round(255*(o[1]-o[0])/(o[2]-o[0]))),t.r=t.r===o[2]?255:t.r===o[0]?0:r,t.g=r>=0&&t.g===o[2]?255:t.g===o[0]?0:r,t.b=r>=0&&t.b===o[2]?255:t.b===o[0]?0:r;var n=this.findColorBarPoint(t);this.colorBarSelector.style.left="".concat((n+this.colorBar.offsetLeft).toString(),"px"),this.colorBarSelector.style.top="".concat(this.colorBar.offsetTop.toString(),"px"),this.updateColorSpectrumUI(t.r,t.g,t.b),this.colorBarColor={r:t.r,g:t.g,b:t.b}}},{key:"updateColorSpectrumPoint",value:function(e){var t=this.colorSpectrumSelector.offsetWidth/2,o=this.colorSpectrum.offsetWidth-2*t+2,r=this.colorSpectrum.offsetHeight-2*t+2,n=Math.max(e.r,e.g,e.b),a=Math.min(e.r,e.g,e.b),s=X.a.getValidNumber(o-(0===n?0:a/n)*o,0,o),i=X.a.getValidNumber(r-n/255*r,0,r);this.colorSpectrumXRatio=s/o,this.colorSpectrumYRatio=i/r,this.colorSpectrumSelector.style.left="".concat((s+this.colorSpectrum.offsetLeft).toString(),"px"),this.colorSpectrumSelector.style.top="".concat((i+this.colorSpectrum.offsetTop).toString(),"px")}},{key:"findColorBarPoint",value:function(e){var t,o,r=this.colorBarSelector.offsetWidth/2,n=this.colorBar.offsetWidth-2*r,a=n/6;255===e.r?e.g<e.b?(t=5,o=255-e.b):(t=0,o=e.g):255===e.g?e.r<e.b?(t=2,o=e.b):(t=1,o=255-e.r):255===e.b?e.r<e.g?(t=3,o=255-e.g):(t=4,o=e.r):(t=0,o=0);var s=t*a+o/255*a;return X.a.getValidNumber(s,0,n)}},{key:"setColorBarPoint",value:function(e){var o,r=this.colorBarSelector.offsetWidth/2,n=this.colorBar.offsetWidth;n?n-=2*r:n=240,e?(o=e.clientX-this.colorBarLeft-r)<0?o=0:o>n&&(o=n):o=0;var a=n/6,s=Math.floor(o/a),i=o/a-s,l=t.COLOR_BAR_POINTS[s%6].r+Math.round((t.COLOR_BAR_POINTS[(s+1)%6].r-t.COLOR_BAR_POINTS[s%6].r)*i),c=t.COLOR_BAR_POINTS[s%6].g+Math.round((t.COLOR_BAR_POINTS[(s+1)%6].g-t.COLOR_BAR_POINTS[s%6].g)*i),d=t.COLOR_BAR_POINTS[s%6].b+Math.round((t.COLOR_BAR_POINTS[(s+1)%6].b-t.COLOR_BAR_POINTS[s%6].b)*i);if(this.colorBarSelector.style.left="".concat((o+this.colorBar.offsetLeft).toString(),"px"),this.colorBarSelector.style.top="".concat(this.colorBar.offsetTop.toString(),"px"),this.updateColorSpectrumUI(l,c,d),this.colorBarColor={r:l,g:c,b:d},e)if(this.prevMode===K.DEFAULT_MODE)this.setColorToSpectrumRGB();else{var h=this.getSelectedRGB(),u=this.toHexString("rgb(".concat(h.r,", ").concat(h.g,", ").concat(h.b,")"));this.updateColorDisplayUI(u),this.updateHexAreaUI({value:u})}}},{key:"getSelectedRGB",value:function(){return isNaN(this.colorSpectrumXRatio)&&(this.colorSpectrumXRatio=0),isNaN(this.colorSpectrumYRatio)&&(this.colorSpectrumYRatio=0),{r:Math.round((255+(this.colorBarColor.r-255)*this.colorSpectrumXRatio)*(1-this.colorSpectrumYRatio)),g:Math.round((255+(this.colorBarColor.g-255)*this.colorSpectrumXRatio)*(1-this.colorSpectrumYRatio)),b:Math.round((255+(this.colorBarColor.b-255)*this.colorSpectrumXRatio)*(1-this.colorSpectrumYRatio))}}},{key:"makeScrollElement",value:function(){var e=this,t=document.createElement("div");t.classList.add(T.a.SCROLL_WRAP),this.scrollContent=document.createElement("div"),this.scrollContent.classList.add(T.a.SCROLL_CONTENT),t.appendChild(this.scrollContent);var o=document.createElement("div");o.classList.add(T.a.SCROLL_BAR_WRAP),t.appendChild(o),this.scrollBar=document.createElement("div"),this.scrollBar.classList.add(T.a.SCROLL_BAR),o.appendChild(this.scrollBar),this.scrollContent.addEventListener("scroll",function(){var t=e.scrollContent.clientHeight/e.scrollContent.scrollHeight,o=e.scrollContent.clientHeight*(1-t),r=e.scrollContent.scrollTop/(e.scrollContent.scrollHeight-e.scrollContent.clientHeight);e.scrollBar.style.transform="translateY(".concat(o*r,"px)")});var r=0,n=function(t){var o=t.clientY-r;r=t.clientY,e.moveScrollY(o)},a=function e(){document.removeEventListener("mouseup",e),document.removeEventListener("mousemove",n)};return this.scrollBar.addEventListener("mousedown",function(e){document.addEventListener("mouseup",a),document.addEventListener("mousemove",n),r=e.clientY}),t}},{key:"initColorSelectAreaUI",value:function(){var e=this.colorBar.width,o=this.colorBar.height,r=this.colorBar.getContext("2d"),n=r.createLinearGradient(0,0,e,0);n.addColorStop(0,"#ff0000"),n.addColorStop(.166,"#ffff00"),n.addColorStop(.333,"#00ff00"),n.addColorStop(.5,"#00ffff"),n.addColorStop(.666,"#0000ff"),n.addColorStop(.834,"#ff00ff"),n.addColorStop(1,"#ff0000"),r.fillStyle=n,r.fillRect(0,0,e,o),this.colorBarLeft=$(this.colorBar).offset().left;var a=$(this.colorSpectrum).offset();this.colorSpectrumLeft=a.left,this.colorSpectrumTop=a.top,this.currColor&&t.hexToRgb(this.currColor)?this.updateColorSelectAreaUI(this.currColor,!0):this.prevColor&&t.hexToRgb(this.prevColor)?this.updateColorSelectAreaUI(this.prevColor,!0):(this.setColorBarPoint(),this.setColorSpectrumPoint())}},{key:"addEventListenerColorControlUI",value:function(){var e=this.colorSpectrum,t=this.colorSpectrumSelector,o=this.colorBar,r=this.colorBarSelector,n="mousemove touchmove",a="mouseup touchend";$([e,t]).on("mousedown touchstart",function(o){!function(o){N.a.instance.mouseAction.mode=w.a.MODE_DOWN_CHANGE_VALUE,s.colorSpectrumDownHandler(o,"touchstart"===o.type),$([e,t]).on(n,i),$([e,t]).on(a,c),$(t).on(a,s.colorSelectorsUpHandler),$(document.body).on(a,c)}(o)}),$([o,r]).on("mousedown touchstart",function(e){!function(e){N.a.instance.mouseAction.mode=w.a.MODE_DOWN_CHANGE_VALUE,s.colorBarDownHandler(e,"touchstart"===e.type),$([o,r]).on(n,l),$([o,r]).on(a,c),$(r).on(a,s.colorSelectorsUpHandler),$(document.body).on(a,c)}(e)});var s=this;function i(e){N.a.instance.mouseAction.mode=w.a.MODE_MOVE_CHANGE_VALUE,s.colorSpectrumDownHandler(e,"touchmove"===e.type)}function l(e){N.a.instance.mouseAction.mode=w.a.MODE_MOVE_CHANGE_VALUE,s.colorBarDownHandler(e,"touchmove"===e.type)}function c(){N.a.instance.mouseAction.mode=w.a.MODE_NONE,$([e,t,o,r]).off("mousemove touchmove mouseup touchend"),$(document.body).off(a,c)}}},{key:"makeColorSelectArea",value:function(){this.moveColorSpectrumSelector=!1,this.moveColorBarSelector=!1;var e=document.createElement("div"),t=this.colorSpectrum=document.createElement("div");t.classList.add(T.a.COLOR_SPECTRUM),e.appendChild(t);var o=document.createElement("div");o.classList.add(T.a.WHITE_SPECTRUM),this.colorSpectrum.appendChild(o);var r=document.createElement("div");r.classList.add(T.a.BLACK_SPECTRUM),o.appendChild(r);var n=document.createElement("div");n.classList.add(T.a.BORDER_SPECTRUM),r.appendChild(n);var a=this.colorSpectrumSelector=document.createElement("div");a.classList.add(T.a.COLOR_SELECTOR),a.classList.add(T.a.COLOR_SPECTRUM_SELECTOR),e.appendChild(a);var s=this.colorBar=document.createElement("canvas");s.classList.add(T.a.COLOR_BAR),e.appendChild(s);var i=this.colorBarSelector=document.createElement("div");return i.classList.add(T.a.COLOR_SELECTOR),i.classList.add(T.a.COLOR_BAR_SELECTOR),e.appendChild(i),this.addEventListenerColorControlUI(),e}},{key:"makeColorStatus",value:function(){var e=this,t=document.createElement("div");return t.classList.add(T.a.COLOR_STATUS),this.colorDisplay=document.createElement("span"),this.colorDisplay.classList.add(T.a.COLOR_DISPLAY),t.appendChild(this.colorDisplay),this.prevColorChip=document.createElement("span"),this.prevColorChip.classList.add(T.a.COLOR_CHIP),this.colorDisplay.appendChild(this.prevColorChip),this.prevColorChip.addEventListener("click",function(){var t=e.toHexString(e.prevColorChip.style.backgroundColor);e.prevMode===K.CUSTOM_MODE&&e.currMode===K.DIRECT_MODE?e.isTransparent(t)||(e.updateColorSelectAreaUI(t),e.updateColorDisplayUI(t),e.updateHexAreaUI({value:t})):e.setColor(t)}),this.statusRight=document.createElement("span"),t.appendChild(this.statusRight),j.a.isMobileDevice()||(this.spoidMode=Object(S.setToolsIcon)(this.statusRight,S.ToolsIcon.EYEDROPPER,!0)),j.a.isMobilePortraitSize()||(this.hexArea=this.makeHexArea(),this.statusRight.appendChild(this.hexArea)),t}},{key:"makeHexArea",value:function(){var e=this,o=document.createElement("span");return o.classList.add(T.a.HEX_AREA),this.hexChip=document.createElement("span"),this.hexChip.classList.add(T.a.COLOR_CHIP),o.appendChild(this.hexChip),this.hexInput=document.createElement("input"),this.hexInput.type="text",this.hexInput.classList.add(T.a.HEX_INPUT),o.appendChild(this.hexInput),this.hexInput.addEventListener("keypress",function(t){var o=e.hexInput.value.length;if(13===t.keyCode&&o>1&&o<8){var r=e.hexInput.value,n=r[1];if(4===o&&n===r[2]&&n===r[3])r=r+n+n+n;else for(var a=0;a<7-o;a++)r+="0";var s=r.toUpperCase();e.prevMode!==K.CUSTOM_MODE||e.currMode!==K.DIRECT_MODE?e.setColor(s):(e.updateHexAreaUI({value:r}),e.updateColorSelectAreaUI(s),e.updateColorDisplayUI(s)),e.hexInput.value=s,e.hexInput.blur()}}),this.hexInput.addEventListener("input",function(){var o="#",r=/[0-9a-f]/i,n=!0,a=!1,s=void 0;try{for(var i,l=e.hexInput.value[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var c=i.value;if(r.test(c)?o+=c:t.KEY_MAP.has(c)&&(o+=t.KEY_MAP.get(c)),7===o.length){(o=o.toUpperCase())!==e.currColor&&(e.prevMode!==K.CUSTOM_MODE||e.currMode!==K.DIRECT_MODE?e.setColor(o):(e.updateHexAreaUI({value:o}),e.updateColorSelectAreaUI(o),e.updateColorDisplayUI(o)));break}}}catch(e){a=!0,s=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw s}}e.hexInput.value=o}),o}},{key:"openPaletteMenu",value:function(){var e=this;if(!this.paletteMenu){this.paletteMenu=document.createElement("div"),this.paletteMenu.classList.add(T.a.PALETTE_MENU),this.btnMore.appendChild(this.paletteMenu),this.paletteMenu.addEventListener("click",function(e){e.stopPropagation()});var o=document.createElement("div");o.className="palette_menu_wrap",this.paletteMenu.appendChild(o);var r=document.createElement("div");o.appendChild(r);var n=document.createElement("div");r.appendChild(n),Object(S.setToolsIcon)(n,S.ToolsIcon.ADD);var a=document.createElement("span");a.innerText=z.ADD_COLOR,n.appendChild(a),n.addEventListener("click",function(){if(e.closePaletteMenu(),e.setDirectMode(),e.initColorSelectAreaUI(),e.prevMode===K.CUSTOM_MODE&&(e.currColor&&e.isTransparent(e.currColor)||!e.currColor&&e.prevColor&&e.isTransparent(e.prevColor))){e.updateColorDisplayUI("#000000FF"),e.updateHexAreaUI({value:"#000000FF"})}});var s=document.createElement("div");r.appendChild(s),Object(S.setToolsIcon)(s,S.ToolsIcon.BAR);var i=document.createElement("span");i.innerText=z.DELETE_COLOR,s.appendChild(i),s.addEventListener("click",function(){e.closePaletteMenu(),e.setEditMode()});var l=document.createElement("div");o.appendChild(l);var c=document.createElement("div");l.appendChild(c),Object(S.setToolsIcon)(c,S.ToolsIcon.PENCIL);var d=document.createElement("span");d.innerText=z.EDIT_PALETTE_NAME,c.appendChild(d),c.addEventListener("click",function(){e.closePaletteMenu(),e.openPalettePopup(function(o){G.updatePalette(o.idx,o.value).then(function(){e.closePalettePopup(),e.updateSelectedUserPalette()}).catch(function(){e.closePalettePopup(),alert(t.ERROR_MSG)})},z.TO_EDIT_PALETTE_NAME,e.selectedPaletteIdx,z.CONFIRM,null,e.txtTitle.innerText)});var h=document.createElement("div");l.appendChild(h),Object(S.setToolsIcon)(h,S.ToolsIcon.DELETE);var u=document.createElement("span");u.innerText=z.DELETE_PALETTE,h.appendChild(u),h.addEventListener("click",function(){e.closePaletteMenu(),e.openPalettePopup(function(o){G.deletePalette(o.idx).then(function(){e.closePalettePopup(),e.selectedPaletteSet.parentElement.removeChild(e.selectedPaletteSet),e.selectedPaletteSet=null,e.selectedPaletteIdx=null,e.setDefaultMode()}).catch(function(){e.closePalettePopup(),alert(t.ERROR_MSG)})},z.TO_DELETE_PALETTE,e.selectedPaletteIdx,z.DELETE,T.a.PALETTE_POPUP_DELETE,null,z.ASK_AGAIN_BEFORE_DELETE)})}this.btnMore.classList.add(T.a.ACTIVE)}},{key:"closePaletteMenu",value:function(){this.btnMore&&this.btnMore.classList.remove(T.a.ACTIVE)}},{key:"updateSelectedUserPalette",value:function(){if(this.selectedPaletteIdx&&this.selectedPaletteSet){var e,t=G.getPalette(this.selectedPaletteIdx);this.currMode===K.DEFAULT_MODE?(e=this.makePaletteSet({name:t.name,idx:t.idx,colors:t.colors,canAddColor:!0,canDeleteColor:!0}),this.selectedPaletteSet.after(e),this.selectedPaletteSet.parentElement.removeChild(this.selectedPaletteSet),this.selectedPaletteSet=e):this.currMode===K.CUSTOM_MODE&&(this.selectedPaletteSet.classList.add(T.a.ACTIVE),this.txtTitle.innerText=t.name,this.updateUserPaletteWrapperUI())}}},{key:"updateColorSelectAreaUI",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.hexToRgb(e);(o||0!==this.colorSpectrumSelector.offsetWidth&&!this.isSameSelectedColor(r))&&(this.updateColorBarPoint(r),this.updateColorSpectrumPoint(r))}},{key:"isSameSelectedColor",value:function(e){if(this.colorBarColor){var t=this.getSelectedRGB();return t.r===e.r&&t.g===e.g&&t.b===e.b}return!1}},{key:"updateColorSpectrumUI",value:function(e,t,o){this.colorSpectrum.style.background="rgb(".concat(e,", ").concat(t,", ").concat(o,")")}},{key:"addToUsedColors",value:function(e){var t=this;e.forEach(function(e){var o=t.toHexString(e);t.isTransparent(o)||t.usedColors.add(o)})}},{key:"updateScrollBarUI",value:function(){var e=this.scrollContent.clientHeight/this.scrollContent.scrollHeight;this.scrollBar.style.height="".concat(1===e?0:100*e,"%")}},{key:"openPalettePopup",value:function(e,t,o,r,n,a,s){var i,l,c,d,h=this,u=this.palettePopup=document.createElement("div");u.classList.add(T.a.PALETTE_POPUP),this.palettePopup.addEventListener("keydown",function(e){e.stopPropagation()}),(i=document.createElement("div")).classList.add(T.a.PALETTE_POPUP_LAYER),u.appendChild(i),l=Object(S.setToolsIcon)(i,S.ToolsIcon.CLOSE,!0),i.appendChild(l),l.addEventListener("click",function(){return h.closePalettePopup()}),(c=document.createElement("div")).classList.add(T.a.PALETTE_POPUP_TITLE),i.appendChild(c),c.innerText=t;var p=i.getElementsByClassName("paletteInputEmpty")[0];null!=a?p||((p=document.createElement("div")).classList.add("paletteInputEmpty"),i.appendChild(p),p.innerText=z.INPUT_NAME):p&&p.parentElement.removeChild(p);var C=i.getElementsByClassName(T.a.PALETTE_POPUP_INPUT)[0];null!=a?(C||((C=document.createElement("input")).type="text",C.classList.add(T.a.PALETTE_POPUP_INPUT),p?i.insertBefore(C,p):i.appendChild(C),C.addEventListener("keyup",function(){0===C.value.trim().length?(C.classList.add("accentInput"),p.classList.remove("hidden")):(C.classList.remove("accentInput"),p.classList.add("hidden"))})),C.value=a,C.classList.remove("accentInput"),p.classList.add("hidden")):C&&C.parentElement.removeChild(C);var m=i.getElementsByClassName(T.a.PALETTE_POPUP_DESCRIPTION)[0];null!=s?(m||((m=document.createElement("div")).classList.add(T.a.PALETTE_POPUP_DESCRIPTION),i.appendChild(m)),m.innerText=s):m&&m.parentElement.removeChild(m);var v=document.createElement("button");v.classList.add(T.a.PALETTE_POPUP_CANCEL),v.innerText=z.CANCEL,i.appendChild(v),v.addEventListener("click",function(){return h.closePalettePopup()}),(d=document.createElement("button")).classList.add(T.a.PALETTE_POPUP_CONFIRM),n&&d.classList.add(n),d.innerText=r,i.appendChild(d),d.onclick=function(t){var r=i.getElementsByClassName(T.a.PALETTE_POPUP_INPUT)[0];if(r)if(j.a.isMobileDevice()||h.focus(r),r.value.trim().length>0)e({e:t,value:r.value.trim(),idx:o});else{var n=i.getElementsByClassName("paletteInputEmpty")[0];r.classList.add("accentInput"),n&&n.classList.remove("hidden"),t.stopPropagation(),t.preventDefault()}else e({e:t,idx:o})},document.body.appendChild(this.palettePopup),C&&(this.focus(C),C.select())}},{key:"closePalettePopup",value:function(){this.palettePopup&&this.palettePopup.parentElement&&(this.palettePopup.parentElement.removeChild(this.palettePopup),this.palettePopup=null)}},{key:"initUsedColors",value:function(){var e=this;U.a.instance.dispatch(new b.c(function(){var t=s()(n.a.mark(function t(o,r){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=e.lastParam&&e.lastParam.isMultiColor,e.usedColors.clear(),o.pages.forEach(function(t){var o=t.getAllSingleItems(),n=t.background;if(n&&!(n.backgroundItem instanceof y.a)&&n.color){var s=new Set;s.add(n.color),e.addToUsedColors(s);var i=o.findIndex(function(e){return!0===e.select});r.renderPageIdx===t.pageIdx&&-1===i||e.setSameBackgroundColorSetInfo(t,n.color)}var l=!0,c=!1,d=void 0;try{for(var h,u=o[Symbol.iterator]();!(l=(h=u.next()).done);l=!0){var p=h.value;e.addToUsedColors(p.getUsedColor()),a||(p instanceof I.a?e.setSameSvgColorSetInfo(p):p instanceof D.a?e.setSameTextColorSetInfo(p):p instanceof R.d?e.setSamePhotoColorSetInfo(p):p instanceof _.a&&e.setSameGridColorSetInfo(p))}}catch(e){c=!0,d=e}finally{try{l||null==u.return||u.return()}finally{if(c)throw d}}});case 4:case"end":return t.stop()}},t)}));return function(e,o){return t.apply(this,arguments)}}()))}},{key:"isSameOutlineColor",value:function(e){if((e instanceof M.a||e instanceof D.a)&&e.props.isActiveOutline()){var t=e.props.getOutlineColor();if(e instanceof D.a&&!t.startsWith("#")&&(t=new A.a(t).rgb),this.prevColor.substring(0,7).toLowerCase()===t.toLowerCase())return!0}return!1}},{key:"isSameShadowColor",value:function(e){if((e instanceof I.a||e instanceof R.d||e instanceof D.a)&&e.props.isActiveShadow()){var t=e.props.getShadowColor();if(this.prevColor.substring(0,7).toLowerCase()===t.toLowerCase())return!0}return!1}},{key:"setSameBackgroundColorSetInfo",value:function(e,t){this.isTransparent(this.prevColor)||this.prevColor.substring(0,7).toLowerCase()===t.toLowerCase()&&this.sameColorSetInfos.push({item:void 0,page:e})}},{key:"setSameSvgColorSetInfo",value:function(e){if(!this.isTransparent(this.prevColor)){var t=e.getOriginColorsByColor(this.prevColor,!0),o=this.isSameOutlineColor(e),r=this.isSameShadowColor(e),n=(t?t.length:0)+(o?1:0)+(r?1:0);(e.select&&n>1||!e.select&&n>0)&&this.sameColorSetInfos.push({item:e,originColors:t,isSameOutlineColor:o,isSameShadowColor:r})}}},{key:"setSameTextColorSetInfo",value:function(e){var t,o=[],r=this.prevColor.toLowerCase(),n=r.length>7?r.substr(0,7):r,a=this.isTransparent(r),s=!1,i=!1,l=[];a||(e.props.getCharsOfLines().forEach(function(e,t){e.forEach(function(e,r){var a=e.color.toLowerCase();a.startsWith("#")||(a=new A.a(a).rgb),a===n&&o.push(new x.a(t,r))})}),s=this.isSameOutlineColor(e),i=this.isSameShadowColor(e));var c=o.length>0,d=e.props.getGradient();if(d.getColorItems().forEach(function(e){d.isSameGradientColor(e.idx,n,a)&&l.push(e.idx)}),t=o.length+(s?1:0)+(i?1:0)+l.length,!e.select&&t>0||e.select&&t>1){var h={item:e,targetSelPosList:o,isSameFontColor:c,isSameBgColor:!1,isSameOutlineColor:s,isSameShadowColor:i,targetGradationPosList:l};this.sameColorSetInfos.push(h)}}},{key:"setSamePhotoColorSetInfo",value:function(e){if(!e.select&&!this.isTransparent(this.prevColor)){var t=this.isSameShadowColor(e);t&&this.sameColorSetInfos.push({item:e,isSameShadowColor:t})}}},{key:"setSameGridColorSetInfo",value:function(e){if(!e.select||e.existSelectedCell()){var t=0,o=this.isTransparent(this.prevColor),r=this.prevColor.substring(0,7).toLowerCase(),n=e.getUsedColorsByColor(this.prevColor,o);n.forEach(function(e){t+=(e.bg?1:0)+(e.left?1:0)+(e.top?1:0)+(e.right?1:0)+(e.bottom?1:0)+(e.downDiagonal?1:0)+(e.upDiagonal?1:0)+(e.text?1:0)});var a=!1;if(!e.select&&!o)e.props.getCellBorderColor().substring(0,7).toLowerCase()===r&&(a=!0,t++);(e.select&&e.existSelectedCell()&&t>1||!e.select&&t>0)&&this.sameColorSetInfos.push({item:e,isSameCellBorderColor:a,cellColorInfos:n})}}},{key:"initUsedColorsUI",value:function(){var e=this;this.initUsedColors(),this.usedColorsArea.innerHTML="";var t=this.makePaletteSet({colors:Array.from(this.usedColors),canAddColor:!0});this.usedColorsArea.appendChild(t);var o=t.getElementsByClassName(T.a.ADD_COLOR)[0];this.newColorChip=document.createElement("div"),this.newColorChip.classList.add(T.a.COLOR_CHIP,T.a.HIDDEN_CHIP),this.newColorChip.addEventListener("click",function(){e.setColor(e.newColorChip.style.backgroundColor)}),o.after(this.newColorChip)}},{key:"updateUsedColorsUI",value:function(){this.currColor&&(this.usedColors.has(this.currColor)||this.isTransparent(this.currColor)?(this.newColorChip.classList.add(T.a.COLOR_CHIP,T.a.HIDDEN_CHIP),this.newColorChip.removeAttribute("style")):(this.newColorChip.classList.remove(T.a.HIDDEN_CHIP),this.newColorChip.setAttribute("style","background-color:"+this.currColor.substr(0,7))))}},{key:"onResultUserColorPalettes",value:function(e){var t=this;this.userPaletteArea.innerHTML="",P.a.getUser().isLogin()&&(!e||e.length<=0||e.forEach(function(e){var o=t.makePaletteSet({name:e.name,idx:e.idx,colors:e.colors,canAddColor:!0,canDeleteColor:!0});t.userPaletteArea.appendChild(o)}))}},{key:"initBtnAddNewPaletteUI",value:function(){var e=this;this.btnAddNewPalette||(this.btnAddNewPalette=document.createElement("button"),this.btnAddNewPalette.classList.add(T.a.ADD_NEW_PALETTE),this.btnAddNewPalette.innerText=z.ADD_NEW_PALETTE,Object(S.setToolsIcon)(this.btnAddNewPalette,S.ToolsIcon.PALETTE),this.btnAddNewPalette.addEventListener("click",function(){P.a.getUser().isLogin()?e.openPalettePopup(function(o){G.addPalette(o.value).then(function(t){e.closePalettePopup();var o=G.getPalette(t),r=e.makePaletteSet({name:o.name,idx:o.idx,colors:o.colors,canAddColor:!0,canDeleteColor:!0});e.userPaletteArea.prepend(r),e.selectedPaletteSet=r,e.selectedPaletteIdx=t,e.setCustomMode()}).catch(function(){e.closePalettePopup(),alert(t.ERROR_MSG)})},z.TO_ADD_NEW_PALETTE,-1,z.CONFIRM,null,""):B.a.openLoginPopup(L.a.SETTING,function(){e.closeColorControl()})})),this.btnAddNewPalette.parentElement!==this.paletteWrapper&&this.paletteWrapper.appendChild(this.btnAddNewPalette)}},{key:"updateUserPaletteWrapperUI",value:function(){this.userPaletteWrapper.innerHTML="";var e=G.getPalette(this.selectedPaletteIdx),t=this.makePaletteSet({colors:e.colors,canAddColor:!0,canDeleteColor:!0});this.userPaletteWrapper.appendChild(t)}},{key:"initColorDisplayUI",value:function(e){var t;e?this.prevColorChip.classList.add(T.a.MULTI_COLOR):(this.prevColorChip.classList.remove(T.a.MULTI_COLOR),this.isTransparent(this.prevColor)?(t=this.prevColor,this.prevColorChip.classList.add(T.a.TRANSPARENT_CHIP)):(t=this.prevColor.substr(0,7),this.prevColorChip.innerHTML="",this.prevColorChip.classList.remove(T.a.TRANSPARENT_CHIP))),this.prevColorChip.setAttribute("style","background-color:"+t),this.changeToRight&&this.changeToRight.parentElement&&(this.changeToRight.parentElement.removeChild(this.changeToRight),this.changeToRight=null),this.currColorChip&&this.currColorChip.parentElement&&(this.currColorChip.parentElement.removeChild(this.currColorChip),this.currColorChip=null)}},{key:"updateColorDisplayUI",value:function(e){var t,o=this;if(!e&&!this.currColor)return this.changeToRight&&this.changeToRight.parentElement&&this.changeToRight.parentElement.removeChild(this.changeToRight),void(this.currColorChip&&this.currColorChip.parentElement&&this.currColorChip.parentElement.removeChild(this.currColorChip));this.changeToRight||(this.changeToRight=document.createElement("span"),Object(S.setToolsIcon)(this.changeToRight,S.ToolsIcon.GREATER_THAN),this.changeToRight.classList.add(T.a.CHANGE_TO_RIGHT)),this.colorDisplay.appendChild(this.changeToRight),this.currColorChip||(this.currColorChip=document.createElement("span"),this.currColorChip.classList.add(T.a.COLOR_CHIP),this.currColorChip.addEventListener("click",function(){o.prevMode===K.CUSTOM_MODE&&o.currMode===K.DIRECT_MODE||o.setColor(o.currColorChip.style.backgroundColor)})),e=e||this.currColor,this.isTransparent(e)?(t=e,this.currColorChip.classList.add(T.a.TRANSPARENT_CHIP)):(t=e.substr(0,7),this.currColorChip.innerHTML="",this.currColorChip.classList.remove(T.a.TRANSPARENT_CHIP)),this.currColorChip.setAttribute("style","background-color:"+t),this.colorDisplay.appendChild(this.currColorChip)}},{key:"updateHexAreaUI",value:function(e){if(e){var t=this.toHexString(this.hexChip.style.backgroundColor),o=this.toHexString(this.hexInput.value),r=this.toHexString(e.value);t!==r&&(this.isTransparent(r)?(this.hexChip.classList.add(T.a.TRANSPARENT_CHIP),this.hexChip.style.background=""):(this.hexChip.classList.remove(T.a.TRANSPARENT_CHIP),this.hexChip.style.background=r.substr(0,7))),o!==r&&(this.isTransparent(r)?this.hexInput.value="":this.hexInput.value=r.substr(0,7))}}},{key:"makeSpoidElement",value:function(){var e=document.createElement("div");e.classList.add(T.a.SPOID);var t=O.a.createCanvas();t.width=128,t.height=128,t.classList.add(T.a.MAGNIFIER),e.appendChild(t);var o=document.createElement("div");o.classList.add(T.a.RECT),e.appendChild(o);var r=document.createElement("div");r.classList.add(T.a.SPOID_COLOR_INFO),e.appendChild(r);var n=document.createElement("span");n.classList.add(T.a.SPOID_COLOR),r.appendChild(n);var a=document.createElement("span");return a.classList.add(T.a.SPOID_COLOR_CODE),r.appendChild(a),e}},{key:"changeToSpoidMode",value:(o=s()(n.a.mark(function e(o){var r,a,s,i,l,c,d,h,u,p,C,m,v,E,f,S,L=this;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=document.createElement("div")).classList.add(T.a.PAGE_SPOID),a=N.a.instance.pageController.getPageRenderer(o).element,s=N.a.instance.pageController.getPageRenderer(o).contents,a.appendChild(r),r.style.top="".concat(s.offsetTop,"px"),r.style.left="".concat(s.offsetLeft,"px"),r.style.width=s.style.width,r.style.height=s.style.height,i=N.a.instance,l=i.zoomScale,c=o.editScale,d=o.sheetSize.width*c,h=o.sheetSize.height*c,(u=O.a.createCanvas()).width=d*l,u.height=h*l,u.classList.add(T.a.SPOID_CANVAS),p=u.getContext("2d"),(C=new Image).onload=function(){p.drawImage(C,0,0,u.width,u.height)},e.next=23,o.renderThumbnail(d,h,c);case 23:m=e.sent,C.src=m,r.appendChild(u),v=t.spoidElement.getElementsByClassName(T.a.MAGNIFIER)[0],E=v.getContext("2d"),f=function e(n){if(N.a.isSpoidMode()){var a=t.spoidElement.getElementsByClassName(T.a.SPOID_COLOR)[0],s=t.spoidElement.getElementsByClassName(T.a.SPOID_COLOR_CODE)[0],l=Math.round(n.offsetX),c=Math.round(n.offsetY),d=p.getImageData(l,c,1,1).data;L.spoidColor=L.toHexString("rgb(".concat(d[0],", ").concat(d[1],", ").concat(d[2],")")),E.clearRect(0,0,v.width,v.height);var h=l-7.5,C=c-7.5,m=v.width/16,f=v.height/16,g=Math.max(h,0),P=Math.max(C,0),O=Math.min(u.width-h,16),A=Math.min(u.height-C,16),I=-Math.min(h,0)*m,_=-Math.min(C,0)*f,R=O*m,y=A*f;E.drawImage(u,g,P,O,A,I,_,R,y);var M=L.spoidColor.substr(0,7);a.style.background=M,s.innerText=M,0===i.pageController.getPageRenderer(o).element.getElementsByClassName(T.a.MAGNIFIER).length&&(t.spoidElement.removeEventListener("mousemove",e),t.spoidElement.addEventListener("mousemove",e),t.spoidElement.removeEventListener("mouseleave",S),t.spoidElement.addEventListener("mouseleave",S),t.spoidElement.removeEventListener("mousedown",L.spoidDownHandler),t.spoidElement.addEventListener("mousedown",L.spoidDownHandler),r.appendChild(t.spoidElement)),t.spoidElement.style.left="".concat(n.offsetX-v.width/2,"px"),t.spoidElement.style.top="".concat(n.offsetY-v.height/2,"px"),(l<0||l>=u.width||c<0||c>=u.height)&&t.spoidElement.parentElement&&(t.spoidElement.removeEventListener("mousemove",e),t.spoidElement.removeEventListener("mousedown",L.spoidDownHandler),r.removeChild(t.spoidElement))}},S=function(e){var o=$(u).offset(),r=e.pageX-Math.round(o.left),n=e.pageY-Math.round(o.top);(r<0||r>=u.width||n<0||n>=u.height)&&t.spoidElement.parentElement&&(t.spoidElement.removeEventListener("mousemove",f),t.spoidElement.removeEventListener("mousedown",L.spoidDownHandler),t.spoidElement.parentElement.removeChild(t.spoidElement))},u.addEventListener("mouseenter",f),u.addEventListener("mousemove",f),u.addEventListener("mouseleave",S),u.addEventListener("mousedown",this.spoidDownHandler);case 34:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"startSpoidMode",value:function(){var e=this;U.a.instance.dispatch(new b.c(function(){var o=s()(n.a.mark(function o(r,a,s){var i,l,c,d,h,u,p;return n.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!N.a.isSpoidMode()){o.next=2;break}return o.abrupt("return");case 2:for(N.a.setSpoidMode(),t.spoidPageIdx=a.renderPageIdx,e.spoidStartScrollPosition=new Y.a(s.canvasAreaVC.scrollElement.getScrollX(),s.canvasAreaVC.scrollElement.getScrollY()),e.colorControlPopup.parentElement&&e.colorControlPopup.parentElement.removeChild(e.colorControlPopup),s.renderHandler(r,a),s.canvasAreaVC.scrollElement.getScrollY(),t.spoidElement||(t.spoidElement=e.makeSpoidElement()),i=t.spoidElement.getElementsByClassName(T.a.MAGNIFIER)[0],i.getContext("2d").imageSmoothingEnabled=!1,t.eventListeners=[],l=!0,c=!1,d=void 0,o.prev=16,h=function(){var o=p.value,r=function t(){e.changeToSpoidMode(o),a.pageController.getPageRenderer(o).contents.removeEventListener("mouseenter",t)};t.eventListeners.push(r),a.pageController.getPageRenderer(o).contents.addEventListener("mouseenter",r)},u=r.pages[Symbol.iterator]();!(l=(p=u.next()).done);l=!0)h();o.next=25;break;case 21:o.prev=21,o.t0=o.catch(16),c=!0,d=o.t0;case 25:o.prev=25,o.prev=26,l||null==u.return||u.return();case 28:if(o.prev=28,!c){o.next=31;break}throw d;case 31:return o.finish(28);case 32:return o.finish(25);case 33:case"end":return o.stop()}},o,null,[[16,21,25,33],[26,,28,32]])}));return function(e,t,r){return o.apply(this,arguments)}}()))}},{key:"endSpoidMode",value:function(e){var o=this;U.a.instance.dispatch(new b.c(function(){var r=s()(n.a.mark(function r(a,s,i){var l,c,d,h,u,p,C,m;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(N.a.isSpoidMode()){r.next=2;break}return r.abrupt("return");case 2:for(N.a.setDefaultMode(),s.renderPageIdx=t.spoidPageIdx,o.spoidStartScrollPosition&&(i.setScroll(o.spoidStartScrollPosition.x,o.spoidStartScrollPosition.y),o.spoidStartScrollPosition=null),o.colorControlPopup.parentElement||document.body.appendChild(o.colorControlPopup),i.renderHandler(a,s),l=!0,c=!1,d=void 0,r.prev=10,h=a.pages[Symbol.iterator]();!(l=(u=h.next()).done);l=!0)p=u.value,(C=s.pageController.getPageRenderer(p).element.getElementsByClassName(T.a.PAGE_SPOID)[0])&&((m=C.getElementsByClassName(T.a.SPOID_CANVAS)[0])&&m.parentElement.removeChild(m),C.parentElement.removeChild(C)),s.pageController.getPageRenderer(p).contents.removeEventListener("mouseenter",t.eventListeners.splice(0,1)[0]);r.next=18;break;case 14:r.prev=14,r.t0=r.catch(10),c=!0,d=r.t0;case 18:r.prev=18,r.prev=19,l||null==h.return||h.return();case 21:if(r.prev=21,!c){r.next=24;break}throw d;case 24:return r.finish(21);case 25:return r.finish(18);case 26:if(t.spoidElement&&t.spoidElement.parentElement&&(t.spoidElement.removeEventListener("mousedown",o.spoidDownHandler),t.spoidElement.parentElement.removeChild(t.spoidElement)),!e){r.next=31;break}o.setColor(e),r.next=33;break;case 31:return r.next=33,s.editorMainVC.canvasAreaVC.renderAuto(a,s);case 33:o.focus(o.container);case 34:case"end":return r.stop()}},r,null,[[10,14,18,26],[19,,21,25]])}));return function(e,t,o){return r.apply(this,arguments)}}()))}},{key:"focus",value:function(e){e.focus({preventScroll:!0})}},{key:"changeColor",value:function(e){e=this.toHexString(e);var t=this.isTransparent(e)?e:e.substr(0,7);if(2===this.listener.length){var o=this.originColor.substr(0,7);("Netscape"===navigator.appName&&-1!==navigator.userAgent.search("Trident")||-1!==navigator.userAgent.indexOf("MSIE"))&&(o=o.toLowerCase()),this.listener(o,t)}else this.listener(t)}},{key:"changeAllSameColors",value:function(e,t){var o=this,r=this.toHexString(e),n=this.toHexString(t),a=this.isTransparent(r)?r:r.substr(0,7),s=this.isTransparent(n)?n:n.substr(0,7);this.isContinuousSameColorChange?U.a.instance.groupingAction(function(){U.a.instance.dispatch(new k(o.sameColorSetInfos,a,s)),o.changeColor(o.currColor)}):(U.a.instance.dispatch(new k(this.sameColorSetInfos,a,s)),this.isContinuousSameColorChange=!0)}},{key:"updateChangeSameColorsUI",value:function(e){var t=this;if(this.useChangeSameColors&&e&&!e.hideChangeSameColors&&this.sameColorSetInfos.length>0&&this.currColor&&!this.changeSameColors){this.changeSameColors=document.createElement("span"),this.changeSameColors.classList.add(T.a.CHANGE_SAME_COLORS),this.footer.appendChild(this.changeSameColors);var o=document.createElement("span");Object(S.setToolsIcon)(o,S.ToolsIcon.CHECK),o.classList.add(T.a.CHANGE_SAME_COLORS_CHECK),this.changeSameColors.appendChild(o);var r=document.createElement("span");r.classList.add(T.a.CHANGE_SAME_COLORS_TEXT),r.classList.add(T.a.CHANGE_SAME_COLORS_CONTENT),r.innerText=z.CHANGE_ALL_SAME_COLORS,this.changeSameColors.appendChild(r),$(this.changeSameColors).on("click",function(){t.changeSameColors&&(t.changeSameColors.classList.contains(T.a.ACTIVE)?(t.changeSameColors.classList.remove(T.a.ACTIVE),t.changeAllSameColors(t.currColorChip.style.backgroundColor,t.prevColorChip.style.backgroundColor),t.isContinuousSameColorChange=!1):(t.changeSameColors.classList.add(T.a.ACTIVE),t.changeAllSameColors(t.prevColorChip.style.backgroundColor,t.currColorChip.style.backgroundColor)))})}}},{key:"setColorControlLocation",value:function(e,t){var o=this.container.offsetWidth,r=this.container.offsetHeight,n=$(window).width(),a=$(window).height(),s=Math.max(20,e);s+o>n&&(s=n-o);var i=t+20;i+r>a&&(i=(i=t-20-r)>=60?i:60),this.container.style.left="".concat(s,"px"),this.container.style.top="".concat(i,"px")}},{key:"moveScrollY",value:function(e){return this.scrollContent.scrollTop+=this.scrollContent.scrollHeight/this.scrollContent.clientHeight*e,this}},{key:"setOriginColor",value:function(e){this.originColor=this.toHexString(e)}},{key:"openColorControl",value:function(e,t,o){var r=this;this.setDefaultMode(),this.prevColor=this.toHexString(e.value),this.colorControlPopup.appendChild(this.container),e.canNotAppend||document.body.appendChild(this.colorControlPopup),this.initBtnAddNewPaletteUI(),this.initColorDisplayUI(e.isMultiColor),this.updateUI(e),this.initUsedColorsUI(),this.setColorControlLocation(t,o),G.fetchColorPalettes(this),window.addEventListener("keydown",this.keyDownHandler),window.addEventListener("resize",this.resizeHandler),document.addEventListener("mousedown",this.mouseDownHandler),document.body.addEventListener("mousemove",this.colorSelectorsMoveHandler),document.body.addEventListener("touchmove",function(e){return r.colorSelectorsMoveHandler(e,!0)}),document.body.addEventListener("mouseup",this.colorSelectorsUpHandler),document.body.addEventListener("touchend",this.colorSelectorsUpHandler)}},{key:"closeColorControl",value:function(){this.callback&&this.callback(),this.endSpoidMode();var e=this.colorControlPopup;e.parentElement&&e.parentElement.removeChild(e),this.closePaletteMenu(),this.prevColor=null,this.currColor=null,this.selectedPaletteSet=null,this.selectedPaletteIdx=null,this.numOfSelectedColors=0,this.container.classList.remove(T.a.ACTIVE),this.sameColorSetInfos=[],this.backupColorSetInfos=[],this.changeSameColors&&this.changeSameColors.parentElement&&this.changeSameColors.parentElement.removeChild(this.changeSameColors),this.changeSameColors=null,this.isContinuousSameColorChange=!1,window.removeEventListener("keydown",this.keyDownHandler),window.removeEventListener("resize",this.resizeHandler),document.removeEventListener("mousedown",this.mouseDownHandler),document.body.removeEventListener("mousemove",this.colorSelectorsMoveHandler),document.body.removeEventListener("touchmove",this.colorSelectorsMoveHandler),document.body.removeEventListener("mouseup",this.colorSelectorsUpHandler),document.body.removeEventListener("touchend",this.colorSelectorsUpHandler)}},{key:"updateUI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lastParam;if(this.onCreateViewIfNotCreated(),!(!this.prevColor||this.currColor&&e&&this.toHexString(e.value)!==this.currColor)){this.useTransparent&&this.paletteTransparentContent&&this.directSetTransparentContent&&(e&&e.hideTransparent?(this.paletteTransparentContent.classList.remove(T.a.ACTIVE),this.directSetTransparentContent.classList.remove(T.a.ACTIVE)):(this.paletteTransparentContent.classList.add(T.a.ACTIVE),this.directSetTransparentContent.classList.add(T.a.ACTIVE))),(this.prevColor!==this.currColor||this.newColorChip)&&this.updateUsedColorsUI();var t=this.currColor?this.currColor:this.prevColor;this.updateColorSelectAreaUI(t),this.updateColorDisplayUI(),this.updateChangeSameColorsUI(e),this.updateHexAreaUI(e),this.lastParam=e}}},{key:"addEventListener",value:function(){var e=this;this.btnClose.addEventListener("click",function(){e.closeColorControl()}),$(this.colorControlPopup).on("mousedown",function(t){e.container.contains(t.target)||e.closeColorControl()}),this.btnBack.addEventListener("click",function(){if(e.prevMode===K.DEFAULT_MODE||e.currMode===K.CUSTOM_MODE)e.setDefaultMode(),e.updateSelectedUserPalette(),e.selectedPaletteSet&&(e.selectedPaletteSet.classList.remove(T.a.ACTIVE),e.selectedPaletteSet=null,e.selectedPaletteIdx=null);else if(e.prevMode===K.CUSTOM_MODE){var o=e.selectedPaletteIdx,r=e.toHexString(e.hexChip.style.backgroundColor).substr(0,7);G.addColor(o,r).then(function(){e.updateSelectedUserPalette()}).catch(function(){alert(t.ERROR_MSG)}),e.setCustomMode(),e.updateColorDisplayUI();var n=e.currColor?e.currColor:e.prevColor;e.updateHexAreaUI({value:n})}}),this.btnMore.addEventListener("click",function(t){t.stopPropagation(),e.btnMore.classList.contains(T.a.ACTIVE)?e.closePaletteMenu():e.openPaletteMenu()}),this.spoidMode&&this.spoidMode.addEventListener("click",function(){e.startSpoidMode()}),this.container.addEventListener("keydown",function(e){e.stopPropagation()}),this.container.addEventListener("click",function(t){e.closePaletteMenu()})}},{key:"setColor",value:function(e){var t=this,o=this.toHexString(e);if(this.currColor&&this.currColor===o)this.updateColorDisplayUI();else{var r=this.currColor;this.currColor=o,this.isTransparent(o)?this.sameColorSetInfos.forEach(function(e){e.item instanceof D.a&&e.isSameFontColor&&t.backupColorSetInfos.push(e)}):this.backupColorSetInfos.length&&(this.backupColorSetInfos=[]);var n=this.changeSameColors;n&&this.enableStyle(0===this.sameColorSetInfos.length,n,T.a.HIDE),n&&n.parentElement&&n.classList.contains(T.a.ACTIVE)?this.changeAllSameColors(r,this.currColor):this.changeColor(this.currColor)}}}],[{key:"hexToRgb",value:function(e){if(!e||e.length<7)return null;var t=e.substring(0,7),o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return o?{r:parseInt(o[1],16),g:parseInt(o[2],16),b:parseInt(o[3],16)}:null}}]),t}(W.a);Q.ERROR_MSG="오류가 발생했습니다",Q.BASE_COLOR_CHART=["#000000FF","#595959FF","#787878FF","#9E9E9EFF","#C2C2C2FF","#EEEEEEFF","#FFFFFFFF","#FECCBEFF","#FEEBB6FF","#DDECCAFF","#B8E6E1FF","#B8E9FFFF","#CCD2F0FF","#E0BFE6FF","#FD8A69FF","#FFCD4AFF","#AFD485FF","#82CBC4FF","#58CCFFFF","#9FA9D8FF","#B96BC6FF","#FC5230FF","#FD9F28FF","#7DB249FF","#2FA599FF","#18A8F1FF","#5D6DBEFF","#9A30AEFF","#D94925FF","#FD6F22FF","#568A35FF","#12887AFF","#1187CFFF","#3A4CA8FF","#692498FF"],Q.COLOR_BAR_POINTS=[{r:255,g:0,b:0},{r:255,g:255,b:0},{r:0,g:255,b:0},{r:0,g:255,b:255},{r:0,g:0,b:255},{r:255,g:0,b:255}],Q.KEY_MAP=new Map([["ㅁ","a"],["ㅠ","b"],["ㅊ","c"],["ㅇ","d"],["ㄷ","e"],["ㄹ","f"]]),Q.eventListeners=[],function(e){e[e.DEFAULT_MODE=0]="DEFAULT_MODE",e[e.DIRECT_MODE=1]="DIRECT_MODE",e[e.CUSTOM_MODE=2]="CUSTOM_MODE",e[e.EDIT_MODE=3]="EDIT_MODE"}(K||(K={})),function(e){e.COLOR="색상",e.TRANSPARENT="투명",e.BASIC_PALETTE="기본 팔레트",e.SET_DIRECTLY="직접 지정",e.ADD_NEW_PALETTE="새 팔레트 추가",e.TO_ADD_NEW_PALETTE="새 팔레트 추가하기",e.EDIT_PALETTE_NAME="팔레트 이름 수정",e.TO_EDIT_PALETTE_NAME="팔레트 이름 수정하기",e.DELETE_PALETTE="팔레트 삭제",e.TO_DELETE_PALETTE="팔레트 삭제하기",e.ADD_COLOR="색상 추가",e.DELETE_COLOR="색상 제거",e.CHANGE_ALL_SAME_COLORS="같은 색상 모두 변경",e.INPUT_NAME="이름을 입력해주세요.",e.SELECT_COLORS_TO_DELETE="삭제할 색상을 선택하세요.",e.ASK_AGAIN_BEFORE_DELETE="삭제한 팔레트는 다시 복구할 수 없습니다. 정말 삭제하시겠습니까?",e.CONFIRM="확인",e.DELETE="삭제",e.COMPLETE="완료",e.CANCEL="취소",e.QUANTITY="개"}(z||(z={}))}}]);